<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 RSA on Pattern Similarity Change | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</title>
  <meta name="description" content="8 RSA on Pattern Similarity Change | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="8 RSA on Pattern Similarity Change | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jacbel.github.io/virtem_code/" />
  
  <meta property="og:description" content="8 RSA on Pattern Similarity Change | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="github-repo" content="jacbel/virtem_code" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 RSA on Pattern Similarity Change | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  
  <meta name="twitter:description" content="8 RSA on Pattern Similarity Change | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  

<meta name="author" content="Jacob L. S. Bellmund" />


<meta name="date" content="2022-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="run-rsa-searchlight.html"/>
<link rel="next" href="signal-to-noise-ratio.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contents"><i class="fa fa-check"></i><b>1.2</b> Contents</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.3</b> Contact</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#license-information"><i class="fa fa-check"></i><b>1.4</b> License Information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analysis-setup.html"><a href="analysis-setup.html"><i class="fa fa-check"></i><b>2</b> Analysis Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analysis-setup.html"><a href="analysis-setup.html#defining-variables-and-folders"><i class="fa fa-check"></i><b>2.1</b> Defining Variables and Folders</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#folder-structure"><i class="fa fa-check"></i>Folder Structure</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="analysis-setup.html"><a href="analysis-setup.html#define-analysis-functions"><i class="fa fa-check"></i><b>2.2</b> Define Analysis Functions</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#analysis-logic"><i class="fa fa-check"></i>Analysis Logic</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#brain-plots-in-ggplot"><i class="fa fa-check"></i>Brain Plots in ggplot</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#ggbrain-functions-to-get-template-background"><i class="fa fa-check"></i>ggBrain functions to get template background</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#waiting-for-cluster-jobs"><i class="fa fa-check"></i>Waiting for Cluster Jobs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html"><i class="fa fa-check"></i><b>3</b> Illustrations of Task Design and Analysis Logic</a>
<ul>
<li class="chapter" data-level="3.1" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#day-learning-task-design"><i class="fa fa-check"></i><b>3.1</b> Day Learning Task Design</a>
<ul>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-and-real-time"><i class="fa fa-check"></i>Events in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-time"><i class="fa fa-check"></i>Events in virtual time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-real-time"><i class="fa fa-check"></i>Events in real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#correlations-of-virtual-time-with-order-and-real-time"><i class="fa fa-check"></i>Correlations of virtual time with order and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#time-cues-in-virtual-and-real-time"><i class="fa fa-check"></i>Time cues in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#supplemental-figure-for-task-design"><i class="fa fa-check"></i>Supplemental figure for task design</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#representational-similarity-analysis-logic"><i class="fa fa-check"></i><b>3.2</b> Representational Similarity Analysis Logic</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html"><i class="fa fa-check"></i><b>4</b> Prepare behavioral data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#sorting-task"><i class="fa fa-check"></i><b>4.1</b> Sorting task</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#timeline-task"><i class="fa fa-check"></i><b>4.2</b> Timeline task</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#picture-viewing-tasks"><i class="fa fa-check"></i><b>4.3</b> Picture viewing tasks</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html"><i class="fa fa-check"></i><b>5</b> Behavioral Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-task-1"><i class="fa fa-check"></i><b>5.1</b> Sorting Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#calculate-percentage-of-correct-responses"><i class="fa fa-check"></i>Calculate percentage of correct responses</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#plot-sorting-performance"><i class="fa fa-check"></i>Plot sorting performance</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Sorting errors as a function of sequence position</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#timeline-task-1"><i class="fa fa-check"></i><b>5.2</b> Timeline Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#visualize-the-raw-data"><i class="fa fa-check"></i>Visualize the raw data</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#accuracy-of-remembered-times"><i class="fa fa-check"></i>Accuracy of remembered times</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#relationship-of-sorting-errors-and-timeline-errors"><i class="fa fa-check"></i>Relationship of sorting errors and timeline errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#time-metrics-underlying-remembered-times"><i class="fa fa-check"></i>Time metrics underlying remembered times</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#compose-figure-for-behavioral-data"><i class="fa fa-check"></i>Compose Figure for Behavioral Data</a></li>
<li class="chapter" data-level="5.3" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#generalization-bias"><i class="fa fa-check"></i><b>5.3</b> Generalization bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#test-generalization-bias"><i class="fa fa-check"></i>Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-of-generalization-bias"><i class="fa fa-check"></i><b>5.4</b> Replication of Generalization Bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Replication data: Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-test-generalization-bias"><i class="fa fa-check"></i>Replication data: Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors"><i class="fa fa-check"></i><b>5.5</b> Swap Errors</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#descriptives-of-swap-errors"><i class="fa fa-check"></i>Descriptives of swap errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Swap errors as a function of sequence position</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-error-more-frequent-than-expected-from-chance"><i class="fa fa-check"></i>Swap error: More frequent than expected from chance?</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-and-generalization-bias"><i class="fa fa-check"></i>Swap errors and generalization bias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html"><i class="fa fa-check"></i><b>6</b> Prepare (f)MRI Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#regions-of-interest"><i class="fa fa-check"></i><b>6.1</b> Regions of Interest</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#freesurfer-masks"><i class="fa fa-check"></i>FreeSurfer Masks</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#subregion-masks-mni"><i class="fa fa-check"></i>Subregion masks (MNI)</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#final-rois-from-intersection-of-masks"><i class="fa fa-check"></i>Final ROIs from intersection of masks</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#group-level-masks"><i class="fa fa-check"></i><b>6.2</b> Group-Level Masks</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#probabilistic-rois-for-visualization"><i class="fa fa-check"></i>Probabilistic ROIs for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#field-of-view-mask-for-visualization"><i class="fa fa-check"></i>Field of view mask for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#gray-matter-mask"><i class="fa fa-check"></i>Gray matter mask</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#small-volume-correction-mask"><i class="fa fa-check"></i>Small Volume Correction Mask</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#quantify-representational-change"><i class="fa fa-check"></i><b>6.3</b> Quantify Representational Change</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#get-multi-voxel-patterns-from-rois"><i class="fa fa-check"></i>Get multi-voxel patterns from ROIs</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-correlation-matrices"><i class="fa fa-check"></i>Calculate correlation matrices</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-pattern-similarity-change"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#combine-behavioral-and-fmri-data-for-rsa"><i class="fa fa-check"></i><b>6.4</b> Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html"><i class="fa fa-check"></i><b>7</b> Run RSA Searchlight</a>
<ul>
<li class="chapter" data-level="7.1" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-functional-data"><i class="fa fa-check"></i><b>7.1</b> Prepare functional data</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#data-cleaning-extract-residuals-from-motion-parameter-regression"><i class="fa fa-check"></i>Data cleaning: Extract residuals from motion parameter regression</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#extract-relevant-volumes-1"><i class="fa fa-check"></i>Extract relevant volumes</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#concatenate-relevant-volumes"><i class="fa fa-check"></i>Concatenate relevant volumes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#first-level-rsa-searchlight"><i class="fa fa-check"></i><b>7.2</b> First-level RSA searchlight</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#set-analysis-parameters"><i class="fa fa-check"></i>Set analysis parameters</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-predictions"><i class="fa fa-check"></i>Prepare RSA-predictions</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-lookup-table-for-searchlight"><i class="fa fa-check"></i>Create lookup table for searchlight</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#dataframe-with-input-for-analysis"><i class="fa fa-check"></i>Dataframe with input for analysis</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#searchlight-implementation"><i class="fa fa-check"></i>Searchlight implementation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#group-level-searchlight-analysis"><i class="fa fa-check"></i><b>7.3</b> Group-level searchlight analysis</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#move-first-level-images-to-mni-space"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#merge-and-smooth-first-level-images"><i class="fa fa-check"></i>Merge and smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#run-fsl-randomise"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#find-searchlight-clusters-and-atlas-labels"><i class="fa fa-check"></i>Find searchlight clusters and atlas labels</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-outlines-of-significant-clusters"><i class="fa fa-check"></i>Create outlines of significant clusters</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-in-searchlight-peak"><i class="fa fa-check"></i><b>7.4</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-the-roi-mask"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculating-the-correlation-matrices"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculate-pattern-similarity-change-1"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#combine-behavioral-and-fmri-data-for-rsa-1"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html"><i class="fa fa-check"></i><b>8</b> RSA on Pattern Similarity Change</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#time-metrics-to-quantify-event-relations"><i class="fa fa-check"></i><b>8.1</b> Time metrics to quantify event relations</a></li>
<li class="chapter" data-level="8.2" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualize-regions-of-interests"><i class="fa fa-check"></i><b>8.2</b> Visualize Regions of Interests</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#template-background-image-with-fov"><i class="fa fa-check"></i>Template background image with FOV</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-hippocampus-roi"><i class="fa fa-check"></i>Anterior hippocampus ROI</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-lateral-entorhinal-cortex"><i class="fa fa-check"></i>Anterior-lateral entorhinal cortex</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#first-level-rsa"><i class="fa fa-check"></i><b>8.3</b> First-level RSA</a></li>
<li class="chapter" data-level="8.4" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence"><i class="fa fa-check"></i><b>8.4</b> aHPC: virtual time within sequence</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-3"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-2"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#not-driven-by-first-last-event-pairs"><i class="fa fa-check"></i>Not driven by first &amp; last event pairs</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.5</b> aHPC: virtual time within sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#one-model-with-multiple-predictors"><i class="fa fa-check"></i>One model with multiple predictors</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-explains-residuals-of-order-and-real-time"><i class="fa fa-check"></i>Virtual time explains residuals of order and real time</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequences"><i class="fa fa-check"></i><b>8.6</b> aHPC: virtual time across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-7"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-5"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization-1"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.7</b> aHPC: virtual time across sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-8"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-6"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i><b>8.8</b> aHPC: virtual time within vs. across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#second-level-analysis"><i class="fa fa-check"></i>Second-level analysis</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-7"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-order"><i class="fa fa-check"></i>Interaction of sequence membership and order</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-real-time"><i class="fa fa-check"></i>Interaction of sequence membership and real time</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-virtual-time-when-including-interactions-with-other-time-metrics"><i class="fa fa-check"></i>Interaction of sequence membership and virtual time when including interactions with other time metrics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mds"><i class="fa fa-check"></i>MDS</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#umap"><i class="fa fa-check"></i>UMAP</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec"><i class="fa fa-check"></i><b>8.9</b> alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-withinacross-sequences-separately"><i class="fa fa-check"></i>alEC: virtual time within/across sequences separately</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i>alEC: virtual time within vs. across sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs"><i class="fa fa-check"></i>alEC: virtual time for all event pairs</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs-when-including-order-real-time"><i class="fa fa-check"></i>alEC: virtual time for all event pairs when including order &amp; real time</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-vs.-alec"><i class="fa fa-check"></i><b>8.10</b> aHPC vs. alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-12"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-10"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#searchlight-results"><i class="fa fa-check"></i><b>8.11</b> Searchlight Results</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-within-sequence"><i class="fa fa-check"></i>Virtual Time Within Sequence</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences-in-within-searchlight-cluster"><i class="fa fa-check"></i>Virtual Time Across Sequences in Within-Searchlight Cluster</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences"><i class="fa fa-check"></i>Virtual Time Across Sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualization-of-overlap"><i class="fa fa-check"></i>Visualization of Overlap</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-sequence-interaction"><i class="fa fa-check"></i>Virtual Time &amp; Sequence Interaction</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#exploratory-searchlight-results"><i class="fa fa-check"></i>Exploratory Searchlight Results</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-of-behavioral-generalization-bias-with-searchlight-effects"><i class="fa fa-check"></i><b>8.12</b> Correlation of behavioral generalization bias with searchlight effects</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-across-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with across-sequence searchlight effect</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-same-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with same-sequence searchlight effect</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mixed-model-summaries"><i class="fa fa-check"></i><b>8.13</b> Mixed Model Summaries</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-figure-1"><i class="fa fa-check"></i>Supplemental Figure</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-tables"><i class="fa fa-check"></i>Supplemental Tables</a></li>
<li class="chapter" data-level="8.13.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#source-data"><i class="fa fa-check"></i><b>8.13.1</b> Source data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html"><i class="fa fa-check"></i><b>9</b> Signal to noise ratio</a>
<ul>
<li class="chapter" data-level="9.1" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#calculate-voxel-wise-temporal-snr"><i class="fa fa-check"></i><b>9.1</b> Calculate voxel-wise temporal SNR</a></li>
<li class="chapter" data-level="9.2" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#average-tsnr-per-roi"><i class="fa fa-check"></i><b>9.2</b> Average tSNR per ROI</a></li>
<li class="chapter" data-level="9.3" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#contrast-tsnr-between-ahpc-and-alec"><i class="fa fa-check"></i><b>9.3</b> Contrast tSNR between aHPC and alEC</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html"><i class="fa fa-check"></i><b>10</b> RSA in searchlight peak with different threshold</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#prepare-rsa-in-searchlight-peak-1"><i class="fa fa-check"></i><b>10.1</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#create-the-roi-mask-1"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculating-the-correlation-matrices-1"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculate-pattern-similarity-change-2"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#combine-behavioral-and-fmri-data-for-rsa-2"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#rsa"><i class="fa fa-check"></i><b>10.2</b> RSA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html"><i class="fa fa-check"></i><b>11</b> Univariate GLM: Relative time</a>
<ul>
<li class="chapter" data-level="11.1" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#copy-feat-folder-from-preprocessing-to-first-level-glm-directory"><i class="fa fa-check"></i><b>11.1</b> Copy FEAT-folder from Preprocessing to First-Level GLM directory</a></li>
<li class="chapter" data-level="11.2" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-glm"><i class="fa fa-check"></i><b>11.2</b> Prepare GLM</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#compute-relative-time"><i class="fa fa-check"></i>Compute relative time</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#write-custom-ev-files-for-fsl-feat"><i class="fa fa-check"></i>Write custom EV files for FSL FEAT</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#glm-design-files"><i class="fa fa-check"></i>GLM Design files</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-confound-ev"><i class="fa fa-check"></i>Prepare confound EV</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#create-design-matrix"><i class="fa fa-check"></i>Create design matrix</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-1st-level-glm-on-htcondor"><i class="fa fa-check"></i><b>11.3</b> Run 1st-level GLM on HTCondor</a></li>
<li class="chapter" data-level="11.4" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#group-level-1"><i class="fa fa-check"></i><b>11.4</b> Group-level</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#move-first-level-images-to-mni-space-1"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#merge-first-level-images"><i class="fa fa-check"></i>Merge first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#smooth-first-level-images"><i class="fa fa-check"></i>Smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#average-first-level-images"><i class="fa fa-check"></i>Average first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#ahpc-roi-analysis"><i class="fa fa-check"></i>aHPC ROI analysis</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-fsl-randomise-1"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#results-in-ahpc-and-alec"><i class="fa fa-check"></i>Results in aHPC and alEC</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#fov-results"><i class="fa fa-check"></i>FOV results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="credit.html"><a href="credit.html"><i class="fa fa-check"></i><b>12</b> Credit</a>
<ul>
<li class="chapter" data-level="12.1" data-path="credit.html"><a href="credit.html#list-of-packages"><i class="fa fa-check"></i><b>12.1</b> List of packages</a></li>
<li class="chapter" data-level="12.2" data-path="credit.html"><a href="credit.html#references"><i class="fa fa-check"></i><b>12.2</b> References</a></li>
<li class="chapter" data-level="12.3" data-path="credit.html"><a href="credit.html#session-info"><i class="fa fa-check"></i><b>12.3</b> Session Info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rsa-on-pattern-similarity-change" class="section level1" number="8">
<h1><span class="header-section-number">8</span> RSA on Pattern Similarity Change</h1>
<blockquote>
<p>In order to assess changes in representational similarity between the two picture viewing tasks, we quantified pattern similarity changes as the difference of the respective correlation coefficients for every pair of events between the post-learning picture viewing task and its pre-learning baseline equivalent (Figure 3). Then, we analyzed how these difference values related to temporal relations between events, which we quantified using the absolute distances in virtual time (“virtual time”) between events (Figure 1C, bottom right). We further tested whether the effect of virtual time on anterior hippocampal pattern similarity change persisted when including the absolute difference between sequence positions (“order”) and the interval in seconds between events (“real time”) as control predictors of no interest in the model. Time metrics were z-scored within each participant prior to analysis. We separately tested the effect of virtual time for event pairs from the same or different sequences and used a Bonferroni-corrected α-level of 0.025 for these tests. Time metrics were z-scored within each participant prior to analysis.</p>
</blockquote>
<p>Next, we can run our analyses of representational change in the ROIs. Let’s load the data.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="rsa-on-pattern-similarity-change.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb176-2"><a href="rsa-on-pattern-similarity-change.html#cb176-2" aria-hidden="true" tabindex="-1"></a>col_types_list <span class="ot">&lt;-</span> <span class="fu">cols_only</span>(</span>
<span id="cb176-3"><a href="rsa-on-pattern-similarity-change.html#cb176-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub_id =</span> <span class="fu">col_character</span>(),</span>
<span id="cb176-4"><a href="rsa-on-pattern-similarity-change.html#cb176-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">day1 =</span> <span class="fu">col_integer</span>(), <span class="at">day2 =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb176-5"><a href="rsa-on-pattern-similarity-change.html#cb176-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">event1 =</span> <span class="fu">col_integer</span>(), <span class="at">event2 =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb176-6"><a href="rsa-on-pattern-similarity-change.html#cb176-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">pic1 =</span> <span class="fu">col_integer</span>(), <span class="at">pic2 =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb176-7"><a href="rsa-on-pattern-similarity-change.html#cb176-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">virtual_time1 =</span> <span class="fu">col_double</span>(), <span class="at">virtual_time2 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb176-8"><a href="rsa-on-pattern-similarity-change.html#cb176-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">real_time1 =</span> <span class="fu">col_double</span>(), <span class="at">real_time2 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb176-9"><a href="rsa-on-pattern-similarity-change.html#cb176-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">memory_time1 =</span> <span class="fu">col_double</span>(), <span class="at">memory_time2 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb176-10"><a href="rsa-on-pattern-similarity-change.html#cb176-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">memory_order1 =</span> <span class="fu">col_double</span>(), <span class="at">memory_order2 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb176-11"><a href="rsa-on-pattern-similarity-change.html#cb176-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">sorted_day1 =</span> <span class="fu">col_integer</span>(), <span class="at">sorted_day2 =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb176-12"><a href="rsa-on-pattern-similarity-change.html#cb176-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">pre_corrs  =</span> <span class="fu">col_double</span>(), <span class="at">post_corrs =</span> <span class="fu">col_double</span>(),</span>
<span id="cb176-13"><a href="rsa-on-pattern-similarity-change.html#cb176-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">ps_change =</span> <span class="fu">col_double</span>(), <span class="at">roi =</span> <span class="fu">col_factor</span>())</span>
<span id="cb176-14"><a href="rsa-on-pattern-similarity-change.html#cb176-14" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;rsa_data_rois.txt&quot;</span>)</span>
<span id="cb176-15"><a href="rsa-on-pattern-similarity-change.html#cb176-15" aria-hidden="true" tabindex="-1"></a>rsa_dat <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_csv</span>(fn, <span class="at">col_types =</span> col_types_list))</span>
<span id="cb176-16"><a href="rsa-on-pattern-similarity-change.html#cb176-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-17"><a href="rsa-on-pattern-similarity-change.html#cb176-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rsa_dat)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-123">
<col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sub_id</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">day1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">day2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">pic1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">pic2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">event1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">event2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual_time1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual_time2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">real_time1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">real_time2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_order1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_order2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_time1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_time2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sorted_day1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sorted_day2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">pre_corrs</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">post_corrs</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">ps_change</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">roi</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">031</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">11.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">23.4&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">11.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00116&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-0.00297&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-0.00413</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">aHPC_lr</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">031</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">23.4&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000529</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0265&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.026&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">alEC_lr</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">031</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">19</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">18.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">64.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">19&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-0.000424</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.000938</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00136</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">aHPC_lr</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">031</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">19</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">64.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">19&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.00318&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000591</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00259</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">alEC_lr</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">031</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">42.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00164&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-0.00198&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-0.00362</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">aHPC_lr</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">031</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">42.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0102&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0121&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.00184</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">alEC_lr</td></tr>
</table>

<div id="time-metrics-to-quantify-event-relations" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Time metrics to quantify event relations</h2>
<p>After loading the data, we first calculate some temporal distance measures for the comparisons of event pairs. These include:</p>
<ul>
<li>virtual time difference</li>
<li>order difference</li>
<li>scanner time difference</li>
</ul>
<p>These temporal distance measures will be used as predictor variables for model-based representational similarity analysis. They are z-scored within each participant.<br />
Importantly, we will analyze event pairs from the same virtual day or from different virtual days in separate analyses. Thus, we also create a corresponding variable that marks whether comparisons are from the same sequence or not.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="rsa-on-pattern-similarity-change.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create predictors for RSA</span></span>
<span id="cb177-2"><a href="rsa-on-pattern-similarity-change.html#cb177-2" aria-hidden="true" tabindex="-1"></a>rsa_dat <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="rsa-on-pattern-similarity-change.html#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb177-4"><a href="rsa-on-pattern-similarity-change.html#cb177-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb177-5"><a href="rsa-on-pattern-similarity-change.html#cb177-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pair of events from say or different day (dv = deviation code)</span></span>
<span id="cb177-6"><a href="rsa-on-pattern-similarity-change.html#cb177-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day =</span> day1 <span class="sc">==</span> day2,</span>
<span id="cb177-7"><a href="rsa-on-pattern-similarity-change.html#cb177-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_dv =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb177-8"><a href="rsa-on-pattern-similarity-change.html#cb177-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb177-9"><a href="rsa-on-pattern-similarity-change.html#cb177-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># absolute difference in time metrics</span></span>
<span id="cb177-10"><a href="rsa-on-pattern-similarity-change.html#cb177-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">vir_time_diff =</span> <span class="fu">abs</span>(virtual_time1 <span class="sc">-</span> virtual_time2),</span>
<span id="cb177-11"><a href="rsa-on-pattern-similarity-change.html#cb177-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#vir_time_diff = abs(memory_time1 - memory_time2),</span></span>
<span id="cb177-12"><a href="rsa-on-pattern-similarity-change.html#cb177-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">order_diff =</span> <span class="fu">abs</span>(event1 <span class="sc">-</span> event2),</span>
<span id="cb177-13"><a href="rsa-on-pattern-similarity-change.html#cb177-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#order_diff = abs(memory_order1 - memory_order2),</span></span>
<span id="cb177-14"><a href="rsa-on-pattern-similarity-change.html#cb177-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">real_time_diff =</span> <span class="fu">abs</span>(real_time1 <span class="sc">-</span> real_time2),</span>
<span id="cb177-15"><a href="rsa-on-pattern-similarity-change.html#cb177-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb177-16"><a href="rsa-on-pattern-similarity-change.html#cb177-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb177-17"><a href="rsa-on-pattern-similarity-change.html#cb177-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># z-score the time metric predictors (within each subject)</span></span>
<span id="cb177-18"><a href="rsa-on-pattern-similarity-change.html#cb177-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb177-19"><a href="rsa-on-pattern-similarity-change.html#cb177-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(</span>
<span id="cb177-20"><a href="rsa-on-pattern-similarity-change.html#cb177-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>), scale, <span class="at">scale =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-21"><a href="rsa-on-pattern-similarity-change.html#cb177-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
</div>
<div id="visualize-regions-of-interests" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Visualize Regions of Interests</h2>
<div id="template-background-image-with-fov" class="section level3 unnumbered">
<h3>Template background image with FOV</h3>
<p>As a background image we use the 1mm MNI template together with a visualization of the field of view of our scans.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="rsa-on-pattern-similarity-change.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 mm MNI template as background image</span></span>
<span id="cb178-2"><a href="rsa-on-pattern-similarity-change.html#cb178-2" aria-hidden="true" tabindex="-1"></a>mni_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;MNI152_T1_1mm_brain.nii.gz&quot;</span>)</span>
<span id="cb178-3"><a href="rsa-on-pattern-similarity-change.html#cb178-3" aria-hidden="true" tabindex="-1"></a>mni_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(mni_fn)</span>
<span id="cb178-4"><a href="rsa-on-pattern-similarity-change.html#cb178-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-5"><a href="rsa-on-pattern-similarity-change.html#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load FOV mask and binarize it</span></span>
<span id="cb178-6"><a href="rsa-on-pattern-similarity-change.html#cb178-6" aria-hidden="true" tabindex="-1"></a>fov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;fov_mask_mni.nii.gz&quot;</span>)</span>
<span id="cb178-7"><a href="rsa-on-pattern-similarity-change.html#cb178-7" aria-hidden="true" tabindex="-1"></a>fov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fov_fn)</span>
<span id="cb178-8"><a href="rsa-on-pattern-similarity-change.html#cb178-8" aria-hidden="true" tabindex="-1"></a>fov_nii[fov_nii <span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb178-9"><a href="rsa-on-pattern-similarity-change.html#cb178-9" aria-hidden="true" tabindex="-1"></a>fov_nii[fov_nii <span class="sc">!=</span><span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb178-10"><a href="rsa-on-pattern-similarity-change.html#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="rsa-on-pattern-similarity-change.html#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make a mask for the brain area outside our FOV</span></span>
<span id="cb178-12"><a href="rsa-on-pattern-similarity-change.html#cb178-12" aria-hidden="true" tabindex="-1"></a>out_fov <span class="ot">&lt;-</span> (fov_nii <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (mni_nii<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb178-13"><a href="rsa-on-pattern-similarity-change.html#cb178-13" aria-hidden="true" tabindex="-1"></a>mni_nii[out_fov] <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">rescale</span>(mni_nii[out_fov], <span class="at">from=</span><span class="fu">range</span>(mni_nii[out_fov]), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">6000</span>, <span class="dv">8207</span>))</span>
<span id="cb178-14"><a href="rsa-on-pattern-similarity-change.html#cb178-14" aria-hidden="true" tabindex="-1"></a>mni_nii[mni_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
</div>
<div id="anterior-hippocampus-roi" class="section level3 unnumbered">
<h3>Anterior hippocampus ROI</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="rsa-on-pattern-similarity-change.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the ROI</span></span>
<span id="cb179-2"><a href="rsa-on-pattern-similarity-change.html#cb179-2" aria-hidden="true" tabindex="-1"></a>roi_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;aHPC_lr_group_prob_mni1mm.nii.gz&quot;</span>)</span>
<span id="cb179-3"><a href="rsa-on-pattern-similarity-change.html#cb179-3" aria-hidden="true" tabindex="-1"></a>roi_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(roi_fn)</span>
<span id="cb179-4"><a href="rsa-on-pattern-similarity-change.html#cb179-4" aria-hidden="true" tabindex="-1"></a>roi_nii[roi_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb179-5"><a href="rsa-on-pattern-similarity-change.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="rsa-on-pattern-similarity-change.html#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now)</span></span>
<span id="cb179-7"><a href="rsa-on-pattern-similarity-change.html#cb179-7" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">24</span>,<span class="sc">-</span><span class="dv">15</span>,<span class="sc">-</span><span class="dv">20</span>))</span>
<span id="cb179-8"><a href="rsa-on-pattern-similarity-change.html#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="rsa-on-pattern-similarity-change.html#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="co"># f4a</span></span>
<span id="cb179-10"><a href="rsa-on-pattern-similarity-change.html#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb179-11"><a href="rsa-on-pattern-similarity-change.html#cb179-11" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb179-12"><a href="rsa-on-pattern-similarity-change.html#cb179-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb179-13"><a href="rsa-on-pattern-similarity-change.html#cb179-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">col_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb179-14"><a href="rsa-on-pattern-similarity-change.html#cb179-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb179-15"><a href="rsa-on-pattern-similarity-change.html#cb179-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-16"><a href="rsa-on-pattern-similarity-change.html#cb179-16" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the ROI image</span></span>
<span id="cb179-17"><a href="rsa-on-pattern-similarity-change.html#cb179-17" aria-hidden="true" tabindex="-1"></a>roi_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>roi_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb179-18"><a href="rsa-on-pattern-similarity-change.html#cb179-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">row_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb179-19"><a href="rsa-on-pattern-similarity-change.html#cb179-19" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#row_ind = c(1,2,3), col_ind = c(1,1,1),</span></span>
<span id="cb179-20"><a href="rsa-on-pattern-similarity-change.html#cb179-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb179-21"><a href="rsa-on-pattern-similarity-change.html#cb179-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-22"><a href="rsa-on-pattern-similarity-change.html#cb179-22" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">row_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)),</span>
<span id="cb179-23"><a href="rsa-on-pattern-similarity-change.html#cb179-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)))</span>
<span id="cb179-24"><a href="rsa-on-pattern-similarity-change.html#cb179-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-25"><a href="rsa-on-pattern-similarity-change.html#cb179-25" aria-hidden="true" tabindex="-1"></a>f4a <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb179-26"><a href="rsa-on-pattern-similarity-change.html#cb179-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>roi_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb179-27"><a href="rsa-on-pattern-similarity-change.html#cb179-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>row_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb179-28"><a href="rsa-on-pattern-similarity-change.html#cb179-28" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;roma&quot;</span>, </span>
<span id="cb179-29"><a href="rsa-on-pattern-similarity-change.html#cb179-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end=</span><span class="dv">1</span>,</span>
<span id="cb179-30"><a href="rsa-on-pattern-similarity-change.html#cb179-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">&quot;probability&quot;</span>,</span>
<span id="cb179-31"><a href="rsa-on-pattern-similarity-change.html#cb179-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(roi_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb179-32"><a href="rsa-on-pattern-similarity-change.html#cb179-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(roi_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb179-33"><a href="rsa-on-pattern-similarity-change.html#cb179-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb179-34"><a href="rsa-on-pattern-similarity-change.html#cb179-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb179-35"><a href="rsa-on-pattern-similarity-change.html#cb179-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb179-36"><a href="rsa-on-pattern-similarity-change.html#cb179-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb179-37"><a href="rsa-on-pattern-similarity-change.html#cb179-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb179-38"><a href="rsa-on-pattern-similarity-change.html#cb179-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb179-39"><a href="rsa-on-pattern-similarity-change.html#cb179-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb179-40"><a href="rsa-on-pattern-similarity-change.html#cb179-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb179-41"><a href="rsa-on-pattern-similarity-change.html#cb179-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb179-42"><a href="rsa-on-pattern-similarity-change.html#cb179-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb179-43"><a href="rsa-on-pattern-similarity-change.html#cb179-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb179-44"><a href="rsa-on-pattern-similarity-change.html#cb179-44" aria-hidden="true" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb179-45"><a href="rsa-on-pattern-similarity-change.html#cb179-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb179-46"><a href="rsa-on-pattern-similarity-change.html#cb179-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb179-47"><a href="rsa-on-pattern-similarity-change.html#cb179-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">84.7</span>,<span class="sc">-</span><span class="fl">67.25</span>,<span class="sc">-</span><span class="fl">84.45</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb179-48"><a href="rsa-on-pattern-similarity-change.html#cb179-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb179-49"><a href="rsa-on-pattern-similarity-change.html#cb179-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb179-50"><a href="rsa-on-pattern-similarity-change.html#cb179-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb179-51"><a href="rsa-on-pattern-similarity-change.html#cb179-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb179-52"><a href="rsa-on-pattern-similarity-change.html#cb179-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f4a)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="rsa-on-pattern-similarity-change.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb180-2"><a href="rsa-on-pattern-similarity-change.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> roi_fn, <span class="at">to =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f4a.nii.gz&quot;</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="anterior-lateral-entorhinal-cortex" class="section level3 unnumbered">
<h3>Anterior-lateral entorhinal cortex</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="rsa-on-pattern-similarity-change.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the ROI</span></span>
<span id="cb182-2"><a href="rsa-on-pattern-similarity-change.html#cb182-2" aria-hidden="true" tabindex="-1"></a>roi_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;alEC_lr_group_prob_mni1mm.nii.gz&quot;</span>)</span>
<span id="cb182-3"><a href="rsa-on-pattern-similarity-change.html#cb182-3" aria-hidden="true" tabindex="-1"></a>roi_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(roi_fn)</span>
<span id="cb182-4"><a href="rsa-on-pattern-similarity-change.html#cb182-4" aria-hidden="true" tabindex="-1"></a>roi_nii[roi_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb182-5"><a href="rsa-on-pattern-similarity-change.html#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="rsa-on-pattern-similarity-change.html#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now)</span></span>
<span id="cb182-7"><a href="rsa-on-pattern-similarity-change.html#cb182-7" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">35</span>))</span>
<span id="cb182-8"><a href="rsa-on-pattern-similarity-change.html#cb182-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-9"><a href="rsa-on-pattern-similarity-change.html#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="co"># f6a</span></span>
<span id="cb182-10"><a href="rsa-on-pattern-similarity-change.html#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb182-11"><a href="rsa-on-pattern-similarity-change.html#cb182-11" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb182-12"><a href="rsa-on-pattern-similarity-change.html#cb182-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb182-13"><a href="rsa-on-pattern-similarity-change.html#cb182-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">col_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb182-14"><a href="rsa-on-pattern-similarity-change.html#cb182-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb182-15"><a href="rsa-on-pattern-similarity-change.html#cb182-15" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#row_ind=c(1,2,3), center_coords=TRUE)</span></span>
<span id="cb182-16"><a href="rsa-on-pattern-similarity-change.html#cb182-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-17"><a href="rsa-on-pattern-similarity-change.html#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the ROI image</span></span>
<span id="cb182-18"><a href="rsa-on-pattern-similarity-change.html#cb182-18" aria-hidden="true" tabindex="-1"></a>roi_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>roi_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb182-19"><a href="rsa-on-pattern-similarity-change.html#cb182-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">row_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb182-20"><a href="rsa-on-pattern-similarity-change.html#cb182-20" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#row_ind = c(1,2,3), col_ind = c(1,1,1),</span></span>
<span id="cb182-21"><a href="rsa-on-pattern-similarity-change.html#cb182-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb182-22"><a href="rsa-on-pattern-similarity-change.html#cb182-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-23"><a href="rsa-on-pattern-similarity-change.html#cb182-23" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">row_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)),</span>
<span id="cb182-24"><a href="rsa-on-pattern-similarity-change.html#cb182-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)))</span>
<span id="cb182-25"><a href="rsa-on-pattern-similarity-change.html#cb182-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-26"><a href="rsa-on-pattern-similarity-change.html#cb182-26" aria-hidden="true" tabindex="-1"></a>f6a <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb182-27"><a href="rsa-on-pattern-similarity-change.html#cb182-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>roi_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb182-28"><a href="rsa-on-pattern-similarity-change.html#cb182-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>row_ind, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-29"><a href="rsa-on-pattern-similarity-change.html#cb182-29" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;roma&quot;</span>, </span>
<span id="cb182-30"><a href="rsa-on-pattern-similarity-change.html#cb182-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end=</span><span class="dv">1</span>,</span>
<span id="cb182-31"><a href="rsa-on-pattern-similarity-change.html#cb182-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb182-32"><a href="rsa-on-pattern-similarity-change.html#cb182-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(roi_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb182-33"><a href="rsa-on-pattern-similarity-change.html#cb182-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(roi_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb182-34"><a href="rsa-on-pattern-similarity-change.html#cb182-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb182-35"><a href="rsa-on-pattern-similarity-change.html#cb182-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb182-36"><a href="rsa-on-pattern-similarity-change.html#cb182-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb182-37"><a href="rsa-on-pattern-similarity-change.html#cb182-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb182-38"><a href="rsa-on-pattern-similarity-change.html#cb182-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb182-39"><a href="rsa-on-pattern-similarity-change.html#cb182-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span></span>
<span id="cb182-40"><a href="rsa-on-pattern-similarity-change.html#cb182-40" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb182-41"><a href="rsa-on-pattern-similarity-change.html#cb182-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb182-42"><a href="rsa-on-pattern-similarity-change.html#cb182-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb182-43"><a href="rsa-on-pattern-similarity-change.html#cb182-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb182-44"><a href="rsa-on-pattern-similarity-change.html#cb182-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb182-45"><a href="rsa-on-pattern-similarity-change.html#cb182-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;right&quot;</span>))<span class="sc">+</span></span>
<span id="cb182-46"><a href="rsa-on-pattern-similarity-change.html#cb182-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb182-47"><a href="rsa-on-pattern-similarity-change.html#cb182-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-48"><a href="rsa-on-pattern-similarity-change.html#cb182-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">85.82</span>,<span class="sc">-</span><span class="fl">72.31</span>,<span class="sc">-</span><span class="fl">78.1</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb182-49"><a href="rsa-on-pattern-similarity-change.html#cb182-49" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb182-50"><a href="rsa-on-pattern-similarity-change.html#cb182-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb182-51"><a href="rsa-on-pattern-similarity-change.html#cb182-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb182-52"><a href="rsa-on-pattern-similarity-change.html#cb182-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb182-53"><a href="rsa-on-pattern-similarity-change.html#cb182-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f6a)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="rsa-on-pattern-similarity-change.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb183-2"><a href="rsa-on-pattern-similarity-change.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> roi_fn, <span class="at">to =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f6a.nii.gz&quot;</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="first-level-rsa" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> First-level RSA</h2>
<blockquote>
<p>In the summary statistics approach, we used the different time metrics as predictors for pattern similarity change. We set up a GLM with the given variable from the day learning task as a predictor and the pairwise representational change values as the criterion for every participant. The t-values of the resulting model coefficients were then compared to a null distribution obtained from shuffling the dependent variable of the linear model (i.e. pattern similarity change) 10,000 times. This approach to permutation-testing of regression coefficients controls Type I errors even under situations of collinear regressors106. Resulting p-values for each coefficient were transformed to a Z-score. The Z-scores were then used for group-level inferential statistics.</p>
<p>Group-level statistics were carried out using permutation-based procedures. For t-tests, we compared the observed t-values against a surrogate distribution obtained from 10,000 random sign-flips to non-parametrically test against 0 or to assess within-participant differences between conditions (two-sided tests; α=0.05 unless stated otherwise). We report Cohen’s d with Hedges’ correction and its 95% confidence interval as computed using the effsize-package for R. For paired tests, Cohen’s d was calculated using pooled standard deviations and confidence intervals are based on the non-central t-distribution. Permutation-based repeated measures ANOVAs were carried out using the permuco-package107 and we report generalized η2 as effect sizes computed using the afex-package(108).</p>
</blockquote>
<p>For the summary statistics approach, let’s run the first-level analysis using virtual time as a predictor of pattern similarity change separately for each participant and each ROI. For simplicity we run these analysis together here and will run separate group-level stats below.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="rsa-on-pattern-similarity-change.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb185-2"><a href="rsa-on-pattern-similarity-change.html#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="rsa-on-pattern-similarity-change.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data from alEC and HPC</span></span>
<span id="cb185-4"><a href="rsa-on-pattern-similarity-change.html#cb185-4" aria-hidden="true" tabindex="-1"></a>rsa_dat_mtl <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb185-5"><a href="rsa-on-pattern-similarity-change.html#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span> <span class="sc">|</span> roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>)</span>
<span id="cb185-6"><a href="rsa-on-pattern-similarity-change.html#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="rsa-on-pattern-similarity-change.html#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit based on permutations</span></span>
<span id="cb185-8"><a href="rsa-on-pattern-similarity-change.html#cb185-8" aria-hidden="true" tabindex="-1"></a>rsa_fit <span class="ot">&lt;-</span> rsa_dat_mtl <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id, roi, same_day) <span class="sc">%&gt;%</span></span>
<span id="cb185-9"><a href="rsa-on-pattern-similarity-change.html#cb185-9" aria-hidden="true" tabindex="-1"></a>          <span class="co"># run the linear model</span></span>
<span id="cb185-10"><a href="rsa-on-pattern-similarity-change.html#cb185-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> ., <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff&quot;</span>, <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb185-11"><a href="rsa-on-pattern-similarity-change.html#cb185-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>, <span class="st">&quot;z_virtual_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb185-12"><a href="rsa-on-pattern-similarity-change.html#cb185-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(z)</span>
<span id="cb185-13"><a href="rsa-on-pattern-similarity-change.html#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="rsa-on-pattern-similarity-change.html#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add group column used for plotting</span></span>
<span id="cb185-15"><a href="rsa-on-pattern-similarity-change.html#cb185-15" aria-hidden="true" tabindex="-1"></a>rsa_fit<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span>)</span>
<span id="cb185-16"><a href="rsa-on-pattern-similarity-change.html#cb185-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-17"><a href="rsa-on-pattern-similarity-change.html#cb185-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add a factor with character labels for within/across days and one to later color control in facets</span></span>
<span id="cb185-18"><a href="rsa-on-pattern-similarity-change.html#cb185-18" aria-hidden="true" tabindex="-1"></a>rsa_fit <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb185-19"><a href="rsa-on-pattern-similarity-change.html#cb185-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">same_day_char =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, </span>
<span id="cb185-20"><a href="rsa-on-pattern-similarity-change.html#cb185-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">from =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb185-21"><a href="rsa-on-pattern-similarity-change.html#cb185-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;across days&quot;</span>, <span class="st">&quot;within days&quot;</span>), </span>
<span id="cb185-22"><a href="rsa-on-pattern-similarity-change.html#cb185-22" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">warn_missing =</span> <span class="cn">FALSE</span>),</span>
<span id="cb185-23"><a href="rsa-on-pattern-similarity-change.html#cb185-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">same_day_char =</span> <span class="fu">factor</span>(same_day_char, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;within days&quot;</span>, <span class="st">&quot;across days&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb185-24"><a href="rsa-on-pattern-similarity-change.html#cb185-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(roi_same_day, <span class="fu">c</span>(<span class="st">&quot;roi&quot;</span>, <span class="st">&quot;same_day_char&quot;</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-25"><a href="rsa-on-pattern-similarity-change.html#cb185-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">roi_same_day =</span> <span class="fu">str_replace</span>(roi_same_day, <span class="st">&quot;_lr&quot;</span>, <span class="st">&quot;:&quot;</span>),</span>
<span id="cb185-26"><a href="rsa-on-pattern-similarity-change.html#cb185-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">roi_same_day =</span> <span class="fu">factor</span>(roi_same_day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;aHPC: within days&quot;</span>, <span class="st">&quot;aHPC: across days&quot;</span>, </span>
<span id="cb185-27"><a href="rsa-on-pattern-similarity-change.html#cb185-27" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">&quot;alEC: within days&quot;</span>, <span class="st">&quot;alEC: across days&quot;</span>))</span>
<span id="cb185-28"><a href="rsa-on-pattern-similarity-change.html#cb185-28" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
</div>
<div id="ahpc-virtual-time-within-sequence" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> aHPC: virtual time within sequence</h2>
<p>We first test, whether virtual time explains pattern similarity change within the aHPC for event pairs from the same sequence.</p>
<div id="summary-statistics-3" class="section level3 unnumbered">
<h3>Summary statistics</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="rsa-on-pattern-similarity-change.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb186-2"><a href="rsa-on-pattern-similarity-change.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="rsa-on-pattern-similarity-change.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb186-4"><a href="rsa-on-pattern-similarity-change.html#cb186-4" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb186-5"><a href="rsa-on-pattern-similarity-change.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb186-6"><a href="rsa-on-pattern-similarity-change.html#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb186-7"><a href="rsa-on-pattern-similarity-change.html#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb186-8"><a href="rsa-on-pattern-similarity-change.html#cb186-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-9"><a href="rsa-on-pattern-similarity-change.html#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb186-10"><a href="rsa-on-pattern-similarity-change.html#cb186-10" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>))<span class="sc">$</span>z_virtual_time, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb186-11"><a href="rsa-on-pattern-similarity-change.html#cb186-11" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb186-12"><a href="rsa-on-pattern-similarity-change.html#cb186-12" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb186-13"><a href="rsa-on-pattern-similarity-change.html#cb186-13" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb186-14"><a href="rsa-on-pattern-similarity-change.html#cb186-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-15"><a href="rsa-on-pattern-similarity-change.html#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb186-16"><a href="rsa-on-pattern-similarity-change.html#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-129">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.618</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.07</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0048</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.006</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.205</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.03</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.564</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.178</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.995</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time within sequence in aHPC<br />
t<sub>27</sub>=3.07, p=0.006, d=0.56, 95% CI [0.18, 1.00]</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="rsa-on-pattern-similarity-change.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data to plot</span></span>
<span id="cb187-2"><a href="rsa-on-pattern-similarity-change.html#cb187-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>) </span>
<span id="cb187-3"><a href="rsa-on-pattern-similarity-change.html#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="rsa-on-pattern-similarity-change.html#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb187-5"><a href="rsa-on-pattern-similarity-change.html#cb187-5" aria-hidden="true" tabindex="-1"></a>f4b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>z_virtual_time, <span class="at">fill =</span> roi, <span class="at">color =</span> roi)) <span class="sc">+</span></span>
<span id="cb187-6"><a href="rsa-on-pattern-similarity-change.html#cb187-6" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>), </span>
<span id="cb187-7"><a href="rsa-on-pattern-similarity-change.html#cb187-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb187-8"><a href="rsa-on-pattern-similarity-change.html#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> z_virtual_time), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb187-9"><a href="rsa-on-pattern-similarity-change.html#cb187-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb187-10"><a href="rsa-on-pattern-similarity-change.html#cb187-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb187-11"><a href="rsa-on-pattern-similarity-change.html#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb187-12"><a href="rsa-on-pattern-similarity-change.html#cb187-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb187-13"><a href="rsa-on-pattern-similarity-change.html#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb187-14"><a href="rsa-on-pattern-similarity-change.html#cb187-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb187-15"><a href="rsa-on-pattern-similarity-change.html#cb187-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb187-16"><a href="rsa-on-pattern-similarity-change.html#cb187-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb187-17"><a href="rsa-on-pattern-similarity-change.html#cb187-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb187-18"><a href="rsa-on-pattern-similarity-change.html#cb187-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb187-19"><a href="rsa-on-pattern-similarity-change.html#cb187-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;virtual time&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-20"><a href="rsa-on-pattern-similarity-change.html#cb187-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-21"><a href="rsa-on-pattern-similarity-change.html#cb187-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb187-22"><a href="rsa-on-pattern-similarity-change.html#cb187-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb187-23"><a href="rsa-on-pattern-similarity-change.html#cb187-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb187-24"><a href="rsa-on-pattern-similarity-change.html#cb187-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb187-25"><a href="rsa-on-pattern-similarity-change.html#cb187-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb187-26"><a href="rsa-on-pattern-similarity-change.html#cb187-26" aria-hidden="true" tabindex="-1"></a>f4b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="rsa-on-pattern-similarity-change.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb188-2"><a href="rsa-on-pattern-similarity-change.html#cb188-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f4b)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb188-3"><a href="rsa-on-pattern-similarity-change.html#cb188-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb188-4"><a href="rsa-on-pattern-similarity-change.html#cb188-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f4b.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="linear-mixed-effects-2" class="section level3 unnumbered">
<h3>Linear Mixed Effects</h3>
<p>Likewise, we want to test whether similarity change reflects virtual time differences between elements within a sequence using a mized model. Thus, we use virtual time differences between scenes as the only fixed effect. Following the recommendation for maximal random effect structures by Barr et al. (<a href="https://www.sciencedirect.com/science/article/pii/S0749596X12001180">JML, 2013</a>), we first include random intercepts and random slopes for each subject. This results in a singular fit (random intercept variance estimated as 0). To avoid anti-conservativity we thus drop the correlation between random intercepts and random slopes as suggested by Barr et al., who demonstrate that “LMEMs with maximal random slopes, but missing either random correlations or within-unit random intercepts, performed nearly as well as “fully” maximal LMEMs, with the exception of the case where p-values were determined by MCMC sampling” (p. 267). This model converges without warnings. Below are the model summaries.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="rsa-on-pattern-similarity-change.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">56</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb189-2"><a href="rsa-on-pattern-similarity-change.html#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="rsa-on-pattern-similarity-change.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from the same day</span></span>
<span id="cb189-4"><a href="rsa-on-pattern-similarity-change.html#cb189-4" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb189-5"><a href="rsa-on-pattern-similarity-change.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb189-6"><a href="rsa-on-pattern-similarity-change.html#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="rsa-on-pattern-similarity-change.html#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference as </span></span>
<span id="cb189-8"><a href="rsa-on-pattern-similarity-change.html#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effect and random intercepts for subject</span></span>
<span id="cb189-9"><a href="rsa-on-pattern-similarity-change.html#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="co"># maximal random effects structure with random slopes and intercepts --&gt; singular fit</span></span>
<span id="cb189-10"><a href="rsa-on-pattern-similarity-change.html#cb189-10" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff | sub_id)&quot;</span> </span>
<span id="cb189-11"><a href="rsa-on-pattern-similarity-change.html#cb189-11" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">20000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="rsa-on-pattern-similarity-change.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># thus we reduce the random effects structure. Following Barr et al. (2013), we drop the correlation between random intercepts and random slopes</span></span>
<span id="cb191-2"><a href="rsa-on-pattern-similarity-change.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb191-3"><a href="rsa-on-pattern-similarity-change.html#cb191-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff || sub_id)&quot;</span></span>
<span id="cb191-4"><a href="rsa-on-pattern-similarity-change.html#cb191-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">20000</span>)))</span>
<span id="cb191-5"><a href="rsa-on-pattern-similarity-change.html#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + ((1 | sub_id) + (0 + vir_time_diff |      sub_id))
##    Data: rsa_dat_same_day
## Control: lmerControl(optCtrl = list(maxfun = 20000))
## 
##      AIC      BIC   logLik deviance df.resid 
##  -7951.4  -7926.3   3980.7  -7961.4     1115 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.4983 -0.6232 -0.0284  0.6645  3.8269 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev. 
##  sub_id   (Intercept)   6.434e-13 8.021e-07
##  sub_id.1 vir_time_diff 6.598e-08 2.569e-04
##  Residual               4.784e-05 6.917e-03
## Number of obs: 1120, groups:  sub_id, 28
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)   -0.0003261  0.0002112  -1.544
## vir_time_diff  0.0007513  0.0002197   3.420</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="rsa-on-pattern-similarity-change.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb193-2"><a href="rsa-on-pattern-similarity-change.html#cb193-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="rsa-on-pattern-similarity-change.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb195-2"><a href="rsa-on-pattern-similarity-change.html#cb195-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span></code></pre></div>
<p>We assess the statistical significance of the fixed effect of virtual time using a likelihood ratio test against a reduced (nested) model that does not have this fixed effect.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="rsa-on-pattern-similarity-change.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one way of testing for significance is by comparing the likelihood against a simpler model.</span></span>
<span id="cb196-2"><a href="rsa-on-pattern-similarity-change.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time difference and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb196-3"><a href="rsa-on-pattern-similarity-change.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">348</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb196-4"><a href="rsa-on-pattern-similarity-change.html#cb196-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ 1 + (1 + vir_time_diff || sub_id)&quot;</span></span>
<span id="cb196-5"><a href="rsa-on-pattern-similarity-change.html#cb196-5" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="rsa-on-pattern-similarity-change.html#cb198-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span>
<span id="cb198-2"><a href="rsa-on-pattern-similarity-change.html#cb198-2" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-132">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-7.94e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-7.92e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.98e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-7.95e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7.95e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7.93e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.98e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7.96e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.87</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00168</td></tr>
</table>

<p>Mixed Model: Fixed effect of virtual time on aHPC pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=9.87, p=0.002</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="rsa-on-pattern-similarity-change.html#cb199-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>)</span>
<span id="cb199-2"><a href="rsa-on-pattern-similarity-change.html#cb199-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">2</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb199-3"><a href="rsa-on-pattern-similarity-change.html#cb199-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept (SD)&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb199-4"><a href="rsa-on-pattern-similarity-change.html#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="rsa-on-pattern-similarity-change.html#cb199-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb199-6"><a href="rsa-on-pattern-similarity-change.html#cb199-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb199-7"><a href="rsa-on-pattern-similarity-change.html#cb199-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb199-8"><a href="rsa-on-pattern-similarity-change.html#cb199-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb199-9"><a href="rsa-on-pattern-similarity-change.html#cb199-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb199-10"><a href="rsa-on-pattern-similarity-change.html#cb199-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb199-11"><a href="rsa-on-pattern-similarity-change.html#cb199-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb199-12"><a href="rsa-on-pattern-similarity-change.html#cb199-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb199-13"><a href="rsa-on-pattern-similarity-change.html#cb199-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change for same-sequence events in the anterior hippocampus&quot;</span>)</span>
<span id="cb199-14"><a href="rsa-on-pattern-similarity-change.html#cb199-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-15"><a href="rsa-on-pattern-similarity-change.html#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb199-16"><a href="rsa-on-pattern-similarity-change.html#cb199-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_same_seq <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb199-17"><a href="rsa-on-pattern-similarity-change.html#cb199-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-18"><a href="rsa-on-pattern-similarity-change.html#cb199-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb199-19"><a href="rsa-on-pattern-similarity-change.html#cb199-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-133">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change for same-sequence events in the anterior hippocampus</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000326</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000211</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.54</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000740</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000088</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000751</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000220</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.42</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000307</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001196</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">intercept (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000001</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000257</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.006917</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">4</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7943.56</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3975.78</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7951.43</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3980.72</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.87</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.002</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+((1|sub_id)+(0+vir_time_diff|sub_id)); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

To visualize this effect, we plot the estimate for the fixed effect coefficient of virtual time together with its confidence intervals. Further we plot the estimated marginal means for illustration.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="rsa-on-pattern-similarity-change.html#cb200-1" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb200-2"><a href="rsa-on-pattern-similarity-change.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term))</span>
<span id="cb200-3"><a href="rsa-on-pattern-similarity-change.html#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="rsa-on-pattern-similarity-change.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb200-5"><a href="rsa-on-pattern-similarity-change.html#cb200-5" aria-hidden="true" tabindex="-1"></a>sfigmm_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb200-6"><a href="rsa-on-pattern-similarity-change.html#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb200-7"><a href="rsa-on-pattern-similarity-change.html#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb200-8"><a href="rsa-on-pattern-similarity-change.html#cb200-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb200-9"><a href="rsa-on-pattern-similarity-change.html#cb200-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb200-10"><a href="rsa-on-pattern-similarity-change.html#cb200-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (same seq)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb200-11"><a href="rsa-on-pattern-similarity-change.html#cb200-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="fl">0.00125</span>, <span class="at">by=</span><span class="fl">0.00025</span>), </span>
<span id="cb200-12"><a href="rsa-on-pattern-similarity-change.html#cb200-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0.000&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fl">0.001</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb200-13"><a href="rsa-on-pattern-similarity-change.html#cb200-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;virtual time&quot;</span>, <span class="at">y=</span><span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">coefficient&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Time Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb200-14"><a href="rsa-on-pattern-similarity-change.html#cb200-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span>   </span>
<span id="cb200-15"><a href="rsa-on-pattern-similarity-change.html#cb200-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb200-16"><a href="rsa-on-pattern-similarity-change.html#cb200-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb200-17"><a href="rsa-on-pattern-similarity-change.html#cb200-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb200-18"><a href="rsa-on-pattern-similarity-change.html#cb200-18" aria-hidden="true" tabindex="-1"></a>sfigmm_c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="rsa-on-pattern-similarity-change.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb201-2"><a href="rsa-on-pattern-similarity-change.html#cb201-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> <span class="fu">get_complete_df</span>()</span>
<span id="cb201-3"><a href="rsa-on-pattern-similarity-change.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="rsa-on-pattern-similarity-change.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb201-5"><a href="rsa-on-pattern-similarity-change.html#cb201-5" aria-hidden="true" tabindex="-1"></a>sfigmm_d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb201-6"><a href="rsa-on-pattern-similarity-change.html#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb201-7"><a href="rsa-on-pattern-similarity-change.html#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb201-8"><a href="rsa-on-pattern-similarity-change.html#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb201-9"><a href="rsa-on-pattern-similarity-change.html#cb201-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb201-10"><a href="rsa-on-pattern-similarity-change.html#cb201-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb201-11"><a href="rsa-on-pattern-similarity-change.html#cb201-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z virtual time&#39;</span>) <span class="sc">+</span></span>
<span id="cb201-12"><a href="rsa-on-pattern-similarity-change.html#cb201-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-13"><a href="rsa-on-pattern-similarity-change.html#cb201-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb201-14"><a href="rsa-on-pattern-similarity-change.html#cb201-14" aria-hidden="true" tabindex="-1"></a>sfigmm_d</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-134-2.png" width="672" /></p>
<div id="lme-model-assumptions-1" class="section level4 unnumbered">
<h4>LME model assumptions</h4>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="rsa-on-pattern-similarity-change.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmm_diagplots_jb</span>(lmm_full)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="representational-change-visualization" class="section level3 unnumbered">
<h3>Representational Change Visualization</h3>
<p>To illustrate the effect in a simpler way, we average pattern similarity changes based on a median split of events, separately for events from the same and from different sequences.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="rsa-on-pattern-similarity-change.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get data from aHPC</span></span>
<span id="cb203-2"><a href="rsa-on-pattern-similarity-change.html#cb203-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_hpc <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb203-3"><a href="rsa-on-pattern-similarity-change.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>)</span>
<span id="cb203-4"><a href="rsa-on-pattern-similarity-change.html#cb203-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-5"><a href="rsa-on-pattern-similarity-change.html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for each subject, ROI and same/diff day comparisons dichotomize virtual time difference</span></span>
<span id="cb203-6"><a href="rsa-on-pattern-similarity-change.html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="co"># based on a median split, then average high/low temporal distances</span></span>
<span id="cb203-7"><a href="rsa-on-pattern-similarity-change.html#cb203-7" aria-hidden="true" tabindex="-1"></a>ps_change_means <span class="ot">&lt;-</span>rsa_dat_hpc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id, same_day) <span class="sc">%&gt;%</span></span>
<span id="cb203-8"><a href="rsa-on-pattern-similarity-change.html#cb203-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_dist =</span> sjmisc<span class="sc">::</span><span class="fu">dicho</span>(vir_time_diff, <span class="at">as.num =</span> <span class="cn">TRUE</span>)<span class="sc">+</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-9"><a href="rsa-on-pattern-similarity-change.html#cb203-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id, same_day, temp_dist) <span class="sc">%&gt;%</span></span>
<span id="cb203-10"><a href="rsa-on-pattern-similarity-change.html#cb203-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ps_change =</span> <span class="fu">mean</span>(ps_change), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb203-11"><a href="rsa-on-pattern-similarity-change.html#cb203-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-12"><a href="rsa-on-pattern-similarity-change.html#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make the high/low temporal distance variable a factor</span></span>
<span id="cb203-13"><a href="rsa-on-pattern-similarity-change.html#cb203-13" aria-hidden="true" tabindex="-1"></a>ps_change_means <span class="ot">&lt;-</span> ps_change_means <span class="sc">%&gt;%</span></span>
<span id="cb203-14"><a href="rsa-on-pattern-similarity-change.html#cb203-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb203-15"><a href="rsa-on-pattern-similarity-change.html#cb203-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist =</span> <span class="fu">as.numeric</span>(temp_dist),</span>
<span id="cb203-16"><a href="rsa-on-pattern-similarity-change.html#cb203-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist_f =</span> <span class="fu">factor</span>(temp_dist),</span>
<span id="cb203-17"><a href="rsa-on-pattern-similarity-change.html#cb203-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist_f =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(temp_dist, <span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)),</span>
<span id="cb203-18"><a href="rsa-on-pattern-similarity-change.html#cb203-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist_f =</span> <span class="fu">factor</span>(temp_dist_f, <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)),</span>
<span id="cb203-19"><a href="rsa-on-pattern-similarity-change.html#cb203-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day =</span> <span class="fu">as.factor</span>(same_day),</span>
<span id="cb203-20"><a href="rsa-on-pattern-similarity-change.html#cb203-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;different day&quot;</span>, <span class="st">&quot;same day&quot;</span>)),</span>
<span id="cb203-21"><a href="rsa-on-pattern-similarity-change.html#cb203-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day =</span> <span class="fu">factor</span>(same_day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;same day&quot;</span>, <span class="st">&quot;different day&quot;</span>)))</span>
<span id="cb203-22"><a href="rsa-on-pattern-similarity-change.html#cb203-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-23"><a href="rsa-on-pattern-similarity-change.html#cb203-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Test pattern similarity for same-sequence events separated by high vs. low temporal distances</span></span>
<span id="cb203-24"><a href="rsa-on-pattern-similarity-change.html#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">208</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb203-25"><a href="rsa-on-pattern-similarity-change.html#cb203-25" aria-hidden="true" tabindex="-1"></a>stats_same_day_high_low <span class="ot">&lt;-</span> <span class="fu">paired_t_perm_jb</span>(ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;same day&quot;</span> <span class="sc">&amp;</span> ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>,]<span class="sc">$</span>ps_change <span class="sc">-</span> </span>
<span id="cb203-26"><a href="rsa-on-pattern-similarity-change.html#cb203-26" aria-hidden="true" tabindex="-1"></a>                            ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;same day&quot;</span> <span class="sc">&amp;</span> ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>,]<span class="sc">$</span>ps_change)</span>
<span id="cb203-27"><a href="rsa-on-pattern-similarity-change.html#cb203-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-28"><a href="rsa-on-pattern-similarity-change.html#cb203-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for paired samples using non-central t-distribution for CI</span></span>
<span id="cb203-29"><a href="rsa-on-pattern-similarity-change.html#cb203-29" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;same day&quot;</span> <span class="sc">&amp;</span> ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>,]<span class="sc">$</span>ps_change, </span>
<span id="cb203-30"><a href="rsa-on-pattern-similarity-change.html#cb203-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span>ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;same day&quot;</span> <span class="sc">&amp;</span> ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>,]<span class="sc">$</span>ps_change, </span>
<span id="cb203-31"><a href="rsa-on-pattern-similarity-change.html#cb203-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">pooled=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb203-32"><a href="rsa-on-pattern-similarity-change.html#cb203-32" aria-hidden="true" tabindex="-1"></a>stats_same_day_high_low<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb203-33"><a href="rsa-on-pattern-similarity-change.html#cb203-33" aria-hidden="true" tabindex="-1"></a>stats_same_day_high_low<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb203-34"><a href="rsa-on-pattern-similarity-change.html#cb203-34" aria-hidden="true" tabindex="-1"></a>stats_same_day_high_low<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb203-35"><a href="rsa-on-pattern-similarity-change.html#cb203-35" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats_same_day_high_low) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-136">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.48</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0197</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0201</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000173</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00183</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.637</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0752</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.871</td></tr>
</table>

<p>To visualize the effect, lets make a plot of the raw pattern similarity change for high vs. low temporal distances.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="rsa-on-pattern-similarity-change.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a column with subject-specific jitter</span></span>
<span id="cb204-2"><a href="rsa-on-pattern-similarity-change.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generate custom repeating jitter (multiply with -1/1 to shift towards each other)</span></span>
<span id="cb204-3"><a href="rsa-on-pattern-similarity-change.html#cb204-3" aria-hidden="true" tabindex="-1"></a>ps_change_means <span class="ot">&lt;-</span> ps_change_means <span class="sc">%&gt;%</span> </span>
<span id="cb204-4"><a href="rsa-on-pattern-similarity-change.html#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb204-5"><a href="rsa-on-pattern-similarity-change.html#cb204-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_jit =</span> <span class="fu">as.numeric</span>(temp_dist) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">jitter</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n_subs), <span class="at">amount =</span> <span class="fl">0.05</span>), <span class="at">each=</span><span class="dv">4</span>) <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),n_subs))</span>
<span id="cb204-6"><a href="rsa-on-pattern-similarity-change.html#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="rsa-on-pattern-similarity-change.html#cb204-7" aria-hidden="true" tabindex="-1"></a>f4c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="st">&quot;same day&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change, <span class="at">fill =</span> same_day, <span class="at">color =</span> same_day)) <span class="sc">+</span></span>
<span id="cb204-8"><a href="rsa-on-pattern-similarity-change.html#cb204-8" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="st">&quot;same day&quot;</span>, temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>), </span>
<span id="cb204-9"><a href="rsa-on-pattern-similarity-change.html#cb204-9" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change),</span>
<span id="cb204-10"><a href="rsa-on-pattern-similarity-change.html#cb204-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb204-11"><a href="rsa-on-pattern-similarity-change.html#cb204-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb204-12"><a href="rsa-on-pattern-similarity-change.html#cb204-12" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="st">&quot;same day&quot;</span>, temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>), </span>
<span id="cb204-13"><a href="rsa-on-pattern-similarity-change.html#cb204-13" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change),</span>
<span id="cb204-14"><a href="rsa-on-pattern-similarity-change.html#cb204-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb204-15"><a href="rsa-on-pattern-similarity-change.html#cb204-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb204-16"><a href="rsa-on-pattern-similarity-change.html#cb204-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group =</span> temp_dist),<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb204-17"><a href="rsa-on-pattern-similarity-change.html#cb204-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>sub_id,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb204-18"><a href="rsa-on-pattern-similarity-change.html#cb204-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb204-19"><a href="rsa-on-pattern-similarity-change.html#cb204-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>)),</span>
<span id="cb204-20"><a href="rsa-on-pattern-similarity-change.html#cb204-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb204-21"><a href="rsa-on-pattern-similarity-change.html#cb204-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb204-22"><a href="rsa-on-pattern-similarity-change.html#cb204-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb204-23"><a href="rsa-on-pattern-similarity-change.html#cb204-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb204-24"><a href="rsa-on-pattern-similarity-change.html#cb204-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb204-25"><a href="rsa-on-pattern-similarity-change.html#cb204-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb204-26"><a href="rsa-on-pattern-similarity-change.html#cb204-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>]), <span class="at">name =</span> <span class="st">&quot;same sequence&quot;</span>, <span class="at">labels =</span> <span class="st">&quot;virtual time&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-27"><a href="rsa-on-pattern-similarity-change.html#cb204-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb204-28"><a href="rsa-on-pattern-similarity-change.html#cb204-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;underline(&quot;    *    &quot;)&#39;</span>, </span>
<span id="cb204-29"><a href="rsa-on-pattern-similarity-change.html#cb204-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb204-30"><a href="rsa-on-pattern-similarity-change.html#cb204-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;pattern similarity change&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;virtual temporal distance&#39;</span>) <span class="sc">+</span></span>
<span id="cb204-31"><a href="rsa-on-pattern-similarity-change.html#cb204-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>), <span class="at">title.position =</span> <span class="st">&quot;left&quot;</span>)) <span class="sc">+</span></span>
<span id="cb204-32"><a href="rsa-on-pattern-similarity-change.html#cb204-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb204-33"><a href="rsa-on-pattern-similarity-change.html#cb204-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb204-34"><a href="rsa-on-pattern-similarity-change.html#cb204-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb204-35"><a href="rsa-on-pattern-similarity-change.html#cb204-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-36"><a href="rsa-on-pattern-similarity-change.html#cb204-36" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb204-37"><a href="rsa-on-pattern-similarity-change.html#cb204-37" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f4c)<span class="sc">$</span>data[[<span class="dv">4</span>]]</span>
<span id="cb204-38"><a href="rsa-on-pattern-similarity-change.html#cb204-38" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y, group), </span>
<span id="cb204-39"><a href="rsa-on-pattern-similarity-change.html#cb204-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f4c.txt&quot;</span>))</span></code></pre></div>
<p>Summary Statistics: paired t-test for aHPC pattern similarity changes for high vs. low temporal distances for same sequence events
t<sub>27</sub>=2.48, p=0.020, d=0.64, 95% CI [0.08, 0.87]</p>
</div>
<div id="not-driven-by-first-last-event-pairs" class="section level3 unnumbered">
<h3>Not driven by first &amp; last event pairs</h3>
<blockquote>
<p>In contrast to our previous work(21), where we observed negative correlations of pattern similarity and temporal distances, participants learned multiple sequences in this study. They might have formed strong associations of same-sequence events on top of inferring each event’s virtual time, potentially altering how temporal distances affected hippocampal pattern similarity (see Discussion). The effect of virtual temporal distances on pattern similarity changes remained significant when competing for variance with a control predictor accounting for comparisons of the first and last event of each sequence (Supplemental Figure 5A-C; summary statistics: t27=2.25, p=0.034, d=0.41, 95%% CI [0.04, 0.82]; mixed model: χ2(1)=5.36, p=0.021, Supplemental Table 3). Thus, the relationship of hippocampal event representations and temporal distances is not exclusively driven by associations of the events marking the transitions between sequences.</p>
</blockquote>
<p>Now, let’s see if the within-day hippocampus effect goes beyond the effect of the most extreme comparisons, i.e. comparisons between the first and last day of an event. These could for example be used by participants to chunk the events into virtual days. For that we create a binary variable (deviation-coded) that tells us whether a comparison is between the first and last event of a virtual day.</p>
<div id="summary-statistics-4" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<p>In the summary statistics approach, let’s test a multiple regression model that includes the virtual time predictor and a binary predictor for those first/last event pairs. The code below implements the first- and second-level analysis.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="rsa-on-pattern-similarity-change.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">57</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb205-2"><a href="rsa-on-pattern-similarity-change.html#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="rsa-on-pattern-similarity-change.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all comparisons from the same day</span></span>
<span id="cb205-4"><a href="rsa-on-pattern-similarity-change.html#cb205-4" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day_aHPC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb205-5"><a href="rsa-on-pattern-similarity-change.html#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb205-6"><a href="rsa-on-pattern-similarity-change.html#cb205-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-7"><a href="rsa-on-pattern-similarity-change.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="co"># find comparisons of first and last event, which are the comparisons of events 1 and 5</span></span>
<span id="cb205-8"><a href="rsa-on-pattern-similarity-change.html#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># that have an order difference of 4</span></span>
<span id="cb205-9"><a href="rsa-on-pattern-similarity-change.html#cb205-9" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day_aHPC<span class="sc">$</span>first_last <span class="ot">&lt;-</span> <span class="fu">abs</span>(rsa_dat_same_day_aHPC<span class="sc">$</span>event1 <span class="sc">-</span> rsa_dat_same_day_aHPC<span class="sc">$</span>event2) <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb205-10"><a href="rsa-on-pattern-similarity-change.html#cb205-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-11"><a href="rsa-on-pattern-similarity-change.html#cb205-11" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb205-12"><a href="rsa-on-pattern-similarity-change.html#cb205-12" aria-hidden="true" tabindex="-1"></a>rsa_fit_aHPC_first_last <span class="ot">&lt;-</span> rsa_dat_same_day_aHPC <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb205-13"><a href="rsa-on-pattern-similarity-change.html#cb205-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb205-14"><a href="rsa-on-pattern-similarity-change.html#cb205-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb205-15"><a href="rsa-on-pattern-similarity-change.html#cb205-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff + first_last&quot;</span>,</span>
<span id="cb205-16"><a href="rsa-on-pattern-similarity-change.html#cb205-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb205-17"><a href="rsa-on-pattern-similarity-change.html#cb205-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_first_last&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb205-18"><a href="rsa-on-pattern-similarity-change.html#cb205-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb205-19"><a href="rsa-on-pattern-similarity-change.html#cb205-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>)</span>
<span id="cb205-20"><a href="rsa-on-pattern-similarity-change.html#cb205-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-21"><a href="rsa-on-pattern-similarity-change.html#cb205-21" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb205-22"><a href="rsa-on-pattern-similarity-change.html#cb205-22" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_aHPC_first_last <span class="sc">%&gt;%</span> </span>
<span id="cb205-23"><a href="rsa-on-pattern-similarity-change.html#cb205-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb205-24"><a href="rsa-on-pattern-similarity-change.html#cb205-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb205-25"><a href="rsa-on-pattern-similarity-change.html#cb205-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb205-26"><a href="rsa-on-pattern-similarity-change.html#cb205-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-27"><a href="rsa-on-pattern-similarity-change.html#cb205-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb205-28"><a href="rsa-on-pattern-similarity-change.html#cb205-28" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_aHPC_first_last <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id<span class="sc">==</span><span class="st">&quot;z_virtual_time&quot;</span>))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb205-29"><a href="rsa-on-pattern-similarity-change.html#cb205-29" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb205-30"><a href="rsa-on-pattern-similarity-change.html#cb205-30" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb205-31"><a href="rsa-on-pattern-similarity-change.html#cb205-31" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb205-32"><a href="rsa-on-pattern-similarity-change.html#cb205-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-33"><a href="rsa-on-pattern-similarity-change.html#cb205-33" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb205-34"><a href="rsa-on-pattern-similarity-change.html#cb205-34" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-138">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.424</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0327</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0341</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0375</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.811</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.413</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0352</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.824</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time within sequence in aHPC with first-last-event-pair control predictor in the model<br />
t<sub>27</sub>=2.25, p=0.034, d=0.41, 95% CI [0.04, 0.82]</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="rsa-on-pattern-similarity-change.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data to plot</span></span>
<span id="cb206-2"><a href="rsa-on-pattern-similarity-change.html#cb206-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit_aHPC_first_last <span class="sc">%&gt;%</span></span>
<span id="cb206-3"><a href="rsa-on-pattern-similarity-change.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_id =</span> <span class="fu">factor</span>(z_id, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_first_last&quot;</span>)))</span>
<span id="cb206-4"><a href="rsa-on-pattern-similarity-change.html#cb206-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-5"><a href="rsa-on-pattern-similarity-change.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb206-6"><a href="rsa-on-pattern-similarity-change.html#cb206-6" aria-hidden="true" tabindex="-1"></a>sfiga <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x=</span>z_id, <span class="at">y=</span>z, <span class="at">fill =</span> z_id, <span class="at">color =</span> z_id)) <span class="sc">+</span></span>
<span id="cb206-7"><a href="rsa-on-pattern-similarity-change.html#cb206-7" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb206-8"><a href="rsa-on-pattern-similarity-change.html#cb206-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb206-9"><a href="rsa-on-pattern-similarity-change.html#cb206-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(z_id)<span class="sc">-</span><span class="fl">0.2</span>, <span class="at">y =</span> z),</span>
<span id="cb206-10"><a href="rsa-on-pattern-similarity-change.html#cb206-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb206-11"><a href="rsa-on-pattern-similarity-change.html#cb206-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb206-12"><a href="rsa-on-pattern-similarity-change.html#cb206-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb206-13"><a href="rsa-on-pattern-similarity-change.html#cb206-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb206-14"><a href="rsa-on-pattern-similarity-change.html#cb206-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb206-15"><a href="rsa-on-pattern-similarity-change.html#cb206-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb206-16"><a href="rsa-on-pattern-similarity-change.html#cb206-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb206-17"><a href="rsa-on-pattern-similarity-change.html#cb206-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb206-18"><a href="rsa-on-pattern-similarity-change.html#cb206-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], ultimate_gray)),</span>
<span id="cb206-19"><a href="rsa-on-pattern-similarity-change.html#cb206-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;RSA predictor&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;first &amp; last event pair&quot;</span>)) <span class="sc">+</span></span>
<span id="cb206-20"><a href="rsa-on-pattern-similarity-change.html#cb206-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], ultimate_gray))) <span class="sc">+</span></span>
<span id="cb206-21"><a href="rsa-on-pattern-similarity-change.html#cb206-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;first &amp; last&quot;</span>)) <span class="sc">+</span></span>
<span id="cb206-22"><a href="rsa-on-pattern-similarity-change.html#cb206-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;predictor&#39;</span>) <span class="sc">+</span></span>
<span id="cb206-23"><a href="rsa-on-pattern-similarity-change.html#cb206-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb206-24"><a href="rsa-on-pattern-similarity-change.html#cb206-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb206-25"><a href="rsa-on-pattern-similarity-change.html#cb206-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb206-26"><a href="rsa-on-pattern-similarity-change.html#cb206-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb206-27"><a href="rsa-on-pattern-similarity-change.html#cb206-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb206-28"><a href="rsa-on-pattern-similarity-change.html#cb206-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">&quot;center&quot;</span>)</span>
<span id="cb206-29"><a href="rsa-on-pattern-similarity-change.html#cb206-29" aria-hidden="true" tabindex="-1"></a>sfiga</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
</div>
<div id="linear-mixed-effects-3" class="section level4 unnumbered">
<h4>Linear Mixed Effects</h4>
<p>Now, let’s do the same using a mixed model. We add the first-last variable as a fixed effect to the model in addition to virtual time to ensure that the effect of virtual time is not exclusively driven by comparisons of the first and last events. The model converges without warnings only with a random effects structure reduced to random slopes for virtual time.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="rsa-on-pattern-similarity-change.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">58</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb207-2"><a href="rsa-on-pattern-similarity-change.html#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="rsa-on-pattern-similarity-change.html#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from the same day and add variable indicating whether comparison</span></span>
<span id="cb207-4"><a href="rsa-on-pattern-similarity-change.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co"># is between first and last event of a day</span></span>
<span id="cb207-5"><a href="rsa-on-pattern-similarity-change.html#cb207-5" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb207-6"><a href="rsa-on-pattern-similarity-change.html#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">first_last =</span> (<span class="fu">as.numeric</span>(<span class="fu">abs</span>(event1 <span class="sc">-</span> event2) <span class="sc">==</span> <span class="dv">4</span>)<span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb207-7"><a href="rsa-on-pattern-similarity-change.html#cb207-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-8"><a href="rsa-on-pattern-similarity-change.html#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference and the extreme pair predictor as </span></span>
<span id="cb207-9"><a href="rsa-on-pattern-similarity-change.html#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effects and random intercepts for subject</span></span>
<span id="cb207-10"><a href="rsa-on-pattern-similarity-change.html#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co"># maximal random effects structure with random slopes and intercepts --&gt; singular fit</span></span>
<span id="cb207-11"><a href="rsa-on-pattern-similarity-change.html#cb207-11" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + first_last + (1 + vir_time_diff + first_last | sub_id)&quot;</span> </span>
<span id="cb207-12"><a href="rsa-on-pattern-similarity-change.html#cb207-12" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>,</span>
<span id="cb207-13"><a href="rsa-on-pattern-similarity-change.html#cb207-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">20000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="rsa-on-pattern-similarity-change.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># thus we remove random intercepts for first-last control predictor -&gt; still singular</span></span>
<span id="cb209-2"><a href="rsa-on-pattern-similarity-change.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">349</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb209-3"><a href="rsa-on-pattern-similarity-change.html#cb209-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + first_last + (1 + vir_time_diff | sub_id)&quot;</span> </span>
<span id="cb209-4"><a href="rsa-on-pattern-similarity-change.html#cb209-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>,</span>
<span id="cb209-5"><a href="rsa-on-pattern-similarity-change.html#cb209-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">90000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="rsa-on-pattern-similarity-change.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># thus we also remove the correlation between random slopes for virtual time and random intercepts</span></span>
<span id="cb211-2"><a href="rsa-on-pattern-similarity-change.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">349</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb211-3"><a href="rsa-on-pattern-similarity-change.html#cb211-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + first_last + (1 + vir_time_diff || sub_id)&quot;</span> </span>
<span id="cb211-4"><a href="rsa-on-pattern-similarity-change.html#cb211-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>,</span>
<span id="cb211-5"><a href="rsa-on-pattern-similarity-change.html#cb211-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">90000</span>)))</span>
<span id="cb211-6"><a href="rsa-on-pattern-similarity-change.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + first_last + ((1 | sub_id) + (0 +      vir_time_diff | sub_id))
##    Data: rsa_dat_same_day
## Control: lmerControl(optCtrl = list(maxfun = 90000))
## 
##      AIC      BIC   logLik deviance df.resid 
##  -7950.2  -7920.0   3981.1  -7962.2     1114 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.5046 -0.6260 -0.0376  0.6554  3.8528 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev. 
##  sub_id   (Intercept)   7.365e-13 8.582e-07
##  sub_id.1 vir_time_diff 6.680e-08 2.585e-04
##  Residual               4.781e-05 6.914e-03
## Number of obs: 1120, groups:  sub_id, 28
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)   -1.523e-05  4.207e-04  -0.036
## vir_time_diff  6.257e-04  2.644e-04   2.367
## first_last     3.568e-04  4.177e-04   0.854</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="rsa-on-pattern-similarity-change.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb213-2"><a href="rsa-on-pattern-similarity-change.html#cb213-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="rsa-on-pattern-similarity-change.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb215-2"><a href="rsa-on-pattern-similarity-change.html#cb215-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb215-3"><a href="rsa-on-pattern-similarity-change.html#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="rsa-on-pattern-similarity-change.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compare against a reduced model</span></span>
<span id="cb215-5"><a href="rsa-on-pattern-similarity-change.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">301</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb215-6"><a href="rsa-on-pattern-similarity-change.html#cb215-6" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ first_last + (1 + vir_time_diff || sub_id)&quot;</span> </span>
<span id="cb215-7"><a href="rsa-on-pattern-similarity-change.html#cb215-7" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="rsa-on-pattern-similarity-change.html#cb217-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span></code></pre></div>
<p>Mixed Model: Fixed effect of virtual time on aHPC pattern similarity change with first-last-event-pair control predictor<br />
<span class="math inline">\(\chi^2\)</span>(1)=5.36, p=0.021</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="rsa-on-pattern-similarity-change.html#cb218-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;first-last pair&quot;</span>)</span>
<span id="cb218-2"><a href="rsa-on-pattern-similarity-change.html#cb218-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">2</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb218-3"><a href="rsa-on-pattern-similarity-change.html#cb218-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept (SD)&quot;</span>, <span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb218-4"><a href="rsa-on-pattern-similarity-change.html#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="rsa-on-pattern-similarity-change.html#cb218-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb218-6"><a href="rsa-on-pattern-similarity-change.html#cb218-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb218-7"><a href="rsa-on-pattern-similarity-change.html#cb218-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb218-8"><a href="rsa-on-pattern-similarity-change.html#cb218-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb218-9"><a href="rsa-on-pattern-similarity-change.html#cb218-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb218-10"><a href="rsa-on-pattern-similarity-change.html#cb218-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb218-11"><a href="rsa-on-pattern-similarity-change.html#cb218-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb218-12"><a href="rsa-on-pattern-similarity-change.html#cb218-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb218-13"><a href="rsa-on-pattern-similarity-change.html#cb218-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change for same-sequence events in the anterior hippocampus when controlling for the effect of first-last event pairs&quot;</span>)</span>
<span id="cb218-14"><a href="rsa-on-pattern-similarity-change.html#cb218-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-15"><a href="rsa-on-pattern-similarity-change.html#cb218-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb218-16"><a href="rsa-on-pattern-similarity-change.html#cb218-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_same_seq_first_last <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb218-17"><a href="rsa-on-pattern-similarity-change.html#cb218-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-18"><a href="rsa-on-pattern-similarity-change.html#cb218-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb218-19"><a href="rsa-on-pattern-similarity-change.html#cb218-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-141">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change for same-sequence events in the anterior hippocampus when controlling for the effect of first-last event pairs</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000015</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000421</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.04</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000841</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000810</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000626</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000264</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.37</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000099</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001152</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">first-last pair</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000357</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000418</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.85</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000462</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001176</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">intercept (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000001</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000258</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.006914</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7946.81</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3978.40</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">6</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7950.16</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3981.08</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.36</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.021</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+first_last+((1|sub_id)+(0+vir_time_diff|sub_id)); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>LME Plots.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="rsa-on-pattern-similarity-change.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s plot the effect</span></span>
<span id="cb219-2"><a href="rsa-on-pattern-similarity-change.html#cb219-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb219-3"><a href="rsa-on-pattern-similarity-change.html#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">factor</span>(term, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;first_last&quot;</span>, <span class="st">&quot;(Intercept)&quot;</span>)))</span>
<span id="cb219-4"><a href="rsa-on-pattern-similarity-change.html#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="rsa-on-pattern-similarity-change.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb219-6"><a href="rsa-on-pattern-similarity-change.html#cb219-6" aria-hidden="true" tabindex="-1"></a>sfigb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb219-7"><a href="rsa-on-pattern-similarity-change.html#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb219-8"><a href="rsa-on-pattern-similarity-change.html#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb219-9"><a href="rsa-on-pattern-similarity-change.html#cb219-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb219-10"><a href="rsa-on-pattern-similarity-change.html#cb219-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_manual(values = c(unname(aHPC_colors[&quot;within_main&quot;]), &quot;gray&quot;)) +</span></span>
<span id="cb219-11"><a href="rsa-on-pattern-similarity-change.html#cb219-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>]), ultimate_gray), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Virtual Time&quot;</span>, <span class="st">&quot;First-last&quot;</span>)) <span class="sc">+</span></span>
<span id="cb219-12"><a href="rsa-on-pattern-similarity-change.html#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">coefficient&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Time Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb219-13"><a href="rsa-on-pattern-similarity-change.html#cb219-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb219-14"><a href="rsa-on-pattern-similarity-change.html#cb219-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb219-15"><a href="rsa-on-pattern-similarity-change.html#cb219-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb219-16"><a href="rsa-on-pattern-similarity-change.html#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coord_fixed(ratio = 3\\\\) +</span></span>
<span id="cb219-17"><a href="rsa-on-pattern-similarity-change.html#cb219-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb219-18"><a href="rsa-on-pattern-similarity-change.html#cb219-18" aria-hidden="true" tabindex="-1"></a>sfigb</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="rsa-on-pattern-similarity-change.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb220-2"><a href="rsa-on-pattern-similarity-change.html#cb220-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="rsa-on-pattern-similarity-change.html#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_complete_df</span>()</span>
<span id="cb220-4"><a href="rsa-on-pattern-similarity-change.html#cb220-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-5"><a href="rsa-on-pattern-similarity-change.html#cb220-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb220-6"><a href="rsa-on-pattern-similarity-change.html#cb220-6" aria-hidden="true" tabindex="-1"></a>sfigc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb220-7"><a href="rsa-on-pattern-similarity-change.html#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb220-8"><a href="rsa-on-pattern-similarity-change.html#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>,</span>
<span id="cb220-9"><a href="rsa-on-pattern-similarity-change.html#cb220-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb220-10"><a href="rsa-on-pattern-similarity-change.html#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>, <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])),</span>
<span id="cb220-11"><a href="rsa-on-pattern-similarity-change.html#cb220-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="fu">element_blank</span>(), <span class="at">labels =</span><span class="fu">c</span>(<span class="st">&quot;first &amp; last event&quot;</span>, <span class="st">&quot;virtual time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb220-12"><a href="rsa-on-pattern-similarity-change.html#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>, <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>]))) <span class="sc">+</span></span>
<span id="cb220-13"><a href="rsa-on-pattern-similarity-change.html#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb220-14"><a href="rsa-on-pattern-similarity-change.html#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;fixed effect&#39;</span>) <span class="sc">+</span></span>
<span id="cb220-15"><a href="rsa-on-pattern-similarity-change.html#cb220-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-16"><a href="rsa-on-pattern-similarity-change.html#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb220-17"><a href="rsa-on-pattern-similarity-change.html#cb220-17" aria-hidden="true" tabindex="-1"></a>sfigc</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-142-2.png" width="672" /></p>
<div id="lme-model-assumptions-2" class="section level5 unnumbered">
<h5>LME model assumptions</h5>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="rsa-on-pattern-similarity-change.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmm_diagplots_jb</span>(lmm_full)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="ahpc-virtual-time-within-sequence-when-including-order-real-time" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> aHPC: virtual time within sequence when including order &amp; real time</h2>
<blockquote>
<p>We further tested whether the effect of virtual time on anterior hippocampal pattern similarity change persisted when including the absolute difference between sequence positions (“order”) and the interval in seconds between events (“real time”) as control predictors of no interest in the model.</p>
</blockquote>
<p>To follow up on the within-day effect in the hippocampus, let’s see if virtual correlates with pattern similarity change above and beyond the effects of order and real time. We will look at this in two ways.</p>
<div id="one-model-with-multiple-predictors" class="section level3 unnumbered">
<h3>One model with multiple predictors</h3>
<p>The first way is to run models in which the three time metrics compete for variance. Temporal distances based on order and real time are control regressors of no interest, we test only the effect of virtual time for significance.</p>
<div id="summary-statistics-5" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<p>In the summary statistics approach, this comes down to a multiple regression on the participant-level. Again, we compute z-values for each regression coefficient from permutations of the dependent variable, which maintains the correlation structure of the regressors. Then we test the z-values for virtual time against 0 on the group level.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="rsa-on-pattern-similarity-change.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">59</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb222-2"><a href="rsa-on-pattern-similarity-change.html#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="rsa-on-pattern-similarity-change.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all comparisons from the same day</span></span>
<span id="cb222-4"><a href="rsa-on-pattern-similarity-change.html#cb222-4" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day_aHPC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb222-5"><a href="rsa-on-pattern-similarity-change.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-6"><a href="rsa-on-pattern-similarity-change.html#cb222-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-7"><a href="rsa-on-pattern-similarity-change.html#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb222-8"><a href="rsa-on-pattern-similarity-change.html#cb222-8" aria-hidden="true" tabindex="-1"></a>rsa_fit_aHPC_mult_reg <span class="ot">&lt;-</span> rsa_dat_same_day_aHPC <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb222-9"><a href="rsa-on-pattern-similarity-change.html#cb222-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb222-10"><a href="rsa-on-pattern-similarity-change.html#cb222-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb222-11"><a href="rsa-on-pattern-similarity-change.html#cb222-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff&quot;</span>,</span>
<span id="cb222-12"><a href="rsa-on-pattern-similarity-change.html#cb222-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb222-13"><a href="rsa-on-pattern-similarity-change.html#cb222-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb222-14"><a href="rsa-on-pattern-similarity-change.html#cb222-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb222-15"><a href="rsa-on-pattern-similarity-change.html#cb222-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>)</span>
<span id="cb222-16"><a href="rsa-on-pattern-similarity-change.html#cb222-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-17"><a href="rsa-on-pattern-similarity-change.html#cb222-17" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb222-18"><a href="rsa-on-pattern-similarity-change.html#cb222-18" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> </span>
<span id="cb222-19"><a href="rsa-on-pattern-similarity-change.html#cb222-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb222-20"><a href="rsa-on-pattern-similarity-change.html#cb222-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb222-21"><a href="rsa-on-pattern-similarity-change.html#cb222-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb222-22"><a href="rsa-on-pattern-similarity-change.html#cb222-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-23"><a href="rsa-on-pattern-similarity-change.html#cb222-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb222-24"><a href="rsa-on-pattern-similarity-change.html#cb222-24" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb222-25"><a href="rsa-on-pattern-similarity-change.html#cb222-25" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb222-26"><a href="rsa-on-pattern-similarity-change.html#cb222-26" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb222-27"><a href="rsa-on-pattern-similarity-change.html#cb222-27" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb222-28"><a href="rsa-on-pattern-similarity-change.html#cb222-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-29"><a href="rsa-on-pattern-similarity-change.html#cb222-29" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb222-30"><a href="rsa-on-pattern-similarity-change.html#cb222-30" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-144">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.437</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0385</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0401</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0248</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.849</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.399</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0218</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.808</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time within sequence in aHPC with order and real time in the model<br />
t<sub>27</sub>=2.18, p=0.040, d=0.40, 95% CI [0.02, 0.81]</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="rsa-on-pattern-similarity-change.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make z_id a factor and reorder it</span></span>
<span id="cb223-2"><a href="rsa-on-pattern-similarity-change.html#cb223-2" aria-hidden="true" tabindex="-1"></a>rsa_fit_aHPC_mult_reg <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb223-3"><a href="rsa-on-pattern-similarity-change.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">z_id =</span> <span class="fu">factor</span>(z_id, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))</span>
<span id="cb223-4"><a href="rsa-on-pattern-similarity-change.html#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="rsa-on-pattern-similarity-change.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb223-6"><a href="rsa-on-pattern-similarity-change.html#cb223-6" aria-hidden="true" tabindex="-1"></a>f4d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rsa_fit_aHPC_mult_reg, <span class="fu">aes</span>(<span class="at">x=</span>z_id, <span class="at">y=</span>z, <span class="at">fill =</span> z_id, <span class="at">colour =</span> z_id)) <span class="sc">+</span></span>
<span id="cb223-7"><a href="rsa-on-pattern-similarity-change.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb223-8"><a href="rsa-on-pattern-similarity-change.html#cb223-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb223-9"><a href="rsa-on-pattern-similarity-change.html#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(z_id)<span class="sc">-</span><span class="fl">0.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb223-10"><a href="rsa-on-pattern-similarity-change.html#cb223-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb223-11"><a href="rsa-on-pattern-similarity-change.html#cb223-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb223-12"><a href="rsa-on-pattern-similarity-change.html#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb223-13"><a href="rsa-on-pattern-similarity-change.html#cb223-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb223-14"><a href="rsa-on-pattern-similarity-change.html#cb223-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb223-15"><a href="rsa-on-pattern-similarity-change.html#cb223-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb223-16"><a href="rsa-on-pattern-similarity-change.html#cb223-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb223-17"><a href="rsa-on-pattern-similarity-change.html#cb223-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb223-18"><a href="rsa-on-pattern-similarity-change.html#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;time metric&#39;</span>) <span class="sc">+</span> </span>
<span id="cb223-19"><a href="rsa-on-pattern-similarity-change.html#cb223-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb223-20"><a href="rsa-on-pattern-similarity-change.html#cb223-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>time_colors, <span class="at">name =</span> <span class="st">&quot;time metric&quot;</span>,</span>
<span id="cb223-21"><a href="rsa-on-pattern-similarity-change.html#cb223-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb223-22"><a href="rsa-on-pattern-similarity-change.html#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>time_colors) <span class="sc">+</span></span>
<span id="cb223-23"><a href="rsa-on-pattern-similarity-change.html#cb223-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb223-24"><a href="rsa-on-pattern-similarity-change.html#cb223-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb223-25"><a href="rsa-on-pattern-similarity-change.html#cb223-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb223-26"><a href="rsa-on-pattern-similarity-change.html#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb223-27"><a href="rsa-on-pattern-similarity-change.html#cb223-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb223-28"><a href="rsa-on-pattern-similarity-change.html#cb223-28" aria-hidden="true" tabindex="-1"></a>f4d</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/RSA%20aHPC%20raincloud%20plot%20of%20time%20metrics%20within%20day-1.png" width="672" /></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="rsa-on-pattern-similarity-change.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb224-2"><a href="rsa-on-pattern-similarity-change.html#cb224-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f4d)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb224-3"><a href="rsa-on-pattern-similarity-change.html#cb224-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y, group), </span>
<span id="cb224-4"><a href="rsa-on-pattern-similarity-change.html#cb224-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f4d.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="linear-mixed-effects-4" class="section level4 unnumbered">
<h4>Linear Mixed Effects</h4>
<p>For the mixed model, we use order differences and real time differences as fixed effects in addition to virtual time. As a random effect structure we first include random intercepts and random slopes for each subject for all 3 fixed effects. This model is singular due to an estimated correlation of 1 between random slopes and random intercepts. We remove the random intercepts, but the fit is still singular. Removing the random slopes for the two fixed effects of no interest (order and real time) also does not help. We thus drop the random intercepts (as above) as well to end up with a model that converges without warnings.</p>
<p>Thus, the full model for this analysis has 3 fixed effects and random slopes for virtual time for each subject.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="rsa-on-pattern-similarity-change.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">87</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb225-2"><a href="rsa-on-pattern-similarity-change.html#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="rsa-on-pattern-similarity-change.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from the same day</span></span>
<span id="cb225-4"><a href="rsa-on-pattern-similarity-change.html#cb225-4" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb225-5"><a href="rsa-on-pattern-similarity-change.html#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="rsa-on-pattern-similarity-change.html#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference, order difference and real time difference as </span></span>
<span id="cb225-7"><a href="rsa-on-pattern-similarity-change.html#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effects and random intercepts and random slopes for all effects</span></span>
<span id="cb225-8"><a href="rsa-on-pattern-similarity-change.html#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fails to converge and is singular after restart</span></span>
<span id="cb225-9"><a href="rsa-on-pattern-similarity-change.html#cb225-9" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff + order_diff + real_time_diff | sub_id)&quot;</span></span>
<span id="cb225-10"><a href="rsa-on-pattern-similarity-change.html#cb225-10" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="rsa-on-pattern-similarity-change.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lmm_full &lt;- update(lmm_full, start=getME(lmm_full, &quot;theta&quot;))</span></span>
<span id="cb227-2"><a href="rsa-on-pattern-similarity-change.html#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="rsa-on-pattern-similarity-change.html#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the correlation between random slopes and random intercepts</span></span>
<span id="cb227-4"><a href="rsa-on-pattern-similarity-change.html#cb227-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff + order_diff + real_time_diff || sub_id)&quot;</span></span>
<span id="cb227-5"><a href="rsa-on-pattern-similarity-change.html#cb227-5" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="rsa-on-pattern-similarity-change.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># thus we reduce the random effect structure by excluding random slopes for the fixed effects of no interest</span></span>
<span id="cb229-2"><a href="rsa-on-pattern-similarity-change.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as above this results in a singular fit (the random intercept variance estimated to be 0)</span></span>
<span id="cb229-3"><a href="rsa-on-pattern-similarity-change.html#cb229-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff | sub_id)&quot;</span></span>
<span id="cb229-4"><a href="rsa-on-pattern-similarity-change.html#cb229-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="rsa-on-pattern-similarity-change.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># next step is to remove the correlation between random slopes and random intercepts</span></span>
<span id="cb231-2"><a href="rsa-on-pattern-similarity-change.html#cb231-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff || sub_id)&quot;</span></span>
<span id="cb231-3"><a href="rsa-on-pattern-similarity-change.html#cb231-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="rsa-on-pattern-similarity-change.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we thus reduce further and keep only the random slopes for virtual time differences</span></span>
<span id="cb233-2"><a href="rsa-on-pattern-similarity-change.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="co"># now the model converges without warnings</span></span>
<span id="cb233-3"><a href="rsa-on-pattern-similarity-change.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">332</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb233-4"><a href="rsa-on-pattern-similarity-change.html#cb233-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb233-5"><a href="rsa-on-pattern-similarity-change.html#cb233-5" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb233-6"><a href="rsa-on-pattern-similarity-change.html#cb233-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-7"><a href="rsa-on-pattern-similarity-change.html#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + order_diff + real_time_diff + (0 +      vir_time_diff | sub_id)
##    Data: rsa_dat_same_day
## 
##      AIC      BIC   logLik deviance df.resid 
##  -7950.8  -7920.6   3981.4  -7962.8     1114 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.4923 -0.6444 -0.0269  0.6629  3.8017 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev. 
##  sub_id   vir_time_diff 6.744e-08 0.0002597
##  Residual               4.778e-05 0.0069126
## Number of obs: 1120, groups:  sub_id, 28
## 
## Fixed effects:
##                  Estimate Std. Error t value
## (Intercept)    -2.812e-04  2.191e-04  -1.284
## vir_time_diff   1.321e-03  5.415e-04   2.439
## order_diff      1.235e-05  9.077e-04   0.014
## real_time_diff -6.760e-04  1.019e-03  -0.663</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="rsa-on-pattern-similarity-change.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb235-2"><a href="rsa-on-pattern-similarity-change.html#cb235-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="rsa-on-pattern-similarity-change.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb237-2"><a href="rsa-on-pattern-similarity-change.html#cb237-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb237-3"><a href="rsa-on-pattern-similarity-change.html#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="rsa-on-pattern-similarity-change.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one way of testing for significance is by comparing the likelihood against a simpler model.</span></span>
<span id="cb237-5"><a href="rsa-on-pattern-similarity-change.html#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time difference and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb237-6"><a href="rsa-on-pattern-similarity-change.html#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb237-7"><a href="rsa-on-pattern-similarity-change.html#cb237-7" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ order_diff + real_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb237-8"><a href="rsa-on-pattern-similarity-change.html#cb237-8" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_same_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb237-9"><a href="rsa-on-pattern-similarity-change.html#cb237-9" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span>
<span id="cb237-10"><a href="rsa-on-pattern-similarity-change.html#cb237-10" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-145">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-7.95e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-7.92e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.98e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-7.96e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7.95e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7.92e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.98e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7.96e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.92</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.015</td></tr>
</table>

<p>Mixed Model: Fixed effect of virtual time on aHPC within-sequence pattern similarity change with order and real time in model
<span class="math inline">\(\chi^2\)</span>(1)=5.92, p=0.015</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="rsa-on-pattern-similarity-change.html#cb238-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)</span>
<span id="cb238-2"><a href="rsa-on-pattern-similarity-change.html#cb238-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb238-3"><a href="rsa-on-pattern-similarity-change.html#cb238-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb238-4"><a href="rsa-on-pattern-similarity-change.html#cb238-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-5"><a href="rsa-on-pattern-similarity-change.html#cb238-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb238-6"><a href="rsa-on-pattern-similarity-change.html#cb238-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb238-7"><a href="rsa-on-pattern-similarity-change.html#cb238-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb238-8"><a href="rsa-on-pattern-similarity-change.html#cb238-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb238-9"><a href="rsa-on-pattern-similarity-change.html#cb238-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb238-10"><a href="rsa-on-pattern-similarity-change.html#cb238-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb238-11"><a href="rsa-on-pattern-similarity-change.html#cb238-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb238-12"><a href="rsa-on-pattern-similarity-change.html#cb238-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb238-13"><a href="rsa-on-pattern-similarity-change.html#cb238-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change for same-sequence events in the anterior hippocampus when including order and real time in the model&quot;</span>)</span>
<span id="cb238-14"><a href="rsa-on-pattern-similarity-change.html#cb238-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-15"><a href="rsa-on-pattern-similarity-change.html#cb238-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb238-16"><a href="rsa-on-pattern-similarity-change.html#cb238-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_same_seq_time_metrics <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb238-17"><a href="rsa-on-pattern-similarity-change.html#cb238-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-18"><a href="rsa-on-pattern-similarity-change.html#cb238-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb238-19"><a href="rsa-on-pattern-similarity-change.html#cb238-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-146">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change for same-sequence events in the anterior hippocampus when including order and real time in the model</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000281</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000219</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.28</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000711</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000149</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.001321</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000541</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.44</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000258</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.002383</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">order</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000012</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000908</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.01</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001768</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001793</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">real time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000676</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.001019</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.66</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.002675</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001323</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000260</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.006913</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7946.84</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3978.42</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">6</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7950.76</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3981.38</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.92</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.015</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+order_diff+real_time_diff+(0+vir_time_diff|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>Mixed model plots.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="rsa-on-pattern-similarity-change.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set RNG</span></span>
<span id="cb239-2"><a href="rsa-on-pattern-similarity-change.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb239-3"><a href="rsa-on-pattern-similarity-change.html#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="rsa-on-pattern-similarity-change.html#cb239-4" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb239-5"><a href="rsa-on-pattern-similarity-change.html#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term) <span class="sc">%&gt;%</span> </span>
<span id="cb239-6"><a href="rsa-on-pattern-similarity-change.html#cb239-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>)))</span>
<span id="cb239-7"><a href="rsa-on-pattern-similarity-change.html#cb239-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-8"><a href="rsa-on-pattern-similarity-change.html#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb239-9"><a href="rsa-on-pattern-similarity-change.html#cb239-9" aria-hidden="true" tabindex="-1"></a>sfigmm_e <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb239-10"><a href="rsa-on-pattern-similarity-change.html#cb239-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-11"><a href="rsa-on-pattern-similarity-change.html#cb239-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb239-12"><a href="rsa-on-pattern-similarity-change.html#cb239-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb239-13"><a href="rsa-on-pattern-similarity-change.html#cb239-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> time_colors) <span class="sc">+</span></span>
<span id="cb239-14"><a href="rsa-on-pattern-similarity-change.html#cb239-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> time_colors, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (same seq.)&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real Time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb239-15"><a href="rsa-on-pattern-similarity-change.html#cb239-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;time metric&quot;</span>, <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Time Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-16"><a href="rsa-on-pattern-similarity-change.html#cb239-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-17"><a href="rsa-on-pattern-similarity-change.html#cb239-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb239-18"><a href="rsa-on-pattern-similarity-change.html#cb239-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb239-19"><a href="rsa-on-pattern-similarity-change.html#cb239-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>()) </span>
<span id="cb239-20"><a href="rsa-on-pattern-similarity-change.html#cb239-20" aria-hidden="true" tabindex="-1"></a>sfigmm_e</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="rsa-on-pattern-similarity-change.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb240-2"><a href="rsa-on-pattern-similarity-change.html#cb240-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> get_complete_df</span>
<span id="cb240-3"><a href="rsa-on-pattern-similarity-change.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the group variable to a factor to control the order of facets below</span></span>
<span id="cb240-4"><a href="rsa-on-pattern-similarity-change.html#cb240-4" aria-hidden="true" tabindex="-1"></a>lmm_full_emm<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(lmm_full_emm<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>))</span>
<span id="cb240-5"><a href="rsa-on-pattern-similarity-change.html#cb240-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-6"><a href="rsa-on-pattern-similarity-change.html#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb240-7"><a href="rsa-on-pattern-similarity-change.html#cb240-7" aria-hidden="true" tabindex="-1"></a>sfigmm_f <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb240-8"><a href="rsa-on-pattern-similarity-change.html#cb240-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb240-9"><a href="rsa-on-pattern-similarity-change.html#cb240-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb240-10"><a href="rsa-on-pattern-similarity-change.html#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> time_colors, <span class="at">name =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb240-11"><a href="rsa-on-pattern-similarity-change.html#cb240-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb240-12"><a href="rsa-on-pattern-similarity-change.html#cb240-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> time_colors) <span class="sc">+</span></span>
<span id="cb240-13"><a href="rsa-on-pattern-similarity-change.html#cb240-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb240-14"><a href="rsa-on-pattern-similarity-change.html#cb240-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z time metric&#39;</span>) <span class="sc">+</span></span>
<span id="cb240-15"><a href="rsa-on-pattern-similarity-change.html#cb240-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb240-16"><a href="rsa-on-pattern-similarity-change.html#cb240-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb240-17"><a href="rsa-on-pattern-similarity-change.html#cb240-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb240-18"><a href="rsa-on-pattern-similarity-change.html#cb240-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb240-19"><a href="rsa-on-pattern-similarity-change.html#cb240-19" aria-hidden="true" tabindex="-1"></a>sfigmm_f</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-147-2.png" width="672" /></p>
<div id="lme-model-assumptions-3" class="section level5 unnumbered">
<h5>LME model assumptions</h5>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="rsa-on-pattern-similarity-change.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmm_diagplots_jb</span>(lmm_full)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<p>We are now ready to create figure 4 of the manuscript:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="rsa-on-pattern-similarity-change.html#cb242-1" aria-hidden="true" tabindex="-1"></a>layoutBD <span class="ot">=</span> <span class="st">&quot;BBCCCDDD&quot;</span></span>
<span id="cb242-2"><a href="rsa-on-pattern-similarity-change.html#cb242-2" aria-hidden="true" tabindex="-1"></a>layoutABD <span class="ot">=</span><span class="st">&quot;</span></span>
<span id="cb242-3"><a href="rsa-on-pattern-similarity-change.html#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="st">ABBBBBB</span></span>
<span id="cb242-4"><a href="rsa-on-pattern-similarity-change.html#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="st">ABBBBBB&quot;</span></span>
<span id="cb242-5"><a href="rsa-on-pattern-similarity-change.html#cb242-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-6"><a href="rsa-on-pattern-similarity-change.html#cb242-6" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> f4a<span class="sc">+</span></span>
<span id="cb242-7"><a href="rsa-on-pattern-similarity-change.html#cb242-7" aria-hidden="true" tabindex="-1"></a>  {f4b <span class="sc">+</span> f4c <span class="sc">+</span> f4d <span class="sc">+</span></span>
<span id="cb242-8"><a href="rsa-on-pattern-similarity-change.html#cb242-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_layout</span>(<span class="at">design =</span> layoutBD, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb242-9"><a href="rsa-on-pattern-similarity-change.html#cb242-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb242-10"><a href="rsa-on-pattern-similarity-change.html#cb242-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb242-11"><a href="rsa-on-pattern-similarity-change.html#cb242-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb242-12"><a href="rsa-on-pattern-similarity-change.html#cb242-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb242-13"><a href="rsa-on-pattern-similarity-change.html#cb242-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&#39;mm&#39;</span>),</span>
<span id="cb242-14"><a href="rsa-on-pattern-similarity-change.html#cb242-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">3</span>,<span class="st">&quot;mm&quot;</span>),                                                                       </span>
<span id="cb242-15"><a href="rsa-on-pattern-similarity-change.html#cb242-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>, <span class="at">legend.justification =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb242-16"><a href="rsa-on-pattern-similarity-change.html#cb242-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>))} <span class="sc">+</span></span>
<span id="cb242-17"><a href="rsa-on-pattern-similarity-change.html#cb242-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layoutABD, <span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb242-18"><a href="rsa-on-pattern-similarity-change.html#cb242-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">19</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb242-19"><a href="rsa-on-pattern-similarity-change.html#cb242-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)<span class="sc">&amp;</span></span>
<span id="cb242-20"><a href="rsa-on-pattern-similarity-change.html#cb242-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use))</span>
<span id="cb242-21"><a href="rsa-on-pattern-similarity-change.html#cb242-21" aria-hidden="true" tabindex="-1"></a>f4[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> f4[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb242-22"><a href="rsa-on-pattern-similarity-change.html#cb242-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.1963</span>),</span>
<span id="cb242-23"><a href="rsa-on-pattern-similarity-change.html#cb242-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb242-24"><a href="rsa-on-pattern-similarity-change.html#cb242-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb242-25"><a href="rsa-on-pattern-similarity-change.html#cb242-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">13</span>)))</span>
<span id="cb242-26"><a href="rsa-on-pattern-similarity-change.html#cb242-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-27"><a href="rsa-on-pattern-similarity-change.html#cb242-27" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print</span></span>
<span id="cb242-28"><a href="rsa-on-pattern-similarity-change.html#cb242-28" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;f4&quot;</span>)</span>
<span id="cb242-29"><a href="rsa-on-pattern-similarity-change.html#cb242-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>f4, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb242-30"><a href="rsa-on-pattern-similarity-change.html#cb242-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb242-31"><a href="rsa-on-pattern-similarity-change.html#cb242-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>f4, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb242-32"><a href="rsa-on-pattern-similarity-change.html#cb242-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/f4.png" alt="" />
<p class="caption">Figure 4. Sequence representations in anterior hippocampus reflect constructed event times. A. The anterior hippocampus region of interest is displayed on the MNI template with voxels outside the field of view shown in lighter shades of gray. Color code denotes probability of a voxel to be included in the mask based on participant-specific ROIs (see Methods). B. The Z-values based on permutation tests of participant-specific linear models assessing the effect of virtual time on pattern similarity change for event pairs from the same sequence were significantly positive. C. To illustrate the effect shown in B, average pattern similarity change values are shown for same-sequence event pairs that are separated by low and high temporal distances based on a median split. D. Z-values show the relationship of the different time metrics to representational change based on participant-specific multiple regression analyses. Virtual time predicts pattern similarity change with event order and real time in the model as control predictors of no interest. B-D. Circles are individual participant data; boxplots show median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distributions show probability density function of data points. ** p&lt;0.01; * p&lt;0.05</p>
</div>
</div>
</div>
</div>
<div id="virtual-time-explains-residuals-of-order-and-real-time" class="section level3 unnumbered">
<h3>Virtual time explains residuals of order and real time</h3>
<blockquote>
<p>We implemented participant-specific regression analyses with order and real time distances as predictors of hippocampal pattern similarity change. The plot shows a significant effect of virtual temporal distances when tested on the residuals of these linear models. Thus, variance that cannot be explained by the other time metrics can be accounted for by virtual temporal distances. This analysis was conducted only using the summary statistics approach because the residuals of a mixed model are more difficult to interpret than those of participant-specific regression analyses using ordinary least squares.</p>
</blockquote>
<p>The second way of running this analysis is via a two-step procedure. We first predict pattern similarity change from the ordinal and real-time relationships and store the residuals, i.e. variance in pattern similarity change that cannot be explained by the effects of order and real time. Then, we test in a second model whether virtual time can explain these residuals.</p>
<div id="summary-statistics-6" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<p>The first step here is a multiple linear regression model with order and real time distances as predictors. We do not use permutations here because we are only interested in the residuals of this model. In the second step, we run a linear model with permutations to obtain z-values for group-level stats for the effect of virtual time on the residuals.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="rsa-on-pattern-similarity-change.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">102</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb243-2"><a href="rsa-on-pattern-similarity-change.html#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="rsa-on-pattern-similarity-change.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all comparisons from the same day</span></span>
<span id="cb243-4"><a href="rsa-on-pattern-similarity-change.html#cb243-4" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day_aHPC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb243-5"><a href="rsa-on-pattern-similarity-change.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb243-6"><a href="rsa-on-pattern-similarity-change.html#cb243-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-7"><a href="rsa-on-pattern-similarity-change.html#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run multiple regression model with order and real time as predictors and store residuals</span></span>
<span id="cb243-8"><a href="rsa-on-pattern-similarity-change.html#cb243-8" aria-hidden="true" tabindex="-1"></a>resids <span class="ot">&lt;-</span> rsa_dat_same_day_aHPC <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb243-9"><a href="rsa-on-pattern-similarity-change.html#cb243-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb243-10"><a href="rsa-on-pattern-similarity-change.html#cb243-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">resids =</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(ps_change <span class="sc">~</span> order_diff <span class="sc">+</span> real_time_diff, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span></span>
<span id="cb243-11"><a href="rsa-on-pattern-similarity-change.html#cb243-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(resids) <span class="sc">%&gt;%</span></span>
<span id="cb243-12"><a href="rsa-on-pattern-similarity-change.html#cb243-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(resids)</span>
<span id="cb243-13"><a href="rsa-on-pattern-similarity-change.html#cb243-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb243-14"><a href="rsa-on-pattern-similarity-change.html#cb243-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add to the original data frame</span></span>
<span id="cb243-15"><a href="rsa-on-pattern-similarity-change.html#cb243-15" aria-hidden="true" tabindex="-1"></a>rsa_dat_same_day_aHPC<span class="sc">$</span>resids <span class="ot">&lt;-</span> resids<span class="sc">$</span>resids</span>
<span id="cb243-16"><a href="rsa-on-pattern-similarity-change.html#cb243-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-17"><a href="rsa-on-pattern-similarity-change.html#cb243-17" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit </span></span>
<span id="cb243-18"><a href="rsa-on-pattern-similarity-change.html#cb243-18" aria-hidden="true" tabindex="-1"></a>rsa_fit_aHPC_mult_reg_resids <span class="ot">&lt;-</span> rsa_dat_same_day_aHPC <span class="sc">%&gt;%</span> </span>
<span id="cb243-19"><a href="rsa-on-pattern-similarity-change.html#cb243-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb243-20"><a href="rsa-on-pattern-similarity-change.html#cb243-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb243-21"><a href="rsa-on-pattern-similarity-change.html#cb243-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb243-22"><a href="rsa-on-pattern-similarity-change.html#cb243-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;resids ~ vir_time_diff&quot;</span>,</span>
<span id="cb243-23"><a href="rsa-on-pattern-similarity-change.html#cb243-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb243-24"><a href="rsa-on-pattern-similarity-change.html#cb243-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb243-25"><a href="rsa-on-pattern-similarity-change.html#cb243-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(z)</span>
<span id="cb243-26"><a href="rsa-on-pattern-similarity-change.html#cb243-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-27"><a href="rsa-on-pattern-similarity-change.html#cb243-27" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb243-28"><a href="rsa-on-pattern-similarity-change.html#cb243-28" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg_resids <span class="sc">%&gt;%</span> </span>
<span id="cb243-29"><a href="rsa-on-pattern-similarity-change.html#cb243-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span></span>
<span id="cb243-30"><a href="rsa-on-pattern-similarity-change.html#cb243-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb243-31"><a href="rsa-on-pattern-similarity-change.html#cb243-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-32"><a href="rsa-on-pattern-similarity-change.html#cb243-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb243-33"><a href="rsa-on-pattern-similarity-change.html#cb243-33" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>rsa_fit_aHPC_mult_reg_resids<span class="sc">$</span>z_virtual_time, </span>
<span id="cb243-34"><a href="rsa-on-pattern-similarity-change.html#cb243-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb243-35"><a href="rsa-on-pattern-similarity-change.html#cb243-35" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb243-36"><a href="rsa-on-pattern-similarity-change.html#cb243-36" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb243-37"><a href="rsa-on-pattern-similarity-change.html#cb243-37" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb243-38"><a href="rsa-on-pattern-similarity-change.html#cb243-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-39"><a href="rsa-on-pattern-similarity-change.html#cb243-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb243-40"><a href="rsa-on-pattern-similarity-change.html#cb243-40" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-150">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.177</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.23</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0345</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0343</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.014</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.341</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.409</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.031</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.819</td></tr>
</table>

<p>Summary Statistics for virtual time on residuals of order and real time:<br />
t<sub>27</sub>=2.23, p=0.034, d=0.41, 95% CI [0.03, 0.82]</p>
<blockquote>
<p>We further observed that the residuals of linear models, in which hippocampal representational change was predicted from order and real time, were related to virtual temporal distances (Supplemental Figure 3D; t<sub>27</sub>=2.23, p=0.034, d=0.41, 95% CI [0.03, 0.82]
), demonstrating that virtual time accounts for variance that the other time metrics fail to explain.</p>
</blockquote>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="rsa-on-pattern-similarity-change.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data to plot</span></span>
<span id="cb244-2"><a href="rsa-on-pattern-similarity-change.html#cb244-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg_resids</span>
<span id="cb244-3"><a href="rsa-on-pattern-similarity-change.html#cb244-3" aria-hidden="true" tabindex="-1"></a>plot_dat<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span>)</span>
<span id="cb244-4"><a href="rsa-on-pattern-similarity-change.html#cb244-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-5"><a href="rsa-on-pattern-similarity-change.html#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud</span></span>
<span id="cb244-6"><a href="rsa-on-pattern-similarity-change.html#cb244-6" aria-hidden="true" tabindex="-1"></a>sfigd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>z_virtual_time, <span class="at">color =</span> group, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb244-7"><a href="rsa-on-pattern-similarity-change.html#cb244-7" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb244-8"><a href="rsa-on-pattern-similarity-change.html#cb244-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb244-9"><a href="rsa-on-pattern-similarity-change.html#cb244-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> z_virtual_time), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb244-10"><a href="rsa-on-pattern-similarity-change.html#cb244-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb244-11"><a href="rsa-on-pattern-similarity-change.html#cb244-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb244-12"><a href="rsa-on-pattern-similarity-change.html#cb244-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb244-13"><a href="rsa-on-pattern-similarity-change.html#cb244-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb244-14"><a href="rsa-on-pattern-similarity-change.html#cb244-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb244-15"><a href="rsa-on-pattern-similarity-change.html#cb244-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb244-16"><a href="rsa-on-pattern-similarity-change.html#cb244-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb244-17"><a href="rsa-on-pattern-similarity-change.html#cb244-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb244-18"><a href="rsa-on-pattern-similarity-change.html#cb244-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb244-19"><a href="rsa-on-pattern-similarity-change.html#cb244-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb244-20"><a href="rsa-on-pattern-similarity-change.html#cb244-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb244-21"><a href="rsa-on-pattern-similarity-change.html#cb244-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb244-22"><a href="rsa-on-pattern-similarity-change.html#cb244-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb244-23"><a href="rsa-on-pattern-similarity-change.html#cb244-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb244-24"><a href="rsa-on-pattern-similarity-change.html#cb244-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb244-25"><a href="rsa-on-pattern-similarity-change.html#cb244-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb244-26"><a href="rsa-on-pattern-similarity-change.html#cb244-26" aria-hidden="true" tabindex="-1"></a>sfigd</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
</div>
<div id="supplemental-figure" class="section level4 unnumbered">
<h4>Supplemental Figure</h4>
<p>Let’s compose a figure from the above plots to summarize these results of the control analyses for the same-sequence effects.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="rsa-on-pattern-similarity-change.html#cb245-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb245-2"><a href="rsa-on-pattern-similarity-change.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="st">AAAABDD</span></span>
<span id="cb245-3"><a href="rsa-on-pattern-similarity-change.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACDD&quot;</span></span>
<span id="cb245-4"><a href="rsa-on-pattern-similarity-change.html#cb245-4" aria-hidden="true" tabindex="-1"></a>sfig <span class="ot">&lt;-</span> sfiga <span class="sc">+</span> sfigb <span class="sc">+</span> sfigc <span class="sc">+</span> sfigd <span class="sc">+</span></span>
<span id="cb245-5"><a href="rsa-on-pattern-similarity-change.html#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&#39;collect&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb245-6"><a href="rsa-on-pattern-similarity-change.html#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb245-7"><a href="rsa-on-pattern-similarity-change.html#cb245-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb245-8"><a href="rsa-on-pattern-similarity-change.html#cb245-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb245-9"><a href="rsa-on-pattern-similarity-change.html#cb245-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">r=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">b=</span><span class="sc">-</span><span class="dv">7</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb245-10"><a href="rsa-on-pattern-similarity-change.html#cb245-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb245-11"><a href="rsa-on-pattern-similarity-change.html#cb245-11" aria-hidden="true" tabindex="-1"></a>sfig[[<span class="dv">4</span>]] <span class="ot">&lt;-</span> sfig[[<span class="dv">4</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb245-12"><a href="rsa-on-pattern-similarity-change.html#cb245-12" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print to screen</span></span>
<span id="cb245-13"><a href="rsa-on-pattern-similarity-change.html#cb245-13" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf05&quot;</span>)</span>
<span id="cb245-14"><a href="rsa-on-pattern-similarity-change.html#cb245-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb245-15"><a href="rsa-on-pattern-similarity-change.html#cb245-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb245-16"><a href="rsa-on-pattern-similarity-change.html#cb245-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb245-17"><a href="rsa-on-pattern-similarity-change.html#cb245-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf05.png" alt="" />
<p class="caption">Supplemental Figure 5. The relationship of virtual time and hippocampal pattern similarity change is not driven by the first and last event of a sequence. A. Z-values from the summary statistics approach show a significant positive effect of virtual time on pattern similarity change in the anterior hippcampus when competing for variance with a control predictor of no interest accounting for variance explained by whether pairs of events were made up from the first and last event of a sequence or not. B, C. Fixed effect estimate with confidence intervals (B) and estimated marginal means (C) visualize the results of the corresponding mixed model. D. We implemented participant-specific regression analyses with order and real time distances as predictors of hippocampal pattern similarity change. The plot shows a significant effect of virtual temporal distances when tested on the residuals of these linear models. Thus, variance that cannot be explained by the other time metrics can be accounted for by virtual temporal distances. This analysis was conducted only using the summary statistics approach because the residuals of a mixed model are more difficult to interpret than those of participant-specific regression analyses using ordinary least squares. A, D. Circles show individual participant Z-values from the summary statistics approach; boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points. * p&lt;0.05</p>
</div>
</div>
</div>
</div>
<div id="ahpc-virtual-time-across-sequences" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> aHPC: virtual time across sequences</h2>
<p>Having established that the anterior hippocampus forms sequence memories shaped by event relations in virtual time, we want to ask whether the hippocampus also generalizes across sequences. So next, we focus on pattern similarity changes for events that stem from different virtual days.</p>
<blockquote>
<p>We separately tested the effect of virtual time for event pairs from the same or different sequences and thus use a Bonferroni-corrected α-level of 0.025 for these tests.</p>
</blockquote>
<div id="summary-statistics-7" class="section level3 unnumbered">
<h3>Summary statistics</h3>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="rsa-on-pattern-similarity-change.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">103</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb246-2"><a href="rsa-on-pattern-similarity-change.html#cb246-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-3"><a href="rsa-on-pattern-similarity-change.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in aHPC for across-day</span></span>
<span id="cb246-4"><a href="rsa-on-pattern-similarity-change.html#cb246-4" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb246-5"><a href="rsa-on-pattern-similarity-change.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb246-6"><a href="rsa-on-pattern-similarity-change.html#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb246-7"><a href="rsa-on-pattern-similarity-change.html#cb246-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb246-8"><a href="rsa-on-pattern-similarity-change.html#cb246-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-9"><a href="rsa-on-pattern-similarity-change.html#cb246-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb246-10"><a href="rsa-on-pattern-similarity-change.html#cb246-10" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>))<span class="sc">$</span>z_virtual_time, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb246-11"><a href="rsa-on-pattern-similarity-change.html#cb246-11" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb246-12"><a href="rsa-on-pattern-similarity-change.html#cb246-12" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb246-13"><a href="rsa-on-pattern-similarity-change.html#cb246-13" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb246-14"><a href="rsa-on-pattern-similarity-change.html#cb246-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-15"><a href="rsa-on-pattern-similarity-change.html#cb246-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb246-16"><a href="rsa-on-pattern-similarity-change.html#cb246-16" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-153">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.65</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0133</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0128</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.887</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.113</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.486</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.906</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.105</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time across sequences in aHPC<br />
t<sub>27</sub>=-2.65, p=0.013, d=-0.49, 95% CI [-0.91, -0.10]</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="rsa-on-pattern-similarity-change.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data to plot</span></span>
<span id="cb247-2"><a href="rsa-on-pattern-similarity-change.html#cb247-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>) </span>
<span id="cb247-3"><a href="rsa-on-pattern-similarity-change.html#cb247-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-4"><a href="rsa-on-pattern-similarity-change.html#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>z_virtual_time, <span class="at">fill =</span> roi, <span class="at">color =</span> roi)) <span class="sc">+</span></span>
<span id="cb247-5"><a href="rsa-on-pattern-similarity-change.html#cb247-5" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb247-6"><a href="rsa-on-pattern-similarity-change.html#cb247-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb247-7"><a href="rsa-on-pattern-similarity-change.html#cb247-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> z_virtual_time), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb247-8"><a href="rsa-on-pattern-similarity-change.html#cb247-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb247-9"><a href="rsa-on-pattern-similarity-change.html#cb247-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb247-10"><a href="rsa-on-pattern-similarity-change.html#cb247-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb247-11"><a href="rsa-on-pattern-similarity-change.html#cb247-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb247-12"><a href="rsa-on-pattern-similarity-change.html#cb247-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb247-13"><a href="rsa-on-pattern-similarity-change.html#cb247-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb247-14"><a href="rsa-on-pattern-similarity-change.html#cb247-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb247-15"><a href="rsa-on-pattern-similarity-change.html#cb247-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb247-16"><a href="rsa-on-pattern-similarity-change.html#cb247-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb247-17"><a href="rsa-on-pattern-similarity-change.html#cb247-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb247-18"><a href="rsa-on-pattern-similarity-change.html#cb247-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb247-19"><a href="rsa-on-pattern-similarity-change.html#cb247-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb247-20"><a href="rsa-on-pattern-similarity-change.html#cb247-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb247-21"><a href="rsa-on-pattern-similarity-change.html#cb247-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb247-22"><a href="rsa-on-pattern-similarity-change.html#cb247-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb247-23"><a href="rsa-on-pattern-similarity-change.html#cb247-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb247-24"><a href="rsa-on-pattern-similarity-change.html#cb247-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/RSA%20aHPC%20raincloud%20plot%20of%20virtual%20time%20across%20days-1.png" width="672" /></p>
</div>
<div id="linear-mixed-effects-5" class="section level3 unnumbered">
<h3>Linear Mixed Effects</h3>
<p>Here, we fit a model with virtual time as the predictor for pattern similarity change for the across-day comparisons in the anterior hippocampus.</p>
<p>We start with a full random effects structure including random slopes and random intercepts for each subject. We reduce the random effects structure, but unfortunately even a simple model with only random slopes for the effect of virtual time results in a singular fit warning; even when trying different optimizers. We keep the random slopes to account for the within-subject dependencies in the data.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="rsa-on-pattern-similarity-change.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from different days</span></span>
<span id="cb248-2"><a href="rsa-on-pattern-similarity-change.html#cb248-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_diff_day <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb248-3"><a href="rsa-on-pattern-similarity-change.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb248-4"><a href="rsa-on-pattern-similarity-change.html#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="rsa-on-pattern-similarity-change.html#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference as </span></span>
<span id="cb248-6"><a href="rsa-on-pattern-similarity-change.html#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effect and by-subject random slopes and random intercepts --&gt; singular fit</span></span>
<span id="cb248-7"><a href="rsa-on-pattern-similarity-change.html#cb248-7" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb248-8"><a href="rsa-on-pattern-similarity-change.html#cb248-8" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="rsa-on-pattern-similarity-change.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove correlation --&gt; still singular</span></span>
<span id="cb250-2"><a href="rsa-on-pattern-similarity-change.html#cb250-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff || sub_id)&quot;</span></span>
<span id="cb250-3"><a href="rsa-on-pattern-similarity-change.html#cb250-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="rsa-on-pattern-similarity-change.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only random slopes</span></span>
<span id="cb252-2"><a href="rsa-on-pattern-similarity-change.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">389</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb252-3"><a href="rsa-on-pattern-similarity-change.html#cb252-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb252-4"><a href="rsa-on-pattern-similarity-change.html#cb252-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>,</span>
<span id="cb252-5"><a href="rsa-on-pattern-similarity-change.html#cb252-5" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#control = lmerControl(optimizer =&#39;optimx&#39;, optCtrl=list(method=&#39;nlminb&#39;))</span></span>
<span id="cb252-6"><a href="rsa-on-pattern-similarity-change.html#cb252-6" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#control = lmerControl(optimizer =&quot;bobyqa&quot;, optCtrl=list(maxfun=40000))</span></span>
<span id="cb252-7"><a href="rsa-on-pattern-similarity-change.html#cb252-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span><span class="st">&#39;nloptwrap&#39;</span>, </span>
<span id="cb252-8"><a href="rsa-on-pattern-similarity-change.html#cb252-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">method=</span><span class="st">&#39;NLOPT_LN_NELDERMEAD&#39;</span>, <span class="at">maxfun=</span><span class="dv">100000</span>))</span>
<span id="cb252-9"><a href="rsa-on-pattern-similarity-change.html#cb252-9" aria-hidden="true" tabindex="-1"></a>                       )</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="rsa-on-pattern-similarity-change.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + (0 + vir_time_diff | sub_id)
##    Data: rsa_dat_diff_day
## Control: lmerControl(optimizer = &quot;nloptwrap&quot;, optCtrl = list(method = &quot;NLOPT_LN_NELDERMEAD&quot;,      maxfun = 1e+05))
## 
##      AIC      BIC   logLik deviance df.resid 
## -29625.4 -29600.0  14816.7 -29633.4     4196 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.3020 -0.6877  0.0324  0.6564  3.5548 
## 
## Random effects:
##  Groups   Name          Variance Std.Dev.
##  sub_id   vir_time_diff 0.00e+00 0.000000
##  Residual               5.05e-05 0.007107
## Number of obs: 4200, groups:  sub_id, 28
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)   -6.075e-05  1.098e-04  -0.553
## vir_time_diff -2.745e-04  1.096e-04  -2.505
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="rsa-on-pattern-similarity-change.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb256-2"><a href="rsa-on-pattern-similarity-change.html#cb256-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, </span>
<span id="cb256-3"><a href="rsa-on-pattern-similarity-change.html#cb256-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>,</span>
<span id="cb256-4"><a href="rsa-on-pattern-similarity-change.html#cb256-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">optimizer =</span> <span class="st">&#39;nloptwrap&#39;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="rsa-on-pattern-similarity-change.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb258-2"><a href="rsa-on-pattern-similarity-change.html#cb258-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb258-3"><a href="rsa-on-pattern-similarity-change.html#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="rsa-on-pattern-similarity-change.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one way of testing for significance is by comparing the likelihood against a simpler model.</span></span>
<span id="cb258-5"><a href="rsa-on-pattern-similarity-change.html#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time difference and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb258-6"><a href="rsa-on-pattern-similarity-change.html#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">328</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb258-7"><a href="rsa-on-pattern-similarity-change.html#cb258-7" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ 1 + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb258-8"><a href="rsa-on-pattern-similarity-change.html#cb258-8" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb258-9"><a href="rsa-on-pattern-similarity-change.html#cb258-9" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span><span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span></code></pre></div>
<p>Mixed Model: Fixed effect of virtual time across sequences on aHPC pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=6.01, p=0.014</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="rsa-on-pattern-similarity-change.html#cb259-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>)</span>
<span id="cb259-2"><a href="rsa-on-pattern-similarity-change.html#cb259-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb259-3"><a href="rsa-on-pattern-similarity-change.html#cb259-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb259-4"><a href="rsa-on-pattern-similarity-change.html#cb259-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-5"><a href="rsa-on-pattern-similarity-change.html#cb259-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb259-6"><a href="rsa-on-pattern-similarity-change.html#cb259-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb259-7"><a href="rsa-on-pattern-similarity-change.html#cb259-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb259-8"><a href="rsa-on-pattern-similarity-change.html#cb259-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb259-9"><a href="rsa-on-pattern-similarity-change.html#cb259-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb259-10"><a href="rsa-on-pattern-similarity-change.html#cb259-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb259-11"><a href="rsa-on-pattern-similarity-change.html#cb259-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb259-12"><a href="rsa-on-pattern-similarity-change.html#cb259-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb259-13"><a href="rsa-on-pattern-similarity-change.html#cb259-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change for different-sequence events in the anterior hippocampus&quot;</span>)</span>
<span id="cb259-14"><a href="rsa-on-pattern-similarity-change.html#cb259-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-15"><a href="rsa-on-pattern-similarity-change.html#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb259-16"><a href="rsa-on-pattern-similarity-change.html#cb259-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_diff_seq <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb259-17"><a href="rsa-on-pattern-similarity-change.html#cb259-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-18"><a href="rsa-on-pattern-similarity-change.html#cb259-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb259-19"><a href="rsa-on-pattern-similarity-change.html#cb259-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-155">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change for different-sequence events in the anterior hippocampus</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000061</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000110</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.55</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000276</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000155</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000275</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000110</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.51</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000491</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.000058</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.007107</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">3</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29621.39</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14813.69</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">4</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29625.40</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14816.70</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.01</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.014</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+(0+vir_time_diff|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="rsa-on-pattern-similarity-change.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="do">### PLOTS</span></span>
<span id="cb260-2"><a href="rsa-on-pattern-similarity-change.html#cb260-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb260-3"><a href="rsa-on-pattern-similarity-change.html#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term))</span>
<span id="cb260-4"><a href="rsa-on-pattern-similarity-change.html#cb260-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-5"><a href="rsa-on-pattern-similarity-change.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb260-6"><a href="rsa-on-pattern-similarity-change.html#cb260-6" aria-hidden="true" tabindex="-1"></a>sfigmm_g <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb260-7"><a href="rsa-on-pattern-similarity-change.html#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb260-8"><a href="rsa-on-pattern-similarity-change.html#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb260-9"><a href="rsa-on-pattern-similarity-change.html#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb260-10"><a href="rsa-on-pattern-similarity-change.html#cb260-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb260-11"><a href="rsa-on-pattern-similarity-change.html#cb260-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (diff. seq.)&quot;</span>), <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb260-12"><a href="rsa-on-pattern-similarity-change.html#cb260-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb260-13"><a href="rsa-on-pattern-similarity-change.html#cb260-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb260-14"><a href="rsa-on-pattern-similarity-change.html#cb260-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb260-15"><a href="rsa-on-pattern-similarity-change.html#cb260-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb260-16"><a href="rsa-on-pattern-similarity-change.html#cb260-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb260-17"><a href="rsa-on-pattern-similarity-change.html#cb260-17" aria-hidden="true" tabindex="-1"></a>sfigmm_g</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="rsa-on-pattern-similarity-change.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb261-2"><a href="rsa-on-pattern-similarity-change.html#cb261-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb261-3"><a href="rsa-on-pattern-similarity-change.html#cb261-3" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">get_complete_df</span>()</span>
<span id="cb261-4"><a href="rsa-on-pattern-similarity-change.html#cb261-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-5"><a href="rsa-on-pattern-similarity-change.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb261-6"><a href="rsa-on-pattern-similarity-change.html#cb261-6" aria-hidden="true" tabindex="-1"></a>sfigmm_h <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm[lmm_full_emm<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;vir_time_diff&quot;</span>,], <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb261-7"><a href="rsa-on-pattern-similarity-change.html#cb261-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb261-8"><a href="rsa-on-pattern-similarity-change.html#cb261-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb261-9"><a href="rsa-on-pattern-similarity-change.html#cb261-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), </span>
<span id="cb261-10"><a href="rsa-on-pattern-similarity-change.html#cb261-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="fu">element_blank</span>(), <span class="at">labels =</span> <span class="st">&quot;virtual time&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-11"><a href="rsa-on-pattern-similarity-change.html#cb261-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb261-12"><a href="rsa-on-pattern-similarity-change.html#cb261-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb261-13"><a href="rsa-on-pattern-similarity-change.html#cb261-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z time metric&#39;</span>) <span class="sc">+</span></span>
<span id="cb261-14"><a href="rsa-on-pattern-similarity-change.html#cb261-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(&quot;Estimated marginal means&quot;) + </span></span>
<span id="cb261-15"><a href="rsa-on-pattern-similarity-change.html#cb261-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-16"><a href="rsa-on-pattern-similarity-change.html#cb261-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb261-17"><a href="rsa-on-pattern-similarity-change.html#cb261-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb261-18"><a href="rsa-on-pattern-similarity-change.html#cb261-18" aria-hidden="true" tabindex="-1"></a>sfigmm_h</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-156-2.png" width="672" /></p>
<div id="lme-model-assumptions-4" class="section level4 unnumbered">
<h4>LME model assumptions</h4>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="rsa-on-pattern-similarity-change.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmm_diagplots_jb</span>(lmm_full)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
</div>
<div id="representational-change-visualization-1" class="section level3 unnumbered">
<h3>Representational Change Visualization</h3>
<p>To illustrate the effect in a simpler way, we average pattern similarity changes based on a median split of events, separately for events from the same and from different sequences.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="rsa-on-pattern-similarity-change.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test pattern similarity for different-sequence events separated by high vs. low temporal distances</span></span>
<span id="cb263-2"><a href="rsa-on-pattern-similarity-change.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">209</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb263-3"><a href="rsa-on-pattern-similarity-change.html#cb263-3" aria-hidden="true" tabindex="-1"></a>stats_diff_day_high_low <span class="ot">&lt;-</span> <span class="fu">paired_t_perm_jb</span>(ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;different day&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb263-4"><a href="rsa-on-pattern-similarity-change.html#cb263-4" aria-hidden="true" tabindex="-1"></a>                                                              ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>,]<span class="sc">$</span>ps_change <span class="sc">-</span></span>
<span id="cb263-5"><a href="rsa-on-pattern-similarity-change.html#cb263-5" aria-hidden="true" tabindex="-1"></a>                            ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;different day&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb263-6"><a href="rsa-on-pattern-similarity-change.html#cb263-6" aria-hidden="true" tabindex="-1"></a>                                              ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>,]<span class="sc">$</span>ps_change)</span>
<span id="cb263-7"><a href="rsa-on-pattern-similarity-change.html#cb263-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-8"><a href="rsa-on-pattern-similarity-change.html#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for paired samples using non-central t-distribution for CI</span></span>
<span id="cb263-9"><a href="rsa-on-pattern-similarity-change.html#cb263-9" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;different day&quot;</span> <span class="sc">&amp;</span> ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>,]<span class="sc">$</span>ps_change, </span>
<span id="cb263-10"><a href="rsa-on-pattern-similarity-change.html#cb263-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span>ps_change_means[ps_change_means<span class="sc">$</span>same_day<span class="sc">==</span><span class="st">&quot;different day&quot;</span> <span class="sc">&amp;</span> ps_change_means<span class="sc">$</span>temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>,]<span class="sc">$</span>ps_change, </span>
<span id="cb263-11"><a href="rsa-on-pattern-similarity-change.html#cb263-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">pooled=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb263-12"><a href="rsa-on-pattern-similarity-change.html#cb263-12" aria-hidden="true" tabindex="-1"></a>stats_diff_day_high_low<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb263-13"><a href="rsa-on-pattern-similarity-change.html#cb263-13" aria-hidden="true" tabindex="-1"></a>stats_diff_day_high_low<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb263-14"><a href="rsa-on-pattern-similarity-change.html#cb263-14" aria-hidden="true" tabindex="-1"></a>stats_diff_day_high_low<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb263-15"><a href="rsa-on-pattern-similarity-change.html#cb263-15" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats_diff_day_high_low) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-158">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.000711</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.26</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00304</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0025</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.00116</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000263</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.89</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.209</td></tr>
</table>

<p>To visualize the effect, lets make a plot of the raw pattern similarity change for high vs. low temporal distances.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="rsa-on-pattern-similarity-change.html#cb264-1" aria-hidden="true" tabindex="-1"></a>f5b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="st">&quot;different day&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change, <span class="at">fill =</span> same_day, <span class="at">color =</span> same_day)) <span class="sc">+</span></span>
<span id="cb264-2"><a href="rsa-on-pattern-similarity-change.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="st">&quot;different day&quot;</span>, temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>), </span>
<span id="cb264-3"><a href="rsa-on-pattern-similarity-change.html#cb264-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change),</span>
<span id="cb264-4"><a href="rsa-on-pattern-similarity-change.html#cb264-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb264-5"><a href="rsa-on-pattern-similarity-change.html#cb264-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb264-6"><a href="rsa-on-pattern-similarity-change.html#cb264-6" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="st">&quot;different day&quot;</span>, temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>), </span>
<span id="cb264-7"><a href="rsa-on-pattern-similarity-change.html#cb264-7" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change),</span>
<span id="cb264-8"><a href="rsa-on-pattern-similarity-change.html#cb264-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb264-9"><a href="rsa-on-pattern-similarity-change.html#cb264-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb264-10"><a href="rsa-on-pattern-similarity-change.html#cb264-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group =</span> temp_dist),<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb264-11"><a href="rsa-on-pattern-similarity-change.html#cb264-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>sub_id,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb264-12"><a href="rsa-on-pattern-similarity-change.html#cb264-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb264-13"><a href="rsa-on-pattern-similarity-change.html#cb264-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>)),</span>
<span id="cb264-14"><a href="rsa-on-pattern-similarity-change.html#cb264-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-15"><a href="rsa-on-pattern-similarity-change.html#cb264-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb264-16"><a href="rsa-on-pattern-similarity-change.html#cb264-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb264-17"><a href="rsa-on-pattern-similarity-change.html#cb264-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb264-18"><a href="rsa-on-pattern-similarity-change.html#cb264-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb264-19"><a href="rsa-on-pattern-similarity-change.html#cb264-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb264-20"><a href="rsa-on-pattern-similarity-change.html#cb264-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), <span class="at">name =</span> <span class="st">&quot;different sequence&quot;</span>, <span class="at">labels =</span> <span class="st">&quot;virtual time&quot;</span>) <span class="sc">+</span></span>
<span id="cb264-21"><a href="rsa-on-pattern-similarity-change.html#cb264-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb264-22"><a href="rsa-on-pattern-similarity-change.html#cb264-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;underline(&quot;    **    &quot;)&#39;</span>, </span>
<span id="cb264-23"><a href="rsa-on-pattern-similarity-change.html#cb264-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb264-24"><a href="rsa-on-pattern-similarity-change.html#cb264-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;pattern similarity change&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;virtual temporal distance&#39;</span>) <span class="sc">+</span></span>
<span id="cb264-25"><a href="rsa-on-pattern-similarity-change.html#cb264-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>), <span class="at">title.position =</span> <span class="st">&quot;left&quot;</span>)) <span class="sc">+</span></span>
<span id="cb264-26"><a href="rsa-on-pattern-similarity-change.html#cb264-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb264-27"><a href="rsa-on-pattern-similarity-change.html#cb264-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb264-28"><a href="rsa-on-pattern-similarity-change.html#cb264-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb264-29"><a href="rsa-on-pattern-similarity-change.html#cb264-29" aria-hidden="true" tabindex="-1"></a>f5b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="rsa-on-pattern-similarity-change.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb265-2"><a href="rsa-on-pattern-similarity-change.html#cb265-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f5b)<span class="sc">$</span>data[[<span class="dv">4</span>]]</span>
<span id="cb265-3"><a href="rsa-on-pattern-similarity-change.html#cb265-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y, group), </span>
<span id="cb265-4"><a href="rsa-on-pattern-similarity-change.html#cb265-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f5b.txt&quot;</span>))</span></code></pre></div>
<p>Summary Statistics: paired t-test for aHPC pattern similarity changes for high vs. low temporal distances for different sequence events
t<sub>27</sub>=-3.26, p=0.002, d=-0.89, 95% CI [-1.03, -0.21]</p>
</div>
</div>
<div id="ahpc-virtual-time-across-sequence-when-including-order-real-time" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> aHPC: virtual time across sequence when including order &amp; real time</h2>
<p>We also test whether virtual time predicts aHPC pattern similarity changes for event pairs from different sequences when including order and real time in the model</p>
<div id="summary-statistics-8" class="section level3 unnumbered">
<h3>Summary Statistics</h3>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="rsa-on-pattern-similarity-change.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SUMMARY STATS AHPC WITH ORDER AND REAL TIME</span></span>
<span id="cb266-2"><a href="rsa-on-pattern-similarity-change.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">59</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb266-3"><a href="rsa-on-pattern-similarity-change.html#cb266-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-4"><a href="rsa-on-pattern-similarity-change.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all comparisons from the same day</span></span>
<span id="cb266-5"><a href="rsa-on-pattern-similarity-change.html#cb266-5" aria-hidden="true" tabindex="-1"></a>rsa_dat_diff_day_aHPC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb266-6"><a href="rsa-on-pattern-similarity-change.html#cb266-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-7"><a href="rsa-on-pattern-similarity-change.html#cb266-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-8"><a href="rsa-on-pattern-similarity-change.html#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb266-9"><a href="rsa-on-pattern-similarity-change.html#cb266-9" aria-hidden="true" tabindex="-1"></a>rsa_fit_aHPC_mult_reg <span class="ot">&lt;-</span> rsa_dat_diff_day_aHPC <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb266-10"><a href="rsa-on-pattern-similarity-change.html#cb266-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb266-11"><a href="rsa-on-pattern-similarity-change.html#cb266-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb266-12"><a href="rsa-on-pattern-similarity-change.html#cb266-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff&quot;</span>,</span>
<span id="cb266-13"><a href="rsa-on-pattern-similarity-change.html#cb266-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb266-14"><a href="rsa-on-pattern-similarity-change.html#cb266-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb266-15"><a href="rsa-on-pattern-similarity-change.html#cb266-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb266-16"><a href="rsa-on-pattern-similarity-change.html#cb266-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>)</span>
<span id="cb266-17"><a href="rsa-on-pattern-similarity-change.html#cb266-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-18"><a href="rsa-on-pattern-similarity-change.html#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb266-19"><a href="rsa-on-pattern-similarity-change.html#cb266-19" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> </span>
<span id="cb266-20"><a href="rsa-on-pattern-similarity-change.html#cb266-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb266-21"><a href="rsa-on-pattern-similarity-change.html#cb266-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb266-22"><a href="rsa-on-pattern-similarity-change.html#cb266-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb266-23"><a href="rsa-on-pattern-similarity-change.html#cb266-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-24"><a href="rsa-on-pattern-similarity-change.html#cb266-24" aria-hidden="true" tabindex="-1"></a><span class="co"># find outliers </span></span>
<span id="cb266-25"><a href="rsa-on-pattern-similarity-change.html#cb266-25" aria-hidden="true" tabindex="-1"></a>is_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb266-26"><a href="rsa-on-pattern-similarity-change.html#cb266-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">&lt;</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>) <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(x) <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(x))</span>
<span id="cb266-27"><a href="rsa-on-pattern-similarity-change.html#cb266-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb266-28"><a href="rsa-on-pattern-similarity-change.html#cb266-28" aria-hidden="true" tabindex="-1"></a>out_ind <span class="ot">&lt;-</span> <span class="fu">is_outlier</span>(rsa_fit_aHPC_mult_reg<span class="sc">$</span>z[rsa_fit_aHPC_mult_reg<span class="sc">$</span>z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>])</span>
<span id="cb266-29"><a href="rsa-on-pattern-similarity-change.html#cb266-29" aria-hidden="true" tabindex="-1"></a>out_sub <span class="ot">&lt;-</span> subjects[out_ind]</span>
<span id="cb266-30"><a href="rsa-on-pattern-similarity-change.html#cb266-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-31"><a href="rsa-on-pattern-similarity-change.html#cb266-31" aria-hidden="true" tabindex="-1"></a><span class="co"># run second-level analysis on data points that are not outliers</span></span>
<span id="cb266-32"><a href="rsa-on-pattern-similarity-change.html#cb266-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb266-33"><a href="rsa-on-pattern-similarity-change.html#cb266-33" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> </span>
<span id="cb266-34"><a href="rsa-on-pattern-similarity-change.html#cb266-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_id <span class="sc">!=</span> out_sub, z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb266-35"><a href="rsa-on-pattern-similarity-change.html#cb266-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;z&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb266-36"><a href="rsa-on-pattern-similarity-change.html#cb266-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span>(., <span class="at">n_perm =</span> n_perm) </span>
<span id="cb266-37"><a href="rsa-on-pattern-similarity-change.html#cb266-37" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-160">
<col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">alternative</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.418</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.62</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0146</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0155</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">26</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.746</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0897</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">two.sided</td></tr>
</table>

<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="rsa-on-pattern-similarity-change.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb267-2"><a href="rsa-on-pattern-similarity-change.html#cb267-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>, sub_id <span class="sc">!=</span> out_sub))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb267-3"><a href="rsa-on-pattern-similarity-change.html#cb267-3" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb267-4"><a href="rsa-on-pattern-similarity-change.html#cb267-4" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb267-5"><a href="rsa-on-pattern-similarity-change.html#cb267-5" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb267-6"><a href="rsa-on-pattern-similarity-change.html#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="rsa-on-pattern-similarity-change.html#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb267-8"><a href="rsa-on-pattern-similarity-change.html#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-160">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.418</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.62</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0146</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0155</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">26</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.746</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0897</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.489</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.918</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.1</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time across sequences in aHPC with order and real time in the model<br />
t<sub>26</sub>=-2.62, p=0.015, d=-0.49, 95% CI [-0.92, -0.10]</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="rsa-on-pattern-similarity-change.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make z_id a factor and reorder it</span></span>
<span id="cb268-2"><a href="rsa-on-pattern-similarity-change.html#cb268-2" aria-hidden="true" tabindex="-1"></a>rsa_fit_aHPC_mult_reg <span class="ot">&lt;-</span> rsa_fit_aHPC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb268-3"><a href="rsa-on-pattern-similarity-change.html#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">z_id =</span> <span class="fu">factor</span>(z_id, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))</span>
<span id="cb268-4"><a href="rsa-on-pattern-similarity-change.html#cb268-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-5"><a href="rsa-on-pattern-similarity-change.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb268-6"><a href="rsa-on-pattern-similarity-change.html#cb268-6" aria-hidden="true" tabindex="-1"></a>sfig6_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rsa_fit_aHPC_mult_reg, <span class="fu">aes</span>(<span class="at">x=</span>z_id, <span class="at">y=</span>z, <span class="at">fill =</span> z_id, <span class="at">colour =</span> z_id)) <span class="sc">+</span></span>
<span id="cb268-7"><a href="rsa-on-pattern-similarity-change.html#cb268-7" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb268-8"><a href="rsa-on-pattern-similarity-change.html#cb268-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb268-9"><a href="rsa-on-pattern-similarity-change.html#cb268-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(z_id)<span class="sc">-</span><span class="fl">0.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb268-10"><a href="rsa-on-pattern-similarity-change.html#cb268-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb268-11"><a href="rsa-on-pattern-similarity-change.html#cb268-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb268-12"><a href="rsa-on-pattern-similarity-change.html#cb268-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb268-13"><a href="rsa-on-pattern-similarity-change.html#cb268-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb268-14"><a href="rsa-on-pattern-similarity-change.html#cb268-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb268-15"><a href="rsa-on-pattern-similarity-change.html#cb268-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb268-16"><a href="rsa-on-pattern-similarity-change.html#cb268-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb268-17"><a href="rsa-on-pattern-similarity-change.html#cb268-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb268-18"><a href="rsa-on-pattern-similarity-change.html#cb268-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;time metric&#39;</span>) <span class="sc">+</span> </span>
<span id="cb268-19"><a href="rsa-on-pattern-similarity-change.html#cb268-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb268-20"><a href="rsa-on-pattern-similarity-change.html#cb268-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">name =</span> <span class="st">&quot;time metric&quot;</span>,</span>
<span id="cb268-21"><a href="rsa-on-pattern-similarity-change.html#cb268-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real&quot;</span>)) <span class="sc">+</span></span>
<span id="cb268-22"><a href="rsa-on-pattern-similarity-change.html#cb268-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])) <span class="sc">+</span></span>
<span id="cb268-23"><a href="rsa-on-pattern-similarity-change.html#cb268-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb268-24"><a href="rsa-on-pattern-similarity-change.html#cb268-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb268-25"><a href="rsa-on-pattern-similarity-change.html#cb268-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb268-26"><a href="rsa-on-pattern-similarity-change.html#cb268-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb268-27"><a href="rsa-on-pattern-similarity-change.html#cb268-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb268-28"><a href="rsa-on-pattern-similarity-change.html#cb268-28" aria-hidden="true" tabindex="-1"></a>sfig6_a</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/RSA%20aHPC%20raincloud%20plot%20of%20time%20metrics%20across%20day-1.png" width="672" /></p>
</div>
<div id="linear-mixed-effects-6" class="section level3 unnumbered">
<h3>Linear Mixed Effects</h3>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="rsa-on-pattern-similarity-change.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MIXED EFFECT AHPC WITH ORDER AND REAL TIME</span></span>
<span id="cb269-2"><a href="rsa-on-pattern-similarity-change.html#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="rsa-on-pattern-similarity-change.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">87</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb269-4"><a href="rsa-on-pattern-similarity-change.html#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="rsa-on-pattern-similarity-change.html#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from different days, exclude outlier</span></span>
<span id="cb269-6"><a href="rsa-on-pattern-similarity-change.html#cb269-6" aria-hidden="true" tabindex="-1"></a>rsa_dat_diff_day <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>, sub_id <span class="sc">!=</span> out_sub)</span>
<span id="cb269-7"><a href="rsa-on-pattern-similarity-change.html#cb269-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-8"><a href="rsa-on-pattern-similarity-change.html#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference, order difference and real time difference as </span></span>
<span id="cb269-9"><a href="rsa-on-pattern-similarity-change.html#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effects and random intercepts and random slopes for all effects</span></span>
<span id="cb269-10"><a href="rsa-on-pattern-similarity-change.html#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="co"># fails to converge and is singular after restart</span></span>
<span id="cb269-11"><a href="rsa-on-pattern-similarity-change.html#cb269-11" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff + order_diff + real_time_diff | sub_id)&quot;</span></span>
<span id="cb269-12"><a href="rsa-on-pattern-similarity-change.html#cb269-12" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="rsa-on-pattern-similarity-change.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lmm_full &lt;- update(lmm_full, start=getME(lmm_full, &quot;theta&quot;))</span></span>
<span id="cb271-2"><a href="rsa-on-pattern-similarity-change.html#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="rsa-on-pattern-similarity-change.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the correlation between random slopes and random intercepts</span></span>
<span id="cb271-4"><a href="rsa-on-pattern-similarity-change.html#cb271-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff + order_diff + real_time_diff || sub_id)&quot;</span></span>
<span id="cb271-5"><a href="rsa-on-pattern-similarity-change.html#cb271-5" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="rsa-on-pattern-similarity-change.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># thus we reduce the random effect structure by excluding random slopes for the fixed effects of no interest</span></span>
<span id="cb273-2"><a href="rsa-on-pattern-similarity-change.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as above this results in a singular fit (the random intercept variance estimated to be 0)</span></span>
<span id="cb273-3"><a href="rsa-on-pattern-similarity-change.html#cb273-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff | sub_id)&quot;</span></span>
<span id="cb273-4"><a href="rsa-on-pattern-similarity-change.html#cb273-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="rsa-on-pattern-similarity-change.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># next step is to remove the correlation between random slopes and random intercepts</span></span>
<span id="cb275-2"><a href="rsa-on-pattern-similarity-change.html#cb275-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff || sub_id)&quot;</span></span>
<span id="cb275-3"><a href="rsa-on-pattern-similarity-change.html#cb275-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="rsa-on-pattern-similarity-change.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we thus reduce further and keep only the random slopes for virtual time differences</span></span>
<span id="cb277-2"><a href="rsa-on-pattern-similarity-change.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="co"># but the model converges with the warning about the singular fit</span></span>
<span id="cb277-3"><a href="rsa-on-pattern-similarity-change.html#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">332</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb277-4"><a href="rsa-on-pattern-similarity-change.html#cb277-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb277-5"><a href="rsa-on-pattern-similarity-change.html#cb277-5" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="rsa-on-pattern-similarity-change.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + order_diff + real_time_diff + (0 +      vir_time_diff | sub_id)
##    Data: rsa_dat_diff_day
## 
##      AIC      BIC   logLik deviance df.resid 
## -28597.1 -28559.3  14304.6 -28609.1     4044 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.2924 -0.6858  0.0382  0.6566  3.6191 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev.
##  sub_id   vir_time_diff 0.000e+00 0.000000
##  Residual               5.008e-05 0.007077
## Number of obs: 4050, groups:  sub_id, 27
## 
## Fixed effects:
##                  Estimate Std. Error t value
## (Intercept)    -0.0001006  0.0001115  -0.902
## vir_time_diff  -0.0006234  0.0002944  -2.118
## order_diff     -0.0003476  0.0004777  -0.728
## real_time_diff  0.0007023  0.0005288   1.328
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="rsa-on-pattern-similarity-change.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb281-2"><a href="rsa-on-pattern-similarity-change.html#cb281-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="rsa-on-pattern-similarity-change.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb283-2"><a href="rsa-on-pattern-similarity-change.html#cb283-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb283-3"><a href="rsa-on-pattern-similarity-change.html#cb283-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-4"><a href="rsa-on-pattern-similarity-change.html#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one way of testing for significance is by comparing the likelihood against a simpler model.</span></span>
<span id="cb283-5"><a href="rsa-on-pattern-similarity-change.html#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time difference and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb283-6"><a href="rsa-on-pattern-similarity-change.html#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb283-7"><a href="rsa-on-pattern-similarity-change.html#cb283-7" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ order_diff + real_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb283-8"><a href="rsa-on-pattern-similarity-change.html#cb283-8" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="rsa-on-pattern-similarity-change.html#cb285-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span>
<span id="cb285-2"><a href="rsa-on-pattern-similarity-change.html#cb285-2" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-161">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.86e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.86e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.43e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.86e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.86e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.86e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.43e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.86e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.48</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0343</td></tr>
</table>

<p>Mixed Model: Fixed effect of virtual time on aHPC across-sequence pattern similarity change with order and real time in model
<span class="math inline">\(\chi^2\)</span>(1)=4.48, p=0.034</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="rsa-on-pattern-similarity-change.html#cb286-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)</span>
<span id="cb286-2"><a href="rsa-on-pattern-similarity-change.html#cb286-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb286-3"><a href="rsa-on-pattern-similarity-change.html#cb286-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb286-4"><a href="rsa-on-pattern-similarity-change.html#cb286-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-5"><a href="rsa-on-pattern-similarity-change.html#cb286-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb286-6"><a href="rsa-on-pattern-similarity-change.html#cb286-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb286-7"><a href="rsa-on-pattern-similarity-change.html#cb286-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb286-8"><a href="rsa-on-pattern-similarity-change.html#cb286-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb286-9"><a href="rsa-on-pattern-similarity-change.html#cb286-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb286-10"><a href="rsa-on-pattern-similarity-change.html#cb286-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb286-11"><a href="rsa-on-pattern-similarity-change.html#cb286-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb286-12"><a href="rsa-on-pattern-similarity-change.html#cb286-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb286-13"><a href="rsa-on-pattern-similarity-change.html#cb286-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change for different-sequence events in the anterior hippocampus when including order and real time in the model&quot;</span>)</span>
<span id="cb286-14"><a href="rsa-on-pattern-similarity-change.html#cb286-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-15"><a href="rsa-on-pattern-similarity-change.html#cb286-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb286-16"><a href="rsa-on-pattern-similarity-change.html#cb286-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_diff_seq_time_metrics <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb286-17"><a href="rsa-on-pattern-similarity-change.html#cb286-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-18"><a href="rsa-on-pattern-similarity-change.html#cb286-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb286-19"><a href="rsa-on-pattern-similarity-change.html#cb286-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-162">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change for different-sequence events in the anterior hippocampus when including order and real time in the model</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000101</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000112</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.90</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000319</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000118</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000623</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000294</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.12</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001201</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.000046</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">order</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000348</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000478</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.73</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001284</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000589</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">real time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000702</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000529</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.33</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000334</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001739</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.007077</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-28594.64</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14302.32</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">6</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-28597.12</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14304.56</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.48</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.034</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+order_diff+real_time_diff+(0+vir_time_diff|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>Mixed model plots.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="rsa-on-pattern-similarity-change.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set RNG</span></span>
<span id="cb287-2"><a href="rsa-on-pattern-similarity-change.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb287-3"><a href="rsa-on-pattern-similarity-change.html#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="rsa-on-pattern-similarity-change.html#cb287-4" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb287-5"><a href="rsa-on-pattern-similarity-change.html#cb287-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term) <span class="sc">%&gt;%</span> </span>
<span id="cb287-6"><a href="rsa-on-pattern-similarity-change.html#cb287-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>)))</span>
<span id="cb287-7"><a href="rsa-on-pattern-similarity-change.html#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="rsa-on-pattern-similarity-change.html#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb287-9"><a href="rsa-on-pattern-similarity-change.html#cb287-9" aria-hidden="true" tabindex="-1"></a>sfig6_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb287-10"><a href="rsa-on-pattern-similarity-change.html#cb287-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-11"><a href="rsa-on-pattern-similarity-change.html#cb287-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb287-12"><a href="rsa-on-pattern-similarity-change.html#cb287-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb287-13"><a href="rsa-on-pattern-similarity-change.html#cb287-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])) <span class="sc">+</span></span>
<span id="cb287-14"><a href="rsa-on-pattern-similarity-change.html#cb287-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Virtual&quot;</span>, <span class="st">&quot;Order&quot;</span>, <span class="st">&quot;Real&quot;</span>)) <span class="sc">+</span></span>
<span id="cb287-15"><a href="rsa-on-pattern-similarity-change.html#cb287-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;time metric&quot;</span>, <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Time Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-16"><a href="rsa-on-pattern-similarity-change.html#cb287-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-17"><a href="rsa-on-pattern-similarity-change.html#cb287-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb287-18"><a href="rsa-on-pattern-similarity-change.html#cb287-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb287-19"><a href="rsa-on-pattern-similarity-change.html#cb287-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>()) </span>
<span id="cb287-20"><a href="rsa-on-pattern-similarity-change.html#cb287-20" aria-hidden="true" tabindex="-1"></a>sfig6_b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="rsa-on-pattern-similarity-change.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb288-2"><a href="rsa-on-pattern-similarity-change.html#cb288-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> get_complete_df</span>
<span id="cb288-3"><a href="rsa-on-pattern-similarity-change.html#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the group variable to a factor to control the order of facets below</span></span>
<span id="cb288-4"><a href="rsa-on-pattern-similarity-change.html#cb288-4" aria-hidden="true" tabindex="-1"></a>lmm_full_emm<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(lmm_full_emm<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>))</span>
<span id="cb288-5"><a href="rsa-on-pattern-similarity-change.html#cb288-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-6"><a href="rsa-on-pattern-similarity-change.html#cb288-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb288-7"><a href="rsa-on-pattern-similarity-change.html#cb288-7" aria-hidden="true" tabindex="-1"></a>sfig6_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb288-8"><a href="rsa-on-pattern-similarity-change.html#cb288-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb288-9"><a href="rsa-on-pattern-similarity-change.html#cb288-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb288-10"><a href="rsa-on-pattern-similarity-change.html#cb288-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">name =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb288-11"><a href="rsa-on-pattern-similarity-change.html#cb288-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb288-12"><a href="rsa-on-pattern-similarity-change.html#cb288-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])) <span class="sc">+</span></span>
<span id="cb288-13"><a href="rsa-on-pattern-similarity-change.html#cb288-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb288-14"><a href="rsa-on-pattern-similarity-change.html#cb288-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z time metric&#39;</span>) <span class="sc">+</span></span>
<span id="cb288-15"><a href="rsa-on-pattern-similarity-change.html#cb288-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb288-16"><a href="rsa-on-pattern-similarity-change.html#cb288-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb288-17"><a href="rsa-on-pattern-similarity-change.html#cb288-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb288-18"><a href="rsa-on-pattern-similarity-change.html#cb288-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb288-19"><a href="rsa-on-pattern-similarity-change.html#cb288-19" aria-hidden="true" tabindex="-1"></a>sfig6_c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-163-2.png" width="672" /></p>
</div>
</div>
<div id="ahpc-virtual-time-within-vs.-across-sequences" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> aHPC: virtual time within vs. across sequences</h2>
<p>The previous results show positive correlations of pattern similarity change with temporal distances between event pairs from the same sequence and negative correlations with temporal distances when events are from different sequences. Next, we want to quantify whether these two modes of representation are significantly different from each other.</p>
<div id="second-level-analysis" class="section level3 unnumbered">
<h3>Second-level analysis</h3>
<p>For the summary statistics approach, we run a permutation-based paired t-test to check for a difference in the effect of virtual time depending on whether we look at within vs. across sequences.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="rsa-on-pattern-similarity-change.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">105</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb289-2"><a href="rsa-on-pattern-similarity-change.html#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="rsa-on-pattern-similarity-change.html#cb289-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span></span>
<span id="cb289-4"><a href="rsa-on-pattern-similarity-change.html#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi<span class="sc">==</span><span class="st">&quot;aHPC_lr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-5"><a href="rsa-on-pattern-similarity-change.html#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate difference between within- an across-day effect for each participant</span></span>
<span id="cb289-6"><a href="rsa-on-pattern-similarity-change.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb289-7"><a href="rsa-on-pattern-similarity-change.html#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb289-8"><a href="rsa-on-pattern-similarity-change.html#cb289-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_diff =</span> z_virtual_time[same_day<span class="sc">==</span><span class="cn">TRUE</span>]<span class="sc">-</span>z_virtual_time[same_day<span class="sc">==</span><span class="cn">FALSE</span>],</span>
<span id="cb289-9"><a href="rsa-on-pattern-similarity-change.html#cb289-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-10"><a href="rsa-on-pattern-similarity-change.html#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test difference against 0</span></span>
<span id="cb289-11"><a href="rsa-on-pattern-similarity-change.html#cb289-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(same_day_diff) <span class="sc">%&gt;%</span> </span>
<span id="cb289-12"><a href="rsa-on-pattern-similarity-change.html#cb289-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb289-13"><a href="rsa-on-pattern-similarity-change.html#cb289-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-14"><a href="rsa-on-pattern-similarity-change.html#cb289-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for paired samples using non-central t-distribution for CI</span></span>
<span id="cb289-15"><a href="rsa-on-pattern-similarity-change.html#cb289-15" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>))<span class="sc">$</span>z_virtual_time, </span>
<span id="cb289-16"><a href="rsa-on-pattern-similarity-change.html#cb289-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>))<span class="sc">$</span>z_virtual_time, </span>
<span id="cb289-17"><a href="rsa-on-pattern-similarity-change.html#cb289-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">pooled =</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb289-18"><a href="rsa-on-pattern-similarity-change.html#cb289-18" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb289-19"><a href="rsa-on-pattern-similarity-change.html#cb289-19" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb289-20"><a href="rsa-on-pattern-similarity-change.html#cb289-20" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb289-21"><a href="rsa-on-pattern-similarity-change.html#cb289-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-22"><a href="rsa-on-pattern-similarity-change.html#cb289-22" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb289-23"><a href="rsa-on-pattern-similarity-change.html#cb289-23" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-164">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">1.12</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.71</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000941</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.74</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.05</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.287</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.13</td></tr>
</table>

<p>Summary Statistics: paired t-test comparing effects of virtual time within and across sequences in aHPC<br />
t<sub>27</sub>=3.71, p=0.001, d=1.05, 95% CI [0.29, 1.13]</p>
<p>To visualize the difference between the effects of virtual time for events from the same or different day, we create a pair of rainclouds facing each other. We use a custom jitter so that the length of lines connecting individual subject data points remains constant, thus keeping their slopes comparable.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="rsa-on-pattern-similarity-change.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate custom repeating jitter (multiply with -1/1 to shift towards each other)</span></span>
<span id="cb290-2"><a href="rsa-on-pattern-similarity-change.html#cb290-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb290-3"><a href="rsa-on-pattern-similarity-change.html#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi<span class="sc">==</span><span class="st">&quot;aHPC_lr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb290-4"><a href="rsa-on-pattern-similarity-change.html#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb290-5"><a href="rsa-on-pattern-similarity-change.html#cb290-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_num =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>),<span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb290-6"><a href="rsa-on-pattern-similarity-change.html#cb290-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_char =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>), </span>
<span id="cb290-7"><a href="rsa-on-pattern-similarity-change.html#cb290-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;different&quot;</span>, <span class="st">&quot;same&quot;</span>)),</span>
<span id="cb290-8"><a href="rsa-on-pattern-similarity-change.html#cb290-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_char =</span> <span class="fu">fct_relevel</span>(same_day_char, <span class="fu">c</span>(<span class="st">&quot;same&quot;</span>, <span class="st">&quot;different&quot;</span>)),</span>
<span id="cb290-9"><a href="rsa-on-pattern-similarity-change.html#cb290-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_jit =</span> <span class="fu">as.numeric</span>(same_day_char) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">jitter</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n_subs), <span class="at">amount=</span><span class="fl">0.05</span>), <span class="at">each=</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),n_subs))</span>
<span id="cb290-10"><a href="rsa-on-pattern-similarity-change.html#cb290-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-11"><a href="rsa-on-pattern-similarity-change.html#cb290-11" aria-hidden="true" tabindex="-1"></a>f5a<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>plot_dat, <span class="fu">aes</span>(<span class="at">x=</span>same_day_char, <span class="at">y=</span>z_virtual_time, <span class="at">fill =</span> same_day_char, <span class="at">color =</span> same_day_char)) <span class="sc">+</span></span>
<span id="cb290-12"><a href="rsa-on-pattern-similarity-change.html#cb290-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span>same_day_char), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb290-13"><a href="rsa-on-pattern-similarity-change.html#cb290-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb290-14"><a href="rsa-on-pattern-similarity-change.html#cb290-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], aHPC_colors[<span class="st">&quot;across_main&quot;</span>]))) <span class="sc">+</span></span>
<span id="cb290-15"><a href="rsa-on-pattern-similarity-change.html#cb290-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], aHPC_colors[<span class="st">&quot;across_main&quot;</span>])),</span>
<span id="cb290-16"><a href="rsa-on-pattern-similarity-change.html#cb290-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;sequence&quot;</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;same&quot;</span>, <span class="st">&quot;different&quot;</span>)) <span class="sc">+</span></span>
<span id="cb290-17"><a href="rsa-on-pattern-similarity-change.html#cb290-17" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> plot_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">TRUE</span>), </span>
<span id="cb290-18"><a href="rsa-on-pattern-similarity-change.html#cb290-18" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>same_day_char, <span class="at">y=</span>z_virtual_time),</span>
<span id="cb290-19"><a href="rsa-on-pattern-similarity-change.html#cb290-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb290-20"><a href="rsa-on-pattern-similarity-change.html#cb290-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb290-21"><a href="rsa-on-pattern-similarity-change.html#cb290-21" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> plot_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">FALSE</span>), </span>
<span id="cb290-22"><a href="rsa-on-pattern-similarity-change.html#cb290-22" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>same_day_char, <span class="at">y=</span>z_virtual_time),</span>
<span id="cb290-23"><a href="rsa-on-pattern-similarity-change.html#cb290-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb290-24"><a href="rsa-on-pattern-similarity-change.html#cb290-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb290-25"><a href="rsa-on-pattern-similarity-change.html#cb290-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb290-26"><a href="rsa-on-pattern-similarity-change.html#cb290-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb290-27"><a href="rsa-on-pattern-similarity-change.html#cb290-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb290-28"><a href="rsa-on-pattern-similarity-change.html#cb290-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb290-29"><a href="rsa-on-pattern-similarity-change.html#cb290-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>sub_id,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb290-30"><a href="rsa-on-pattern-similarity-change.html#cb290-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb290-31"><a href="rsa-on-pattern-similarity-change.html#cb290-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit, <span class="at">fill =</span> same_day_char), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.15</span>, <span class="fl">0.15</span>)),</span>
<span id="cb290-32"><a href="rsa-on-pattern-similarity-change.html#cb290-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb290-33"><a href="rsa-on-pattern-similarity-change.html#cb290-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;sequence&#39;</span>) <span class="sc">+</span></span>
<span id="cb290-34"><a href="rsa-on-pattern-similarity-change.html#cb290-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-35"><a href="rsa-on-pattern-similarity-change.html#cb290-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb290-36"><a href="rsa-on-pattern-similarity-change.html#cb290-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&#39;**&#39;</span>, <span class="st">&#39;*&#39;</span>), </span>
<span id="cb290-37"><a href="rsa-on-pattern-similarity-change.html#cb290-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb290-38"><a href="rsa-on-pattern-similarity-change.html#cb290-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb290-39"><a href="rsa-on-pattern-similarity-change.html#cb290-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;underline(&quot;   ***   &quot;)&#39;</span>, </span>
<span id="cb290-40"><a href="rsa-on-pattern-similarity-change.html#cb290-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb290-41"><a href="rsa-on-pattern-similarity-change.html#cb290-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb290-42"><a href="rsa-on-pattern-similarity-change.html#cb290-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb290-43"><a href="rsa-on-pattern-similarity-change.html#cb290-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb290-44"><a href="rsa-on-pattern-similarity-change.html#cb290-44" aria-hidden="true" tabindex="-1"></a>f5a</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="rsa-on-pattern-similarity-change.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb291-2"><a href="rsa-on-pattern-similarity-change.html#cb291-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f5a)<span class="sc">$</span>data[[<span class="dv">6</span>]]</span>
<span id="cb291-3"><a href="rsa-on-pattern-similarity-change.html#cb291-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y, group), </span>
<span id="cb291-4"><a href="rsa-on-pattern-similarity-change.html#cb291-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f5a.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="linear-mixed-effects-7" class="section level3 unnumbered">
<h3>Linear Mixed Effects</h3>
<p>Next, we test whether there is an interaction effect, i.e. we test whether the effect of virtual time on hippocampal pattern similarity change depends on whether we look at event pairs from the same vs. from different days.</p>
<p>We again have to reduce our model from the maximal random effects structure. We end up with a model that keeps only the random slopes for the interaction of virtual time and day. This is in keeping with the paper on random effect structures when testing interactions that emphasizes the importance of random slopes for the interaction of interest <a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00328/full">Barr, 2013, Frontiers Psychology</a>.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="rsa-on-pattern-similarity-change.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the data</span></span>
<span id="cb292-2"><a href="rsa-on-pattern-similarity-change.html#cb292-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_aHPC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>)</span>
<span id="cb292-3"><a href="rsa-on-pattern-similarity-change.html#cb292-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-4"><a href="rsa-on-pattern-similarity-change.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test the interaction for aHPC</span></span>
<span id="cb292-5"><a href="rsa-on-pattern-similarity-change.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co"># maximal random effect structure --&gt; singular fit</span></span>
<span id="cb292-6"><a href="rsa-on-pattern-similarity-change.html#cb292-6" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (1 + vir_time_diff * same_day_dv | sub_id)&quot;</span></span>
<span id="cb292-7"><a href="rsa-on-pattern-similarity-change.html#cb292-7" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="rsa-on-pattern-similarity-change.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no correlations with random intercept --&gt; singular fit</span></span>
<span id="cb294-2"><a href="rsa-on-pattern-similarity-change.html#cb294-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (1 + vir_time_diff * same_day_dv || sub_id)&quot;</span></span>
<span id="cb294-3"><a href="rsa-on-pattern-similarity-change.html#cb294-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="rsa-on-pattern-similarity-change.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercepts and random slopes only for the critical interaction --&gt; singular fit</span></span>
<span id="cb296-2"><a href="rsa-on-pattern-similarity-change.html#cb296-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (1 + vir_time_diff : same_day_dv || sub_id)&quot;</span></span>
<span id="cb296-3"><a href="rsa-on-pattern-similarity-change.html#cb296-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="rsa-on-pattern-similarity-change.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random slopes for critical interactions</span></span>
<span id="cb298-2"><a href="rsa-on-pattern-similarity-change.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">334</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb298-3"><a href="rsa-on-pattern-similarity-change.html#cb298-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (0 + vir_time_diff : same_day_dv | sub_id)&quot;</span></span>
<span id="cb298-4"><a href="rsa-on-pattern-similarity-change.html#cb298-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb298-5"><a href="rsa-on-pattern-similarity-change.html#cb298-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff * same_day_dv + (0 + vir_time_diff:same_day_dv |      sub_id)
##    Data: rsa_dat_aHPC
## 
##      AIC      BIC   logLik deviance df.resid 
## -37581.7 -37542.3  18796.9 -37593.7     5314 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.3282 -0.6823  0.0196  0.6564  3.7447 
## 
## Random effects:
##  Groups   Name                      Variance  Std.Dev. 
##  sub_id   vir_time_diff:same_day_dv 3.083e-08 0.0001756
##  Residual                           4.993e-05 0.0070659
## Number of obs: 5320, groups:  sub_id, 28
## 
## Fixed effects:
##                             Estimate Std. Error t value
## (Intercept)               -0.0001934  0.0001209  -1.600
## vir_time_diff              0.0002384  0.0001223   1.950
## same_day_dv               -0.0001327  0.0001209  -1.098
## vir_time_diff:same_day_dv  0.0005129  0.0001267   4.049</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="rsa-on-pattern-similarity-change.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb300-2"><a href="rsa-on-pattern-similarity-change.html#cb300-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="rsa-on-pattern-similarity-change.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb302-2"><a href="rsa-on-pattern-similarity-change.html#cb302-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb302-3"><a href="rsa-on-pattern-similarity-change.html#cb302-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-4"><a href="rsa-on-pattern-similarity-change.html#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test against reduced model</span></span>
<span id="cb302-5"><a href="rsa-on-pattern-similarity-change.html#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">309</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb302-6"><a href="rsa-on-pattern-similarity-change.html#cb302-6" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> <span class="fu">update</span>(lmm_full, <span class="sc">~</span> . <span class="sc">-</span> vir_time_diff<span class="sc">:</span>same_day_dv)</span>
<span id="cb302-7"><a href="rsa-on-pattern-similarity-change.html#cb302-7" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_reduced, lmm_full)</span>
<span id="cb302-8"><a href="rsa-on-pattern-similarity-change.html#cb302-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-9"><a href="rsa-on-pattern-similarity-change.html#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="co"># store for future use (MDS)</span></span>
<span id="cb302-10"><a href="rsa-on-pattern-similarity-change.html#cb302-10" aria-hidden="true" tabindex="-1"></a>lmm_aHPC_interaction <span class="ot">&lt;-</span> lmm_full</span></code></pre></div>
<p>Mixed Model: Fixed effect of interaction of virtual time with sequence identity on aHPC pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=14.37, p=0.000</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="rsa-on-pattern-similarity-change.html#cb303-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;interaction virtual time and day&quot;</span>)</span>
<span id="cb303-2"><a href="rsa-on-pattern-similarity-change.html#cb303-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb303-3"><a href="rsa-on-pattern-similarity-change.html#cb303-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;interaction virtual time and day (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb303-4"><a href="rsa-on-pattern-similarity-change.html#cb303-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-5"><a href="rsa-on-pattern-similarity-change.html#cb303-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb303-6"><a href="rsa-on-pattern-similarity-change.html#cb303-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb303-7"><a href="rsa-on-pattern-similarity-change.html#cb303-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb303-8"><a href="rsa-on-pattern-similarity-change.html#cb303-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb303-9"><a href="rsa-on-pattern-similarity-change.html#cb303-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb303-10"><a href="rsa-on-pattern-similarity-change.html#cb303-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb303-11"><a href="rsa-on-pattern-similarity-change.html#cb303-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb303-12"><a href="rsa-on-pattern-similarity-change.html#cb303-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb303-13"><a href="rsa-on-pattern-similarity-change.html#cb303-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: The effect of virtual time differs between same-sequence and different-sequence events in the anterior hippocampus&quot;</span>)</span>
<span id="cb303-14"><a href="rsa-on-pattern-similarity-change.html#cb303-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-15"><a href="rsa-on-pattern-similarity-change.html#cb303-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb303-16"><a href="rsa-on-pattern-similarity-change.html#cb303-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_same_vs_diff_seq <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb303-17"><a href="rsa-on-pattern-similarity-change.html#cb303-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-18"><a href="rsa-on-pattern-similarity-change.html#cb303-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb303-19"><a href="rsa-on-pattern-similarity-change.html#cb303-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-167">
<caption style="caption-side: top; text-align: left;">Mixed Model: The effect of virtual time differs between same-sequence and different-sequence events in the anterior hippocampus</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000193</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000121</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.60</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000430</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000044</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000238</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000122</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.95</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000001</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000478</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000133</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000121</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.10</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000370</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000104</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">interaction virtual time and day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000513</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000127</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.05</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000261</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000765</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">interaction virtual time and day (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000176</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.007066</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-37569.38</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18789.69</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">6</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-37581.75</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18796.87</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14.37</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.50e-04</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff*same_day_dv+(0+vir_time_diff:same_day_dv|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="rsa-on-pattern-similarity-change.html#cb304-1" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb304-2"><a href="rsa-on-pattern-similarity-change.html#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term))</span>
<span id="cb304-3"><a href="rsa-on-pattern-similarity-change.html#cb304-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-4"><a href="rsa-on-pattern-similarity-change.html#cb304-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb304-5"><a href="rsa-on-pattern-similarity-change.html#cb304-5" aria-hidden="true" tabindex="-1"></a>sfigmm_i <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb304-6"><a href="rsa-on-pattern-similarity-change.html#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb304-7"><a href="rsa-on-pattern-similarity-change.html#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb304-8"><a href="rsa-on-pattern-similarity-change.html#cb304-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb304-9"><a href="rsa-on-pattern-similarity-change.html#cb304-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;black&quot;</span>,<span class="dv">6</span>), <span class="st">&quot;#DD8D29&quot;</span>)) <span class="sc">+</span></span>
<span id="cb304-10"><a href="rsa-on-pattern-similarity-change.html#cb304-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(ultimate_gray, time_within_across_color, day_time_int_color), <span class="at">name =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb304-11"><a href="rsa-on-pattern-similarity-change.html#cb304-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;sequence&quot;</span>, <span class="st">&quot;virtual time (all events)&quot;</span>, <span class="st">&quot;interaction&quot;</span>)) <span class="sc">+</span></span>
<span id="cb304-12"><a href="rsa-on-pattern-similarity-change.html#cb304-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb304-13"><a href="rsa-on-pattern-similarity-change.html#cb304-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb304-14"><a href="rsa-on-pattern-similarity-change.html#cb304-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb304-15"><a href="rsa-on-pattern-similarity-change.html#cb304-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb304-16"><a href="rsa-on-pattern-similarity-change.html#cb304-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb304-17"><a href="rsa-on-pattern-similarity-change.html#cb304-17" aria-hidden="true" tabindex="-1"></a>sfigmm_i</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="rsa-on-pattern-similarity-change.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means (&amp; add factor for easier plotting)</span></span>
<span id="cb305-2"><a href="rsa-on-pattern-similarity-change.html#cb305-2" aria-hidden="true" tabindex="-1"></a>hpc_emms <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;same_day_dv&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb305-3"><a href="rsa-on-pattern-similarity-change.html#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb305-4"><a href="rsa-on-pattern-similarity-change.html#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(group <span class="sc">==</span> <span class="dv">1</span>, <span class="at">true =</span> <span class="st">&quot;same day&quot;</span>, <span class="at">false =</span> <span class="st">&quot;different day&quot;</span>),</span>
<span id="cb305-5"><a href="rsa-on-pattern-similarity-change.html#cb305-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;same day&quot;</span>, <span class="st">&quot;different day&quot;</span>)))</span>
<span id="cb305-6"><a href="rsa-on-pattern-similarity-change.html#cb305-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-7"><a href="rsa-on-pattern-similarity-change.html#cb305-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb305-8"><a href="rsa-on-pattern-similarity-change.html#cb305-8" aria-hidden="true" tabindex="-1"></a>sfigmm_j <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hpc_emms, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">colour =</span> day, <span class="at">fill =</span> day)) <span class="sc">+</span></span>
<span id="cb305-9"><a href="rsa-on-pattern-similarity-change.html#cb305-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb305-10"><a href="rsa-on-pattern-similarity-change.html#cb305-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb305-11"><a href="rsa-on-pattern-similarity-change.html#cb305-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(linetype = day), size = 0.5) +</span></span>
<span id="cb305-12"><a href="rsa-on-pattern-similarity-change.html#cb305-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_linetype_manual(values=c(&quot;solid&quot;, &quot;2121&quot;)) +</span></span>
<span id="cb305-13"><a href="rsa-on-pattern-similarity-change.html#cb305-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="fu">c</span>(<span class="st">&quot;within_main&quot;</span>, <span class="st">&quot;across_main&quot;</span>)])), <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb305-14"><a href="rsa-on-pattern-similarity-change.html#cb305-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="fu">c</span>(<span class="st">&quot;within_main&quot;</span>, <span class="st">&quot;across_main&quot;</span>)]))) <span class="sc">+</span></span>
<span id="cb305-15"><a href="rsa-on-pattern-similarity-change.html#cb305-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb305-16"><a href="rsa-on-pattern-similarity-change.html#cb305-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z virtual time&#39;</span>) <span class="sc">+</span></span>
<span id="cb305-17"><a href="rsa-on-pattern-similarity-change.html#cb305-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb305-18"><a href="rsa-on-pattern-similarity-change.html#cb305-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb305-19"><a href="rsa-on-pattern-similarity-change.html#cb305-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb305-20"><a href="rsa-on-pattern-similarity-change.html#cb305-20" aria-hidden="true" tabindex="-1"></a>sfigmm_j</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-168-2.png" width="672" /></p>
<div id="lme-model-assumptions-5" class="section level4 unnumbered">
<h4>LME model assumptions</h4>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="rsa-on-pattern-similarity-change.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmm_diagplots_jb</span>(lmm_full)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="interaction-of-sequence-membership-and-order" class="section level3 unnumbered">
<h3>Interaction of sequence membership and order</h3>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="rsa-on-pattern-similarity-change.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction of order and sequence (including only cirtical random slopes to avoid singular fit)</span></span>
<span id="cb307-2"><a href="rsa-on-pattern-similarity-change.html#cb307-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ order_diff * same_day_dv + (0 + order_diff : same_day_dv | sub_id)&quot;</span></span>
<span id="cb307-3"><a href="rsa-on-pattern-similarity-change.html#cb307-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb307-4"><a href="rsa-on-pattern-similarity-change.html#cb307-4" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> <span class="fu">update</span>(lmm_full, <span class="sc">~</span> . <span class="sc">-</span> order_diff<span class="sc">:</span>same_day_dv)</span>
<span id="cb307-5"><a href="rsa-on-pattern-similarity-change.html#cb307-5" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_reduced, lmm_full)</span>
<span id="cb307-6"><a href="rsa-on-pattern-similarity-change.html#cb307-6" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-170">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.75e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.88e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.75e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.88e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.98</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00158</td></tr>
</table>

<p>Mixed Model: Fixed effect of interaction of order with sequence identity on aHPC pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=9.98, p=0.002</p>
</div>
<div id="interaction-of-sequence-membership-and-real-time" class="section level3 unnumbered">
<h3>Interaction of sequence membership and real time</h3>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="rsa-on-pattern-similarity-change.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction of real time and sequence (including only cirtical random slopes to avoid singular fit)</span></span>
<span id="cb308-2"><a href="rsa-on-pattern-similarity-change.html#cb308-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ real_time_diff * same_day_dv + (0 + real_time_diff : same_day_dv | sub_id)&quot;</span></span>
<span id="cb308-3"><a href="rsa-on-pattern-similarity-change.html#cb308-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb308-4"><a href="rsa-on-pattern-similarity-change.html#cb308-4" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> <span class="fu">update</span>(lmm_full, <span class="sc">~</span> . <span class="sc">-</span> real_time_diff<span class="sc">:</span>same_day_dv)</span>
<span id="cb308-5"><a href="rsa-on-pattern-similarity-change.html#cb308-5" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_reduced, lmm_full)</span>
<span id="cb308-6"><a href="rsa-on-pattern-similarity-change.html#cb308-6" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-171">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.75e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.88e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.75e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.88e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00232</td></tr>
</table>

<p>Mixed Model: Fixed effect of interaction of real time with sequence identity on aHPC pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=9.27, p=0.002</p>
</div>
<div id="interaction-of-sequence-membership-and-virtual-time-when-including-interactions-with-other-time-metrics" class="section level3 unnumbered">
<h3>Interaction of sequence membership and virtual time when including interactions with other time metrics</h3>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="rsa-on-pattern-similarity-change.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test the interaction for aHPC</span></span>
<span id="cb309-2"><a href="rsa-on-pattern-similarity-change.html#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="co"># maximal random effect structure --&gt; singular fit</span></span>
<span id="cb309-3"><a href="rsa-on-pattern-similarity-change.html#cb309-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + order_diff:same_day_dv + real_time_diff:same_day_dv+ (1 + vir_time_diff * same_day_dv | sub_id)&quot;</span></span>
<span id="cb309-4"><a href="rsa-on-pattern-similarity-change.html#cb309-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="rsa-on-pattern-similarity-change.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no correlations with random intercept --&gt; singular fit</span></span>
<span id="cb311-2"><a href="rsa-on-pattern-similarity-change.html#cb311-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + order_diff:same_day_dv + real_time_diff:same_day_dv+ (1 + vir_time_diff * same_day_dv || sub_id)&quot;</span></span>
<span id="cb311-3"><a href="rsa-on-pattern-similarity-change.html#cb311-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="rsa-on-pattern-similarity-change.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercepts and random slopes only for the critical interaction --&gt; singular fit</span></span>
<span id="cb313-2"><a href="rsa-on-pattern-similarity-change.html#cb313-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + order_diff:same_day_dv + real_time_diff:same_day_dv+ (1 + vir_time_diff : same_day_dv || sub_id)&quot;</span></span>
<span id="cb313-3"><a href="rsa-on-pattern-similarity-change.html#cb313-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="rsa-on-pattern-similarity-change.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random slopes for critical interactions</span></span>
<span id="cb315-2"><a href="rsa-on-pattern-similarity-change.html#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">334</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb315-3"><a href="rsa-on-pattern-similarity-change.html#cb315-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + order_diff:same_day_dv + real_time_diff:same_day_dv+ (0 + vir_time_diff : same_day_dv | sub_id)&quot;</span></span>
<span id="cb315-4"><a href="rsa-on-pattern-similarity-change.html#cb315-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_aHPC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb315-5"><a href="rsa-on-pattern-similarity-change.html#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff * same_day_dv + order_diff:same_day_dv +      real_time_diff:same_day_dv + (0 + vir_time_diff:same_day_dv |      sub_id)
##    Data: rsa_dat_aHPC
## 
##      AIC      BIC   logLik deviance df.resid 
## -37579.5 -37526.9  18797.8 -37595.5     5312 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.3143 -0.6830  0.0224  0.6567  3.7470 
## 
## Random effects:
##  Groups   Name                      Variance  Std.Dev. 
##  sub_id   vir_time_diff:same_day_dv 3.092e-08 0.0001758
##  Residual                           4.991e-05 0.0070647
## Number of obs: 5320, groups:  sub_id, 28
## 
## Fixed effects:
##                              Estimate Std. Error t value
## (Intercept)                -0.0001895  0.0001219  -1.554
## vir_time_diff               0.0002373  0.0001237   1.919
## same_day_dv                -0.0001303  0.0001214  -1.074
## vir_time_diff:same_day_dv   0.0007689  0.0002621   2.934
## same_day_dv:order_diff      0.0002866  0.0004180   0.686
## same_day_dv:real_time_diff -0.0005584  0.0004640  -1.203</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="rsa-on-pattern-similarity-change.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb317-2"><a href="rsa-on-pattern-similarity-change.html#cb317-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="rsa-on-pattern-similarity-change.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb319-2"><a href="rsa-on-pattern-similarity-change.html#cb319-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb319-3"><a href="rsa-on-pattern-similarity-change.html#cb319-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-4"><a href="rsa-on-pattern-similarity-change.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test against reduced model</span></span>
<span id="cb319-5"><a href="rsa-on-pattern-similarity-change.html#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">309</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb319-6"><a href="rsa-on-pattern-similarity-change.html#cb319-6" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> <span class="fu">update</span>(lmm_full, <span class="sc">~</span> . <span class="sc">-</span> vir_time_diff<span class="sc">:</span>same_day_dv)</span>
<span id="cb319-7"><a href="rsa-on-pattern-similarity-change.html#cb319-7" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_reduced, lmm_full)</span>
<span id="cb319-8"><a href="rsa-on-pattern-similarity-change.html#cb319-8" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-172">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.75e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.88e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.75e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.88e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.76e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8.57</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00342</td></tr>
</table>

<p>Mixed Model: Fixed effect of interaction of virtual time with sequence identity on aHPC pattern similarity change when including interaction with other time metrics
<span class="math inline">\(\chi^2\)</span>(1)=8.57, p=0.003</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="rsa-on-pattern-similarity-change.html#cb320-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;interaction virtual time and day&quot;</span>, <span class="st">&quot;interaction order and day&quot;</span>, <span class="st">&quot;interaction real time and day&quot;</span>)</span>
<span id="cb320-2"><a href="rsa-on-pattern-similarity-change.html#cb320-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb320-3"><a href="rsa-on-pattern-similarity-change.html#cb320-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;interaction virtual time and day (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb320-4"><a href="rsa-on-pattern-similarity-change.html#cb320-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-5"><a href="rsa-on-pattern-similarity-change.html#cb320-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb320-6"><a href="rsa-on-pattern-similarity-change.html#cb320-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb320-7"><a href="rsa-on-pattern-similarity-change.html#cb320-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb320-8"><a href="rsa-on-pattern-similarity-change.html#cb320-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb320-9"><a href="rsa-on-pattern-similarity-change.html#cb320-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb320-10"><a href="rsa-on-pattern-similarity-change.html#cb320-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb320-11"><a href="rsa-on-pattern-similarity-change.html#cb320-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb320-12"><a href="rsa-on-pattern-similarity-change.html#cb320-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb320-13"><a href="rsa-on-pattern-similarity-change.html#cb320-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: The effect of virtual time differs between same-sequence and different-sequence events in the anterior hippocampus when including interactions with other time metrics&quot;</span>)</span>
<span id="cb320-14"><a href="rsa-on-pattern-similarity-change.html#cb320-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-15"><a href="rsa-on-pattern-similarity-change.html#cb320-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb320-16"><a href="rsa-on-pattern-similarity-change.html#cb320-16" aria-hidden="true" tabindex="-1"></a>stable_lme_aHPC_virtime_same_vs_diff_seq_all_interactions <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb320-17"><a href="rsa-on-pattern-similarity-change.html#cb320-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-18"><a href="rsa-on-pattern-similarity-change.html#cb320-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb320-19"><a href="rsa-on-pattern-similarity-change.html#cb320-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-173">
<caption style="caption-side: top; text-align: left;">Mixed Model: The effect of virtual time differs between same-sequence and different-sequence events in the anterior hippocampus when including interactions with other time metrics</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000190</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000122</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.55</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000428</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000049</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000237</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000124</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.92</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000005</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000480</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000130</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000121</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.07</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000368</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000108</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">interaction virtual time and day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000769</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000262</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.93</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000255</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001283</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">interaction order and day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000287</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000418</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.69</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000533</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001106</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">interaction real time and day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000558</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000464</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.20</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001468</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000351</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">interaction virtual time and day (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000176</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.007065</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">7</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-37572.96</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18793.48</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">8</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-37579.53</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18797.77</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8.57</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.003</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff*same_day_dv+order_diff:same_day_dv+real_time_diff:same_day_dv+(0+vir_time_diff:same_day_dv|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="rsa-on-pattern-similarity-change.html#cb321-1" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb321-2"><a href="rsa-on-pattern-similarity-change.html#cb321-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">factor</span>(term, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="st">&quot;same_day_dv&quot;</span>, <span class="st">&quot;vir_time_diff&quot;</span>,  <span class="st">&quot;vir_time_diff:same_day_dv&quot;</span>, <span class="st">&quot;same_day_dv:order_diff&quot;</span>, <span class="st">&quot;same_day_dv:real_time_diff&quot;</span>)))</span>
<span id="cb321-3"><a href="rsa-on-pattern-similarity-change.html#cb321-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-4"><a href="rsa-on-pattern-similarity-change.html#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb321-5"><a href="rsa-on-pattern-similarity-change.html#cb321-5" aria-hidden="true" tabindex="-1"></a>sfig_x <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb321-6"><a href="rsa-on-pattern-similarity-change.html#cb321-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb321-7"><a href="rsa-on-pattern-similarity-change.html#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb321-8"><a href="rsa-on-pattern-similarity-change.html#cb321-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb321-9"><a href="rsa-on-pattern-similarity-change.html#cb321-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_manual(values = c(rep(&quot;black&quot;,6), &quot;#DD8D29&quot;)) +</span></span>
<span id="cb321-10"><a href="rsa-on-pattern-similarity-change.html#cb321-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(ultimate_gray, time_within_across_color, day_time_int_color, time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">name =</span> <span class="st">&quot;mixed model predictor&quot;</span>,</span>
<span id="cb321-11"><a href="rsa-on-pattern-similarity-change.html#cb321-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;sequence&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;interaction (virtual time)&quot;</span>, <span class="st">&quot;interaction (order)&quot;</span>, <span class="st">&quot;interaction (real time)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb321-12"><a href="rsa-on-pattern-similarity-change.html#cb321-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb321-13"><a href="rsa-on-pattern-similarity-change.html#cb321-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb321-14"><a href="rsa-on-pattern-similarity-change.html#cb321-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>), <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb321-15"><a href="rsa-on-pattern-similarity-change.html#cb321-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb321-16"><a href="rsa-on-pattern-similarity-change.html#cb321-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb321-17"><a href="rsa-on-pattern-similarity-change.html#cb321-17" aria-hidden="true" tabindex="-1"></a>sfig_x</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
</div>
<div id="mds" class="section level3 unnumbered">
<h3>MDS</h3>
<p>To explore how the event sequences could be arranged in a low-dimensional representational space, we want to run multi-dimensional scaling. To implement these analyses, we use the <a href="https://cran.r-project.org/web/packages/smacof/index.html">smacof-package</a>, see also the helpful vignette <a href="https://cran.r-project.org/web/packages/smacof/vignettes/smacof.pdf">here</a>. MDS requires a distance matrix as an input. We will use a distance matrix based on the population-level predictions from the linear mixed model fitted to the anterior hippocampus pattern similarity change data as an input. This model captures the interaction between virtual temporal distances and sequence membership of event pairs on pattern similarity in the aHPC.</p>
<p>We first initialize a data frame that has one row for each possible pairwise comparison of two events and their (z-scored) absolute virtual temporal distances. We use this data frame as “new” data to predict pattern similarity changes from the linear mixed model. The resulting predicted pairwise similarity changes are converted to a matrix, converted to distances and scaled to the range from 0 to 1.</p>
<blockquote>
<p>We aimed to explore how hippocampal event representations of the different sequences could be embedded in a low-dimensional representational space to give rise to the positive and negative correlations of pattern similarity change and temporal distances for same-sequence and different-sequence events, respectively. For each pair of events, we generated an expected similarity value (Supplemental Figure 6D) using the fixed effects of the mixed model fitted to hippocampal pattern similarity that captures the interaction between virtual temporal distances and sequence membership (c.f. Figure 5, Supplemental Figure 4IJ, and Supplemental Table 7). Using the predict-method implemented in the lme4-package109, we generated model-derived similarity values for all event pairs given their temporal distances and sequence membership. We chose this approach over the raw pattern similarity values to obtain less noisy estimates of the pairwise distances.</p>
</blockquote>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="rsa-on-pattern-similarity-change.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if virtual time exists </span></span>
<span id="cb322-2"><a href="rsa-on-pattern-similarity-change.html#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="co">#(added for OSF code, which will not have this variable in the workspace yet because it did not run the design illustration script included in the full analysis)</span></span>
<span id="cb322-3"><a href="rsa-on-pattern-similarity-change.html#cb322-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;virtual_time&quot;</span>)){virtual_time <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_id<span class="sc">==</span><span class="st">&quot;31&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="st">&quot;virtual_time&quot;</span>)} <span class="co"># virtual time is the same for all subjects</span></span>
<span id="cb322-4"><a href="rsa-on-pattern-similarity-change.html#cb322-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-5"><a href="rsa-on-pattern-similarity-change.html#cb322-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble to use for MDS</span></span>
<span id="cb322-6"><a href="rsa-on-pattern-similarity-change.html#cb322-6" aria-hidden="true" tabindex="-1"></a><span class="co"># this tibble should have a row for each possible pairwise comparison of two events</span></span>
<span id="cb322-7"><a href="rsa-on-pattern-similarity-change.html#cb322-7" aria-hidden="true" tabindex="-1"></a>mds_df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">virtual_time1=</span>virtual_time, <span class="at">virtual_time2=</span>virtual_time) <span class="sc">%&gt;%</span></span>
<span id="cb322-8"><a href="rsa-on-pattern-similarity-change.html#cb322-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># add design variables </span></span>
<span id="cb322-9"><a href="rsa-on-pattern-similarity-change.html#cb322-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">day1 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_days, <span class="at">each=</span>n_days<span class="sc">*</span>n_events_day<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb322-10"><a href="rsa-on-pattern-similarity-change.html#cb322-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">day2 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_days, <span class="at">each=</span>n_events_day, <span class="at">times=</span>n_events_day<span class="sc">*</span>n_days),</span>
<span id="cb322-11"><a href="rsa-on-pattern-similarity-change.html#cb322-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">event1 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_events_day, <span class="at">each=</span>n_events_day<span class="sc">*</span>n_days, <span class="at">times=</span>n_days),</span>
<span id="cb322-12"><a href="rsa-on-pattern-similarity-change.html#cb322-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">event2 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_events_day, <span class="at">times=</span>n_days<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>n_events_day),</span>
<span id="cb322-13"><a href="rsa-on-pattern-similarity-change.html#cb322-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">idx1 =</span> (day1<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">5</span><span class="sc">+</span>event1, <span class="co"># for later conversion to matrix</span></span>
<span id="cb322-14"><a href="rsa-on-pattern-similarity-change.html#cb322-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ixd2 =</span> (day2<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">5</span><span class="sc">+</span>event2, <span class="co"># for later conversion to matrix</span></span>
<span id="cb322-15"><a href="rsa-on-pattern-similarity-change.html#cb322-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day =</span> day1<span class="sc">==</span>day2,</span>
<span id="cb322-16"><a href="rsa-on-pattern-similarity-change.html#cb322-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_dv =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb322-17"><a href="rsa-on-pattern-similarity-change.html#cb322-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> virtual_time1) <span class="sc">%&gt;%</span></span>
<span id="cb322-18"><a href="rsa-on-pattern-similarity-change.html#cb322-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(day1<span class="sc">==</span>day2 <span class="sc">&amp;</span> event1 <span class="sc">==</span> event2)) <span class="sc">%&gt;%</span> <span class="co"># remove diagonal, important to do before z-scoring!</span></span>
<span id="cb322-19"><a href="rsa-on-pattern-similarity-change.html#cb322-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vir_time_diff =</span> <span class="fu">scale</span>(<span class="fu">abs</span>(virtual_time1<span class="sc">-</span>virtual_time2))) <span class="co"># z-scored absolute virtual time difference</span></span>
<span id="cb322-20"><a href="rsa-on-pattern-similarity-change.html#cb322-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-21"><a href="rsa-on-pattern-similarity-change.html#cb322-21" aria-hidden="true" tabindex="-1"></a><span class="co"># for each event pair, get a predicted pattern similarity change value from the mixed model fitted to the aHPC data (ignoring the random effects)</span></span>
<span id="cb322-22"><a href="rsa-on-pattern-similarity-change.html#cb322-22" aria-hidden="true" tabindex="-1"></a>mds_df<span class="sc">$</span>ps_change_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmm_aHPC_interaction, <span class="at">newdata=</span>mds_df, <span class="at">re.form=</span><span class="cn">NA</span>)</span>
<span id="cb322-23"><a href="rsa-on-pattern-similarity-change.html#cb322-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-24"><a href="rsa-on-pattern-similarity-change.html#cb322-24" aria-hidden="true" tabindex="-1"></a><span class="co"># turn into matrix (can probably be done in a prettier way without the loop)</span></span>
<span id="cb322-25"><a href="rsa-on-pattern-similarity-change.html#cb322-25" aria-hidden="true" tabindex="-1"></a>ps_change_hat_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>n_events_day<span class="sc">*</span>n_days, <span class="at">ncol=</span>n_events_day<span class="sc">*</span>n_days)</span>
<span id="cb322-26"><a href="rsa-on-pattern-similarity-change.html#cb322-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mds_df)){</span>
<span id="cb322-27"><a href="rsa-on-pattern-similarity-change.html#cb322-27" aria-hidden="true" tabindex="-1"></a>  ps_change_hat_mat[mds_df<span class="sc">$</span>idx1[i], mds_df<span class="sc">$</span>ixd2[i]] <span class="ot">&lt;-</span> mds_df<span class="sc">$</span>ps_change_hat[i]</span>
<span id="cb322-28"><a href="rsa-on-pattern-similarity-change.html#cb322-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb322-29"><a href="rsa-on-pattern-similarity-change.html#cb322-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-30"><a href="rsa-on-pattern-similarity-change.html#cb322-30" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot of the resulting predicted pattern similarity change matrix</span></span>
<span id="cb322-31"><a href="rsa-on-pattern-similarity-change.html#cb322-31" aria-hidden="true" tabindex="-1"></a>ps_change_hat_df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(ps_change_hat_mat)</span>
<span id="cb322-32"><a href="rsa-on-pattern-similarity-change.html#cb322-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-33"><a href="rsa-on-pattern-similarity-change.html#cb322-33" aria-hidden="true" tabindex="-1"></a>f0a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ps_change_hat_df, <span class="fu">aes</span>(<span class="at">x=</span>Var1, <span class="at">y=</span>Var2, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb322-34"><a href="rsa-on-pattern-similarity-change.html#cb322-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb322-35"><a href="rsa-on-pattern-similarity-change.html#cb322-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb322-36"><a href="rsa-on-pattern-similarity-change.html#cb322-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;buda&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-37"><a href="rsa-on-pattern-similarity-change.html#cb322-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;predicted similarity change&quot;</span>) <span class="sc">+</span> </span>
<span id="cb322-38"><a href="rsa-on-pattern-similarity-change.html#cb322-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;events by day&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-39"><a href="rsa-on-pattern-similarity-change.html#cb322-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;events by day&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-40"><a href="rsa-on-pattern-similarity-change.html#cb322-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;ps change&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-41"><a href="rsa-on-pattern-similarity-change.html#cb322-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb322-42"><a href="rsa-on-pattern-similarity-change.html#cb322-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="co">#theme(aspect.ratio = 1)</span></span>
<span id="cb322-43"><a href="rsa-on-pattern-similarity-change.html#cb322-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-44"><a href="rsa-on-pattern-similarity-change.html#cb322-44" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to distance matrix</span></span>
<span id="cb322-45"><a href="rsa-on-pattern-similarity-change.html#cb322-45" aria-hidden="true" tabindex="-1"></a>ps_dist_hat_mat <span class="ot">&lt;-</span> ps_change_hat_mat <span class="sc">%&gt;%</span> </span>
<span id="cb322-46"><a href="rsa-on-pattern-similarity-change.html#cb322-46" aria-hidden="true" tabindex="-1"></a>  smacof<span class="sc">::</span><span class="fu">sim2diss</span>(<span class="at">method =</span> <span class="st">&quot;corr&quot;</span>)</span>
<span id="cb322-47"><a href="rsa-on-pattern-similarity-change.html#cb322-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-48"><a href="rsa-on-pattern-similarity-change.html#cb322-48" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale from 0 to 1</span></span>
<span id="cb322-49"><a href="rsa-on-pattern-similarity-change.html#cb322-49" aria-hidden="true" tabindex="-1"></a>ps_dist_hat_mat <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ps_dist_hat_mat, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb322-50"><a href="rsa-on-pattern-similarity-change.html#cb322-50" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(ps_dist_hat_mat)<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb322-51"><a href="rsa-on-pattern-similarity-change.html#cb322-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-52"><a href="rsa-on-pattern-similarity-change.html#cb322-52" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot of the resulting distance matrix</span></span>
<span id="cb322-53"><a href="rsa-on-pattern-similarity-change.html#cb322-53" aria-hidden="true" tabindex="-1"></a>ps_dist_hat_df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(ps_dist_hat_mat)</span>
<span id="cb322-54"><a href="rsa-on-pattern-similarity-change.html#cb322-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-55"><a href="rsa-on-pattern-similarity-change.html#cb322-55" aria-hidden="true" tabindex="-1"></a>f0b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ps_dist_hat_df, <span class="fu">aes</span>(<span class="at">x=</span>Var1, <span class="at">y=</span>Var2, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb322-56"><a href="rsa-on-pattern-similarity-change.html#cb322-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb322-57"><a href="rsa-on-pattern-similarity-change.html#cb322-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb322-58"><a href="rsa-on-pattern-similarity-change.html#cb322-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;buda&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb322-59"><a href="rsa-on-pattern-similarity-change.html#cb322-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb322-60"><a href="rsa-on-pattern-similarity-change.html#cb322-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()<span class="sc">+</span> <span class="co">#theme(aspect.ratio = 1) +</span></span>
<span id="cb322-61"><a href="rsa-on-pattern-similarity-change.html#cb322-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;corresponding distance matrix&quot;</span>) <span class="sc">+</span> </span>
<span id="cb322-62"><a href="rsa-on-pattern-similarity-change.html#cb322-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;events by day&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-63"><a href="rsa-on-pattern-similarity-change.html#cb322-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;events by day&quot;</span>) <span class="sc">+</span></span>
<span id="cb322-64"><a href="rsa-on-pattern-similarity-change.html#cb322-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;distance&quot;</span>)</span>
<span id="cb322-65"><a href="rsa-on-pattern-similarity-change.html#cb322-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-66"><a href="rsa-on-pattern-similarity-change.html#cb322-66" aria-hidden="true" tabindex="-1"></a>f0a <span class="sc">+</span>f0b <span class="sc">&amp;</span></span>
<span id="cb322-67"><a href="rsa-on-pattern-similarity-change.html#cb322-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>,</span>
<span id="cb322-68"><a href="rsa-on-pattern-similarity-change.html#cb322-68" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">&quot;MDS based on mixed model fitted to aHPC pattern similarity change&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb322-69"><a href="rsa-on-pattern-similarity-change.html#cb322-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb322-70"><a href="rsa-on-pattern-similarity-change.html#cb322-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb322-71"><a href="rsa-on-pattern-similarity-change.html#cb322-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb322-72"><a href="rsa-on-pattern-similarity-change.html#cb322-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb322-73"><a href="rsa-on-pattern-similarity-change.html#cb322-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>,</span>
<span id="cb322-74"><a href="rsa-on-pattern-similarity-change.html#cb322-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="rsa-on-pattern-similarity-change.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make plot of lower triangle only of the resulting distance matrix</span></span>
<span id="cb323-2"><a href="rsa-on-pattern-similarity-change.html#cb323-2" aria-hidden="true" tabindex="-1"></a>lt <span class="ot">&lt;-</span> <span class="fu">upper.tri</span>(ps_dist_hat_mat, <span class="at">diag =</span> <span class="cn">TRUE</span>)</span>
<span id="cb323-3"><a href="rsa-on-pattern-similarity-change.html#cb323-3" aria-hidden="true" tabindex="-1"></a>lt_df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(lt)</span>
<span id="cb323-4"><a href="rsa-on-pattern-similarity-change.html#cb323-4" aria-hidden="true" tabindex="-1"></a>ps_dist_hat_df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(ps_dist_hat_mat)</span>
<span id="cb323-5"><a href="rsa-on-pattern-similarity-change.html#cb323-5" aria-hidden="true" tabindex="-1"></a>ps_dist_hat_df<span class="ot">&lt;-</span>ps_dist_hat_df[lt_df<span class="sc">$</span>value,]</span>
<span id="cb323-6"><a href="rsa-on-pattern-similarity-change.html#cb323-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-7"><a href="rsa-on-pattern-similarity-change.html#cb323-7" aria-hidden="true" tabindex="-1"></a>sfig_mds_input <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ps_dist_hat_df, <span class="fu">aes</span>(<span class="at">x=</span>Var1, <span class="at">y=</span>Var2, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb323-8"><a href="rsa-on-pattern-similarity-change.html#cb323-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb323-9"><a href="rsa-on-pattern-similarity-change.html#cb323-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb323-10"><a href="rsa-on-pattern-similarity-change.html#cb323-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;buda&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb323-11"><a href="rsa-on-pattern-similarity-change.html#cb323-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb323-12"><a href="rsa-on-pattern-similarity-change.html#cb323-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb323-13"><a href="rsa-on-pattern-similarity-change.html#cb323-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;events by sequence&quot;</span>) <span class="sc">+</span></span>
<span id="cb323-14"><a href="rsa-on-pattern-similarity-change.html#cb323-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;events by sequence&quot;</span>) <span class="sc">+</span></span>
<span id="cb323-15"><a href="rsa-on-pattern-similarity-change.html#cb323-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&quot;distance&quot;</span>, <span class="at">title.hjust =</span> <span class="dv">1</span>, <span class="at">barwidth =</span> <span class="fl">0.3</span>, <span class="at">barheight =</span> <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb323-16"><a href="rsa-on-pattern-similarity-change.html#cb323-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>, <span class="at">family =</span> font2use),</span>
<span id="cb323-17"><a href="rsa-on-pattern-similarity-change.html#cb323-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb323-18"><a href="rsa-on-pattern-similarity-change.html#cb323-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb323-19"><a href="rsa-on-pattern-similarity-change.html#cb323-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb323-20"><a href="rsa-on-pattern-similarity-change.html#cb323-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb323-21"><a href="rsa-on-pattern-similarity-change.html#cb323-21" aria-hidden="true" tabindex="-1"></a>sfig_mds_input</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-175-2.png" width="672" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="rsa-on-pattern-similarity-change.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print</span></span>
<span id="cb324-2"><a href="rsa-on-pattern-similarity-change.html#cb324-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;mds_input_mat&quot;</span>)</span>
<span id="cb324-3"><a href="rsa-on-pattern-similarity-change.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig_mds_input, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb324-4"><a href="rsa-on-pattern-similarity-change.html#cb324-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">3</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb324-5"><a href="rsa-on-pattern-similarity-change.html#cb324-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig_mds_input, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb324-6"><a href="rsa-on-pattern-similarity-change.html#cb324-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">3</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<p>We are now ready to run MDS. We subject the distance matrix to MDS using an ordinal model (i.e. non-metric MDS) using two dimensions. Because MDS is sensitive to the starting configuration, we run MDS many times using random starting configurations. From the resulting configurations, we pick the one resulting in the lowest stress. This procedure is described in the <a href="https://cran.r-project.org/web/packages/smacof/vignettes/smacof.pdf">vignette</a> of the <a href="https://cran.r-project.org/web/packages/smacof/index.html">smacof-package</a>, which we use for these analyses.</p>
<blockquote>
<p>Using the smacof-package111, the model-predicted similarities were converted to distances and the resulting distance matrix (Supplemental Figure 6D) was subjected to non-metric multidimensional scaling using two dimensions. We chose two dimensions to be able to intuitively visualize the results. Because MDS is sensitive to starting values, we ran multidimensional scaling 1000 times with random initial configurations and visualized the resulting configuration with the lowest stress value. Basing this analysis on the model-derived similarities assumes the same relationship of virtual temporal distances for all event pairs from different sequences, but we would like to note that not all solutions we observed, in particular those with higher stress values, resulted in parallel configurations for the four sequences.</p>
</blockquote>
<div id="metric-mds" class="section level4 unnumbered">
<h4>Metric MDS</h4>
<p>Let’s begin by testing out MDS using a ratio transformation.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="rsa-on-pattern-similarity-change.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because MDS is sensitive to the start configuration, let&#39;s run it with many different random configurations (take the best in the end)</span></span>
<span id="cb325-2"><a href="rsa-on-pattern-similarity-change.html#cb325-2" aria-hidden="true" tabindex="-1"></a>n_rand_starts <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb325-3"><a href="rsa-on-pattern-similarity-change.html#cb325-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-4"><a href="rsa-on-pattern-similarity-change.html#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="co"># maximum number of iterations</span></span>
<span id="cb325-5"><a href="rsa-on-pattern-similarity-change.html#cb325-5" aria-hidden="true" tabindex="-1"></a>max_it <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb325-6"><a href="rsa-on-pattern-similarity-change.html#cb325-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-7"><a href="rsa-on-pattern-similarity-change.html#cb325-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run MDS for 2 dimensions n_rand_starts times with random start configuration and store best fit</span></span>
<span id="cb325-8"><a href="rsa-on-pattern-similarity-change.html#cb325-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb325-9"><a href="rsa-on-pattern-similarity-change.html#cb325-9" aria-hidden="true" tabindex="-1"></a>stressvec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_rand_starts)</span>
<span id="cb325-10"><a href="rsa-on-pattern-similarity-change.html#cb325-10" aria-hidden="true" tabindex="-1"></a>fitbest <span class="ot">&lt;-</span> <span class="fu">mds</span>(ps_dist_hat_mat, <span class="at">ndim =</span> <span class="dv">2</span>, <span class="at">itmax =</span> max_it, <span class="at">init =</span> <span class="st">&quot;random&quot;</span>, <span class="at">type =</span> <span class="st">&quot;ratio&quot;</span>)</span>
<span id="cb325-11"><a href="rsa-on-pattern-similarity-change.html#cb325-11" aria-hidden="true" tabindex="-1"></a>stressvec[<span class="dv">1</span>] <span class="ot">&lt;-</span> fitbest<span class="sc">$</span>stress</span>
<span id="cb325-12"><a href="rsa-on-pattern-similarity-change.html#cb325-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-13"><a href="rsa-on-pattern-similarity-change.html#cb325-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_rand_starts) {</span>
<span id="cb325-14"><a href="rsa-on-pattern-similarity-change.html#cb325-14" aria-hidden="true" tabindex="-1"></a>  fitran <span class="ot">&lt;-</span> <span class="fu">mds</span>(ps_dist_hat_mat, <span class="at">ndim =</span> <span class="dv">2</span>, <span class="at">itmax =</span> max_it, <span class="at">init =</span> <span class="st">&quot;random&quot;</span>, <span class="at">type =</span> <span class="st">&quot;ratio&quot;</span>)</span>
<span id="cb325-15"><a href="rsa-on-pattern-similarity-change.html#cb325-15" aria-hidden="true" tabindex="-1"></a>  stressvec[i] <span class="ot">&lt;-</span> fitran<span class="sc">$</span>stress</span>
<span id="cb325-16"><a href="rsa-on-pattern-similarity-change.html#cb325-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (fitran<span class="sc">$</span>stress <span class="sc">&lt;</span> fitbest<span class="sc">$</span>stress){</span>
<span id="cb325-17"><a href="rsa-on-pattern-similarity-change.html#cb325-17" aria-hidden="true" tabindex="-1"></a>    fitbest <span class="ot">&lt;-</span> fitran}</span>
<span id="cb325-18"><a href="rsa-on-pattern-similarity-change.html#cb325-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb325-19"><a href="rsa-on-pattern-similarity-change.html#cb325-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-20"><a href="rsa-on-pattern-similarity-change.html#cb325-20" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame of resulting configuration</span></span>
<span id="cb325-21"><a href="rsa-on-pattern-similarity-change.html#cb325-21" aria-hidden="true" tabindex="-1"></a>conf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fitbest<span class="sc">$</span>conf)</span>
<span id="cb325-22"><a href="rsa-on-pattern-similarity-change.html#cb325-22" aria-hidden="true" tabindex="-1"></a>conf<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_days, <span class="at">each =</span> n_events_day))</span>
<span id="cb325-23"><a href="rsa-on-pattern-similarity-change.html#cb325-23" aria-hidden="true" tabindex="-1"></a>conf<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_events_day,n_days))</span>
<span id="cb325-24"><a href="rsa-on-pattern-similarity-change.html#cb325-24" aria-hidden="true" tabindex="-1"></a>conf<span class="sc">$</span>virtual_time <span class="ot">&lt;-</span> virtual_time</span>
<span id="cb325-25"><a href="rsa-on-pattern-similarity-change.html#cb325-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-26"><a href="rsa-on-pattern-similarity-change.html#cb325-26" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize as 2D scatter with lines of the configuration </span></span>
<span id="cb325-27"><a href="rsa-on-pattern-similarity-change.html#cb325-27" aria-hidden="true" tabindex="-1"></a>ratioMDS_confplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(conf, <span class="fu">aes</span>(<span class="at">x=</span>D1,<span class="at">y=</span>D2, <span class="at">group=</span>day, <span class="at">color=</span>virtual_time, <span class="at">fill=</span>virtual_time, <span class="at">shape=</span>event)) <span class="sc">+</span></span>
<span id="cb325-28"><a href="rsa-on-pattern-similarity-change.html#cb325-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>day),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-29"><a href="rsa-on-pattern-similarity-change.html#cb325-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;3111&quot;</span>)) <span class="sc">+</span></span>
<span id="cb325-30"><a href="rsa-on-pattern-similarity-change.html#cb325-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb325-31"><a href="rsa-on-pattern-similarity-change.html#cb325-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb325-32"><a href="rsa-on-pattern-similarity-change.html#cb325-32" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb325-33"><a href="rsa-on-pattern-similarity-change.html#cb325-33" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_color_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-34"><a href="rsa-on-pattern-similarity-change.html#cb325-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype=</span><span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;sequence&quot;</span>, <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">3</span>),</span>
<span id="cb325-35"><a href="rsa-on-pattern-similarity-change.html#cb325-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>), <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">2</span>),</span>
<span id="cb325-36"><a href="rsa-on-pattern-similarity-change.html#cb325-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&quot;virtual time&quot;</span>, <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="dv">1</span>, <span class="at">barwidth =</span> <span class="dv">2</span>, <span class="at">barheight =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">1</span>),</span>
<span id="cb325-37"><a href="rsa-on-pattern-similarity-change.html#cb325-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">color=</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb325-38"><a href="rsa-on-pattern-similarity-change.html#cb325-38" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb325-39"><a href="rsa-on-pattern-similarity-change.html#cb325-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;dimension 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-40"><a href="rsa-on-pattern-similarity-change.html#cb325-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;dimension 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-41"><a href="rsa-on-pattern-similarity-change.html#cb325-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb325-42"><a href="rsa-on-pattern-similarity-change.html#cb325-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb325-43"><a href="rsa-on-pattern-similarity-change.html#cb325-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#aspect.ratio = 1,</span></span>
<span id="cb325-44"><a href="rsa-on-pattern-similarity-change.html#cb325-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&#39;mm&#39;</span>),</span>
<span id="cb325-45"><a href="rsa-on-pattern-similarity-change.html#cb325-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb325-46"><a href="rsa-on-pattern-similarity-change.html#cb325-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">#legend.margin = margin(0,0,0,0.5, unit=&quot;cm&quot;),</span></span>
<span id="cb325-47"><a href="rsa-on-pattern-similarity-change.html#cb325-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb325-48"><a href="rsa-on-pattern-similarity-change.html#cb325-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb325-49"><a href="rsa-on-pattern-similarity-change.html#cb325-49" aria-hidden="true" tabindex="-1"></a>ratioMDS_confplot</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
<p>Let’s test how good this fit really is. As described in the smacof-vignette, one way to do so is to run a permutation test to compare the observed stress value against a surrogate distribution generated from applying MDS to a shuffled distance matrix. To visualize the result, we plot a histogram of the permutation distribution as well as the critical (5th percentile) and the observed stress value.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="rsa-on-pattern-similarity-change.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation test to assess fit relative to permuted data</span></span>
<span id="cb326-2"><a href="rsa-on-pattern-similarity-change.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb326-3"><a href="rsa-on-pattern-similarity-change.html#cb326-3" aria-hidden="true" tabindex="-1"></a>perm_fitbest <span class="ot">&lt;-</span> <span class="fu">permtest</span>(fitbest, <span class="at">nrep =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb326-4"><a href="rsa-on-pattern-similarity-change.html#cb326-4" aria-hidden="true" tabindex="-1"></a>perm_fitbest</span></code></pre></div>
<pre><code>## 
## Call: permtest.smacof(object = fitbest, nrep = 1000, verbose = FALSE)
## 
## SMACOF Permutation Test
## Number of objects: 20 
## Number of replications (permutations): 1000 
## 
## Observed stress value: 0.366 
## p-value: 0.999</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="rsa-on-pattern-similarity-change.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get p and z-value</span></span>
<span id="cb328-2"><a href="rsa-on-pattern-similarity-change.html#cb328-2" aria-hidden="true" tabindex="-1"></a>p_perm <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">c</span>(perm_fitbest<span class="sc">$</span>stress.obs, perm_fitbest<span class="sc">$</span>stressvec) <span class="sc">&lt;=</span> perm_fitbest<span class="sc">$</span>stress.obs)<span class="sc">/</span>(perm_fitbest<span class="sc">$</span>nrep<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb328-3"><a href="rsa-on-pattern-similarity-change.html#cb328-3" aria-hidden="true" tabindex="-1"></a>z_perm <span class="ot">&lt;-</span> (perm_fitbest<span class="sc">$</span>stress.obs<span class="sc">-</span><span class="fu">mean</span>(perm_fitbest<span class="sc">$</span>stressvec))<span class="sc">/</span><span class="fu">sd</span>(perm_fitbest<span class="sc">$</span>stressvec)</span>
<span id="cb328-4"><a href="rsa-on-pattern-similarity-change.html#cb328-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-5"><a href="rsa-on-pattern-similarity-change.html#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of permutation test results</span></span>
<span id="cb328-6"><a href="rsa-on-pattern-similarity-change.html#cb328-6" aria-hidden="true" tabindex="-1"></a>perm_fitbest_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">stress_perms =</span> perm_fitbest<span class="sc">$</span>stressvec)</span>
<span id="cb328-7"><a href="rsa-on-pattern-similarity-change.html#cb328-7" aria-hidden="true" tabindex="-1"></a>prctile <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">expression</span>(<span class="dv">95</span><span class="sc">^</span>{th}<span class="sc">*</span><span class="st">&quot; percentile&quot;</span>))</span>
<span id="cb328-8"><a href="rsa-on-pattern-similarity-change.html#cb328-8" aria-hidden="true" tabindex="-1"></a>ratioMDS_permplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(perm_fitbest_df, <span class="fu">aes</span>(<span class="at">x=</span>stress_perms)) <span class="sc">+</span></span>
<span id="cb328-9"><a href="rsa-on-pattern-similarity-change.html#cb328-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">stat</span>(width<span class="sc">*</span>density)), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> ultimate_gray) <span class="sc">+</span></span>
<span id="cb328-10"><a href="rsa-on-pattern-similarity-change.html#cb328-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> perm_fitbest<span class="sc">$</span>stress.obs, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> perm_fitbest<span class="sc">$</span>stress.obs, <span class="at">yend =</span> <span class="fl">0.02</span>), </span>
<span id="cb328-11"><a href="rsa-on-pattern-similarity-change.html#cb328-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;#972D15&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-12"><a href="rsa-on-pattern-similarity-change.html#cb328-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(stress_perms, <span class="fl">0.05</span>), <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb328-13"><a href="rsa-on-pattern-similarity-change.html#cb328-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fu">quantile</span>(stress_perms, <span class="fl">0.05</span>), <span class="at">yend =</span> <span class="fl">0.04</span>), </span>
<span id="cb328-14"><a href="rsa-on-pattern-similarity-change.html#cb328-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;Black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-15"><a href="rsa-on-pattern-similarity-change.html#cb328-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">quantile</span>(stress_perms, <span class="at">probs=</span><span class="fl">0.05</span>), <span class="at">y=</span><span class="fl">0.04</span>, <span class="at">label =</span> prctile), </span>
<span id="cb328-16"><a href="rsa-on-pattern-similarity-change.html#cb328-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust=</span><span class="dv">0</span>, <span class="at">vjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;BLACK&quot;</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb328-17"><a href="rsa-on-pattern-similarity-change.html#cb328-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">label.size =</span> <span class="dv">1</span><span class="sc">/</span>.pt,) <span class="sc">+</span></span>
<span id="cb328-18"><a href="rsa-on-pattern-similarity-change.html#cb328-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span>perm_fitbest<span class="sc">$</span>stress.obs, <span class="at">y=</span><span class="fl">0.02</span>, <span class="at">label=</span><span class="st">&quot;observed stress&quot;</span>), </span>
<span id="cb328-19"><a href="rsa-on-pattern-similarity-change.html#cb328-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">label.size =</span> <span class="dv">1</span><span class="sc">/</span>.pt,</span>
<span id="cb328-20"><a href="rsa-on-pattern-similarity-change.html#cb328-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;#972D15&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-21"><a href="rsa-on-pattern-similarity-change.html#cb328-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb328-22"><a href="rsa-on-pattern-similarity-change.html#cb328-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;% of shuffles&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-23"><a href="rsa-on-pattern-similarity-change.html#cb328-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;stress (null distr.)&quot;</span>) <span class="sc">+</span></span>
<span id="cb328-24"><a href="rsa-on-pattern-similarity-change.html#cb328-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb328-25"><a href="rsa-on-pattern-similarity-change.html#cb328-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb328-26"><a href="rsa-on-pattern-similarity-change.html#cb328-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb328-27"><a href="rsa-on-pattern-similarity-change.html#cb328-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb328-28"><a href="rsa-on-pattern-similarity-change.html#cb328-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb328-29"><a href="rsa-on-pattern-similarity-change.html#cb328-29" aria-hidden="true" tabindex="-1"></a>ratioMDS_permplot</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<p>Permutation test of observed stress against shuffles for metric (ratio) MDS:
z=3.3, p=0.999</p>
</div>
<div id="non-metric-mds" class="section level4 unnumbered">
<h4>Non-metric MDS</h4>
<p>Because the permutation test is not significant for metric MDS, we continue with non-metric MDS.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="rsa-on-pattern-similarity-change.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because MDS is sensitive to the start configuration, let&#39;s run it with many different random configurations (take the best in the end)</span></span>
<span id="cb329-2"><a href="rsa-on-pattern-similarity-change.html#cb329-2" aria-hidden="true" tabindex="-1"></a>n_rand_starts <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb329-3"><a href="rsa-on-pattern-similarity-change.html#cb329-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-4"><a href="rsa-on-pattern-similarity-change.html#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="co"># maximum number of iterations</span></span>
<span id="cb329-5"><a href="rsa-on-pattern-similarity-change.html#cb329-5" aria-hidden="true" tabindex="-1"></a>max_it <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb329-6"><a href="rsa-on-pattern-similarity-change.html#cb329-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb329-7"><a href="rsa-on-pattern-similarity-change.html#cb329-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run MDS for 2 dimensions n_rand_starts times with random start configuration and store best fit</span></span>
<span id="cb329-8"><a href="rsa-on-pattern-similarity-change.html#cb329-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb329-9"><a href="rsa-on-pattern-similarity-change.html#cb329-9" aria-hidden="true" tabindex="-1"></a>stressvec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_rand_starts)</span>
<span id="cb329-10"><a href="rsa-on-pattern-similarity-change.html#cb329-10" aria-hidden="true" tabindex="-1"></a>fitbest <span class="ot">&lt;-</span> <span class="fu">mds</span>(ps_dist_hat_mat, <span class="at">ndim =</span> <span class="dv">2</span>, <span class="at">itmax =</span> max_it, <span class="at">init =</span> <span class="st">&quot;random&quot;</span>, <span class="at">type =</span> <span class="st">&quot;ordinal&quot;</span>)</span>
<span id="cb329-11"><a href="rsa-on-pattern-similarity-change.html#cb329-11" aria-hidden="true" tabindex="-1"></a>stressvec[<span class="dv">1</span>] <span class="ot">&lt;-</span> fitbest<span class="sc">$</span>stress</span>
<span id="cb329-12"><a href="rsa-on-pattern-similarity-change.html#cb329-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-13"><a href="rsa-on-pattern-similarity-change.html#cb329-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_rand_starts) {</span>
<span id="cb329-14"><a href="rsa-on-pattern-similarity-change.html#cb329-14" aria-hidden="true" tabindex="-1"></a>  fitran <span class="ot">&lt;-</span> <span class="fu">mds</span>(ps_dist_hat_mat, <span class="at">ndim =</span> <span class="dv">2</span>, <span class="at">itmax =</span> max_it, <span class="at">init =</span> <span class="st">&quot;random&quot;</span>, <span class="at">type =</span> <span class="st">&quot;ordinal&quot;</span>)</span>
<span id="cb329-15"><a href="rsa-on-pattern-similarity-change.html#cb329-15" aria-hidden="true" tabindex="-1"></a>  stressvec[i] <span class="ot">&lt;-</span> fitran<span class="sc">$</span>stress</span>
<span id="cb329-16"><a href="rsa-on-pattern-similarity-change.html#cb329-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (fitran<span class="sc">$</span>stress <span class="sc">&lt;</span> fitbest<span class="sc">$</span>stress){</span>
<span id="cb329-17"><a href="rsa-on-pattern-similarity-change.html#cb329-17" aria-hidden="true" tabindex="-1"></a>    fitbest <span class="ot">&lt;-</span> fitran}</span>
<span id="cb329-18"><a href="rsa-on-pattern-similarity-change.html#cb329-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb329-19"><a href="rsa-on-pattern-similarity-change.html#cb329-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb329-20"><a href="rsa-on-pattern-similarity-change.html#cb329-20" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame of resulting configuration</span></span>
<span id="cb329-21"><a href="rsa-on-pattern-similarity-change.html#cb329-21" aria-hidden="true" tabindex="-1"></a>conf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fitbest<span class="sc">$</span>conf)</span>
<span id="cb329-22"><a href="rsa-on-pattern-similarity-change.html#cb329-22" aria-hidden="true" tabindex="-1"></a>conf<span class="sc">$</span>day <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_days, <span class="at">each =</span> n_events_day))</span>
<span id="cb329-23"><a href="rsa-on-pattern-similarity-change.html#cb329-23" aria-hidden="true" tabindex="-1"></a>conf<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_events_day,n_days))</span>
<span id="cb329-24"><a href="rsa-on-pattern-similarity-change.html#cb329-24" aria-hidden="true" tabindex="-1"></a>conf<span class="sc">$</span>virtual_time <span class="ot">&lt;-</span> virtual_time</span>
<span id="cb329-25"><a href="rsa-on-pattern-similarity-change.html#cb329-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb329-26"><a href="rsa-on-pattern-similarity-change.html#cb329-26" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize as 2D scatter with lines of the configuration </span></span>
<span id="cb329-27"><a href="rsa-on-pattern-similarity-change.html#cb329-27" aria-hidden="true" tabindex="-1"></a>f5c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(conf, <span class="fu">aes</span>(<span class="at">x=</span>D1,<span class="at">y=</span>D2, <span class="at">group=</span>day, <span class="at">color=</span>virtual_time, <span class="at">fill=</span>virtual_time, <span class="at">shape=</span>event)) <span class="sc">+</span></span>
<span id="cb329-28"><a href="rsa-on-pattern-similarity-change.html#cb329-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>day),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb329-29"><a href="rsa-on-pattern-similarity-change.html#cb329-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;3111&quot;</span>)) <span class="sc">+</span></span>
<span id="cb329-30"><a href="rsa-on-pattern-similarity-change.html#cb329-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb329-31"><a href="rsa-on-pattern-similarity-change.html#cb329-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb329-32"><a href="rsa-on-pattern-similarity-change.html#cb329-32" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb329-33"><a href="rsa-on-pattern-similarity-change.html#cb329-33" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_color_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>) <span class="sc">+</span></span>
<span id="cb329-34"><a href="rsa-on-pattern-similarity-change.html#cb329-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype=</span><span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;sequence&quot;</span>, <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">3</span>),</span>
<span id="cb329-35"><a href="rsa-on-pattern-similarity-change.html#cb329-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>), <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">2</span>),</span>
<span id="cb329-36"><a href="rsa-on-pattern-similarity-change.html#cb329-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&quot;virtual time&quot;</span>, <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="dv">1</span>, <span class="at">barwidth =</span> <span class="dv">2</span>, <span class="at">barheight =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">1</span>),</span>
<span id="cb329-37"><a href="rsa-on-pattern-similarity-change.html#cb329-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">color=</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb329-38"><a href="rsa-on-pattern-similarity-change.html#cb329-38" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb329-39"><a href="rsa-on-pattern-similarity-change.html#cb329-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;dimension 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb329-40"><a href="rsa-on-pattern-similarity-change.html#cb329-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;dimension 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb329-41"><a href="rsa-on-pattern-similarity-change.html#cb329-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb329-42"><a href="rsa-on-pattern-similarity-change.html#cb329-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb329-43"><a href="rsa-on-pattern-similarity-change.html#cb329-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#aspect.ratio = 1,</span></span>
<span id="cb329-44"><a href="rsa-on-pattern-similarity-change.html#cb329-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&#39;mm&#39;</span>),</span>
<span id="cb329-45"><a href="rsa-on-pattern-similarity-change.html#cb329-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb329-46"><a href="rsa-on-pattern-similarity-change.html#cb329-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">#legend.margin = margin(0,0,0,0.5, unit=&quot;cm&quot;),</span></span>
<span id="cb329-47"><a href="rsa-on-pattern-similarity-change.html#cb329-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb329-48"><a href="rsa-on-pattern-similarity-change.html#cb329-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb329-49"><a href="rsa-on-pattern-similarity-change.html#cb329-49" aria-hidden="true" tabindex="-1"></a>f5c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="rsa-on-pattern-similarity-change.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb330-2"><a href="rsa-on-pattern-similarity-change.html#cb330-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f5c)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb330-3"><a href="rsa-on-pattern-similarity-change.html#cb330-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x, y, colour, group, shape), </span>
<span id="cb330-4"><a href="rsa-on-pattern-similarity-change.html#cb330-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f5c.txt&quot;</span>))</span>
<span id="cb330-5"><a href="rsa-on-pattern-similarity-change.html#cb330-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-6"><a href="rsa-on-pattern-similarity-change.html#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="co">#comparing metric and non-metric MDS</span></span>
<span id="cb330-7"><a href="rsa-on-pattern-similarity-change.html#cb330-7" aria-hidden="true" tabindex="-1"></a>mds_fig <span class="ot">&lt;-</span> f5c <span class="sc">+</span> ratioMDS_confplot <span class="sc">+</span> </span>
<span id="cb330-8"><a href="rsa-on-pattern-similarity-change.html#cb330-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb330-9"><a href="rsa-on-pattern-similarity-change.html#cb330-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb330-10"><a href="rsa-on-pattern-similarity-change.html#cb330-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb330-11"><a href="rsa-on-pattern-similarity-change.html#cb330-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb330-12"><a href="rsa-on-pattern-similarity-change.html#cb330-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb330-13"><a href="rsa-on-pattern-similarity-change.html#cb330-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">&amp;</span></span>
<span id="cb330-14"><a href="rsa-on-pattern-similarity-change.html#cb330-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb330-15"><a href="rsa-on-pattern-similarity-change.html#cb330-15" aria-hidden="true" tabindex="-1"></a>mds_fig[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> mds_fig[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;non-metric MDS&quot;</span>)</span>
<span id="cb330-16"><a href="rsa-on-pattern-similarity-change.html#cb330-16" aria-hidden="true" tabindex="-1"></a>mds_fig[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> mds_fig[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;metric MDS&quot;</span>)</span>
<span id="cb330-17"><a href="rsa-on-pattern-similarity-change.html#cb330-17" aria-hidden="true" tabindex="-1"></a>mds_fig <span class="ot">&lt;-</span> mds_fig <span class="sc">&amp;</span></span>
<span id="cb330-18"><a href="rsa-on-pattern-similarity-change.html#cb330-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb330-19"><a href="rsa-on-pattern-similarity-change.html#cb330-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb330-20"><a href="rsa-on-pattern-similarity-change.html#cb330-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb330-21"><a href="rsa-on-pattern-similarity-change.html#cb330-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb330-22"><a href="rsa-on-pattern-similarity-change.html#cb330-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb330-23"><a href="rsa-on-pattern-similarity-change.html#cb330-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb330-24"><a href="rsa-on-pattern-similarity-change.html#cb330-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb330-25"><a href="rsa-on-pattern-similarity-change.html#cb330-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-26"><a href="rsa-on-pattern-similarity-change.html#cb330-26" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print (height was 18 when incl. searchlights)</span></span>
<span id="cb330-27"><a href="rsa-on-pattern-similarity-change.html#cb330-27" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;mds_fig&quot;</span>)</span>
<span id="cb330-28"><a href="rsa-on-pattern-similarity-change.html#cb330-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>mds_fig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb330-29"><a href="rsa-on-pattern-similarity-change.html#cb330-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">14.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span>
<span id="cb330-30"><a href="rsa-on-pattern-similarity-change.html#cb330-30" aria-hidden="true" tabindex="-1"></a>mds_fig</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-178-2.png" width="672" /></p>
<p>Let’s test how good the non-metric fit really is. As described in the smacof-vignette, one way to do so is to run a permutation test to compare the observed stress value against a surrogate distribution generated from applying MDS to a shuffled distance matrix. To visualize the result, we plot a histogram of the permutation distribution as well as the critical (5th percentile) and the observed stress value.</p>
<blockquote>
<p>We tested the stress value of the resulting configuration against a surrogate distribution of stress values obtained from permuting the input distances on each of 1000 iterations. Using the mean and standard deviation of the resulting null distribution, we obtained a z-value as a test statistic and report the proportion of stress values in the null distribution that were equal to or smaller than the observed stress value (Supplemental Figure 6E).</p>
</blockquote>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="rsa-on-pattern-similarity-change.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation test to assess fit relative to permuted data</span></span>
<span id="cb331-2"><a href="rsa-on-pattern-similarity-change.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb331-3"><a href="rsa-on-pattern-similarity-change.html#cb331-3" aria-hidden="true" tabindex="-1"></a>perm_fitbest <span class="ot">&lt;-</span> <span class="fu">permtest</span>(fitbest, <span class="at">nrep =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb331-4"><a href="rsa-on-pattern-similarity-change.html#cb331-4" aria-hidden="true" tabindex="-1"></a>perm_fitbest</span></code></pre></div>
<pre><code>## 
## Call: permtest.smacof(object = fitbest, nrep = 1000, verbose = FALSE)
## 
## SMACOF Permutation Test
## Number of objects: 20 
## Number of replications (permutations): 1000 
## 
## Observed stress value: 0.261 
## p-value: &lt;0.001</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="rsa-on-pattern-similarity-change.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get p and z-value</span></span>
<span id="cb333-2"><a href="rsa-on-pattern-similarity-change.html#cb333-2" aria-hidden="true" tabindex="-1"></a>p_perm <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">c</span>(perm_fitbest<span class="sc">$</span>stress.obs, perm_fitbest<span class="sc">$</span>stressvec) <span class="sc">&lt;=</span> perm_fitbest<span class="sc">$</span>stress.obs)<span class="sc">/</span>(perm_fitbest<span class="sc">$</span>nrep<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb333-3"><a href="rsa-on-pattern-similarity-change.html#cb333-3" aria-hidden="true" tabindex="-1"></a>z_perm <span class="ot">&lt;-</span> (perm_fitbest<span class="sc">$</span>stress.obs<span class="sc">-</span><span class="fu">mean</span>(perm_fitbest<span class="sc">$</span>stressvec))<span class="sc">/</span><span class="fu">sd</span>(perm_fitbest<span class="sc">$</span>stressvec)</span>
<span id="cb333-4"><a href="rsa-on-pattern-similarity-change.html#cb333-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-5"><a href="rsa-on-pattern-similarity-change.html#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of permutation test results</span></span>
<span id="cb333-6"><a href="rsa-on-pattern-similarity-change.html#cb333-6" aria-hidden="true" tabindex="-1"></a>perm_fitbest_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">stress_perms =</span> perm_fitbest<span class="sc">$</span>stressvec)</span>
<span id="cb333-7"><a href="rsa-on-pattern-similarity-change.html#cb333-7" aria-hidden="true" tabindex="-1"></a>prctile <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">expression</span>(<span class="dv">95</span><span class="sc">^</span>{th}<span class="sc">*</span><span class="st">&quot; percentile&quot;</span>))</span>
<span id="cb333-8"><a href="rsa-on-pattern-similarity-change.html#cb333-8" aria-hidden="true" tabindex="-1"></a>sfig6_e <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(perm_fitbest_df, <span class="fu">aes</span>(<span class="at">x=</span>stress_perms)) <span class="sc">+</span></span>
<span id="cb333-9"><a href="rsa-on-pattern-similarity-change.html#cb333-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">stat</span>(width<span class="sc">*</span>density)), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> ultimate_gray) <span class="sc">+</span></span>
<span id="cb333-10"><a href="rsa-on-pattern-similarity-change.html#cb333-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> perm_fitbest<span class="sc">$</span>stress.obs, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> perm_fitbest<span class="sc">$</span>stress.obs, <span class="at">yend =</span> <span class="fl">0.02</span>), </span>
<span id="cb333-11"><a href="rsa-on-pattern-similarity-change.html#cb333-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;#972D15&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-12"><a href="rsa-on-pattern-similarity-change.html#cb333-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">quantile</span>(stress_perms, <span class="fl">0.05</span>), <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb333-13"><a href="rsa-on-pattern-similarity-change.html#cb333-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fu">quantile</span>(stress_perms, <span class="fl">0.05</span>), <span class="at">yend =</span> <span class="fl">0.04</span>), </span>
<span id="cb333-14"><a href="rsa-on-pattern-similarity-change.html#cb333-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;Black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-15"><a href="rsa-on-pattern-similarity-change.html#cb333-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">quantile</span>(stress_perms, <span class="at">probs=</span><span class="fl">0.05</span>), <span class="at">y=</span><span class="fl">0.04</span>, <span class="at">label =</span> prctile), </span>
<span id="cb333-16"><a href="rsa-on-pattern-similarity-change.html#cb333-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust=</span><span class="dv">0</span>, <span class="at">vjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;BLACK&quot;</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb333-17"><a href="rsa-on-pattern-similarity-change.html#cb333-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">label.size =</span> <span class="dv">1</span><span class="sc">/</span>.pt,) <span class="sc">+</span></span>
<span id="cb333-18"><a href="rsa-on-pattern-similarity-change.html#cb333-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span>perm_fitbest<span class="sc">$</span>stress.obs, <span class="at">y=</span><span class="fl">0.02</span>, <span class="at">label=</span><span class="st">&quot;observed stress&quot;</span>), </span>
<span id="cb333-19"><a href="rsa-on-pattern-similarity-change.html#cb333-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">label.size =</span> <span class="dv">1</span><span class="sc">/</span>.pt,</span>
<span id="cb333-20"><a href="rsa-on-pattern-similarity-change.html#cb333-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust=</span><span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;#972D15&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-21"><a href="rsa-on-pattern-similarity-change.html#cb333-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb333-22"><a href="rsa-on-pattern-similarity-change.html#cb333-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;% of shuffles&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-23"><a href="rsa-on-pattern-similarity-change.html#cb333-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;stress (null distr.)&quot;</span>) <span class="sc">+</span></span>
<span id="cb333-24"><a href="rsa-on-pattern-similarity-change.html#cb333-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb333-25"><a href="rsa-on-pattern-similarity-change.html#cb333-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb333-26"><a href="rsa-on-pattern-similarity-change.html#cb333-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb333-27"><a href="rsa-on-pattern-similarity-change.html#cb333-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb333-28"><a href="rsa-on-pattern-similarity-change.html#cb333-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb333-29"><a href="rsa-on-pattern-similarity-change.html#cb333-29" aria-hidden="true" tabindex="-1"></a>sfig6_e</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>Permutation test of observed stress against shuffles for non-metric (ordinal) MDS:
z=-3.5, p=0.001</p>
<p>To test whether the resulting configuration exhibits higher distances between pairs of events that have a high input distance we run a t-test for independent samples based on a median split (high vs. low input distance).</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="rsa-on-pattern-similarity-change.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataframe that includes event and MDS configuration information</span></span>
<span id="cb334-2"><a href="rsa-on-pattern-similarity-change.html#cb334-2" aria-hidden="true" tabindex="-1"></a>idx_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">TRUE</span>, <span class="at">nrow=</span><span class="dv">20</span>, <span class="at">ncol=</span><span class="dv">20</span>)</span>
<span id="cb334-3"><a href="rsa-on-pattern-similarity-change.html#cb334-3" aria-hidden="true" tabindex="-1"></a>fit_best_df<span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">day1 =</span> day[<span class="fu">which</span>(<span class="fu">lower.tri</span>(idx_mat), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="st">&quot;row&quot;</span>]],</span>
<span id="cb334-4"><a href="rsa-on-pattern-similarity-change.html#cb334-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">day2 =</span> day[<span class="fu">which</span>(<span class="fu">lower.tri</span>(idx_mat), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="st">&quot;col&quot;</span>]],</span>
<span id="cb334-5"><a href="rsa-on-pattern-similarity-change.html#cb334-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">event1 =</span> event[<span class="fu">which</span>(<span class="fu">lower.tri</span>(idx_mat), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="st">&quot;row&quot;</span>]],</span>
<span id="cb334-6"><a href="rsa-on-pattern-similarity-change.html#cb334-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">event2 =</span> event[<span class="fu">which</span>(<span class="fu">lower.tri</span>(idx_mat), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)[,<span class="st">&quot;col&quot;</span>]],</span>
<span id="cb334-7"><a href="rsa-on-pattern-similarity-change.html#cb334-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">delta =</span> <span class="fu">as.numeric</span>(fitbest<span class="sc">$</span>delta),</span>
<span id="cb334-8"><a href="rsa-on-pattern-similarity-change.html#cb334-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">confdist =</span> <span class="fu">as.numeric</span>(fitbest<span class="sc">$</span>confdist),</span>
<span id="cb334-9"><a href="rsa-on-pattern-similarity-change.html#cb334-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">same_day =</span> day1 <span class="sc">==</span> day2)</span>
<span id="cb334-10"><a href="rsa-on-pattern-similarity-change.html#cb334-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-11"><a href="rsa-on-pattern-similarity-change.html#cb334-11" aria-hidden="true" tabindex="-1"></a><span class="co"># median split variable based on input distances (delta)</span></span>
<span id="cb334-12"><a href="rsa-on-pattern-similarity-change.html#cb334-12" aria-hidden="true" tabindex="-1"></a>fit_best_df <span class="ot">&lt;-</span> fit_best_df <span class="sc">%&gt;%</span></span>
<span id="cb334-13"><a href="rsa-on-pattern-similarity-change.html#cb334-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">high_low =</span> sjmisc<span class="sc">::</span><span class="fu">dicho</span>(fit_best_df<span class="sc">$</span>delta),</span>
<span id="cb334-14"><a href="rsa-on-pattern-similarity-change.html#cb334-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">high_low_f =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(high_low <span class="sc">==</span><span class="dv">1</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>))) </span>
<span id="cb334-15"><a href="rsa-on-pattern-similarity-change.html#cb334-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-16"><a href="rsa-on-pattern-similarity-change.html#cb334-16" aria-hidden="true" tabindex="-1"></a><span class="co"># do t-test based on median split</span></span>
<span id="cb334-17"><a href="rsa-on-pattern-similarity-change.html#cb334-17" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> fit_best_df <span class="sc">%&gt;%</span></span>
<span id="cb334-18"><a href="rsa-on-pattern-similarity-change.html#cb334-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">t.test</span>(confdist <span class="sc">~</span> high_low_f, <span class="at">data =</span> ., <span class="at">var.equal =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb334-19"><a href="rsa-on-pattern-similarity-change.html#cb334-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-20"><a href="rsa-on-pattern-similarity-change.html#cb334-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for independent samples</span></span>
<span id="cb334-21"><a href="rsa-on-pattern-similarity-change.html#cb334-21" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d =</span> fit_best_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(high_low_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(confdist),</span>
<span id="cb334-22"><a href="rsa-on-pattern-similarity-change.html#cb334-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">f =</span> fit_best_df<span class="sc">%&gt;%</span><span class="fu">filter</span>(high_low_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(confdist), </span>
<span id="cb334-23"><a href="rsa-on-pattern-similarity-change.html#cb334-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">paired=</span><span class="cn">FALSE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">FALSE</span>)</span>
<span id="cb334-24"><a href="rsa-on-pattern-similarity-change.html#cb334-24" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb334-25"><a href="rsa-on-pattern-similarity-change.html#cb334-25" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb334-26"><a href="rsa-on-pattern-similarity-change.html#cb334-26" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb334-27"><a href="rsa-on-pattern-similarity-change.html#cb334-27" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-180">
<col><col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate1</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate2</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.419</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.683</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.35</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.71e-17</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">188</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.331</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.507</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Two Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.35</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.67</td></tr>
</table>

<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="rsa-on-pattern-similarity-change.html#cb335-1" aria-hidden="true" tabindex="-1"></a>sfig6_f <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit_best_df, <span class="fu">aes</span>(<span class="at">x=</span>high_low, <span class="at">y=</span>confdist, <span class="at">fill=</span>high_low, <span class="at">color=</span>high_low)) <span class="sc">+</span></span>
<span id="cb335-2"><a href="rsa-on-pattern-similarity-change.html#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb335-3"><a href="rsa-on-pattern-similarity-change.html#cb335-3" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data=</span>fit_best_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(high_low<span class="sc">==</span><span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>confdist),</span>
<span id="cb335-4"><a href="rsa-on-pattern-similarity-change.html#cb335-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb335-5"><a href="rsa-on-pattern-similarity-change.html#cb335-5" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data=</span>fit_best_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(high_low<span class="sc">==</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">y=</span>confdist),</span>
<span id="cb335-6"><a href="rsa-on-pattern-similarity-change.html#cb335-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb335-7"><a href="rsa-on-pattern-similarity-change.html#cb335-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">ifelse</span>(high_low<span class="sc">==</span><span class="dv">0</span>, <span class="fl">1.2</span>, <span class="fl">1.8</span>)), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb335-8"><a href="rsa-on-pattern-similarity-change.html#cb335-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb335-9"><a href="rsa-on-pattern-similarity-change.html#cb335-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span> </span>
<span id="cb335-10"><a href="rsa-on-pattern-similarity-change.html#cb335-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb335-11"><a href="rsa-on-pattern-similarity-change.html#cb335-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb335-12"><a href="rsa-on-pattern-similarity-change.html#cb335-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;MDS distance&#39;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;input distance&#39;</span>) <span class="sc">+</span> </span>
<span id="cb335-13"><a href="rsa-on-pattern-similarity-change.html#cb335-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;underline(&quot;    ***    &quot;)&#39;</span>, </span>
<span id="cb335-14"><a href="rsa-on-pattern-similarity-change.html#cb335-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb335-15"><a href="rsa-on-pattern-similarity-change.html#cb335-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb335-16"><a href="rsa-on-pattern-similarity-change.html#cb335-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;darkgrey&quot;</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb335-17"><a href="rsa-on-pattern-similarity-change.html#cb335-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;darkgrey&quot;</span>)) <span class="sc">+</span></span>
<span id="cb335-18"><a href="rsa-on-pattern-similarity-change.html#cb335-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="st">&quot;input distance&quot;</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape=</span><span class="dv">16</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">0</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="dv">1</span>)), <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb335-19"><a href="rsa-on-pattern-similarity-change.html#cb335-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb335-20"><a href="rsa-on-pattern-similarity-change.html#cb335-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb335-21"><a href="rsa-on-pattern-similarity-change.html#cb335-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb335-22"><a href="rsa-on-pattern-similarity-change.html#cb335-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb335-23"><a href="rsa-on-pattern-similarity-change.html#cb335-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb335-24"><a href="rsa-on-pattern-similarity-change.html#cb335-24" aria-hidden="true" tabindex="-1"></a>sfig6_f</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<p>Summary Statistics: t-test of resulting MDS distances contrasting event pairs separated by high vs. low input distances (median split):
t<sub>188</sub>=9.35, p=0.000, d=1.35, 95% CI [1.03, 1.67]</p>
<blockquote>
<p>Additionally, we contrasted the distances between pairs of events in the resulting configuration between distances separated by high or low (median split) input distances using a t-test for independent samples (Supplemental Figure 6F). Using a Spearman correlation, we quantified the relationship of the input distances and the distances in the resulting configuration (Supplemental Figure 6G).</p>
</blockquote>
<p>To further assess the fit of the configuration to the underlying distance matrix, we calculate the correlation between input distances between event pairs and the distances in the resulting MDS configuration as well as conducting a permutation test to assess the resulting stress value.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="rsa-on-pattern-similarity-change.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlate input distances and configuration distances</span></span>
<span id="cb336-2"><a href="rsa-on-pattern-similarity-change.html#cb336-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">cor.test</span>(fit_best_df<span class="sc">$</span>delta, fit_best_df<span class="sc">$</span>confdist, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span></code></pre></div>
<pre><code>## Warning in cor.test.default(fit_best_df$delta, fit_best_df$confdist, method = &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="rsa-on-pattern-similarity-change.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shepard plot showing input distances and configuration distances</span></span>
<span id="cb338-2"><a href="rsa-on-pattern-similarity-change.html#cb338-2" aria-hidden="true" tabindex="-1"></a>sfig6_g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit_best_df,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">rank</span>(delta), <span class="at">y =</span> <span class="fu">rank</span>(confdist))) <span class="sc">+</span></span>
<span id="cb338-3"><a href="rsa-on-pattern-similarity-change.html#cb338-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb338-4"><a href="rsa-on-pattern-similarity-change.html#cb338-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb338-5"><a href="rsa-on-pattern-similarity-change.html#cb338-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate(&quot;text&quot;, x=Inf, y=-Inf, hjust=&quot;inward&quot;, vjust=&quot;inward&quot;, size=6/.pt,</span></span>
<span id="cb338-6"><a href="rsa-on-pattern-similarity-change.html#cb338-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         label=sprintf(&quot;r=%.2f\np=%.3f&quot;, round(stats$estimate, digits=2), round(stats$p.value, digits=3)),</span></span>
<span id="cb338-7"><a href="rsa-on-pattern-similarity-change.html#cb338-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         family=font2use) +</span></span>
<span id="cb338-8"><a href="rsa-on-pattern-similarity-change.html#cb338-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;input distance&quot;</span>) <span class="sc">+</span></span>
<span id="cb338-9"><a href="rsa-on-pattern-similarity-change.html#cb338-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;MDS distance&quot;</span>) <span class="sc">+</span></span>
<span id="cb338-10"><a href="rsa-on-pattern-similarity-change.html#cb338-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb338-11"><a href="rsa-on-pattern-similarity-change.html#cb338-11" aria-hidden="true" tabindex="-1"></a>sfig6_g</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-181-1.png" width="672" />
Spearman correlation of input distances and distances in resulting MDS configuration:
r=0.46, p=0.000</p>
<p>We are ready to create figure 5:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="rsa-on-pattern-similarity-change.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># start figure 5 by making the MDS plot</span></span>
<span id="cb339-2"><a href="rsa-on-pattern-similarity-change.html#cb339-2" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb339-3"><a href="rsa-on-pattern-similarity-change.html#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb339-4"><a href="rsa-on-pattern-similarity-change.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb339-5"><a href="rsa-on-pattern-similarity-change.html#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="st">B&quot;</span></span>
<span id="cb339-6"><a href="rsa-on-pattern-similarity-change.html#cb339-6" aria-hidden="true" tabindex="-1"></a>f5c_guide <span class="ot">&lt;-</span> f5c <span class="sc">/</span> <span class="fu">guide_area</span>() <span class="sc">+</span></span>
<span id="cb339-7"><a href="rsa-on-pattern-similarity-change.html#cb339-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span>layout, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb339-8"><a href="rsa-on-pattern-similarity-change.html#cb339-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb339-9"><a href="rsa-on-pattern-similarity-change.html#cb339-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb339-10"><a href="rsa-on-pattern-similarity-change.html#cb339-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb339-11"><a href="rsa-on-pattern-similarity-change.html#cb339-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb339-12"><a href="rsa-on-pattern-similarity-change.html#cb339-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb339-13"><a href="rsa-on-pattern-similarity-change.html#cb339-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb339-14"><a href="rsa-on-pattern-similarity-change.html#cb339-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb339-15"><a href="rsa-on-pattern-similarity-change.html#cb339-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-16"><a href="rsa-on-pattern-similarity-change.html#cb339-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add the three panels together</span></span>
<span id="cb339-17"><a href="rsa-on-pattern-similarity-change.html#cb339-17" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;ABC&quot;</span></span>
<span id="cb339-18"><a href="rsa-on-pattern-similarity-change.html#cb339-18" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span>  f5a <span class="sc">+</span> f5b <span class="sc">+</span> f5c_guide <span class="sc">+</span> </span>
<span id="cb339-19"><a href="rsa-on-pattern-similarity-change.html#cb339-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>, <span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb339-20"><a href="rsa-on-pattern-similarity-change.html#cb339-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb339-21"><a href="rsa-on-pattern-similarity-change.html#cb339-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb339-22"><a href="rsa-on-pattern-similarity-change.html#cb339-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb339-23"><a href="rsa-on-pattern-similarity-change.html#cb339-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb339-24"><a href="rsa-on-pattern-similarity-change.html#cb339-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">&amp;</span></span>
<span id="cb339-25"><a href="rsa-on-pattern-similarity-change.html#cb339-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb339-26"><a href="rsa-on-pattern-similarity-change.html#cb339-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-27"><a href="rsa-on-pattern-similarity-change.html#cb339-27" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print (height was 18 when incl. searchlights)</span></span>
<span id="cb339-28"><a href="rsa-on-pattern-similarity-change.html#cb339-28" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;f5&quot;</span>)</span>
<span id="cb339-29"><a href="rsa-on-pattern-similarity-change.html#cb339-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>f5, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb339-30"><a href="rsa-on-pattern-similarity-change.html#cb339-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb339-31"><a href="rsa-on-pattern-similarity-change.html#cb339-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>f5, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb339-32"><a href="rsa-on-pattern-similarity-change.html#cb339-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/f5.png" alt="" />
<p class="caption">Figure 5. The anterior hippocampus generalizes temporal relations across sequences. A. Z-values show results of participant-specific linear models quantifying the effect of virtual time for event pairs from the same sequence (blue, as in Figure 4B) and from different sequences (red). Temporal distance is negatively related to hippocampal representational change for event pairs from different sequences. See Supplemental Figure 4EF for mixed model analysis of across-sequence comparisons. The effect of virtual time differs for comparisons within the same sequence or between two different sequences. B. To illustrate the effect shown in A, average pattern similarity change values are shown for across–sequence event pairs that are separated by low and high temporal distances based on a median split. C. Multidimensional scaling results show low-dimensional embedding of the event sequences. Shapes indicate event order, color shows virtual times of events. The different lines connect the events belonging to the four sequences for illustration. *** p≤0.001; ** p&lt;0.01; * p&lt;0.05</p>
</div>
</div>
</div>
<div id="umap" class="section level3 unnumbered">
<h3>UMAP</h3>
<p>To check if the MDS results depend on the specific algorithm, let’s also try the <a href="https://umap-learn.readthedocs.io/en/latest/">UMAP (Uniform Manifold Approximation and Projection for Dimension Reduction)</a> algorithm on the mixed model distance matrix.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="rsa-on-pattern-similarity-change.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up umap config based on defaults, but using distance matrix as input and define the two parameters</span></span>
<span id="cb340-2"><a href="rsa-on-pattern-similarity-change.html#cb340-2" aria-hidden="true" tabindex="-1"></a>custom_config <span class="ot">=</span> umap.defaults</span>
<span id="cb340-3"><a href="rsa-on-pattern-similarity-change.html#cb340-3" aria-hidden="true" tabindex="-1"></a>custom_config<span class="sc">$</span>input <span class="ot">=</span> <span class="st">&quot;dist&quot;</span></span>
<span id="cb340-4"><a href="rsa-on-pattern-similarity-change.html#cb340-4" aria-hidden="true" tabindex="-1"></a>custom_config<span class="sc">$</span>n_neighbors <span class="ot">&lt;-</span> <span class="dv">6</span>  <span class="co"># k nearest neighbors: high-values push towards global structure at cost of detail</span></span>
<span id="cb340-5"><a href="rsa-on-pattern-similarity-change.html#cb340-5" aria-hidden="true" tabindex="-1"></a>custom_config<span class="sc">$</span>min_dist <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># minimum distance: high values lead to looser packing, but better topology</span></span>
<span id="cb340-6"><a href="rsa-on-pattern-similarity-change.html#cb340-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-7"><a href="rsa-on-pattern-similarity-change.html#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run umap using the LME distance matrix as input. use the custom config</span></span>
<span id="cb340-8"><a href="rsa-on-pattern-similarity-change.html#cb340-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">306</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb340-9"><a href="rsa-on-pattern-similarity-change.html#cb340-9" aria-hidden="true" tabindex="-1"></a>umap_dist <span class="ot">=</span> <span class="fu">umap</span>(ps_dist_hat_mat, <span class="at">config =</span> custom_config)</span>
<span id="cb340-10"><a href="rsa-on-pattern-similarity-change.html#cb340-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-11"><a href="rsa-on-pattern-similarity-change.html#cb340-11" aria-hidden="true" tabindex="-1"></a><span class="co"># turn this solution into a tibble and include info about days and events</span></span>
<span id="cb340-12"><a href="rsa-on-pattern-similarity-change.html#cb340-12" aria-hidden="true" tabindex="-1"></a>umap_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n_days), <span class="at">each=</span>n_events_day)),</span>
<span id="cb340-13"><a href="rsa-on-pattern-similarity-change.html#cb340-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">event =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_events_day,n_days)),</span>
<span id="cb340-14"><a href="rsa-on-pattern-similarity-change.html#cb340-14" aria-hidden="true" tabindex="-1"></a>                  virtual_time <span class="ot">&lt;-</span> virtual_time,</span>
<span id="cb340-15"><a href="rsa-on-pattern-similarity-change.html#cb340-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">umapX =</span> umap_dist<span class="sc">$</span>layout[,<span class="dv">1</span>], </span>
<span id="cb340-16"><a href="rsa-on-pattern-similarity-change.html#cb340-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">umapY =</span> umap_dist<span class="sc">$</span>layout[,<span class="dv">2</span>])</span>
<span id="cb340-17"><a href="rsa-on-pattern-similarity-change.html#cb340-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-18"><a href="rsa-on-pattern-similarity-change.html#cb340-18" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize as 2D scatter with lines of the configuration </span></span>
<span id="cb340-19"><a href="rsa-on-pattern-similarity-change.html#cb340-19" aria-hidden="true" tabindex="-1"></a>sfig6_x <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(umap_df, <span class="fu">aes</span>(<span class="at">x=</span>umapX,<span class="at">y=</span>umapY, <span class="at">group=</span>day, <span class="at">color=</span>virtual_time, <span class="at">fill=</span>virtual_time, <span class="at">shape=</span>event)) <span class="sc">+</span></span>
<span id="cb340-20"><a href="rsa-on-pattern-similarity-change.html#cb340-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>day),<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-21"><a href="rsa-on-pattern-similarity-change.html#cb340-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;3111&quot;</span>)) <span class="sc">+</span></span>
<span id="cb340-22"><a href="rsa-on-pattern-similarity-change.html#cb340-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb340-23"><a href="rsa-on-pattern-similarity-change.html#cb340-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb340-24"><a href="rsa-on-pattern-similarity-change.html#cb340-24" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb340-25"><a href="rsa-on-pattern-similarity-change.html#cb340-25" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_color_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-26"><a href="rsa-on-pattern-similarity-change.html#cb340-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;sequence&quot;</span>, <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">1</span>),</span>
<span id="cb340-27"><a href="rsa-on-pattern-similarity-change.html#cb340-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>), <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>, <span class="at">order=</span><span class="dv">2</span>),</span>
<span id="cb340-28"><a href="rsa-on-pattern-similarity-change.html#cb340-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&quot;virtual time&quot;</span>, <span class="at">title.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">title.hjust =</span> <span class="dv">1</span>, <span class="at">barwidth =</span> <span class="fl">0.5</span>, <span class="at">barheight =</span> <span class="dv">1</span>),</span>
<span id="cb340-29"><a href="rsa-on-pattern-similarity-change.html#cb340-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb340-30"><a href="rsa-on-pattern-similarity-change.html#cb340-30" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb340-31"><a href="rsa-on-pattern-similarity-change.html#cb340-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;dimension 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-32"><a href="rsa-on-pattern-similarity-change.html#cb340-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;dimension 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb340-33"><a href="rsa-on-pattern-similarity-change.html#cb340-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb340-34"><a href="rsa-on-pattern-similarity-change.html#cb340-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb340-35"><a href="rsa-on-pattern-similarity-change.html#cb340-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&#39;mm&#39;</span>),</span>
<span id="cb340-36"><a href="rsa-on-pattern-similarity-change.html#cb340-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb340-37"><a href="rsa-on-pattern-similarity-change.html#cb340-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb340-38"><a href="rsa-on-pattern-similarity-change.html#cb340-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb340-39"><a href="rsa-on-pattern-similarity-change.html#cb340-39" aria-hidden="true" tabindex="-1"></a>sfig6_x</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<p>Let’s create supplemental figure 6</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="rsa-on-pattern-similarity-change.html#cb341-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb341-2"><a href="rsa-on-pattern-similarity-change.html#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="st">AADDFF</span></span>
<span id="cb341-3"><a href="rsa-on-pattern-similarity-change.html#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="st">AADDFF</span></span>
<span id="cb341-4"><a href="rsa-on-pattern-similarity-change.html#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="st">BCEEGG&quot;</span></span>
<span id="cb341-5"><a href="rsa-on-pattern-similarity-change.html#cb341-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-6"><a href="rsa-on-pattern-similarity-change.html#cb341-6" aria-hidden="true" tabindex="-1"></a>sfig6 <span class="ot">&lt;-</span> sfig6_a <span class="sc">+</span> sfig6_b <span class="sc">+</span> sfig6_c <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> sfig6_e <span class="sc">+</span> sfig6_f <span class="sc">+</span> sfig6_g <span class="sc">+</span></span>
<span id="cb341-7"><a href="rsa-on-pattern-similarity-change.html#cb341-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">+</span></span>
<span id="cb341-8"><a href="rsa-on-pattern-similarity-change.html#cb341-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb341-9"><a href="rsa-on-pattern-similarity-change.html#cb341-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;F&#39;</span>, <span class="st">&#39;G&#39;</span>))) <span class="sc">&amp;</span></span>
<span id="cb341-10"><a href="rsa-on-pattern-similarity-change.html#cb341-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb341-11"><a href="rsa-on-pattern-similarity-change.html#cb341-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb341-12"><a href="rsa-on-pattern-similarity-change.html#cb341-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb341-13"><a href="rsa-on-pattern-similarity-change.html#cb341-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb341-14"><a href="rsa-on-pattern-similarity-change.html#cb341-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">0</span>, <span class="at">unit=</span><span class="st">&#39;cm&#39;</span>)) </span>
<span id="cb341-15"><a href="rsa-on-pattern-similarity-change.html#cb341-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-16"><a href="rsa-on-pattern-similarity-change.html#cb341-16" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf06&quot;</span>)</span>
<span id="cb341-17"><a href="rsa-on-pattern-similarity-change.html#cb341-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig6, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb341-18"><a href="rsa-on-pattern-similarity-change.html#cb341-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb341-19"><a href="rsa-on-pattern-similarity-change.html#cb341-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig6, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb341-20"><a href="rsa-on-pattern-similarity-change.html#cb341-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf06.png" alt="" />
<p class="caption">Supplemental Figure 6. Virtual time predicts hippocampal pattern similarity change for events from different sequences. A. Z-values show the relationship of the different time metrics to representational change in the anterior hippocampus based on participant-specific multiple regression analyses for pairs of events from different sequences. Circles show participant-specific Z-values from summary statistics approach; boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points. B, C. Parameter estimates with 95% CIs (B) and estimated marginal means (C) show the fixed effects of the three time metrics from the corresponding mixed model. * p&lt;0.05 after exclusion of one outlier excluded based on the boxplot criterion. D. A linear mixed model capturing the interaction effect of virtual temporal distances and sequence membership (Figure 5, Supplemental Figure 4IJ) was fitted to hippocampal representational change. An event-by-event similarity matrix was derived from the fixed effects of this model. Similarities were converted distances and then used as input for multidimensional scaling (see Methods). E. The stress value observed in the MDS analysis (red line) was significantly smaller than the 5th percentile (black dashed line) of a surrogate distribution of stress values obtained from shuffling the dissimilarities before running MDS in each of 1000 iterations. F. Pairs of events separated by a large distance in the input distance matrix were separated by a larger Euclidean distance in the resulting MDS configuration (t188=9.35, p&lt;0.001, d=1.35, 95% CI [1.03, 1.67]). *** p &lt;0.001. G. There was a significant Spearman correlation of input distances and MDS configuration distances (r=0.46, p&lt;0.001), but visual inspection reveals a non-linear relationship where very high distances are systematically underestimated in the MDS configuration. This is likely because the data were projected onto only two dimensions for visualization. More dimensions would be needed to improve the fit of the MDS configuration and the input distance matrix. Distances are shown as ranks because non-metric MDS was used (high ranks for high distances).</p>
</div>
</div>
</div>
<div id="alec" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> alEC</h2>
<p>So far we focused on the anterior hippocampus. But what about our second region of interest, the anterior-lateral entorhinal cortex (alEC)?</p>
<div id="alec-virtual-time-withinacross-sequences-separately" class="section level3 unnumbered">
<h3>alEC: virtual time within/across sequences separately</h3>
<p>First, we run the t-tests against zero for the alEC, separately for events from the same or two different sequences.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="rsa-on-pattern-similarity-change.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">108</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb342-2"><a href="rsa-on-pattern-similarity-change.html#cb342-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-3"><a href="rsa-on-pattern-similarity-change.html#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in alEC for within-day</span></span>
<span id="cb342-4"><a href="rsa-on-pattern-similarity-change.html#cb342-4" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb342-5"><a href="rsa-on-pattern-similarity-change.html#cb342-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb342-6"><a href="rsa-on-pattern-similarity-change.html#cb342-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb342-7"><a href="rsa-on-pattern-similarity-change.html#cb342-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb342-8"><a href="rsa-on-pattern-similarity-change.html#cb342-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-9"><a href="rsa-on-pattern-similarity-change.html#cb342-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb342-10"><a href="rsa-on-pattern-similarity-change.html#cb342-10" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-185">
<col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">alternative</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.233</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.26</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.217</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.215</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.611</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.145</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">two.sided</td></tr>
</table>

<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="rsa-on-pattern-similarity-change.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># re-run without outliers (see outliers in subsequent plot)</span></span>
<span id="cb343-2"><a href="rsa-on-pattern-similarity-change.html#cb343-2" aria-hidden="true" tabindex="-1"></a>alEC_within <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span></span>
<span id="cb343-3"><a href="rsa-on-pattern-similarity-change.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>) </span>
<span id="cb343-4"><a href="rsa-on-pattern-similarity-change.html#cb343-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-5"><a href="rsa-on-pattern-similarity-change.html#cb343-5" aria-hidden="true" tabindex="-1"></a><span class="co"># find outliers </span></span>
<span id="cb343-6"><a href="rsa-on-pattern-similarity-change.html#cb343-6" aria-hidden="true" tabindex="-1"></a>is_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb343-7"><a href="rsa-on-pattern-similarity-change.html#cb343-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">&lt;</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>) <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(x) <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(x))</span>
<span id="cb343-8"><a href="rsa-on-pattern-similarity-change.html#cb343-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb343-9"><a href="rsa-on-pattern-similarity-change.html#cb343-9" aria-hidden="true" tabindex="-1"></a>out_ind <span class="ot">&lt;-</span> <span class="fu">is_outlier</span>(alEC_within<span class="sc">$</span>z_virtual_time)</span>
<span id="cb343-10"><a href="rsa-on-pattern-similarity-change.html#cb343-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-11"><a href="rsa-on-pattern-similarity-change.html#cb343-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run second-level analysis on data points that are not outliers</span></span>
<span id="cb343-12"><a href="rsa-on-pattern-similarity-change.html#cb343-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb343-13"><a href="rsa-on-pattern-similarity-change.html#cb343-13" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> alEC_within[<span class="sc">!</span>out_ind,] <span class="sc">%&gt;%</span> </span>
<span id="cb343-14"><a href="rsa-on-pattern-similarity-change.html#cb343-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb343-15"><a href="rsa-on-pattern-similarity-change.html#cb343-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm) </span>
<span id="cb343-16"><a href="rsa-on-pattern-similarity-change.html#cb343-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-17"><a href="rsa-on-pattern-similarity-change.html#cb343-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb343-18"><a href="rsa-on-pattern-similarity-change.html#cb343-18" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>alEC_within[<span class="sc">!</span>out_ind,]<span class="sc">$</span>z_virtual_time, </span>
<span id="cb343-19"><a href="rsa-on-pattern-similarity-change.html#cb343-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb343-20"><a href="rsa-on-pattern-similarity-change.html#cb343-20" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb343-21"><a href="rsa-on-pattern-similarity-change.html#cb343-21" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb343-22"><a href="rsa-on-pattern-similarity-change.html#cb343-22" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb343-23"><a href="rsa-on-pattern-similarity-change.html#cb343-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-24"><a href="rsa-on-pattern-similarity-change.html#cb343-24" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-185">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.482</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.54</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00166</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.002</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">24</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.763</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.201</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.685</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.17</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.268</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time within sequence in alEC (outliers excluded)<br />
t<sub>24</sub>=-3.54, p=0.002, d=-0.69, 95% CI [-1.17, -0.27]</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="rsa-on-pattern-similarity-change.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in alEC for across-day</span></span>
<span id="cb344-2"><a href="rsa-on-pattern-similarity-change.html#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">145</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb344-3"><a href="rsa-on-pattern-similarity-change.html#cb344-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb344-4"><a href="rsa-on-pattern-similarity-change.html#cb344-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb344-5"><a href="rsa-on-pattern-similarity-change.html#cb344-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb344-6"><a href="rsa-on-pattern-similarity-change.html#cb344-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb344-7"><a href="rsa-on-pattern-similarity-change.html#cb344-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-8"><a href="rsa-on-pattern-similarity-change.html#cb344-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb344-9"><a href="rsa-on-pattern-similarity-change.html#cb344-9" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>))<span class="sc">$</span>z_virtual_time, </span>
<span id="cb344-10"><a href="rsa-on-pattern-similarity-change.html#cb344-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb344-11"><a href="rsa-on-pattern-similarity-change.html#cb344-11" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb344-12"><a href="rsa-on-pattern-similarity-change.html#cb344-12" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb344-13"><a href="rsa-on-pattern-similarity-change.html#cb344-13" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb344-14"><a href="rsa-on-pattern-similarity-change.html#cb344-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-15"><a href="rsa-on-pattern-similarity-change.html#cb344-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb344-16"><a href="rsa-on-pattern-similarity-change.html#cb344-16" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-186">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.253</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.121</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.122</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.577</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0709</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.294</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.692</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0803</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time across sequences in alEC<br />
t<sub>27</sub>=-1.6, p=0.122, d=-0.29, 95% CI [-0.69, 0.08]</p>
</div>
<div id="alec-virtual-time-within-vs.-across-sequences" class="section level3 unnumbered">
<h3>alEC: virtual time within vs. across sequences</h3>
<div id="summary-statistics-9" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<p>Let’s contrast the effect of virtual time on entorhinal pattern similarity change depending on whether we compare events from the same sequence or from different sequences.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="rsa-on-pattern-similarity-change.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb345-2"><a href="rsa-on-pattern-similarity-change.html#cb345-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-3"><a href="rsa-on-pattern-similarity-change.html#cb345-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span></span>
<span id="cb345-4"><a href="rsa-on-pattern-similarity-change.html#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi<span class="sc">==</span><span class="st">&quot;alEC_lr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb345-5"><a href="rsa-on-pattern-similarity-change.html#cb345-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate difference between within- an across-day effect for each participant</span></span>
<span id="cb345-6"><a href="rsa-on-pattern-similarity-change.html#cb345-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb345-7"><a href="rsa-on-pattern-similarity-change.html#cb345-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb345-8"><a href="rsa-on-pattern-similarity-change.html#cb345-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_diff =</span> z_virtual_time[same_day<span class="sc">==</span><span class="cn">TRUE</span>]<span class="sc">-</span>z_virtual_time[same_day<span class="sc">==</span><span class="cn">FALSE</span>],</span>
<span id="cb345-9"><a href="rsa-on-pattern-similarity-change.html#cb345-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb345-10"><a href="rsa-on-pattern-similarity-change.html#cb345-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test difference against 0</span></span>
<span id="cb345-11"><a href="rsa-on-pattern-similarity-change.html#cb345-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(same_day_diff) <span class="sc">%&gt;%</span> </span>
<span id="cb345-12"><a href="rsa-on-pattern-similarity-change.html#cb345-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb345-13"><a href="rsa-on-pattern-similarity-change.html#cb345-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb345-14"><a href="rsa-on-pattern-similarity-change.html#cb345-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for paired samples using non-central t-distribution for CI</span></span>
<span id="cb345-15"><a href="rsa-on-pattern-similarity-change.html#cb345-15" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">TRUE</span>))<span class="sc">$</span>z_virtual_time, </span>
<span id="cb345-16"><a href="rsa-on-pattern-similarity-change.html#cb345-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span>(rsa_fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>, same_day <span class="sc">==</span> <span class="cn">FALSE</span>))<span class="sc">$</span>z_virtual_time, </span>
<span id="cb345-17"><a href="rsa-on-pattern-similarity-change.html#cb345-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">pooled=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb345-18"><a href="rsa-on-pattern-similarity-change.html#cb345-18" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb345-19"><a href="rsa-on-pattern-similarity-change.html#cb345-19" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb345-20"><a href="rsa-on-pattern-similarity-change.html#cb345-20" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb345-21"><a href="rsa-on-pattern-similarity-change.html#cb345-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-22"><a href="rsa-on-pattern-similarity-change.html#cb345-22" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb345-23"><a href="rsa-on-pattern-similarity-change.html#cb345-23" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-187">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.0199</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.073</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.942</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.942</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.539</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.579</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0213</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.363</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.391</td></tr>
</table>

<p>Summary Statistics: paired t-test comparing effect of virtual time within and across sequences in alEC<br />
t<sub>27</sub>=0.07, p=0.942, d=0.02, 95% CI [-0.36, 0.39]</p>
<p>To finish this, we make a plot of the same and different sequence effect to go into the supplement.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="rsa-on-pattern-similarity-change.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate custom repeating jitter (multiply with -1/1 to shift towards each other)</span></span>
<span id="cb346-2"><a href="rsa-on-pattern-similarity-change.html#cb346-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit <span class="sc">%&gt;%</span> </span>
<span id="cb346-3"><a href="rsa-on-pattern-similarity-change.html#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi<span class="sc">==</span><span class="st">&quot;alEC_lr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb346-4"><a href="rsa-on-pattern-similarity-change.html#cb346-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb346-5"><a href="rsa-on-pattern-similarity-change.html#cb346-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_num =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>),<span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb346-6"><a href="rsa-on-pattern-similarity-change.html#cb346-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_char =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span>, <span class="st">&quot;TRUE&quot;</span>), </span>
<span id="cb346-7"><a href="rsa-on-pattern-similarity-change.html#cb346-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;different&quot;</span>, <span class="st">&quot;same&quot;</span>)),</span>
<span id="cb346-8"><a href="rsa-on-pattern-similarity-change.html#cb346-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_char =</span> <span class="fu">fct_relevel</span>(same_day_char, <span class="fu">c</span>(<span class="st">&quot;same&quot;</span>, <span class="st">&quot;different&quot;</span>)),</span>
<span id="cb346-9"><a href="rsa-on-pattern-similarity-change.html#cb346-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_jit =</span> <span class="fu">as.numeric</span>(same_day_char) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">jitter</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n_subs), <span class="at">amount=</span><span class="fl">0.05</span>), <span class="at">each=</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),n_subs))</span>
<span id="cb346-10"><a href="rsa-on-pattern-similarity-change.html#cb346-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-11"><a href="rsa-on-pattern-similarity-change.html#cb346-11" aria-hidden="true" tabindex="-1"></a>sfig7_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>plot_dat, <span class="fu">aes</span>(<span class="at">x=</span>same_day_char, <span class="at">y=</span>z_virtual_time, <span class="at">fill =</span> same_day_char, <span class="at">color =</span> same_day_char)) <span class="sc">+</span></span>
<span id="cb346-12"><a href="rsa-on-pattern-similarity-change.html#cb346-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span>same_day_char), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb346-13"><a href="rsa-on-pattern-similarity-change.html#cb346-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb346-14"><a href="rsa-on-pattern-similarity-change.html#cb346-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], aHPC_colors[<span class="st">&quot;across_main&quot;</span>]))) <span class="sc">+</span></span>
<span id="cb346-15"><a href="rsa-on-pattern-similarity-change.html#cb346-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], aHPC_colors[<span class="st">&quot;across_main&quot;</span>])),</span>
<span id="cb346-16"><a href="rsa-on-pattern-similarity-change.html#cb346-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;sequence&quot;</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;same&quot;</span>, <span class="st">&quot;different&quot;</span>)) <span class="sc">+</span></span>
<span id="cb346-17"><a href="rsa-on-pattern-similarity-change.html#cb346-17" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> plot_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">TRUE</span>), </span>
<span id="cb346-18"><a href="rsa-on-pattern-similarity-change.html#cb346-18" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>same_day_char, <span class="at">y=</span>z_virtual_time),</span>
<span id="cb346-19"><a href="rsa-on-pattern-similarity-change.html#cb346-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb346-20"><a href="rsa-on-pattern-similarity-change.html#cb346-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb346-21"><a href="rsa-on-pattern-similarity-change.html#cb346-21" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> plot_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">FALSE</span>), </span>
<span id="cb346-22"><a href="rsa-on-pattern-similarity-change.html#cb346-22" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>same_day_char, <span class="at">y=</span>z_virtual_time),</span>
<span id="cb346-23"><a href="rsa-on-pattern-similarity-change.html#cb346-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb346-24"><a href="rsa-on-pattern-similarity-change.html#cb346-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb346-25"><a href="rsa-on-pattern-similarity-change.html#cb346-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb346-26"><a href="rsa-on-pattern-similarity-change.html#cb346-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb346-27"><a href="rsa-on-pattern-similarity-change.html#cb346-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb346-28"><a href="rsa-on-pattern-similarity-change.html#cb346-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb346-29"><a href="rsa-on-pattern-similarity-change.html#cb346-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>sub_id,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb346-30"><a href="rsa-on-pattern-similarity-change.html#cb346-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb346-31"><a href="rsa-on-pattern-similarity-change.html#cb346-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit, <span class="at">fill =</span> same_day_char), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.15</span>, <span class="fl">0.15</span>)),</span>
<span id="cb346-32"><a href="rsa-on-pattern-similarity-change.html#cb346-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb346-33"><a href="rsa-on-pattern-similarity-change.html#cb346-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;sequence&#39;</span>) <span class="sc">+</span>    </span>
<span id="cb346-34"><a href="rsa-on-pattern-similarity-change.html#cb346-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb346-35"><a href="rsa-on-pattern-similarity-change.html#cb346-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb346-36"><a href="rsa-on-pattern-similarity-change.html#cb346-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;**&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb346-37"><a href="rsa-on-pattern-similarity-change.html#cb346-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb346-38"><a href="rsa-on-pattern-similarity-change.html#cb346-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;underline(&quot;  n.s.  &quot;)&#39;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb346-39"><a href="rsa-on-pattern-similarity-change.html#cb346-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb346-40"><a href="rsa-on-pattern-similarity-change.html#cb346-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb346-41"><a href="rsa-on-pattern-similarity-change.html#cb346-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb346-42"><a href="rsa-on-pattern-similarity-change.html#cb346-42" aria-hidden="true" tabindex="-1"></a>sfig7_a</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
</div>
<div id="mixed-effects" class="section level4 unnumbered">
<h4>Mixed Effects</h4>
<p>Test the interaction between sequence membership and virtual time on alEC representational change in mixed model analysis.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="rsa-on-pattern-similarity-change.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the data</span></span>
<span id="cb347-2"><a href="rsa-on-pattern-similarity-change.html#cb347-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_alEC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>)</span>
<span id="cb347-3"><a href="rsa-on-pattern-similarity-change.html#cb347-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-4"><a href="rsa-on-pattern-similarity-change.html#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test the interaction for alEC</span></span>
<span id="cb347-5"><a href="rsa-on-pattern-similarity-change.html#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="co"># maximal random effect structure --&gt; singular fit</span></span>
<span id="cb347-6"><a href="rsa-on-pattern-similarity-change.html#cb347-6" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (1 + vir_time_diff * same_day_dv | sub_id)&quot;</span></span>
<span id="cb347-7"><a href="rsa-on-pattern-similarity-change.html#cb347-7" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_alEC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="rsa-on-pattern-similarity-change.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no correlations with random intercept --&gt; singular fit</span></span>
<span id="cb349-2"><a href="rsa-on-pattern-similarity-change.html#cb349-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (1 + vir_time_diff * same_day_dv || sub_id)&quot;</span></span>
<span id="cb349-3"><a href="rsa-on-pattern-similarity-change.html#cb349-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_alEC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="rsa-on-pattern-similarity-change.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercepts and random slopes only for the critical interaction --&gt; singular fit</span></span>
<span id="cb351-2"><a href="rsa-on-pattern-similarity-change.html#cb351-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (1 + vir_time_diff : same_day_dv || sub_id)&quot;</span></span>
<span id="cb351-3"><a href="rsa-on-pattern-similarity-change.html#cb351-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_alEC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="rsa-on-pattern-similarity-change.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random slopes for critical interactions</span></span>
<span id="cb353-2"><a href="rsa-on-pattern-similarity-change.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">378</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb353-3"><a href="rsa-on-pattern-similarity-change.html#cb353-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv + (0 + vir_time_diff : same_day_dv | sub_id)&quot;</span></span>
<span id="cb353-4"><a href="rsa-on-pattern-similarity-change.html#cb353-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_alEC, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="rsa-on-pattern-similarity-change.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff * same_day_dv + (0 + vir_time_diff:same_day_dv |      sub_id)
##    Data: rsa_dat_alEC
## 
##      AIC      BIC   logLik deviance df.resid 
## -29766.7 -29727.3  14889.4 -29778.7     5314 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5825 -0.6461  0.0014  0.6380  4.1761 
## 
## Random effects:
##  Groups   Name                      Variance Std.Dev.
##  sub_id   vir_time_diff:same_day_dv 0.000000 0.00000 
##  Residual                           0.000217 0.01473 
## Number of obs: 5320, groups:  sub_id, 28
## 
## Fixed effects:
##                             Estimate Std. Error t value
## (Intercept)                0.0002612  0.0002521   1.036
## vir_time_diff             -0.0005716  0.0002549  -2.242
## same_day_dv                0.0001285  0.0002521   0.510
## vir_time_diff:same_day_dv -0.0002320  0.0002549  -0.910
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="rsa-on-pattern-similarity-change.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb357-2"><a href="rsa-on-pattern-similarity-change.html#cb357-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="rsa-on-pattern-similarity-change.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb359-2"><a href="rsa-on-pattern-similarity-change.html#cb359-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb359-3"><a href="rsa-on-pattern-similarity-change.html#cb359-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-4"><a href="rsa-on-pattern-similarity-change.html#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test against reduced model</span></span>
<span id="cb359-5"><a href="rsa-on-pattern-similarity-change.html#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">370</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb359-6"><a href="rsa-on-pattern-similarity-change.html#cb359-6" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> <span class="fu">update</span>(lmm_full, <span class="sc">~</span> . <span class="sc">-</span> vir_time_diff<span class="sc">:</span>same_day_dv)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="rsa-on-pattern-similarity-change.html#cb361-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_reduced, lmm_full)</span></code></pre></div>
<p>Mixed Model: Fixed effect of interaction of virtual time with sequence identity on alEC pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=0.83, p=0.363</p>
</div>
</div>
<div id="alec-virtual-time-for-all-event-pairs" class="section level3 unnumbered">
<h3>alEC: virtual time for all event pairs</h3>
<p>Because there is no significant difference when we look at event pairs from the same vs. different days in the above analysis, we collapse across all comparisons to test for an effect of virtual time on entorhinal pattern similarity change.</p>
<div id="summary-statistics-10" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="rsa-on-pattern-similarity-change.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb362-2"><a href="rsa-on-pattern-similarity-change.html#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="rsa-on-pattern-similarity-change.html#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from 1000 permutations</span></span>
<span id="cb362-4"><a href="rsa-on-pattern-similarity-change.html#cb362-4" aria-hidden="true" tabindex="-1"></a>rsa_fit_ec <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb362-5"><a href="rsa-on-pattern-similarity-change.html#cb362-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb362-6"><a href="rsa-on-pattern-similarity-change.html#cb362-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb362-7"><a href="rsa-on-pattern-similarity-change.html#cb362-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb362-8"><a href="rsa-on-pattern-similarity-change.html#cb362-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> ., <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff&quot;</span>, <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb362-9"><a href="rsa-on-pattern-similarity-change.html#cb362-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb362-10"><a href="rsa-on-pattern-similarity-change.html#cb362-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(z)</span>
<span id="cb362-11"><a href="rsa-on-pattern-similarity-change.html#cb362-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-12"><a href="rsa-on-pattern-similarity-change.html#cb362-12" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in alEC for both within-day and across days</span></span>
<span id="cb362-13"><a href="rsa-on-pattern-similarity-change.html#cb362-13" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_ec <span class="sc">%&gt;%</span> </span>
<span id="cb362-14"><a href="rsa-on-pattern-similarity-change.html#cb362-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb362-15"><a href="rsa-on-pattern-similarity-change.html#cb362-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb362-16"><a href="rsa-on-pattern-similarity-change.html#cb362-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-17"><a href="rsa-on-pattern-similarity-change.html#cb362-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb362-18"><a href="rsa-on-pattern-similarity-change.html#cb362-18" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>rsa_fit_ec<span class="sc">$</span>z_virtual_time, </span>
<span id="cb362-19"><a href="rsa-on-pattern-similarity-change.html#cb362-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb362-20"><a href="rsa-on-pattern-similarity-change.html#cb362-20" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb362-21"><a href="rsa-on-pattern-similarity-change.html#cb362-21" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb362-22"><a href="rsa-on-pattern-similarity-change.html#cb362-22" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb362-23"><a href="rsa-on-pattern-similarity-change.html#cb362-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-24"><a href="rsa-on-pattern-similarity-change.html#cb362-24" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb362-25"><a href="rsa-on-pattern-similarity-change.html#cb362-25" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-190">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.335</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.31</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.029</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0294</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.634</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0371</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.423</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.835</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.0451</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time for all pairs in alEC<br />
t<sub>27</sub>=-2.31, p=0.029, d=-0.42, 95% CI [-0.84, -0.05]</p>
<p><img src="virtem_book_files/figure-html/RSA%20alEC%20raincloud%20plot%20of%20virtual%20time%20all%20comparisons-1.png" width="672" /></p>
</div>
<div id="linear-mixed-effects-8" class="section level4 unnumbered">
<h4>Linear Mixed Effects</h4>
<p>When fitting a linear mixed effects model to test the effect of virtual time on pattern similarity change in the alEC, we thus use all pairwise comparisons. Due to singular fits we reduce the random effects structure to only include random slopes for virtual time. The model is still singular, but we keep these random slopes in the model to avoid anti-conservativity and to account for the within-subject dependencies.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="rsa-on-pattern-similarity-change.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from the same day</span></span>
<span id="cb363-2"><a href="rsa-on-pattern-similarity-change.html#cb363-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_ec <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>)</span>
<span id="cb363-3"><a href="rsa-on-pattern-similarity-change.html#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="rsa-on-pattern-similarity-change.html#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference as </span></span>
<span id="cb363-5"><a href="rsa-on-pattern-similarity-change.html#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effect and random intercepts for subject --&gt; singular fit</span></span>
<span id="cb363-6"><a href="rsa-on-pattern-similarity-change.html#cb363-6" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb363-7"><a href="rsa-on-pattern-similarity-change.html#cb363-7" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_ec, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="rsa-on-pattern-similarity-change.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the correlation between random slopes and intercepts --&gt; still singular</span></span>
<span id="cb365-2"><a href="rsa-on-pattern-similarity-change.html#cb365-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff || sub_id)&quot;</span></span>
<span id="cb365-3"><a href="rsa-on-pattern-similarity-change.html#cb365-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_ec, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="rsa-on-pattern-similarity-change.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only random slopes --&gt; still singular</span></span>
<span id="cb367-2"><a href="rsa-on-pattern-similarity-change.html#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">301</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb367-3"><a href="rsa-on-pattern-similarity-change.html#cb367-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb367-4"><a href="rsa-on-pattern-similarity-change.html#cb367-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_ec, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="rsa-on-pattern-similarity-change.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lmm_full = lme4::lmer(formula, data=rsa_dat_mtl, REML=FALSE,</span></span>
<span id="cb369-2"><a href="rsa-on-pattern-similarity-change.html#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                control = lmerControl(optimizer =&quot;bobyqa&quot;, optCtrl=list(maxfun=100000)))</span></span>
<span id="cb369-3"><a href="rsa-on-pattern-similarity-change.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="co">#lmm_full = lmer(formula, data=rsa_dat_mtl, REML=FALSE,</span></span>
<span id="cb369-4"><a href="rsa-on-pattern-similarity-change.html#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                 control = lmerControl(optimizer =&#39;nloptwrap&#39;, </span></span>
<span id="cb369-5"><a href="rsa-on-pattern-similarity-change.html#cb369-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       optCtrl=list(method=&#39;NLOPT_LN_NELDERMEAD&#39;, maxfun=100000)))</span></span>
<span id="cb369-6"><a href="rsa-on-pattern-similarity-change.html#cb369-6" aria-hidden="true" tabindex="-1"></a><span class="co">#lmm_full = lme4::lmer(formula, data=rsa_dat_mtl, REML=FALSE,</span></span>
<span id="cb369-7"><a href="rsa-on-pattern-similarity-change.html#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                control = lmerControl(optimizer =&#39;optimx&#39;, optCtrl=list(method=&#39;nlminb&#39;)))</span></span>
<span id="cb369-8"><a href="rsa-on-pattern-similarity-change.html#cb369-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-9"><a href="rsa-on-pattern-similarity-change.html#cb369-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + (0 + vir_time_diff | sub_id)
##    Data: rsa_dat_ec
## 
##      AIC      BIC   logLik deviance df.resid 
## -29769.8 -29743.5  14888.9 -29777.8     5316 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5888 -0.6468  0.0016  0.6373  4.1684 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev.
##  sub_id   vir_time_diff 0.0000000 0.00000 
##  Residual               0.0002171 0.01473 
## Number of obs: 5320, groups:  sub_id, 28
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)    0.0001670  0.0002020   0.827
## vir_time_diff -0.0004237  0.0002023  -2.095
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="rsa-on-pattern-similarity-change.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb371-2"><a href="rsa-on-pattern-similarity-change.html#cb371-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="rsa-on-pattern-similarity-change.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb373-2"><a href="rsa-on-pattern-similarity-change.html#cb373-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb373-3"><a href="rsa-on-pattern-similarity-change.html#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="rsa-on-pattern-similarity-change.html#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test against reduced model</span></span>
<span id="cb373-5"><a href="rsa-on-pattern-similarity-change.html#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">317</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb373-6"><a href="rsa-on-pattern-similarity-change.html#cb373-6" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ 1 + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb373-7"><a href="rsa-on-pattern-similarity-change.html#cb373-7" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_ec, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="rsa-on-pattern-similarity-change.html#cb375-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span></code></pre></div>
<p>Mixed Model: Fixed effect of virtual time on alEC pattern similarity change (all pairs)
<span class="math inline">\(\chi^2\)</span>(1)=4.39, p=0.036</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="rsa-on-pattern-similarity-change.html#cb376-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>)</span>
<span id="cb376-2"><a href="rsa-on-pattern-similarity-change.html#cb376-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb376-3"><a href="rsa-on-pattern-similarity-change.html#cb376-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb376-4"><a href="rsa-on-pattern-similarity-change.html#cb376-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-5"><a href="rsa-on-pattern-similarity-change.html#cb376-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb376-6"><a href="rsa-on-pattern-similarity-change.html#cb376-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb376-7"><a href="rsa-on-pattern-similarity-change.html#cb376-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb376-8"><a href="rsa-on-pattern-similarity-change.html#cb376-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb376-9"><a href="rsa-on-pattern-similarity-change.html#cb376-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb376-10"><a href="rsa-on-pattern-similarity-change.html#cb376-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb376-11"><a href="rsa-on-pattern-similarity-change.html#cb376-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb376-12"><a href="rsa-on-pattern-similarity-change.html#cb376-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb376-13"><a href="rsa-on-pattern-similarity-change.html#cb376-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change in the anterior-lateral entorhinal cortex (all events)&quot;</span>)</span>
<span id="cb376-14"><a href="rsa-on-pattern-similarity-change.html#cb376-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-15"><a href="rsa-on-pattern-similarity-change.html#cb376-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb376-16"><a href="rsa-on-pattern-similarity-change.html#cb376-16" aria-hidden="true" tabindex="-1"></a>stable_lme_alEC_virtime_all_events <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb376-17"><a href="rsa-on-pattern-similarity-change.html#cb376-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-18"><a href="rsa-on-pattern-similarity-change.html#cb376-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb376-19"><a href="rsa-on-pattern-similarity-change.html#cb376-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-192">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change in the anterior-lateral entorhinal cortex (all events)</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000167</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000202</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.83</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000229</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000563</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000424</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000202</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.09</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000820</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.000027</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.014734</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">3</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29767.39</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14886.69</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">4</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29769.77</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14888.89</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.39</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.036</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+(0+vir_time_diff|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>Visualize the effects.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="rsa-on-pattern-similarity-change.html#cb377-1" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb377-2"><a href="rsa-on-pattern-similarity-change.html#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term))</span>
<span id="cb377-3"><a href="rsa-on-pattern-similarity-change.html#cb377-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-4"><a href="rsa-on-pattern-similarity-change.html#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb377-5"><a href="rsa-on-pattern-similarity-change.html#cb377-5" aria-hidden="true" tabindex="-1"></a>sfigmm_k <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb377-6"><a href="rsa-on-pattern-similarity-change.html#cb377-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb377-7"><a href="rsa-on-pattern-similarity-change.html#cb377-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb377-8"><a href="rsa-on-pattern-similarity-change.html#cb377-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb377-9"><a href="rsa-on-pattern-similarity-change.html#cb377-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb377-10"><a href="rsa-on-pattern-similarity-change.html#cb377-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Virtual Time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb377-11"><a href="rsa-on-pattern-similarity-change.html#cb377-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;virtual time&quot;</span>, <span class="at">y=</span><span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">coefficient&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Time Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb377-12"><a href="rsa-on-pattern-similarity-change.html#cb377-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span>   </span>
<span id="cb377-13"><a href="rsa-on-pattern-similarity-change.html#cb377-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb377-14"><a href="rsa-on-pattern-similarity-change.html#cb377-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb377-15"><a href="rsa-on-pattern-similarity-change.html#cb377-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb377-16"><a href="rsa-on-pattern-similarity-change.html#cb377-16" aria-hidden="true" tabindex="-1"></a>sfigmm_k</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-193-1.png" width="672" /></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="rsa-on-pattern-similarity-change.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb378-2"><a href="rsa-on-pattern-similarity-change.html#cb378-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> <span class="fu">get_complete_df</span>()</span>
<span id="cb378-3"><a href="rsa-on-pattern-similarity-change.html#cb378-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-4"><a href="rsa-on-pattern-similarity-change.html#cb378-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb378-5"><a href="rsa-on-pattern-similarity-change.html#cb378-5" aria-hidden="true" tabindex="-1"></a>sfigmm_l <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb378-6"><a href="rsa-on-pattern-similarity-change.html#cb378-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb378-7"><a href="rsa-on-pattern-similarity-change.html#cb378-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb378-8"><a href="rsa-on-pattern-similarity-change.html#cb378-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb378-9"><a href="rsa-on-pattern-similarity-change.html#cb378-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb378-10"><a href="rsa-on-pattern-similarity-change.html#cb378-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb378-11"><a href="rsa-on-pattern-similarity-change.html#cb378-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z virtual time&#39;</span>) <span class="sc">+</span></span>
<span id="cb378-12"><a href="rsa-on-pattern-similarity-change.html#cb378-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb378-13"><a href="rsa-on-pattern-similarity-change.html#cb378-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb378-14"><a href="rsa-on-pattern-similarity-change.html#cb378-14" aria-hidden="true" tabindex="-1"></a>sfigmm_l</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-193-2.png" width="672" /></p>
</div>
<div id="pattern-similarity-change-visualization" class="section level4 unnumbered">
<h4>Pattern Similarity Change Visualization</h4>
<p>To further visualize the effect, lets make a plot of the raw pattern similarity change for high vs. low temporal distances, averaged across all pairs.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="rsa-on-pattern-similarity-change.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get data from alEC</span></span>
<span id="cb379-2"><a href="rsa-on-pattern-similarity-change.html#cb379-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_ec <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb379-3"><a href="rsa-on-pattern-similarity-change.html#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>)</span>
<span id="cb379-4"><a href="rsa-on-pattern-similarity-change.html#cb379-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-5"><a href="rsa-on-pattern-similarity-change.html#cb379-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for each subject dichotomize virtual time difference</span></span>
<span id="cb379-6"><a href="rsa-on-pattern-similarity-change.html#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="co"># based on a median split, then average high/low temporal distances</span></span>
<span id="cb379-7"><a href="rsa-on-pattern-similarity-change.html#cb379-7" aria-hidden="true" tabindex="-1"></a>ps_change_means <span class="ot">&lt;-</span>rsa_dat_ec <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb379-8"><a href="rsa-on-pattern-similarity-change.html#cb379-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_dist =</span> sjmisc<span class="sc">::</span><span class="fu">dicho</span>(vir_time_diff, <span class="at">as.num =</span> <span class="cn">TRUE</span>)<span class="sc">+</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-9"><a href="rsa-on-pattern-similarity-change.html#cb379-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id, temp_dist) <span class="sc">%&gt;%</span></span>
<span id="cb379-10"><a href="rsa-on-pattern-similarity-change.html#cb379-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ps_change =</span> <span class="fu">mean</span>(ps_change), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb379-11"><a href="rsa-on-pattern-similarity-change.html#cb379-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-12"><a href="rsa-on-pattern-similarity-change.html#cb379-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make the high/low temporal distance variable a factor</span></span>
<span id="cb379-13"><a href="rsa-on-pattern-similarity-change.html#cb379-13" aria-hidden="true" tabindex="-1"></a>ps_change_means <span class="ot">&lt;-</span> ps_change_means <span class="sc">%&gt;%</span></span>
<span id="cb379-14"><a href="rsa-on-pattern-similarity-change.html#cb379-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb379-15"><a href="rsa-on-pattern-similarity-change.html#cb379-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist =</span> <span class="fu">as.numeric</span>(temp_dist),</span>
<span id="cb379-16"><a href="rsa-on-pattern-similarity-change.html#cb379-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist_f =</span> <span class="fu">factor</span>(temp_dist),</span>
<span id="cb379-17"><a href="rsa-on-pattern-similarity-change.html#cb379-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist_f =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(temp_dist, <span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)),</span>
<span id="cb379-18"><a href="rsa-on-pattern-similarity-change.html#cb379-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_dist_f =</span> <span class="fu">factor</span>(temp_dist_f, <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)),</span>
<span id="cb379-19"><a href="rsa-on-pattern-similarity-change.html#cb379-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">roi =</span> <span class="st">&quot;alEC&quot;</span>)</span>
<span id="cb379-20"><a href="rsa-on-pattern-similarity-change.html#cb379-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-21"><a href="rsa-on-pattern-similarity-change.html#cb379-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add a column with subject-specific jitter</span></span>
<span id="cb379-22"><a href="rsa-on-pattern-similarity-change.html#cb379-22" aria-hidden="true" tabindex="-1"></a><span class="co"># generate custom repeating jitter (multiply with -1/1 to shift towards each other)</span></span>
<span id="cb379-23"><a href="rsa-on-pattern-similarity-change.html#cb379-23" aria-hidden="true" tabindex="-1"></a>ps_change_means <span class="ot">&lt;-</span> ps_change_means <span class="sc">%&gt;%</span> </span>
<span id="cb379-24"><a href="rsa-on-pattern-similarity-change.html#cb379-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb379-25"><a href="rsa-on-pattern-similarity-change.html#cb379-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_jit =</span> <span class="fu">as.numeric</span>(temp_dist) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">jitter</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n_subs), <span class="at">amount =</span> <span class="fl">0.05</span>), <span class="at">each=</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),n_subs))</span>
<span id="cb379-26"><a href="rsa-on-pattern-similarity-change.html#cb379-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-27"><a href="rsa-on-pattern-similarity-change.html#cb379-27" aria-hidden="true" tabindex="-1"></a>f6c<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ps_change_means, <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change, <span class="at">fill =</span> roi, <span class="at">color =</span> roi)) <span class="sc">+</span></span>
<span id="cb379-28"><a href="rsa-on-pattern-similarity-change.html#cb379-28" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp_dist_f <span class="sc">==</span> <span class="st">&quot;low&quot;</span>), </span>
<span id="cb379-29"><a href="rsa-on-pattern-similarity-change.html#cb379-29" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change),</span>
<span id="cb379-30"><a href="rsa-on-pattern-similarity-change.html#cb379-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb379-31"><a href="rsa-on-pattern-similarity-change.html#cb379-31" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb379-32"><a href="rsa-on-pattern-similarity-change.html#cb379-32" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> ps_change_means <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp_dist_f <span class="sc">==</span> <span class="st">&quot;high&quot;</span>), </span>
<span id="cb379-33"><a href="rsa-on-pattern-similarity-change.html#cb379-33" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>temp_dist, <span class="at">y=</span>ps_change),</span>
<span id="cb379-34"><a href="rsa-on-pattern-similarity-change.html#cb379-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb379-35"><a href="rsa-on-pattern-similarity-change.html#cb379-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb379-36"><a href="rsa-on-pattern-similarity-change.html#cb379-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group =</span> temp_dist),<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb379-37"><a href="rsa-on-pattern-similarity-change.html#cb379-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>sub_id,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb379-38"><a href="rsa-on-pattern-similarity-change.html#cb379-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb379-39"><a href="rsa-on-pattern-similarity-change.html#cb379-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>)),</span>
<span id="cb379-40"><a href="rsa-on-pattern-similarity-change.html#cb379-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb379-41"><a href="rsa-on-pattern-similarity-change.html#cb379-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb379-42"><a href="rsa-on-pattern-similarity-change.html#cb379-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb379-43"><a href="rsa-on-pattern-similarity-change.html#cb379-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb379-44"><a href="rsa-on-pattern-similarity-change.html#cb379-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>       </span>
<span id="cb379-45"><a href="rsa-on-pattern-similarity-change.html#cb379-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb379-46"><a href="rsa-on-pattern-similarity-change.html#cb379-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]))<span class="sc">+</span></span>
<span id="cb379-47"><a href="rsa-on-pattern-similarity-change.html#cb379-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb379-48"><a href="rsa-on-pattern-similarity-change.html#cb379-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;pattern similarity change&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;temporal distance&#39;</span>) <span class="sc">+</span></span>
<span id="cb379-49"><a href="rsa-on-pattern-similarity-change.html#cb379-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb379-50"><a href="rsa-on-pattern-similarity-change.html#cb379-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb379-51"><a href="rsa-on-pattern-similarity-change.html#cb379-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb379-52"><a href="rsa-on-pattern-similarity-change.html#cb379-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb379-53"><a href="rsa-on-pattern-similarity-change.html#cb379-53" aria-hidden="true" tabindex="-1"></a>f6c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="rsa-on-pattern-similarity-change.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb380-2"><a href="rsa-on-pattern-similarity-change.html#cb380-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f6c)<span class="sc">$</span>data[[<span class="dv">4</span>]]</span>
<span id="cb380-3"><a href="rsa-on-pattern-similarity-change.html#cb380-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x, y, group), </span>
<span id="cb380-4"><a href="rsa-on-pattern-similarity-change.html#cb380-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f6c.txt&quot;</span>))</span></code></pre></div>
<p>Now we are ready to make <strong>figure 6</strong> of the manuscript.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="rsa-on-pattern-similarity-change.html#cb381-1" aria-hidden="true" tabindex="-1"></a>layoutBC <span class="ot">&lt;-</span> <span class="st">&quot;BCC&quot;</span></span>
<span id="cb381-2"><a href="rsa-on-pattern-similarity-change.html#cb381-2" aria-hidden="true" tabindex="-1"></a>f6bc <span class="ot">&lt;-</span> f6b <span class="sc">+</span> f6c <span class="sc">+</span></span>
<span id="cb381-3"><a href="rsa-on-pattern-similarity-change.html#cb381-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layoutBC)</span>
<span id="cb381-4"><a href="rsa-on-pattern-similarity-change.html#cb381-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-5"><a href="rsa-on-pattern-similarity-change.html#cb381-5" aria-hidden="true" tabindex="-1"></a>f6a_guide <span class="ot">&lt;-</span> <span class="fu">guide_area</span>() <span class="sc">+</span> f6a <span class="sc">+</span></span>
<span id="cb381-6"><a href="rsa-on-pattern-similarity-change.html#cb381-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> <span class="st">&quot;ABBBB&quot;</span>, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) </span>
<span id="cb381-7"><a href="rsa-on-pattern-similarity-change.html#cb381-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-8"><a href="rsa-on-pattern-similarity-change.html#cb381-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-9"><a href="rsa-on-pattern-similarity-change.html#cb381-9" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb381-10"><a href="rsa-on-pattern-similarity-change.html#cb381-10" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb381-11"><a href="rsa-on-pattern-similarity-change.html#cb381-11" aria-hidden="true" tabindex="-1"></a><span class="st">BCC</span></span>
<span id="cb381-12"><a href="rsa-on-pattern-similarity-change.html#cb381-12" aria-hidden="true" tabindex="-1"></a><span class="st">BCC</span></span>
<span id="cb381-13"><a href="rsa-on-pattern-similarity-change.html#cb381-13" aria-hidden="true" tabindex="-1"></a><span class="st">BCC&quot;</span></span>
<span id="cb381-14"><a href="rsa-on-pattern-similarity-change.html#cb381-14" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> f6a <span class="sc">+</span> f6b <span class="sc">+</span> f6c <span class="sc">+</span></span>
<span id="cb381-15"><a href="rsa-on-pattern-similarity-change.html#cb381-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb381-16"><a href="rsa-on-pattern-similarity-change.html#cb381-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb381-17"><a href="rsa-on-pattern-similarity-change.html#cb381-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb381-18"><a href="rsa-on-pattern-similarity-change.html#cb381-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb381-19"><a href="rsa-on-pattern-similarity-change.html#cb381-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb381-20"><a href="rsa-on-pattern-similarity-change.html#cb381-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb381-21"><a href="rsa-on-pattern-similarity-change.html#cb381-21" aria-hidden="true" tabindex="-1"></a>f6[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> f6[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">theme_no_ticks</span>()</span>
<span id="cb381-22"><a href="rsa-on-pattern-similarity-change.html#cb381-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-23"><a href="rsa-on-pattern-similarity-change.html#cb381-23" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print</span></span>
<span id="cb381-24"><a href="rsa-on-pattern-similarity-change.html#cb381-24" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;f6&quot;</span>)</span>
<span id="cb381-25"><a href="rsa-on-pattern-similarity-change.html#cb381-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>f6, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb381-26"><a href="rsa-on-pattern-similarity-change.html#cb381-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">8.8</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb381-27"><a href="rsa-on-pattern-similarity-change.html#cb381-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>f6, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb381-28"><a href="rsa-on-pattern-similarity-change.html#cb381-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">8.8</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/f6.png" alt="" />
<p class="caption">Figure 6. The anterior-lateral entorhinal cortex uses a shared representational format for relations of events from the same and different sequences. A. The anterior-lateral entorhinal cortex region of interest is displayed on the MNI template with voxels outside the field of view shown in lighter shades of gray. Color code denotes probability of a voxel to be included based on participant-specific masks (see Methods). B. Z-values for participant-specific RSA model fits show a negative relationship between pattern similarity change and virtual temporal distances when collapsing across all event pairs. C. To illustrate the effect in B, raw pattern similarity change in the anterior-lateral entorhinal cortex was averaged for events separated by low and high temporal distances based on a median split. * p&lt;0.05</p>
</div>
</div>
</div>
<div id="alec-virtual-time-for-all-event-pairs-when-including-order-real-time" class="section level3 unnumbered">
<h3>alEC: virtual time for all event pairs when including order &amp; real time</h3>
<p>We also asked whether virtual time explains alEC pattern similarity change when including order and real time in the model as predictors of no interest. Based on the findings above, we collapse across event pairs from the same and from different sequences.</p>
<div id="summary-statistics-11" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="rsa-on-pattern-similarity-change.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SUMMARY STATS alEC WITH ORDER AND REAL TIME</span></span>
<span id="cb382-2"><a href="rsa-on-pattern-similarity-change.html#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">59</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb382-3"><a href="rsa-on-pattern-similarity-change.html#cb382-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-4"><a href="rsa-on-pattern-similarity-change.html#cb382-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all comparisons from the same day</span></span>
<span id="cb382-5"><a href="rsa-on-pattern-similarity-change.html#cb382-5" aria-hidden="true" tabindex="-1"></a>rsa_dat_alEC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb382-6"><a href="rsa-on-pattern-similarity-change.html#cb382-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>)</span>
<span id="cb382-7"><a href="rsa-on-pattern-similarity-change.html#cb382-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-8"><a href="rsa-on-pattern-similarity-change.html#cb382-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb382-9"><a href="rsa-on-pattern-similarity-change.html#cb382-9" aria-hidden="true" tabindex="-1"></a>rsa_fit_alEC_mult_reg <span class="ot">&lt;-</span> rsa_dat_alEC <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb382-10"><a href="rsa-on-pattern-similarity-change.html#cb382-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb382-11"><a href="rsa-on-pattern-similarity-change.html#cb382-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb382-12"><a href="rsa-on-pattern-similarity-change.html#cb382-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff&quot;</span>,</span>
<span id="cb382-13"><a href="rsa-on-pattern-similarity-change.html#cb382-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb382-14"><a href="rsa-on-pattern-similarity-change.html#cb382-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb382-15"><a href="rsa-on-pattern-similarity-change.html#cb382-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb382-16"><a href="rsa-on-pattern-similarity-change.html#cb382-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>)</span>
<span id="cb382-17"><a href="rsa-on-pattern-similarity-change.html#cb382-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-18"><a href="rsa-on-pattern-similarity-change.html#cb382-18" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in alEC (virtual time)</span></span>
<span id="cb382-19"><a href="rsa-on-pattern-similarity-change.html#cb382-19" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> </span>
<span id="cb382-20"><a href="rsa-on-pattern-similarity-change.html#cb382-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb382-21"><a href="rsa-on-pattern-similarity-change.html#cb382-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb382-22"><a href="rsa-on-pattern-similarity-change.html#cb382-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb382-23"><a href="rsa-on-pattern-similarity-change.html#cb382-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-24"><a href="rsa-on-pattern-similarity-change.html#cb382-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb382-25"><a href="rsa-on-pattern-similarity-change.html#cb382-25" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb382-26"><a href="rsa-on-pattern-similarity-change.html#cb382-26" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb382-27"><a href="rsa-on-pattern-similarity-change.html#cb382-27" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb382-28"><a href="rsa-on-pattern-similarity-change.html#cb382-28" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb382-29"><a href="rsa-on-pattern-similarity-change.html#cb382-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-30"><a href="rsa-on-pattern-similarity-change.html#cb382-30" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb382-31"><a href="rsa-on-pattern-similarity-change.html#cb382-31" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-196">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.144</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.702</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.489</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.495</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.567</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.278</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.129</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.513</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.245</td></tr>
</table>

Summary Statistics: t-test against 0 for virtual time (all comparisons) in aLEC with order and real time in the model<br />
t<sub>27</sub>=-0.7, p=0.495, d=-0.13, 95% CI [-0.51, 0.25]</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="rsa-on-pattern-similarity-change.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make z_id a factor and reorder it</span></span>
<span id="cb383-2"><a href="rsa-on-pattern-similarity-change.html#cb383-2" aria-hidden="true" tabindex="-1"></a>rsa_fit_alEC_mult_reg <span class="ot">&lt;-</span> rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb383-3"><a href="rsa-on-pattern-similarity-change.html#cb383-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">z_id =</span> <span class="fu">factor</span>(z_id, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))</span>
<span id="cb383-4"><a href="rsa-on-pattern-similarity-change.html#cb383-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-5"><a href="rsa-on-pattern-similarity-change.html#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb383-6"><a href="rsa-on-pattern-similarity-change.html#cb383-6" aria-hidden="true" tabindex="-1"></a>sfig7_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rsa_fit_alEC_mult_reg, <span class="fu">aes</span>(<span class="at">x=</span>z_id, <span class="at">y=</span>z, <span class="at">fill =</span> z_id, <span class="at">colour =</span> z_id)) <span class="sc">+</span></span>
<span id="cb383-7"><a href="rsa-on-pattern-similarity-change.html#cb383-7" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb383-8"><a href="rsa-on-pattern-similarity-change.html#cb383-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb383-9"><a href="rsa-on-pattern-similarity-change.html#cb383-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(z_id)<span class="sc">-</span><span class="fl">0.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb383-10"><a href="rsa-on-pattern-similarity-change.html#cb383-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb383-11"><a href="rsa-on-pattern-similarity-change.html#cb383-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb383-12"><a href="rsa-on-pattern-similarity-change.html#cb383-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb383-13"><a href="rsa-on-pattern-similarity-change.html#cb383-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb383-14"><a href="rsa-on-pattern-similarity-change.html#cb383-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb383-15"><a href="rsa-on-pattern-similarity-change.html#cb383-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb383-16"><a href="rsa-on-pattern-similarity-change.html#cb383-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb383-17"><a href="rsa-on-pattern-similarity-change.html#cb383-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb383-18"><a href="rsa-on-pattern-similarity-change.html#cb383-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;time metric&#39;</span>) <span class="sc">+</span> </span>
<span id="cb383-19"><a href="rsa-on-pattern-similarity-change.html#cb383-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb383-20"><a href="rsa-on-pattern-similarity-change.html#cb383-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">name =</span> <span class="st">&quot;time metric&quot;</span>,</span>
<span id="cb383-21"><a href="rsa-on-pattern-similarity-change.html#cb383-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb383-22"><a href="rsa-on-pattern-similarity-change.html#cb383-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])) <span class="sc">+</span></span>
<span id="cb383-23"><a href="rsa-on-pattern-similarity-change.html#cb383-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb383-24"><a href="rsa-on-pattern-similarity-change.html#cb383-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb383-25"><a href="rsa-on-pattern-similarity-change.html#cb383-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb383-26"><a href="rsa-on-pattern-similarity-change.html#cb383-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb383-27"><a href="rsa-on-pattern-similarity-change.html#cb383-27" aria-hidden="true" tabindex="-1"></a>sfig7_b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/RSA%20alEC%20raincloud%20plot%20of%20time%20metrics%20all%20pairs-1.png" width="672" /></p>
<p>Try real time in alEC for response letter.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="rsa-on-pattern-similarity-change.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb384-2"><a href="rsa-on-pattern-similarity-change.html#cb384-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-3"><a href="rsa-on-pattern-similarity-change.html#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from 1000 permutations</span></span>
<span id="cb384-4"><a href="rsa-on-pattern-similarity-change.html#cb384-4" aria-hidden="true" tabindex="-1"></a>rsa_fit_ec <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb384-5"><a href="rsa-on-pattern-similarity-change.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb384-6"><a href="rsa-on-pattern-similarity-change.html#cb384-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb384-7"><a href="rsa-on-pattern-similarity-change.html#cb384-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb384-8"><a href="rsa-on-pattern-similarity-change.html#cb384-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> ., <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ real_time_diff&quot;</span>, <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb384-9"><a href="rsa-on-pattern-similarity-change.html#cb384-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_real_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb384-10"><a href="rsa-on-pattern-similarity-change.html#cb384-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(z)</span>
<span id="cb384-11"><a href="rsa-on-pattern-similarity-change.html#cb384-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-12"><a href="rsa-on-pattern-similarity-change.html#cb384-12" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the RSA fits from the first level in alEC for both within-day and across days</span></span>
<span id="cb384-13"><a href="rsa-on-pattern-similarity-change.html#cb384-13" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_ec <span class="sc">%&gt;%</span> </span>
<span id="cb384-14"><a href="rsa-on-pattern-similarity-change.html#cb384-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_real_time) <span class="sc">%&gt;%</span> </span>
<span id="cb384-15"><a href="rsa-on-pattern-similarity-change.html#cb384-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb384-16"><a href="rsa-on-pattern-similarity-change.html#cb384-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-17"><a href="rsa-on-pattern-similarity-change.html#cb384-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb384-18"><a href="rsa-on-pattern-similarity-change.html#cb384-18" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>rsa_fit_ec<span class="sc">$</span>z_real_time, </span>
<span id="cb384-19"><a href="rsa-on-pattern-similarity-change.html#cb384-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb384-20"><a href="rsa-on-pattern-similarity-change.html#cb384-20" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb384-21"><a href="rsa-on-pattern-similarity-change.html#cb384-21" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb384-22"><a href="rsa-on-pattern-similarity-change.html#cb384-22" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb384-23"><a href="rsa-on-pattern-similarity-change.html#cb384-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-24"><a href="rsa-on-pattern-similarity-change.html#cb384-24" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb384-25"><a href="rsa-on-pattern-similarity-change.html#cb384-25" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-197">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.296</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.17</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0389</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0382</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.576</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0162</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.398</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.807</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.021</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for real time for all pairs in alEC<br />
t<sub>27</sub>=-2.17, p=0.038, d=-0.40, 95% CI [-0.81, -0.02]</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="rsa-on-pattern-similarity-change.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in alEC [real time]</span></span>
<span id="cb385-2"><a href="rsa-on-pattern-similarity-change.html#cb385-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> </span>
<span id="cb385-3"><a href="rsa-on-pattern-similarity-change.html#cb385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_real_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-4"><a href="rsa-on-pattern-similarity-change.html#cb385-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb385-5"><a href="rsa-on-pattern-similarity-change.html#cb385-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb385-6"><a href="rsa-on-pattern-similarity-change.html#cb385-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-7"><a href="rsa-on-pattern-similarity-change.html#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb385-8"><a href="rsa-on-pattern-similarity-change.html#cb385-8" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id <span class="sc">==</span> <span class="st">&quot;z_virtual_time&quot;</span>))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb385-9"><a href="rsa-on-pattern-similarity-change.html#cb385-9" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb385-10"><a href="rsa-on-pattern-similarity-change.html#cb385-10" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb385-11"><a href="rsa-on-pattern-similarity-change.html#cb385-11" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb385-12"><a href="rsa-on-pattern-similarity-change.html#cb385-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-13"><a href="rsa-on-pattern-similarity-change.html#cb385-13" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-198">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">0.148</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.764</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.451</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.446</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.547</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.129</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.513</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.245</td></tr>
</table>

Summary Statistics: t-test against 0 for real time (all comparisons) in aLEC with order and virtual time in the model<br />
t<sub>27</sub>=0.76, p=0.446, d=-0.13, 95% CI [-0.51, 0.25]</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="rsa-on-pattern-similarity-change.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in alEC [order]</span></span>
<span id="cb386-2"><a href="rsa-on-pattern-similarity-change.html#cb386-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> </span>
<span id="cb386-3"><a href="rsa-on-pattern-similarity-change.html#cb386-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_order&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb386-4"><a href="rsa-on-pattern-similarity-change.html#cb386-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb386-5"><a href="rsa-on-pattern-similarity-change.html#cb386-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb386-6"><a href="rsa-on-pattern-similarity-change.html#cb386-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-7"><a href="rsa-on-pattern-similarity-change.html#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb386-8"><a href="rsa-on-pattern-similarity-change.html#cb386-8" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_alEC_mult_reg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id <span class="sc">==</span> <span class="st">&quot;z_order&quot;</span>))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb386-9"><a href="rsa-on-pattern-similarity-change.html#cb386-9" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb386-10"><a href="rsa-on-pattern-similarity-change.html#cb386-10" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb386-11"><a href="rsa-on-pattern-similarity-change.html#cb386-11" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb386-12"><a href="rsa-on-pattern-similarity-change.html#cb386-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-13"><a href="rsa-on-pattern-similarity-change.html#cb386-13" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-199">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.155</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.885</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.384</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.384</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.514</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.204</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.162</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.549</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.211</td></tr>
</table>

Summary Statistics: t-test against 0 for order (all comparisons) in aLEC with virtual and real time in the model<br />
t<sub>27</sub>=-0.89, p=0.384, d=-0.16, 95% CI [-0.55, 0.21]</p>
</div>
<div id="linear-mixed-effects-9" class="section level4 unnumbered">
<h4>Linear Mixed Effects</h4>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="rsa-on-pattern-similarity-change.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LME alEC WITH ORDER AND REAL TIME</span></span>
<span id="cb387-2"><a href="rsa-on-pattern-similarity-change.html#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">59</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb387-3"><a href="rsa-on-pattern-similarity-change.html#cb387-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-4"><a href="rsa-on-pattern-similarity-change.html#cb387-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract all comparisons from the same day</span></span>
<span id="cb387-5"><a href="rsa-on-pattern-similarity-change.html#cb387-5" aria-hidden="true" tabindex="-1"></a>rsa_dat_alEC <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> </span>
<span id="cb387-6"><a href="rsa-on-pattern-similarity-change.html#cb387-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>)</span>
<span id="cb387-7"><a href="rsa-on-pattern-similarity-change.html#cb387-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-8"><a href="rsa-on-pattern-similarity-change.html#cb387-8" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference, order difference and real time difference as </span></span>
<span id="cb387-9"><a href="rsa-on-pattern-similarity-change.html#cb387-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effects and random intercepts and random slopes for all effects</span></span>
<span id="cb387-10"><a href="rsa-on-pattern-similarity-change.html#cb387-10" aria-hidden="true" tabindex="-1"></a><span class="co"># fails to converge and is singular after restart</span></span>
<span id="cb387-11"><a href="rsa-on-pattern-similarity-change.html#cb387-11" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff + order_diff + real_time_diff | sub_id)&quot;</span></span>
<span id="cb387-12"><a href="rsa-on-pattern-similarity-change.html#cb387-12" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_alEC, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="rsa-on-pattern-similarity-change.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the correlation between random slopes and random intercepts</span></span>
<span id="cb389-2"><a href="rsa-on-pattern-similarity-change.html#cb389-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff + order_diff + real_time_diff || sub_id)&quot;</span></span>
<span id="cb389-3"><a href="rsa-on-pattern-similarity-change.html#cb389-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_alEC, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="rsa-on-pattern-similarity-change.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># thus we reduce the random effect structure by excluding random slopes for the fixed effects of no interest</span></span>
<span id="cb391-2"><a href="rsa-on-pattern-similarity-change.html#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as above this results in a singular fit (the random intercept variance estimated to be 0)</span></span>
<span id="cb391-3"><a href="rsa-on-pattern-similarity-change.html#cb391-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff | sub_id)&quot;</span></span>
<span id="cb391-4"><a href="rsa-on-pattern-similarity-change.html#cb391-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_alEC, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="rsa-on-pattern-similarity-change.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># next step is to remove the correlation between random slopes and random intercepts</span></span>
<span id="cb393-2"><a href="rsa-on-pattern-similarity-change.html#cb393-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (1+vir_time_diff || sub_id)&quot;</span></span>
<span id="cb393-3"><a href="rsa-on-pattern-similarity-change.html#cb393-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_alEC, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="rsa-on-pattern-similarity-change.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we thus reduce further and keep only the random slopes for virtual time differences, but fit is still singular</span></span>
<span id="cb395-2"><a href="rsa-on-pattern-similarity-change.html#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">332</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb395-3"><a href="rsa-on-pattern-similarity-change.html#cb395-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + order_diff + real_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb395-4"><a href="rsa-on-pattern-similarity-change.html#cb395-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_alEC, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="rsa-on-pattern-similarity-change.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + order_diff + real_time_diff + (0 +      vir_time_diff | sub_id)
##    Data: rsa_dat_alEC
## 
##      AIC      BIC   logLik deviance df.resid 
## -29766.6 -29727.1  14889.3 -29778.6     5314 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5966 -0.6483  0.0047  0.6405  4.1872 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev.
##  sub_id   vir_time_diff 0.0000000 0.00000 
##  Residual               0.0002171 0.01473 
## Number of obs: 5320, groups:  sub_id, 28
## 
## Fixed effects:
##                  Estimate Std. Error t value
## (Intercept)     0.0001670  0.0002020   0.827
## vir_time_diff  -0.0005762  0.0005307  -1.086
## order_diff     -0.0007122  0.0008621  -0.826
## real_time_diff  0.0008616  0.0009656   0.892
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="rsa-on-pattern-similarity-change.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb399-2"><a href="rsa-on-pattern-similarity-change.html#cb399-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="rsa-on-pattern-similarity-change.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb401-2"><a href="rsa-on-pattern-similarity-change.html#cb401-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb401-3"><a href="rsa-on-pattern-similarity-change.html#cb401-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-4"><a href="rsa-on-pattern-similarity-change.html#cb401-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one way of testing for significance is by comparing the likelihood against a simpler model.</span></span>
<span id="cb401-5"><a href="rsa-on-pattern-similarity-change.html#cb401-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time difference and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb401-6"><a href="rsa-on-pattern-similarity-change.html#cb401-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb401-7"><a href="rsa-on-pattern-similarity-change.html#cb401-7" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ order_diff + real_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb401-8"><a href="rsa-on-pattern-similarity-change.html#cb401-8" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_alEC, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="rsa-on-pattern-similarity-change.html#cb403-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span>
<span id="cb403-2"><a href="rsa-on-pattern-similarity-change.html#cb403-2" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-200">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.98e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.97e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.49e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.98e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.98e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.97e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.49e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.98e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.278</td></tr>
</table>

<p>Mixed Model: Fixed effect of virtual time on alEC (all event pairs) pattern similarity change with order and real time in model
<span class="math inline">\(\chi^2\)</span>(1)=1.18, p=0.278</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="rsa-on-pattern-similarity-change.html#cb404-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)</span>
<span id="cb404-2"><a href="rsa-on-pattern-similarity-change.html#cb404-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb404-3"><a href="rsa-on-pattern-similarity-change.html#cb404-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb404-4"><a href="rsa-on-pattern-similarity-change.html#cb404-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-5"><a href="rsa-on-pattern-similarity-change.html#cb404-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb404-6"><a href="rsa-on-pattern-similarity-change.html#cb404-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb404-7"><a href="rsa-on-pattern-similarity-change.html#cb404-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb404-8"><a href="rsa-on-pattern-similarity-change.html#cb404-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb404-9"><a href="rsa-on-pattern-similarity-change.html#cb404-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb404-10"><a href="rsa-on-pattern-similarity-change.html#cb404-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb404-11"><a href="rsa-on-pattern-similarity-change.html#cb404-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb404-12"><a href="rsa-on-pattern-similarity-change.html#cb404-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb404-13"><a href="rsa-on-pattern-similarity-change.html#cb404-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time does not explain representational change for different-sequence events in the anterior-lateral entorhinal cortex when including order and real time in the model&quot;</span>)</span>
<span id="cb404-14"><a href="rsa-on-pattern-similarity-change.html#cb404-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-15"><a href="rsa-on-pattern-similarity-change.html#cb404-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb404-16"><a href="rsa-on-pattern-similarity-change.html#cb404-16" aria-hidden="true" tabindex="-1"></a>stable_lme_alEC_virtime_all_comps_time_metrics <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb404-17"><a href="rsa-on-pattern-similarity-change.html#cb404-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-18"><a href="rsa-on-pattern-similarity-change.html#cb404-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb404-19"><a href="rsa-on-pattern-similarity-change.html#cb404-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-201">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time does not explain representational change for different-sequence events in the anterior-lateral entorhinal cortex when including order and real time in the model</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000167</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000202</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.83</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000229</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000563</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000576</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000531</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.09</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001617</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000464</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">order</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000712</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000862</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.83</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.002402</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000978</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">real time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000862</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000966</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.89</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001031</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.002754</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.014733</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29767.41</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14888.71</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">6</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29766.59</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14889.30</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.18</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.278</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+order_diff+real_time_diff+(0+vir_time_diff|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>Mixed model plots.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="rsa-on-pattern-similarity-change.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set RNG</span></span>
<span id="cb405-2"><a href="rsa-on-pattern-similarity-change.html#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb405-3"><a href="rsa-on-pattern-similarity-change.html#cb405-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-4"><a href="rsa-on-pattern-similarity-change.html#cb405-4" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb405-5"><a href="rsa-on-pattern-similarity-change.html#cb405-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term) <span class="sc">%&gt;%</span> </span>
<span id="cb405-6"><a href="rsa-on-pattern-similarity-change.html#cb405-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>)))</span>
<span id="cb405-7"><a href="rsa-on-pattern-similarity-change.html#cb405-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-8"><a href="rsa-on-pattern-similarity-change.html#cb405-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb405-9"><a href="rsa-on-pattern-similarity-change.html#cb405-9" aria-hidden="true" tabindex="-1"></a>sfig7_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb405-10"><a href="rsa-on-pattern-similarity-change.html#cb405-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb405-11"><a href="rsa-on-pattern-similarity-change.html#cb405-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb405-12"><a href="rsa-on-pattern-similarity-change.html#cb405-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb405-13"><a href="rsa-on-pattern-similarity-change.html#cb405-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])) <span class="sc">+</span></span>
<span id="cb405-14"><a href="rsa-on-pattern-similarity-change.html#cb405-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Virtual Time&quot;</span>, <span class="st">&quot;Order&quot;</span>, <span class="st">&quot;Real Time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb405-15"><a href="rsa-on-pattern-similarity-change.html#cb405-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;time metric&quot;</span>, <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Time Metric&quot;</span>) <span class="sc">+</span></span>
<span id="cb405-16"><a href="rsa-on-pattern-similarity-change.html#cb405-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb405-17"><a href="rsa-on-pattern-similarity-change.html#cb405-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb405-18"><a href="rsa-on-pattern-similarity-change.html#cb405-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>()) </span>
<span id="cb405-19"><a href="rsa-on-pattern-similarity-change.html#cb405-19" aria-hidden="true" tabindex="-1"></a>sfig7_c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="rsa-on-pattern-similarity-change.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb406-2"><a href="rsa-on-pattern-similarity-change.html#cb406-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> get_complete_df</span>
<span id="cb406-3"><a href="rsa-on-pattern-similarity-change.html#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the group variable to a factor to control the order of facets below</span></span>
<span id="cb406-4"><a href="rsa-on-pattern-similarity-change.html#cb406-4" aria-hidden="true" tabindex="-1"></a>lmm_full_emm<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(lmm_full_emm<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>, <span class="st">&quot;order_diff&quot;</span>, <span class="st">&quot;real_time_diff&quot;</span>))</span>
<span id="cb406-5"><a href="rsa-on-pattern-similarity-change.html#cb406-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-6"><a href="rsa-on-pattern-similarity-change.html#cb406-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb406-7"><a href="rsa-on-pattern-similarity-change.html#cb406-7" aria-hidden="true" tabindex="-1"></a>sfig7_d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb406-8"><a href="rsa-on-pattern-similarity-change.html#cb406-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb406-9"><a href="rsa-on-pattern-similarity-change.html#cb406-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb406-10"><a href="rsa-on-pattern-similarity-change.html#cb406-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="at">name =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb406-11"><a href="rsa-on-pattern-similarity-change.html#cb406-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb406-12"><a href="rsa-on-pattern-similarity-change.html#cb406-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">unname</span>(alEC_colors[<span class="st">&quot;main&quot;</span>]), time_colors[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])) <span class="sc">+</span></span>
<span id="cb406-13"><a href="rsa-on-pattern-similarity-change.html#cb406-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb406-14"><a href="rsa-on-pattern-similarity-change.html#cb406-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z time metric&#39;</span>) <span class="sc">+</span></span>
<span id="cb406-15"><a href="rsa-on-pattern-similarity-change.html#cb406-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb406-16"><a href="rsa-on-pattern-similarity-change.html#cb406-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb406-17"><a href="rsa-on-pattern-similarity-change.html#cb406-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb406-18"><a href="rsa-on-pattern-similarity-change.html#cb406-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb406-19"><a href="rsa-on-pattern-similarity-change.html#cb406-19" aria-hidden="true" tabindex="-1"></a>sfig7_d</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-202-2.png" width="672" /></p>
</div>
<div id="alec-supplemental-figure" class="section level4" number="8.9.0.1">
<h4><span class="header-section-number">8.9.0.1</span> alEC Supplemental Figure</h4>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="rsa-on-pattern-similarity-change.html#cb407-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb407-2"><a href="rsa-on-pattern-similarity-change.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="st">AAABBBC</span></span>
<span id="cb407-3"><a href="rsa-on-pattern-similarity-change.html#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="st">AAABBBD&quot;</span></span>
<span id="cb407-4"><a href="rsa-on-pattern-similarity-change.html#cb407-4" aria-hidden="true" tabindex="-1"></a>sfig7 <span class="ot">&lt;-</span> sfig7_a <span class="sc">+</span> sfig7_b <span class="sc">+</span> sfig7_c <span class="sc">+</span> sfig7_d <span class="sc">+</span></span>
<span id="cb407-5"><a href="rsa-on-pattern-similarity-change.html#cb407-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&#39;collect&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb407-6"><a href="rsa-on-pattern-similarity-change.html#cb407-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use),</span>
<span id="cb407-7"><a href="rsa-on-pattern-similarity-change.html#cb407-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb407-8"><a href="rsa-on-pattern-similarity-change.html#cb407-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb407-9"><a href="rsa-on-pattern-similarity-change.html#cb407-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb407-10"><a href="rsa-on-pattern-similarity-change.html#cb407-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-11"><a href="rsa-on-pattern-similarity-change.html#cb407-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print to screen</span></span>
<span id="cb407-12"><a href="rsa-on-pattern-similarity-change.html#cb407-12" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf07&quot;</span>)</span>
<span id="cb407-13"><a href="rsa-on-pattern-similarity-change.html#cb407-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig7, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb407-14"><a href="rsa-on-pattern-similarity-change.html#cb407-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb407-15"><a href="rsa-on-pattern-similarity-change.html#cb407-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig7, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb407-16"><a href="rsa-on-pattern-similarity-change.html#cb407-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf07.png" alt="" />
<p class="caption">Supplemental Figure 7. Pattern similarity change in the anterior-lateral entorhinal cortex. A. Relationship of pattern similarity change and temporal distances between events from the same and different sequences in the anterior-lateral entorhinal cortex. There was no statistically significant difference between correlations of virtual temporal distances and representational change in the anterior-lateral entorhinal cortex depending on whether event pairs were from the same or different sequences. Entorhinal representational change was negatively related to temporal distances between events from the same sequence (summary statistics: t24=-3.54, p=0.002, d=-0.69, 95% CI [-1.17, -0.27]; α=0.025, corrected for separate tests of events of the same and different sequences; three outliers excluded based on the boxplot criterion). The relationship between entorhinal pattern similarity change for events from different sequences was not statistically different from zero (summary statistics: t27=-1.60, p=0.122, d=-0.29, 95% CI [-0.69, 0.08]; α=0.025, corrected for separate tests of events of the same and different sequences). ** p&lt;0.01 after outlier exclusion. B. Z-values show the relationship of the different time metrics to representational change in the anterior-lateral entorhinal cortex based on participant-specific multiple regression analyses. Analysis includes all pairs of events. C, D. Parameter estimates with 95% CI (C) and estimated marginal means (D) show the fixed effects of the three time metrics from the corresponding mixed model. A,B. Circles show participant-specific Z-values from summary statistics approach; boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points.</p>
</div>
</div>
</div>
</div>
<div id="ahpc-vs.-alec" class="section level2" number="8.10">
<h2><span class="header-section-number">8.10</span> aHPC vs. alEC</h2>
<p>The findings above suggest differences between how sequence memories in aHPC and alEC are shaped by virtual time depending on whether events from the same or from different sequences are compared. Let’s qualify these differences by running models with both ROIs.</p>
<div id="summary-statistics-12" class="section level3 unnumbered">
<h3>Summary Statistics</h3>
<blockquote>
<p>Permutation-based repeated measures ANOVAs were carried out using the permuco package111 and we report generalized η2 as effect sizes computed using the afex-package112.</p>
</blockquote>
<p>In the summary statistics approach, this comes down to a 2x2 repeated measures ANOVA with the factors ROI (aHPC vs. alEC) and sequence (same vs. different). We use a permutation-based repeated measures ANOVA to show there is a significant interaction between the two factors.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="rsa-on-pattern-similarity-change.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check &amp; effect size: parametric ANOVA using</span></span>
<span id="cb408-2"><a href="rsa-on-pattern-similarity-change.html#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="co"># run a 2x2 repeated measures ANOVA from afex package</span></span>
<span id="cb408-3"><a href="rsa-on-pattern-similarity-change.html#cb408-3" aria-hidden="true" tabindex="-1"></a>aov_fit <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;sub_id&quot;</span>, </span>
<span id="cb408-4"><a href="rsa-on-pattern-similarity-change.html#cb408-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dv =</span> <span class="st">&quot;z_virtual_time&quot;</span>, </span>
<span id="cb408-5"><a href="rsa-on-pattern-similarity-change.html#cb408-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> rsa_fit, </span>
<span id="cb408-6"><a href="rsa-on-pattern-similarity-change.html#cb408-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">within =</span> <span class="fu">c</span>(<span class="st">&quot;roi&quot;</span>, <span class="st">&quot;same_day&quot;</span>), <span class="at">print.formula =</span> <span class="cn">TRUE</span>, <span class="at">es=</span><span class="st">&quot;ges&quot;</span>)</span></code></pre></div>
<pre><code>## Formula send to aov_car: z_virtual_time ~ 1 + Error(sub_id/(roi * same_day))</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="rsa-on-pattern-similarity-change.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print stats</span></span>
<span id="cb410-2"><a href="rsa-on-pattern-similarity-change.html#cb410-2" aria-hidden="true" tabindex="-1"></a>aov_fit</span></code></pre></div>
<pre><code>## Anova Table (Type 3 tests)
## 
## Response: z_virtual_time
##         Effect    df  MSE       F  ges p.value
## 1          roi 1, 27 0.82  3.10 + .024    .089
## 2     same_day 1, 27 1.22  7.41 * .082    .011
## 3 roi:same_day 1, 27 1.09 7.76 ** .076    .010
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="rsa-on-pattern-similarity-change.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb412-2"><a href="rsa-on-pattern-similarity-change.html#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation repeated measures from permuco package (use factorial same_day variable)</span></span>
<span id="cb412-3"><a href="rsa-on-pattern-similarity-change.html#cb412-3" aria-hidden="true" tabindex="-1"></a>aov_fit_perm <span class="ot">&lt;-</span> permuco<span class="sc">::</span><span class="fu">aovperm</span>(<span class="at">formula =</span> z_virtual_time <span class="sc">~</span> roi <span class="sc">*</span> same_day_char <span class="sc">+</span> <span class="fu">Error</span>(sub_id<span class="sc">/</span>(roi<span class="sc">*</span>same_day_char)), </span>
<span id="cb412-4"><a href="rsa-on-pattern-similarity-change.html#cb412-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> rsa_fit, <span class="at">method =</span> <span class="st">&quot;Rd_kheradPajouh_renaud&quot;</span>, <span class="at">np =</span>n_perm)</span>
<span id="cb412-5"><a href="rsa-on-pattern-similarity-change.html#cb412-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_fit_perm)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-204">
<col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SSn</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dfn</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SSd</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dfd</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">MSEn</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">MSEd</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">F</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parametric P(&gt;F)</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">permutation P(&gt;F)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.55</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">22.2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.55</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.822</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.0895&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.0859</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.06</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">33&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.06</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.22&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7.41</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0112&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0115</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">8.43</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">29.3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">8.43</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.09&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7.76</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00964</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.0102</td></tr>
</table>

<p>Summary Statistics: permutation-based repeated measures ANOVA (Rd_kheradPajouh_renaud method)
main effect of ROI: F<sub>1,27</sub>=3.1, p=0.086, <span class="math inline">\(\eta^2\)</span>=0.02<br />
main effect of sequence: F<sub>1,27</sub>=7.41, p=0.012, <span class="math inline">\(\eta^2\)</span>=0.08<br />
interaction ROI and sequence: F<sub>1,27</sub>=7.76, p=0.010, <span class="math inline">\(\eta^2\)</span>=0.08</p>
</div>
<div id="linear-mixed-effects-10" class="section level3 unnumbered">
<h3>Linear Mixed Effects</h3>
<p>To test whether the hippocampus and entorhinal cortex differentially represent virtual time between events within a virtual day and also virtual days, we also run a linear mixed model on pattern similarity change in both regions that includes event pairs that are from the same day, but also from different days. We include the fixed effects ROI (aHPC and alEC), day (same or different) and virtual time difference as well as their interaction in the model.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="rsa-on-pattern-similarity-change.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get data from aHPC and alEC for within and across day comparisons</span></span>
<span id="cb413-2"><a href="rsa-on-pattern-similarity-change.html#cb413-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_mtl <span class="ot">&lt;-</span> rsa_dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span> <span class="sc">|</span> roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>)</span>
<span id="cb413-3"><a href="rsa-on-pattern-similarity-change.html#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="rsa-on-pattern-similarity-change.html#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co"># recode the ROI factor to -1 and 1</span></span>
<span id="cb413-5"><a href="rsa-on-pattern-similarity-change.html#cb413-5" aria-hidden="true" tabindex="-1"></a>rsa_dat_mtl <span class="ot">&lt;-</span> rsa_dat_mtl <span class="sc">%&gt;%</span></span>
<span id="cb413-6"><a href="rsa-on-pattern-similarity-change.html#cb413-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb413-7"><a href="rsa-on-pattern-similarity-change.html#cb413-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">roi_dv =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(roi, <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;alEC_lr&quot;</span>, <span class="st">&quot;aHPC_lr&quot;</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb413-8"><a href="rsa-on-pattern-similarity-change.html#cb413-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb413-9"><a href="rsa-on-pattern-similarity-change.html#cb413-9" aria-hidden="true" tabindex="-1"></a><span class="co"># run LME for effect of time with factors same/different day vs. ROI</span></span>
<span id="cb413-10"><a href="rsa-on-pattern-similarity-change.html#cb413-10" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercepts and all random slopes and interactions --&gt; singular fit</span></span>
<span id="cb413-11"><a href="rsa-on-pattern-similarity-change.html#cb413-11" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv * roi_dv + (1 + vir_time_diff * same_day_dv * roi_dv | sub_id)&quot;</span></span>
<span id="cb413-12"><a href="rsa-on-pattern-similarity-change.html#cb413-12" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_mtl, <span class="at">REML=</span><span class="cn">FALSE</span>,</span>
<span id="cb413-13"><a href="rsa-on-pattern-similarity-change.html#cb413-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span><span class="st">&quot;bobyqa&quot;</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">40000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="rsa-on-pattern-similarity-change.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove correlation between random slopes and random intercepts --&gt; singular fit</span></span>
<span id="cb415-2"><a href="rsa-on-pattern-similarity-change.html#cb415-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv * roi_dv + (1 + vir_time_diff * same_day_dv * roi_dv || sub_id)&quot;</span></span>
<span id="cb415-3"><a href="rsa-on-pattern-similarity-change.html#cb415-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_mtl, <span class="at">REML=</span><span class="cn">FALSE</span>,</span>
<span id="cb415-4"><a href="rsa-on-pattern-similarity-change.html#cb415-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span><span class="st">&quot;bobyqa&quot;</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">40000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="rsa-on-pattern-similarity-change.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only highest-order interaction as random slopes</span></span>
<span id="cb417-2"><a href="rsa-on-pattern-similarity-change.html#cb417-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff * same_day_dv * roi_dv + (1 + vir_time_diff : same_day_dv : roi_dv | sub_id)&quot;</span></span>
<span id="cb417-3"><a href="rsa-on-pattern-similarity-change.html#cb417-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_mtl, <span class="at">REML=</span><span class="cn">FALSE</span>,</span>
<span id="cb417-4"><a href="rsa-on-pattern-similarity-change.html#cb417-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span><span class="st">&quot;bobyqa&quot;</span>, <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">40000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="rsa-on-pattern-similarity-change.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lmm_full = lme4::lmer(formula, data=rsa_dat_mtl, REML=FALSE,</span></span>
<span id="cb419-2"><a href="rsa-on-pattern-similarity-change.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                control = lmerControl(optimizer =&#39;optimx&#39;, optCtrl=list(method=&#39;nlminb&#39;, maxit=100000)))</span></span>
<span id="cb419-3"><a href="rsa-on-pattern-similarity-change.html#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">398</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb419-4"><a href="rsa-on-pattern-similarity-change.html#cb419-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">=</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data=</span>rsa_dat_mtl, <span class="at">REML=</span><span class="cn">FALSE</span>,</span>
<span id="cb419-5"><a href="rsa-on-pattern-similarity-change.html#cb419-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span><span class="st">&#39;nloptwrap&#39;</span>, </span>
<span id="cb419-6"><a href="rsa-on-pattern-similarity-change.html#cb419-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">method=</span><span class="st">&#39;NLOPT_LN_NELDERMEAD&#39;</span>, <span class="at">maxfun=</span><span class="dv">100000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="rsa-on-pattern-similarity-change.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff * same_day_dv * roi_dv + (1 + vir_time_diff:same_day_dv:roi_dv |      sub_id)
##    Data: rsa_dat_mtl
## Control: lmerControl(optimizer = &quot;nloptwrap&quot;, optCtrl = list(method = &quot;NLOPT_LN_NELDERMEAD&quot;,      maxfun = 1e+05))
## 
##      AIC      BIC   logLik deviance df.resid 
## -64704.2 -64595.1  32367.1 -64734.2    10625 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.9391 -0.5647  0.0096  0.5629  5.3781 
## 
## Random effects:
##  Groups   Name                               Variance  Std.Dev.  Corr       
##  sub_id   (Intercept)                        2.460e-07 0.0004960            
##           vir_time_diff:same_day_dv:roi_dv1  2.897e-08 0.0001702 -1.00      
##           vir_time_diff:same_day_dv:roi_dv-1 1.772e-07 0.0004209 -0.15  0.15
##  Residual                                    1.332e-04 0.0115397            
## Number of obs: 10640, groups:  sub_id, 28
## 
## Fixed effects:
##                                      Estimate Std. Error t value
## (Intercept)                        -0.0001934  0.0002186  -0.885
## vir_time_diff                       0.0002384  0.0001997   1.194
## same_day_dv                        -0.0001327  0.0001974  -0.672
## roi_dv-1                            0.0004546  0.0002792   1.628
## vir_time_diff:same_day_dv           0.0005129  0.0002022   2.536
## vir_time_diff:roi_dv-1             -0.0008100  0.0002824  -2.868
## same_day_dv:roi_dv-1                0.0002612  0.0002792   0.936
## vir_time_diff:same_day_dv:roi_dv-1 -0.0007449  0.0002938  -2.535
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="rsa-on-pattern-similarity-change.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb423-2"><a href="rsa-on-pattern-similarity-change.html#cb423-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, </span>
<span id="cb423-3"><a href="rsa-on-pattern-similarity-change.html#cb423-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">optimizer =</span> <span class="st">&#39;bobyqa&#39;</span>)</span>
<span id="cb423-4"><a href="rsa-on-pattern-similarity-change.html#cb423-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-5"><a href="rsa-on-pattern-similarity-change.html#cb423-5" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb423-6"><a href="rsa-on-pattern-similarity-change.html#cb423-6" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb423-7"><a href="rsa-on-pattern-similarity-change.html#cb423-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-8"><a href="rsa-on-pattern-similarity-change.html#cb423-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to reduced model without interaction term</span></span>
<span id="cb423-9"><a href="rsa-on-pattern-similarity-change.html#cb423-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">351</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb423-10"><a href="rsa-on-pattern-similarity-change.html#cb423-10" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span><span class="fu">update</span>(lmm_full, <span class="sc">~</span> . <span class="sc">-</span> vir_time_diff<span class="sc">:</span>same_day_dv<span class="sc">:</span>roi_dv)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="rsa-on-pattern-similarity-change.html#cb425-1" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_reduced, lmm_full)</span>
<span id="cb425-2"><a href="rsa-on-pattern-similarity-change.html#cb425-2" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-205">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-6.47e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-6.46e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.24e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-6.47e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-6.47e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-6.46e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.24e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-6.47e+04</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.31</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.012</td></tr>
</table>

<p>Mixed Model: Fixed effect of interaction virtual time with sequence identity and ROI on pattern similarity change
<span class="math inline">\(\chi^2\)</span>(1)=6.31, p=0.012</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="rsa-on-pattern-similarity-change.html#cb426-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;ROI&quot;</span>, <span class="st">&quot;virtual time * day&quot;</span>, </span>
<span id="cb426-2"><a href="rsa-on-pattern-similarity-change.html#cb426-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;virtual time * ROI&quot;</span>, <span class="st">&quot;day * ROI&quot;</span>, <span class="st">&quot;virtual time * day * ROI&quot;</span>)</span>
<span id="cb426-3"><a href="rsa-on-pattern-similarity-change.html#cb426-3" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">6</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb426-4"><a href="rsa-on-pattern-similarity-change.html#cb426-4" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept (SD)&quot;</span>, <span class="st">&quot;corr. intercept, virtual time:day:ROI1&quot;</span>,</span>
<span id="cb426-5"><a href="rsa-on-pattern-similarity-change.html#cb426-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;corr. intercept, virtual time:day:ROI-1&quot;</span>, <span class="st">&quot;virtual time:day:ROI1 (SD)&quot;</span>,</span>
<span id="cb426-6"><a href="rsa-on-pattern-similarity-change.html#cb426-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;corr. virtual time:day:ROI1, virtual time:day:ROI-1&quot;</span>, </span>
<span id="cb426-7"><a href="rsa-on-pattern-similarity-change.html#cb426-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;virtual time:day:ROI-1 (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb426-8"><a href="rsa-on-pattern-similarity-change.html#cb426-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-9"><a href="rsa-on-pattern-similarity-change.html#cb426-9" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb426-10"><a href="rsa-on-pattern-similarity-change.html#cb426-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb426-11"><a href="rsa-on-pattern-similarity-change.html#cb426-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb426-12"><a href="rsa-on-pattern-similarity-change.html#cb426-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb426-13"><a href="rsa-on-pattern-similarity-change.html#cb426-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb426-14"><a href="rsa-on-pattern-similarity-change.html#cb426-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb426-15"><a href="rsa-on-pattern-similarity-change.html#cb426-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb426-16"><a href="rsa-on-pattern-similarity-change.html#cb426-16" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb426-17"><a href="rsa-on-pattern-similarity-change.html#cb426-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: The effect of virtual time differentially depends on sequence membership in the anterior hippocampus and the anterior-lateral entorhinal cortex&quot;</span>)</span>
<span id="cb426-18"><a href="rsa-on-pattern-similarity-change.html#cb426-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-19"><a href="rsa-on-pattern-similarity-change.html#cb426-19" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb426-20"><a href="rsa-on-pattern-similarity-change.html#cb426-20" aria-hidden="true" tabindex="-1"></a>stable_lme_virtime_aHPC_vs_alEC <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb426-21"><a href="rsa-on-pattern-similarity-change.html#cb426-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-22"><a href="rsa-on-pattern-similarity-change.html#cb426-22" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb426-23"><a href="rsa-on-pattern-similarity-change.html#cb426-23" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-206">
<caption style="caption-side: top; text-align: left;">Mixed Model: The effect of virtual time differentially depends on sequence membership in the anterior hippocampus and the anterior-lateral entorhinal cortex</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000193</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000219</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.89</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000622</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000235</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000238</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000200</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.19</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000153</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000630</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000133</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000197</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.67</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000520</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000254</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">ROI</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000455</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000279</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.63</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000093</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.001002</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time * day</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000513</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000202</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.54</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000117</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000909</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time * ROI</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000810</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000282</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.87</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001363</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.000257</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">day * ROI</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000261</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000279</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.94</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000286</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000808</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time * day * ROI</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000745</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000294</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.54</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.001321</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.000169</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">intercept (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000496</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">corr. intercept, virtual time:day:ROI1</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-1.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">corr. intercept, virtual time:day:ROI-1</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.151340</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time:day:ROI1 (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000170</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">corr. virtual time:day:ROI1, virtual time:day:ROI-1</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.151340</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time:day:ROI-1 (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000421</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.011540</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">14</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-64699.87</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">32363.94</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">15</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-64704.19</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">32367.09</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.31</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.012</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff*same_day_dv*roi_dv+(1+vir_time_diff:same_day_dv:roi_dv|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

</div>
</div>
<div id="searchlight-results" class="section level2" number="8.11">
<h2><span class="header-section-number">8.11</span> Searchlight Results</h2>
<blockquote>
<p>We further probed how temporal distances between events shaped representational change using searchlight analyses. Using the procedures described above, we calculated pattern similarity change values for search spheres with a radius of 3 voxels around the center voxel. Search spheres were centered on all brain voxels within our field of view. Within a given search sphere, only gray matter voxels were analyzed. Search spheres not containing more than 25 gray matter voxels were discarded. For each search sphere, we implemented linear models to quantify the relationship between representational change and the learned temporal structure. Specifically, we assessed the relationship of pattern similarity change and absolute virtual temporal distances, separately for event pairs from the same sequences and from pairs from different sequences. In a third model, we included all event pairs and tested for an interaction effect of sequence membership (same or different) predictor and virtual temporal distances. The t-values of the respective regressors of interest were stored at the center voxel of a given search sphere.</p>
<p>The resulting t-maps were registered to MNI space for group level statistics and spatially smoothed (FWHM 3mm). Group level statistics were carried out using random sign flipping implemented with FSL Randomise and threshold-free cluster enhancement. We corrected for multiple comparisons using a small volume correction mask including our a priori regions of interest, the anterior hippocampus and the anterior-lateral entorhinal cortex. Further, we used a liberal threshold of puncorrected&lt;0.001 to explore the data for additional effects within our field of view. Exploratory searchlight results are shown in Supplemental Figure 9 and clusters with a minimum extent of 30 voxels are listed in Supplemental Tables 12, 14 and 15.</p>
</blockquote>
<p>To complement our ROI-analyses we also ran searchlights analyses. Here, we used search spheres with a 3 voxel radius around the center voxel. Each brain voxel served as a sphere center, but only gray matter voxels were analyzed as features. We analyzed the relationship of virtual temporal distances to pattern similarity changes for events from the same day only, from different days only, and for the interaction of virtual time with the same/different day factor.</p>
<p>First, we load the MNI template brain (1mm resolution) and gray out the voxels outside the field of view.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="rsa-on-pattern-similarity-change.html#cb427-1" aria-hidden="true" tabindex="-1"></a>radius<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb427-2"><a href="rsa-on-pattern-similarity-change.html#cb427-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-3"><a href="rsa-on-pattern-similarity-change.html#cb427-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 mm MNI template as background image</span></span>
<span id="cb427-4"><a href="rsa-on-pattern-similarity-change.html#cb427-4" aria-hidden="true" tabindex="-1"></a>mni_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;MNI152_T1_1mm_brain.nii.gz&quot;</span>)</span>
<span id="cb427-5"><a href="rsa-on-pattern-similarity-change.html#cb427-5" aria-hidden="true" tabindex="-1"></a>mni_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(mni_fn)</span>
<span id="cb427-6"><a href="rsa-on-pattern-similarity-change.html#cb427-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-7"><a href="rsa-on-pattern-similarity-change.html#cb427-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load FOV mask and binarize it</span></span>
<span id="cb427-8"><a href="rsa-on-pattern-similarity-change.html#cb427-8" aria-hidden="true" tabindex="-1"></a>fov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;fov_mask_mni.nii.gz&quot;</span>)</span>
<span id="cb427-9"><a href="rsa-on-pattern-similarity-change.html#cb427-9" aria-hidden="true" tabindex="-1"></a>fov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fov_fn)</span>
<span id="cb427-10"><a href="rsa-on-pattern-similarity-change.html#cb427-10" aria-hidden="true" tabindex="-1"></a>fov_nii[fov_nii <span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb427-11"><a href="rsa-on-pattern-similarity-change.html#cb427-11" aria-hidden="true" tabindex="-1"></a>fov_nii[fov_nii <span class="sc">!=</span><span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb427-12"><a href="rsa-on-pattern-similarity-change.html#cb427-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-13"><a href="rsa-on-pattern-similarity-change.html#cb427-13" aria-hidden="true" tabindex="-1"></a><span class="co"># make a mask for the brain area outside our FOV</span></span>
<span id="cb427-14"><a href="rsa-on-pattern-similarity-change.html#cb427-14" aria-hidden="true" tabindex="-1"></a>out_fov <span class="ot">&lt;-</span> (fov_nii <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (mni_nii<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb427-15"><a href="rsa-on-pattern-similarity-change.html#cb427-15" aria-hidden="true" tabindex="-1"></a>mni_nii[out_fov] <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">rescale</span>(mni_nii[out_fov], <span class="at">from=</span><span class="fu">range</span>(mni_nii[out_fov]), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">6000</span>, <span class="dv">8207</span>))</span>
<span id="cb427-16"><a href="rsa-on-pattern-similarity-change.html#cb427-16" aria-hidden="true" tabindex="-1"></a>mni_nii[mni_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<div id="virtual-time-within-sequence" class="section level3 unnumbered">
<h3>Virtual Time Within Sequence</h3>
<p>Report significant clusters after small volume correction.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="rsa-on-pattern-similarity-change.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the cluster file for corrected results</span></span>
<span id="cb428-2"><a href="rsa-on-pattern-similarity-change.html#cb428-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,</span>
<span id="cb428-3"><a href="rsa-on-pattern-similarity-change.html#cb428-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;same_day_vir_time&quot;</span>, <span class="st">&quot;cluster_same_day_vir_time_svc_corrp_atlas.txt&quot;</span>)</span>
<span id="cb428-4"><a href="rsa-on-pattern-similarity-change.html#cb428-4" aria-hidden="true" tabindex="-1"></a>corrp_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(fn, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;ccdddddddddd&quot;</span>))</span>
<span id="cb428-5"><a href="rsa-on-pattern-similarity-change.html#cb428-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-6"><a href="rsa-on-pattern-similarity-change.html#cb428-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with p-values (not 1-p as given by FSL) and manual labels</span></span>
<span id="cb428-7"><a href="rsa-on-pattern-similarity-change.html#cb428-7" aria-hidden="true" tabindex="-1"></a>corrp_df <span class="ot">&lt;-</span> corrp_df <span class="sc">%&gt;%</span></span>
<span id="cb428-8"><a href="rsa-on-pattern-similarity-change.html#cb428-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb428-9"><a href="rsa-on-pattern-similarity-change.html#cb428-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>max_1minusp,</span>
<span id="cb428-10"><a href="rsa-on-pattern-similarity-change.html#cb428-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">atlas_label =</span> <span class="fu">c</span>(<span class="st">&quot;left hippocampus&quot;</span>, <span class="st">&quot;right hippocampus&quot;</span>, <span class="st">&quot;left hippocampus&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb428-11"><a href="rsa-on-pattern-similarity-change.html#cb428-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(max_1minusp, <span class="st">&quot;Harvard_Oxford_Cortical&quot;</span>, <span class="st">&quot;Harvard_Oxford_Subcortical&quot;</span>, cluster_index)) <span class="sc">%&gt;%</span></span>
<span id="cb428-12"><a href="rsa-on-pattern-similarity-change.html#cb428-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(atlas_label)</span>
<span id="cb428-13"><a href="rsa-on-pattern-similarity-change.html#cb428-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-14"><a href="rsa-on-pattern-similarity-change.html#cb428-14" aria-hidden="true" tabindex="-1"></a><span class="co"># quick print</span></span>
<span id="cb428-15"><a href="rsa-on-pattern-similarity-change.html#cb428-15" aria-hidden="true" tabindex="-1"></a><span class="co">#corrp_df %&gt;% huxtable::as_huxtable() %&gt;% theme_article()</span></span>
<span id="cb428-16"><a href="rsa-on-pattern-similarity-change.html#cb428-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-17"><a href="rsa-on-pattern-similarity-change.html#cb428-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen </span></span>
<span id="cb428-18"><a href="rsa-on-pattern-similarity-change.html#cb428-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;significant clusters in same day searchlight:&quot;</span>,</span>
<span id="cb428-19"><a href="rsa-on-pattern-similarity-change.html#cb428-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">%s, peak voxel at x=%d, y=%d, z=%d; t=%.2f, corrected p=%.3f&quot;</span>,</span>
<span id="cb428-20"><a href="rsa-on-pattern-similarity-change.html#cb428-20" aria-hidden="true" tabindex="-1"></a>            corrp_df<span class="sc">$</span>atlas_label, corrp_df<span class="sc">$</span>x, corrp_df<span class="sc">$</span>y, corrp_df<span class="sc">$</span>z, corrp_df<span class="sc">$</span>t_extr, corrp_df<span class="sc">$</span>p))</span></code></pre></div>
<pre><code>## significant clusters in same day searchlight: 
## left hippocampus, peak voxel at x=-24, y=-13, z=-20; t=4.53, corrected p=0.006 
## right hippocampus, peak voxel at x=31, y=-16, z=-20; t=3.56, corrected p=0.035 
## left hippocampus, peak voxel at x=-27, y=-20, z=-15; t=3.47, corrected p=0.029</code></pre>
<p>Report additional clusters from exploratory analysis with threshold p&lt;0.001 uncorrected and a minimum of 30 voxels per cluster.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="rsa-on-pattern-similarity-change.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the cluster file for uncorrected results</span></span>
<span id="cb430-2"><a href="rsa-on-pattern-similarity-change.html#cb430-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,</span>
<span id="cb430-3"><a href="rsa-on-pattern-similarity-change.html#cb430-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;same_day_vir_time&quot;</span>, <span class="st">&quot;cluster_same_day_vir_time_fov_uncorrp_atlas.txt&quot;</span>)</span>
<span id="cb430-4"><a href="rsa-on-pattern-similarity-change.html#cb430-4" aria-hidden="true" tabindex="-1"></a>uncorrp_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(fn, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;ccdddddddddd&quot;</span>))</span>
<span id="cb430-5"><a href="rsa-on-pattern-similarity-change.html#cb430-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-6"><a href="rsa-on-pattern-similarity-change.html#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with p-values (not 1-p as given by FSL) and manual labels</span></span>
<span id="cb430-7"><a href="rsa-on-pattern-similarity-change.html#cb430-7" aria-hidden="true" tabindex="-1"></a>uncorrp_df <span class="ot">&lt;-</span> uncorrp_df <span class="sc">%&gt;%</span></span>
<span id="cb430-8"><a href="rsa-on-pattern-similarity-change.html#cb430-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb430-9"><a href="rsa-on-pattern-similarity-change.html#cb430-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>max_1minusp,</span>
<span id="cb430-10"><a href="rsa-on-pattern-similarity-change.html#cb430-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">atlas_label =</span> <span class="fu">c</span>(</span>
<span id="cb430-11"><a href="rsa-on-pattern-similarity-change.html#cb430-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;frontal pole&quot;</span>,</span>
<span id="cb430-12"><a href="rsa-on-pattern-similarity-change.html#cb430-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;frontal pole&quot;</span>,</span>
<span id="cb430-13"><a href="rsa-on-pattern-similarity-change.html#cb430-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;left hippocampus&quot;</span>,</span>
<span id="cb430-14"><a href="rsa-on-pattern-similarity-change.html#cb430-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;left entorhinal cortex&quot;</span>,</span>
<span id="cb430-15"><a href="rsa-on-pattern-similarity-change.html#cb430-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;inferior frontal gyrus&quot;</span>,</span>
<span id="cb430-16"><a href="rsa-on-pattern-similarity-change.html#cb430-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;lingual gyrus&quot;</span>,</span>
<span id="cb430-17"><a href="rsa-on-pattern-similarity-change.html#cb430-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;frontal medial cortex&quot;</span>,</span>
<span id="cb430-18"><a href="rsa-on-pattern-similarity-change.html#cb430-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;left hippocampus&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb430-19"><a href="rsa-on-pattern-similarity-change.html#cb430-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(max_1minusp, <span class="st">&quot;Harvard_Oxford_Cortical&quot;</span>, <span class="st">&quot;Harvard_Oxford_Subcortical&quot;</span>, cluster_index)) <span class="sc">%&gt;%</span></span>
<span id="cb430-20"><a href="rsa-on-pattern-similarity-change.html#cb430-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(atlas_label, <span class="st">&quot;hippocampus&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove hippocampal clusters (already reported with SVC)</span></span>
<span id="cb430-21"><a href="rsa-on-pattern-similarity-change.html#cb430-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(atlas_label)</span>
<span id="cb430-22"><a href="rsa-on-pattern-similarity-change.html#cb430-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-23"><a href="rsa-on-pattern-similarity-change.html#cb430-23" aria-hidden="true" tabindex="-1"></a><span class="co"># add p-values because small values are reported as 0 by FSL cluster</span></span>
<span id="cb430-24"><a href="rsa-on-pattern-similarity-change.html#cb430-24" aria-hidden="true" tabindex="-1"></a>uncorrp_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb430-25"><a href="rsa-on-pattern-similarity-change.html#cb430-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;same_day_vir_time_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb430-26"><a href="rsa-on-pattern-similarity-change.html#cb430-26" aria-hidden="true" tabindex="-1"></a>uncorrp_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(uncorrp_fn)</span>
<span id="cb430-27"><a href="rsa-on-pattern-similarity-change.html#cb430-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(uncorrp_df)){</span>
<span id="cb430-28"><a href="rsa-on-pattern-similarity-change.html#cb430-28" aria-hidden="true" tabindex="-1"></a>  coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(uncorrp_df[i,]<span class="sc">$</span>x,uncorrp_df[i,]<span class="sc">$</span>y,uncorrp_df[i,]<span class="sc">$</span>z))</span>
<span id="cb430-29"><a href="rsa-on-pattern-similarity-change.html#cb430-29" aria-hidden="true" tabindex="-1"></a>  uncorrp_df[i,]<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>uncorrp_nii[coords[<span class="dv">1</span>], coords[<span class="dv">2</span>], coords[<span class="dv">3</span>]]</span>
<span id="cb430-30"><a href="rsa-on-pattern-similarity-change.html#cb430-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb430-31"><a href="rsa-on-pattern-similarity-change.html#cb430-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-32"><a href="rsa-on-pattern-similarity-change.html#cb430-32" aria-hidden="true" tabindex="-1"></a><span class="co"># quick print</span></span>
<span id="cb430-33"><a href="rsa-on-pattern-similarity-change.html#cb430-33" aria-hidden="true" tabindex="-1"></a><span class="co">#uncorrp_df %&gt;% huxtable::as_huxtable() %&gt;% theme_article()</span></span></code></pre></div>
<p>Create supplemental table.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="rsa-on-pattern-similarity-change.html#cb431-1" aria-hidden="true" tabindex="-1"></a>corrp_ht <span class="ot">&lt;-</span> corrp_df <span class="sc">%&gt;%</span> </span>
<span id="cb431-2"><a href="rsa-on-pattern-similarity-change.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_huxtable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb431-3"><a href="rsa-on-pattern-similarity-change.html#cb431-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="fu">c</span>(<span class="st">&quot;Atlas Label&quot;</span>, <span class="st">&quot;Voxel Extent&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;COG x&quot;</span>, <span class="st">&quot;COG y&quot;</span>, <span class="st">&quot;COG z&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;p&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb431-4"><a href="rsa-on-pattern-similarity-change.html#cb431-4" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">insert_row</span>(., <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="fu">ncol</span>(.)), <span class="at">after=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-5"><a href="rsa-on-pattern-similarity-change.html#cb431-5" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">merge_across</span>(.,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb431-6"><a href="rsa-on-pattern-similarity-change.html#cb431-6" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="st">&quot;Searchlight results in a priori regions of interest, p-values corrected using small volume correction&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-7"><a href="rsa-on-pattern-similarity-change.html#cb431-7" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_header_rows</span>(.,<span class="at">row=</span><span class="dv">1</span>, <span class="at">value=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-8"><a href="rsa-on-pattern-similarity-change.html#cb431-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_article</span>()</span>
<span id="cb431-9"><a href="rsa-on-pattern-similarity-change.html#cb431-9" aria-hidden="true" tabindex="-1"></a>corrp_ht</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-210">
<col><col><col><col><col><col><col><col><col><col><tr>
<th colspan="10" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Searchlight results in a priori regions of interest, p-values corrected using small volume correction</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Atlas Label</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Voxel Extent</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">left hippocampus</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">193</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-24</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-13</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-23.3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-13.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-19.8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.53</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.006</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">right hippocampus</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">96</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">31</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">30.1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-16.7</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-19.8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.56</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.035</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">left hippocampus</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">76</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-27.9</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-19.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-16.6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.47</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.029</td></tr>
</table>

<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="rsa-on-pattern-similarity-change.html#cb432-1" aria-hidden="true" tabindex="-1"></a>uncorrp_ht <span class="ot">&lt;-</span> uncorrp_df <span class="sc">%&gt;%</span> </span>
<span id="cb432-2"><a href="rsa-on-pattern-similarity-change.html#cb432-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_huxtable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb432-3"><a href="rsa-on-pattern-similarity-change.html#cb432-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="fu">c</span>(<span class="st">&quot;Atlas Label&quot;</span>, <span class="st">&quot;Voxel Extent&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;COG x&quot;</span>, <span class="st">&quot;COG y&quot;</span>, <span class="st">&quot;COG z&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;p&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb432-4"><a href="rsa-on-pattern-similarity-change.html#cb432-4" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">insert_row</span>(., <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="fu">ncol</span>(.)), <span class="at">after=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb432-5"><a href="rsa-on-pattern-similarity-change.html#cb432-5" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">merge_across</span>(.,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb432-6"><a href="rsa-on-pattern-similarity-change.html#cb432-6" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="st">&quot;Exploratory searchlight results, p-values uncorrected&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb432-7"><a href="rsa-on-pattern-similarity-change.html#cb432-7" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_header_rows</span>(.,<span class="at">row=</span><span class="dv">1</span>, <span class="at">value=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb432-8"><a href="rsa-on-pattern-similarity-change.html#cb432-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_article</span>()</span>
<span id="cb432-9"><a href="rsa-on-pattern-similarity-change.html#cb432-9" aria-hidden="true" tabindex="-1"></a>uncorrp_ht</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-210">
<col><col><col><col><col><col><col><col><col><col><tr>
<th colspan="10" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Exploratory searchlight results, p-values uncorrected</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Atlas Label</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Voxel Extent</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">frontal pole</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">399</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">50</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">44</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">48.3&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">41.6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">19.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.96</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">frontal pole</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">173</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">53</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">41</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-7</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">51.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">42.9</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-4.45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.56</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">left entorhinal cortex</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">119</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-18</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-32</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-21.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-14.6</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-31.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0004</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">inferior frontal gyrus</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">91</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">40</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">44.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">28&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.59</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.29</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">lingual gyrus</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">86</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-17</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-58</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-15</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-15.7&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-56.9</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-9.64</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.82</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">frontal medial cortex</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">49</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">35</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-23</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.29</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">36.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-24.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.28</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0004</td></tr>
</table>

<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="rsa-on-pattern-similarity-change.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge and convert to flexable that can be written to Word</span></span>
<span id="cb433-2"><a href="rsa-on-pattern-similarity-change.html#cb433-2" aria-hidden="true" tabindex="-1"></a>stable_srchlght_same_seq <span class="ot">&lt;-</span> <span class="fu">rbind</span>(corrp_ht, uncorrp_ht) <span class="sc">%&gt;%</span> </span>
<span id="cb433-3"><a href="rsa-on-pattern-similarity-change.html#cb433-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">add_footnote</span>(<span class="st">&quot;x, y, z refer to MNI coordinates of minimum p-value in cluster, t denotes the most extreme t-value, COG: center of gravity&quot;</span>, <span class="at">border =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb433-4"><a href="rsa-on-pattern-similarity-change.html#cb433-4" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">as_flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb433-5"><a href="rsa-on-pattern-similarity-change.html#cb433-5" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb433-6"><a href="rsa-on-pattern-similarity-change.html#cb433-6" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">font</span>(<span class="at">fontname =</span> font2use) <span class="sc">%&gt;%</span></span>
<span id="cb433-7"><a href="rsa-on-pattern-similarity-change.html#cb433-7" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">style</span>(<span class="at">i=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(corrp_ht)<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb433-8"><a href="rsa-on-pattern-similarity-change.html#cb433-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pr_c =</span> officer<span class="sc">::</span><span class="fu">fp_cell</span>(<span class="at">border.bottom =</span> <span class="fu">fp_border</span>(),</span>
<span id="cb433-9"><a href="rsa-on-pattern-similarity-change.html#cb433-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">border.top =</span> <span class="fu">fp_border</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb433-10"><a href="rsa-on-pattern-similarity-change.html#cb433-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">bg</span>(<span class="at">i=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(corrp_ht)<span class="sc">+</span><span class="dv">1</span>), <span class="at">bg=</span><span class="st">&quot;lightgrey&quot;</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb433-11"><a href="rsa-on-pattern-similarity-change.html#cb433-11" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">padding</span>(., <span class="at">padding =</span> <span class="dv">3</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb433-12"><a href="rsa-on-pattern-similarity-change.html#cb433-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(., <span class="at">width=</span><span class="dv">1</span>, <span class="at">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb433-13"><a href="rsa-on-pattern-similarity-change.html#cb433-13" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(., <span class="at">caption =</span> <span class="st">&quot;Searchlight Analysis: Virtual time explains representational change for same-sequence events&quot;</span>, </span>
<span id="cb433-14"><a href="rsa-on-pattern-similarity-change.html#cb433-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style=</span><span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<p>Here, we plot the results of the searchlight looking at the effect of virtual time on pattern similarity change for events from the same sequence. We show the t-values thresholded at p &lt; 0.01 uncorrected. To also show which voxels survive corrections for multiple comparisons (within aHPC and alEC), we also load the outline of the clusters surviving at corrected p&lt;0.05. In the resulting plot, voxels <strong>inside</strong> the black area are significant when correcting for multiple comparisons.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="rsa-on-pattern-similarity-change.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb434-2"><a href="rsa-on-pattern-similarity-change.html#cb434-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">24</span>,<span class="sc">-</span><span class="dv">15</span>,<span class="sc">-</span><span class="dv">19</span>))</span>
<span id="cb434-3"><a href="rsa-on-pattern-similarity-change.html#cb434-3" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)),</span>
<span id="cb434-4"><a href="rsa-on-pattern-similarity-change.html#cb434-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)))</span>
<span id="cb434-5"><a href="rsa-on-pattern-similarity-change.html#cb434-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-6"><a href="rsa-on-pattern-similarity-change.html#cb434-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb434-7"><a href="rsa-on-pattern-similarity-change.html#cb434-7" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb434-8"><a href="rsa-on-pattern-similarity-change.html#cb434-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb434-9"><a href="rsa-on-pattern-similarity-change.html#cb434-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb434-10"><a href="rsa-on-pattern-similarity-change.html#cb434-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb434-11"><a href="rsa-on-pattern-similarity-change.html#cb434-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-12"><a href="rsa-on-pattern-similarity-change.html#cb434-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb434-13"><a href="rsa-on-pattern-similarity-change.html#cb434-13" aria-hidden="true" tabindex="-1"></a>pfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb434-14"><a href="rsa-on-pattern-similarity-change.html#cb434-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;same_day_vir_time_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb434-15"><a href="rsa-on-pattern-similarity-change.html#cb434-15" aria-hidden="true" tabindex="-1"></a>pfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(pfov_fn)</span>
<span id="cb434-16"><a href="rsa-on-pattern-similarity-change.html#cb434-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-17"><a href="rsa-on-pattern-similarity-change.html#cb434-17" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (FOV)</span></span>
<span id="cb434-18"><a href="rsa-on-pattern-similarity-change.html#cb434-18" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb434-19"><a href="rsa-on-pattern-similarity-change.html#cb434-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;same_day_vir_time_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb434-20"><a href="rsa-on-pattern-similarity-change.html#cb434-20" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb434-21"><a href="rsa-on-pattern-similarity-change.html#cb434-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-22"><a href="rsa-on-pattern-similarity-change.html#cb434-22" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb434-23"><a href="rsa-on-pattern-similarity-change.html#cb434-23" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.01</span> </span>
<span id="cb434-24"><a href="rsa-on-pattern-similarity-change.html#cb434-24" aria-hidden="true" tabindex="-1"></a>t_nii[pfov_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb434-25"><a href="rsa-on-pattern-similarity-change.html#cb434-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-26"><a href="rsa-on-pattern-similarity-change.html#cb434-26" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb434-27"><a href="rsa-on-pattern-similarity-change.html#cb434-27" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb434-28"><a href="rsa-on-pattern-similarity-change.html#cb434-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb434-29"><a href="rsa-on-pattern-similarity-change.html#cb434-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb434-30"><a href="rsa-on-pattern-similarity-change.html#cb434-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-31"><a href="rsa-on-pattern-similarity-change.html#cb434-31" aria-hidden="true" tabindex="-1"></a><span class="co"># load the outline image</span></span>
<span id="cb434-32"><a href="rsa-on-pattern-similarity-change.html#cb434-32" aria-hidden="true" tabindex="-1"></a>outl_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb434-33"><a href="rsa-on-pattern-similarity-change.html#cb434-33" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;same_day_vir_time_randomise_svc_fwhm3_tfce_corrp_outline.nii.gz&quot;</span>)</span>
<span id="cb434-34"><a href="rsa-on-pattern-similarity-change.html#cb434-34" aria-hidden="true" tabindex="-1"></a>outl_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(outl_fn)</span>
<span id="cb434-35"><a href="rsa-on-pattern-similarity-change.html#cb434-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-36"><a href="rsa-on-pattern-similarity-change.html#cb434-36" aria-hidden="true" tabindex="-1"></a><span class="co"># remove zero voxels and get dataframe at coordinates</span></span>
<span id="cb434-37"><a href="rsa-on-pattern-similarity-change.html#cb434-37" aria-hidden="true" tabindex="-1"></a>outl_nii[outl_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb434-38"><a href="rsa-on-pattern-similarity-change.html#cb434-38" aria-hidden="true" tabindex="-1"></a>o_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>outl_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb434-39"><a href="rsa-on-pattern-similarity-change.html#cb434-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb434-40"><a href="rsa-on-pattern-similarity-change.html#cb434-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb434-41"><a href="rsa-on-pattern-similarity-change.html#cb434-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-42"><a href="rsa-on-pattern-similarity-change.html#cb434-42" aria-hidden="true" tabindex="-1"></a>f7a <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb434-43"><a href="rsa-on-pattern-similarity-change.html#cb434-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb434-44"><a href="rsa-on-pattern-similarity-change.html#cb434-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>o_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col), <span class="at">fill=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb434-45"><a href="rsa-on-pattern-similarity-change.html#cb434-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb434-46"><a href="rsa-on-pattern-similarity-change.html#cb434-46" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>, </span>
<span id="cb434-47"><a href="rsa-on-pattern-similarity-change.html#cb434-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end=</span><span class="fl">0.7</span>,</span>
<span id="cb434-48"><a href="rsa-on-pattern-similarity-change.html#cb434-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb434-49"><a href="rsa-on-pattern-similarity-change.html#cb434-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb434-50"><a href="rsa-on-pattern-similarity-change.html#cb434-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb434-51"><a href="rsa-on-pattern-similarity-change.html#cb434-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">same</span><span class="sc">\n</span><span class="st">sequence&quot;</span>) <span class="sc">+</span></span>
<span id="cb434-52"><a href="rsa-on-pattern-similarity-change.html#cb434-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb434-53"><a href="rsa-on-pattern-similarity-change.html#cb434-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb434-54"><a href="rsa-on-pattern-similarity-change.html#cb434-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb434-55"><a href="rsa-on-pattern-similarity-change.html#cb434-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb434-56"><a href="rsa-on-pattern-similarity-change.html#cb434-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb434-57"><a href="rsa-on-pattern-similarity-change.html#cb434-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb434-58"><a href="rsa-on-pattern-similarity-change.html#cb434-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb434-59"><a href="rsa-on-pattern-similarity-change.html#cb434-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb434-60"><a href="rsa-on-pattern-similarity-change.html#cb434-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb434-61"><a href="rsa-on-pattern-similarity-change.html#cb434-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb434-62"><a href="rsa-on-pattern-similarity-change.html#cb434-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb434-63"><a href="rsa-on-pattern-similarity-change.html#cb434-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb434-64"><a href="rsa-on-pattern-similarity-change.html#cb434-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb434-65"><a href="rsa-on-pattern-similarity-change.html#cb434-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>))<span class="sc">+</span></span>
<span id="cb434-66"><a href="rsa-on-pattern-similarity-change.html#cb434-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb434-67"><a href="rsa-on-pattern-similarity-change.html#cb434-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb434-68"><a href="rsa-on-pattern-similarity-change.html#cb434-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">84.7</span>,<span class="sc">-</span><span class="fl">70.37</span>,<span class="sc">-</span><span class="fl">90.69</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb434-69"><a href="rsa-on-pattern-similarity-change.html#cb434-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb434-70"><a href="rsa-on-pattern-similarity-change.html#cb434-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb434-71"><a href="rsa-on-pattern-similarity-change.html#cb434-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb434-72"><a href="rsa-on-pattern-similarity-change.html#cb434-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb434-73"><a href="rsa-on-pattern-similarity-change.html#cb434-73" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f7a)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="rsa-on-pattern-similarity-change.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb435-2"><a href="rsa-on-pattern-similarity-change.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> tvals_fn, <span class="at">to =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f7a.nii.gz&quot;</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="virtual-time-across-sequences-in-within-searchlight-cluster" class="section level3 unnumbered">
<h3>Virtual Time Across Sequences in Within-Searchlight Cluster</h3>
<p>The plot above shows a significant effect of virtual time on pattern similarity change in some voxels of the hippocampus. To ask whether these voxels also show the across-sequence effect, we run an ROI-analyis based on the significant voxels from the within-searchlight (peak cluster from left hemisphere, defined at p&lt;0.99 uncorrected within small volume correction mask). These data were calculated in the script <strong>virtem_mri_prepare_RSA_in_searchlight_cluster</strong> and are loaded here.</p>
<blockquote>
<p>To test whether within- and across-sequence representations overlap, we defined an ROI based on the within-sequence searchlight analysis. Specifically, voxels belonging to the cluster around the peak voxel, thresholded at p&lt;0.01 uncorrected within our small volume correction mask, were included. The analysis of representational change was then carried out as described for the other ROIs above.</p>
</blockquote>
<div id="load-data" class="section level4 unnumbered">
<h4>Load data</h4>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="rsa-on-pattern-similarity-change.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb437-2"><a href="rsa-on-pattern-similarity-change.html#cb437-2" aria-hidden="true" tabindex="-1"></a>col_types_list <span class="ot">&lt;-</span> <span class="fu">cols_only</span>(</span>
<span id="cb437-3"><a href="rsa-on-pattern-similarity-change.html#cb437-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">sub_id =</span> <span class="fu">col_character</span>(),</span>
<span id="cb437-4"><a href="rsa-on-pattern-similarity-change.html#cb437-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">day1 =</span> <span class="fu">col_integer</span>(), <span class="at">day2 =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb437-5"><a href="rsa-on-pattern-similarity-change.html#cb437-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">virtual_time1 =</span> <span class="fu">col_double</span>(), <span class="at">virtual_time2 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb437-6"><a href="rsa-on-pattern-similarity-change.html#cb437-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ps_change =</span> <span class="fu">col_double</span>(), <span class="at">roi =</span> <span class="fu">col_factor</span>())</span>
<span id="cb437-7"><a href="rsa-on-pattern-similarity-change.html#cb437-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;rsa_data_in_same-seq_searchlight_peak.txt&quot;</span>)</span>
<span id="cb437-8"><a href="rsa-on-pattern-similarity-change.html#cb437-8" aria-hidden="true" tabindex="-1"></a>rsa_dat_within_cluster <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_csv</span>(fn, <span class="at">col_types =</span> col_types_list))</span></code></pre></div>
</div>
<div id="prepare-time-metrics-for-rsa" class="section level4 unnumbered">
<h4>Prepare Time Metrics for RSA</h4>
<p>Create day factor and create virtual temporal distance variables, analogous to main ROI analyses above.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="rsa-on-pattern-similarity-change.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create predictors for RSA</span></span>
<span id="cb438-2"><a href="rsa-on-pattern-similarity-change.html#cb438-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_within_cluster <span class="ot">&lt;-</span> rsa_dat_within_cluster <span class="sc">%&gt;%</span></span>
<span id="cb438-3"><a href="rsa-on-pattern-similarity-change.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb438-4"><a href="rsa-on-pattern-similarity-change.html#cb438-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb438-5"><a href="rsa-on-pattern-similarity-change.html#cb438-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pair of events from say or different day (dv = deviation code)</span></span>
<span id="cb438-6"><a href="rsa-on-pattern-similarity-change.html#cb438-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day =</span> day1 <span class="sc">==</span> day2,</span>
<span id="cb438-7"><a href="rsa-on-pattern-similarity-change.html#cb438-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">same_day_dv =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, <span class="at">from =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb438-8"><a href="rsa-on-pattern-similarity-change.html#cb438-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb438-9"><a href="rsa-on-pattern-similarity-change.html#cb438-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># absolute difference in time metrics</span></span>
<span id="cb438-10"><a href="rsa-on-pattern-similarity-change.html#cb438-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">vir_time_diff =</span> <span class="fu">abs</span>(virtual_time1 <span class="sc">-</span> virtual_time2)) <span class="sc">%&gt;%</span></span>
<span id="cb438-11"><a href="rsa-on-pattern-similarity-change.html#cb438-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb438-12"><a href="rsa-on-pattern-similarity-change.html#cb438-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># z-score the time metric predictors (within each subject)</span></span>
<span id="cb438-13"><a href="rsa-on-pattern-similarity-change.html#cb438-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb438-14"><a href="rsa-on-pattern-similarity-change.html#cb438-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">&quot;vir_time_diff&quot;</span>), scale, <span class="at">scale =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb438-15"><a href="rsa-on-pattern-similarity-change.html#cb438-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
</div>
<div id="summary-statistics-13" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<div id="first-level-rsa-1" class="section level5 unnumbered">
<h5>First-level RSA</h5>
<p>Let’s run the first-level analysis using virtual time as a predictor of pattern similarity change separately for each participant in this ROI.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="rsa-on-pattern-similarity-change.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb439-2"><a href="rsa-on-pattern-similarity-change.html#cb439-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-3"><a href="rsa-on-pattern-similarity-change.html#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit based on permutations</span></span>
<span id="cb439-4"><a href="rsa-on-pattern-similarity-change.html#cb439-4" aria-hidden="true" tabindex="-1"></a>rsa_fit_within_cluster <span class="ot">&lt;-</span> rsa_dat_within_cluster <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id, same_day) <span class="sc">%&gt;%</span></span>
<span id="cb439-5"><a href="rsa-on-pattern-similarity-change.html#cb439-5" aria-hidden="true" tabindex="-1"></a>          <span class="co"># run the linear model</span></span>
<span id="cb439-6"><a href="rsa-on-pattern-similarity-change.html#cb439-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> ., <span class="at">lm_formula =</span> <span class="st">&quot;ps_change ~ vir_time_diff&quot;</span>, <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb439-7"><a href="rsa-on-pattern-similarity-change.html#cb439-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>, <span class="st">&quot;z_virtual_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb439-8"><a href="rsa-on-pattern-similarity-change.html#cb439-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(z)</span>
<span id="cb439-9"><a href="rsa-on-pattern-similarity-change.html#cb439-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-10"><a href="rsa-on-pattern-similarity-change.html#cb439-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add group column used for plotting</span></span>
<span id="cb439-11"><a href="rsa-on-pattern-similarity-change.html#cb439-11" aria-hidden="true" tabindex="-1"></a>rsa_fit_within_cluster<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span>)</span>
<span id="cb439-12"><a href="rsa-on-pattern-similarity-change.html#cb439-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-13"><a href="rsa-on-pattern-similarity-change.html#cb439-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add a factor with character labels for within/across days and one to later color control in facets</span></span>
<span id="cb439-14"><a href="rsa-on-pattern-similarity-change.html#cb439-14" aria-hidden="true" tabindex="-1"></a>rsa_fit_within_cluster <span class="ot">&lt;-</span> rsa_fit_within_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb439-15"><a href="rsa-on-pattern-similarity-change.html#cb439-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">same_day_char =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(same_day, </span>
<span id="cb439-16"><a href="rsa-on-pattern-similarity-change.html#cb439-16" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">from =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb439-17"><a href="rsa-on-pattern-similarity-change.html#cb439-17" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;across days&quot;</span>, <span class="st">&quot;within days&quot;</span>), </span>
<span id="cb439-18"><a href="rsa-on-pattern-similarity-change.html#cb439-18" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">warn_missing =</span> <span class="cn">FALSE</span>),</span>
<span id="cb439-19"><a href="rsa-on-pattern-similarity-change.html#cb439-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">same_day_char =</span> <span class="fu">factor</span>(same_day_char, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;within days&quot;</span>, <span class="st">&quot;across days&quot;</span>)))</span></code></pre></div>
</div>
<div id="group-level" class="section level5 unnumbered">
<h5>Group Level</h5>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="rsa-on-pattern-similarity-change.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run a group-level t-test on the different sequence RSA fits in the within-searchlight cluster</span></span>
<span id="cb440-2"><a href="rsa-on-pattern-similarity-change.html#cb440-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> rsa_fit_within_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb440-3"><a href="rsa-on-pattern-similarity-change.html#cb440-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb440-4"><a href="rsa-on-pattern-similarity-change.html#cb440-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z_virtual_time) <span class="sc">%&gt;%</span> </span>
<span id="cb440-5"><a href="rsa-on-pattern-similarity-change.html#cb440-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb440-6"><a href="rsa-on-pattern-similarity-change.html#cb440-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-7"><a href="rsa-on-pattern-similarity-change.html#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb440-8"><a href="rsa-on-pattern-similarity-change.html#cb440-8" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(rsa_fit_within_cluster <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">FALSE</span>))<span class="sc">$</span>z_virtual_time, </span>
<span id="cb440-9"><a href="rsa-on-pattern-similarity-change.html#cb440-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb440-10"><a href="rsa-on-pattern-similarity-change.html#cb440-10" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb440-11"><a href="rsa-on-pattern-similarity-change.html#cb440-11" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb440-12"><a href="rsa-on-pattern-similarity-change.html#cb440-12" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb440-13"><a href="rsa-on-pattern-similarity-change.html#cb440-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-14"><a href="rsa-on-pattern-similarity-change.html#cb440-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb440-15"><a href="rsa-on-pattern-similarity-change.html#cb440-15" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-215">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.424</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.19</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.037</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0357</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.821</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.0275</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.403</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.812</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.0251</td></tr>
</table>

<p>Summary Statistics: t-test against 0 for virtual time across sequences in within-sequence searchlight peak<br />
t<sub>27</sub>=-2.19, p=0.036, d=-0.40, 95% CI [-0.81, -0.03]</p>
<p>Lastly, we create a raincloud plot of the z-values</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="rsa-on-pattern-similarity-change.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data to plot</span></span>
<span id="cb441-2"><a href="rsa-on-pattern-similarity-change.html#cb441-2" aria-hidden="true" tabindex="-1"></a>plot_dat <span class="ot">&lt;-</span> rsa_fit_within_cluster <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">FALSE</span>) </span>
<span id="cb441-3"><a href="rsa-on-pattern-similarity-change.html#cb441-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-4"><a href="rsa-on-pattern-similarity-change.html#cb441-4" aria-hidden="true" tabindex="-1"></a>f7b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_dat, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>z_virtual_time, <span class="at">fill =</span> group, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb441-5"><a href="rsa-on-pattern-similarity-change.html#cb441-5" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb441-6"><a href="rsa-on-pattern-similarity-change.html#cb441-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb441-7"><a href="rsa-on-pattern-similarity-change.html#cb441-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> z_virtual_time), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb441-8"><a href="rsa-on-pattern-similarity-change.html#cb441-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb441-9"><a href="rsa-on-pattern-similarity-change.html#cb441-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb441-10"><a href="rsa-on-pattern-similarity-change.html#cb441-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb441-11"><a href="rsa-on-pattern-similarity-change.html#cb441-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb441-12"><a href="rsa-on-pattern-similarity-change.html#cb441-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb441-13"><a href="rsa-on-pattern-similarity-change.html#cb441-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb441-14"><a href="rsa-on-pattern-similarity-change.html#cb441-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb441-15"><a href="rsa-on-pattern-similarity-change.html#cb441-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb441-16"><a href="rsa-on-pattern-similarity-change.html#cb441-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb441-17"><a href="rsa-on-pattern-similarity-change.html#cb441-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb441-18"><a href="rsa-on-pattern-similarity-change.html#cb441-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;z RSA model fit&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb441-19"><a href="rsa-on-pattern-similarity-change.html#cb441-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb441-20"><a href="rsa-on-pattern-similarity-change.html#cb441-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb441-21"><a href="rsa-on-pattern-similarity-change.html#cb441-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">different sequence in</span><span class="sc">\n</span><span class="st">same sequence peak&quot;</span>) <span class="sc">+</span></span>
<span id="cb441-22"><a href="rsa-on-pattern-similarity-change.html#cb441-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb441-23"><a href="rsa-on-pattern-similarity-change.html#cb441-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb441-24"><a href="rsa-on-pattern-similarity-change.html#cb441-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb441-25"><a href="rsa-on-pattern-similarity-change.html#cb441-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb441-26"><a href="rsa-on-pattern-similarity-change.html#cb441-26" aria-hidden="true" tabindex="-1"></a>f7b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="rsa-on-pattern-similarity-change.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb442-2"><a href="rsa-on-pattern-similarity-change.html#cb442-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f7b)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb442-3"><a href="rsa-on-pattern-similarity-change.html#cb442-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb442-4"><a href="rsa-on-pattern-similarity-change.html#cb442-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f7b.txt&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="linear-mixed-effects-11" class="section level4 unnumbered">
<h4>Linear Mixed Effects</h4>
<p>As for the main analyses, we also want to run the same model using linear mixed effects.</p>
<p>Due to singular fits we have to reduce the random effects structure until only random slopes are in the model.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="rsa-on-pattern-similarity-change.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the comparisons from the same day</span></span>
<span id="cb443-2"><a href="rsa-on-pattern-similarity-change.html#cb443-2" aria-hidden="true" tabindex="-1"></a>rsa_dat_diff_day <span class="ot">&lt;-</span> rsa_dat_within_cluster <span class="sc">%&gt;%</span> <span class="fu">filter</span>(same_day <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb443-3"><a href="rsa-on-pattern-similarity-change.html#cb443-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-4"><a href="rsa-on-pattern-similarity-change.html#cb443-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with virtual time difference as </span></span>
<span id="cb443-5"><a href="rsa-on-pattern-similarity-change.html#cb443-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed effect and by-subject random slopes and random intercepts --&gt; singular fit</span></span>
<span id="cb443-6"><a href="rsa-on-pattern-similarity-change.html#cb443-6" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb443-7"><a href="rsa-on-pattern-similarity-change.html#cb443-7" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="rsa-on-pattern-similarity-change.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove correlation --&gt; still singular</span></span>
<span id="cb445-2"><a href="rsa-on-pattern-similarity-change.html#cb445-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (1 + vir_time_diff || sub_id)&quot;</span></span>
<span id="cb445-3"><a href="rsa-on-pattern-similarity-change.html#cb445-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="rsa-on-pattern-similarity-change.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only random slopes</span></span>
<span id="cb447-2"><a href="rsa-on-pattern-similarity-change.html#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">322</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb447-3"><a href="rsa-on-pattern-similarity-change.html#cb447-3" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ vir_time_diff + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb447-4"><a href="rsa-on-pattern-similarity-change.html#cb447-4" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="rsa-on-pattern-similarity-change.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ps_change ~ vir_time_diff + (0 + vir_time_diff | sub_id)
##    Data: rsa_dat_diff_day
## 
##      AIC      BIC   logLik deviance df.resid 
## -23260.0 -23234.6  11634.0 -23268.0     4196 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.0842 -0.6392  0.0084  0.6616  3.7002 
## 
## Random effects:
##  Groups   Name          Variance  Std.Dev.
##  sub_id   vir_time_diff 0.0000000 0.00000 
##  Residual               0.0002299 0.01516 
## Number of obs: 4200, groups:  sub_id, 28
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)   -9.718e-05  2.343e-04  -0.415
## vir_time_diff -4.782e-04  2.341e-04  -2.043
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="rsa-on-pattern-similarity-change.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb451-2"><a href="rsa-on-pattern-similarity-change.html#cb451-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, </span>
<span id="cb451-3"><a href="rsa-on-pattern-similarity-change.html#cb451-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>,</span>
<span id="cb451-4"><a href="rsa-on-pattern-similarity-change.html#cb451-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">optimizer =</span> <span class="st">&#39;nloptwrap&#39;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="rsa-on-pattern-similarity-change.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb453-2"><a href="rsa-on-pattern-similarity-change.html#cb453-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span>
<span id="cb453-3"><a href="rsa-on-pattern-similarity-change.html#cb453-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-4"><a href="rsa-on-pattern-similarity-change.html#cb453-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one way of testing for significance is by comparing the likelihood against a simpler model.</span></span>
<span id="cb453-5"><a href="rsa-on-pattern-similarity-change.html#cb453-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time difference and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb453-6"><a href="rsa-on-pattern-similarity-change.html#cb453-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">396</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb453-7"><a href="rsa-on-pattern-similarity-change.html#cb453-7" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;ps_change ~ 1 + (0 + vir_time_diff | sub_id)&quot;</span></span>
<span id="cb453-8"><a href="rsa-on-pattern-similarity-change.html#cb453-8" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> rsa_dat_diff_day, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb453-9"><a href="rsa-on-pattern-similarity-change.html#cb453-9" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span><span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span></code></pre></div>
<p>Mixed Model: Fixed effect of virtual time across sequences in within-sequence searchlight peak
<span class="math inline">\(\chi^2\)</span>(1)=4.13, p=0.042</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="rsa-on-pattern-similarity-change.html#cb454-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>)</span>
<span id="cb454-2"><a href="rsa-on-pattern-similarity-change.html#cb454-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb454-3"><a href="rsa-on-pattern-similarity-change.html#cb454-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb454-4"><a href="rsa-on-pattern-similarity-change.html#cb454-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-5"><a href="rsa-on-pattern-similarity-change.html#cb454-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb454-6"><a href="rsa-on-pattern-similarity-change.html#cb454-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb454-7"><a href="rsa-on-pattern-similarity-change.html#cb454-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb454-8"><a href="rsa-on-pattern-similarity-change.html#cb454-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb454-9"><a href="rsa-on-pattern-similarity-change.html#cb454-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb454-10"><a href="rsa-on-pattern-similarity-change.html#cb454-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb454-11"><a href="rsa-on-pattern-similarity-change.html#cb454-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb454-12"><a href="rsa-on-pattern-similarity-change.html#cb454-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb454-13"><a href="rsa-on-pattern-similarity-change.html#cb454-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains representational change for different-sequence events in the peak cluster of the same-sequence searchlight analysis&quot;</span>)</span>
<span id="cb454-14"><a href="rsa-on-pattern-similarity-change.html#cb454-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-15"><a href="rsa-on-pattern-similarity-change.html#cb454-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb454-16"><a href="rsa-on-pattern-similarity-change.html#cb454-16" aria-hidden="true" tabindex="-1"></a>stable_lme_same_seq_cluster_virtime_diff_seq <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb454-17"><a href="rsa-on-pattern-similarity-change.html#cb454-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-18"><a href="rsa-on-pattern-similarity-change.html#cb454-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb454-19"><a href="rsa-on-pattern-similarity-change.html#cb454-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-218">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains representational change for different-sequence events in the peak cluster of the same-sequence searchlight analysis</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000097</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000234</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.41</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000557</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000362</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000478</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.000234</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.04</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.000939</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.000018</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.015162</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">3</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-23257.87</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11631.93</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">4</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-23260.00</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11634.00</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.13</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.042</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: ps_change~vir_time_diff+(0+vir_time_diff|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="rsa-on-pattern-similarity-change.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="do">### PLOTS</span></span>
<span id="cb455-2"><a href="rsa-on-pattern-similarity-change.html#cb455-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb455-3"><a href="rsa-on-pattern-similarity-change.html#cb455-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term))</span>
<span id="cb455-4"><a href="rsa-on-pattern-similarity-change.html#cb455-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-5"><a href="rsa-on-pattern-similarity-change.html#cb455-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb455-6"><a href="rsa-on-pattern-similarity-change.html#cb455-6" aria-hidden="true" tabindex="-1"></a>sfigmm_m <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb455-7"><a href="rsa-on-pattern-similarity-change.html#cb455-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb455-8"><a href="rsa-on-pattern-similarity-change.html#cb455-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb455-9"><a href="rsa-on-pattern-similarity-change.html#cb455-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb455-10"><a href="rsa-on-pattern-similarity-change.html#cb455-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb455-11"><a href="rsa-on-pattern-similarity-change.html#cb455-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), </span>
<span id="cb455-12"><a href="rsa-on-pattern-similarity-change.html#cb455-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (diff. seq.)&quot;</span>), <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb455-13"><a href="rsa-on-pattern-similarity-change.html#cb455-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">&quot;fixed effect</span><span class="sc">\n</span><span class="st">estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb455-14"><a href="rsa-on-pattern-similarity-change.html#cb455-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb455-15"><a href="rsa-on-pattern-similarity-change.html#cb455-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;*&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb455-16"><a href="rsa-on-pattern-similarity-change.html#cb455-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb455-17"><a href="rsa-on-pattern-similarity-change.html#cb455-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">axis.text.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb455-18"><a href="rsa-on-pattern-similarity-change.html#cb455-18" aria-hidden="true" tabindex="-1"></a>sfigmm_m</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="rsa-on-pattern-similarity-change.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb456-2"><a href="rsa-on-pattern-similarity-change.html#cb456-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-3"><a href="rsa-on-pattern-similarity-change.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">get_complete_df</span>()</span>
<span id="cb456-4"><a href="rsa-on-pattern-similarity-change.html#cb456-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-5"><a href="rsa-on-pattern-similarity-change.html#cb456-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb456-6"><a href="rsa-on-pattern-similarity-change.html#cb456-6" aria-hidden="true" tabindex="-1"></a>sfigmm_n <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm[lmm_full_emm<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;vir_time_diff&quot;</span>,], <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb456-7"><a href="rsa-on-pattern-similarity-change.html#cb456-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb456-8"><a href="rsa-on-pattern-similarity-change.html#cb456-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb456-9"><a href="rsa-on-pattern-similarity-change.html#cb456-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), </span>
<span id="cb456-10"><a href="rsa-on-pattern-similarity-change.html#cb456-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="fu">element_blank</span>(), <span class="at">labels =</span> <span class="st">&quot;virtual time&quot;</span>) <span class="sc">+</span></span>
<span id="cb456-11"><a href="rsa-on-pattern-similarity-change.html#cb456-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb456-12"><a href="rsa-on-pattern-similarity-change.html#cb456-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb456-13"><a href="rsa-on-pattern-similarity-change.html#cb456-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z virtual time&#39;</span>) <span class="sc">+</span></span>
<span id="cb456-14"><a href="rsa-on-pattern-similarity-change.html#cb456-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(&quot;Estimated marginal means&quot;) + </span></span>
<span id="cb456-15"><a href="rsa-on-pattern-similarity-change.html#cb456-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb456-16"><a href="rsa-on-pattern-similarity-change.html#cb456-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb456-17"><a href="rsa-on-pattern-similarity-change.html#cb456-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb456-18"><a href="rsa-on-pattern-similarity-change.html#cb456-18" aria-hidden="true" tabindex="-1"></a>sfigmm_n</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-219-2.png" width="672" /></p>
</div>
</div>
<div id="virtual-time-across-sequences" class="section level3 unnumbered">
<h3>Virtual Time Across Sequences</h3>
<p>Next, we plot the results of the searchlight looking at the across-sequence comparisons. This effect fails to reach the significance threshold when correcting for multiple comparisons. For visualization, we show the effect at p&lt;0.05 uncorrected (within FOV). We report strongest cluster after small volume correction.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="rsa-on-pattern-similarity-change.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the cluster file for corrected results</span></span>
<span id="cb457-2"><a href="rsa-on-pattern-similarity-change.html#cb457-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,</span>
<span id="cb457-3"><a href="rsa-on-pattern-similarity-change.html#cb457-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;diff_day_vir_time&quot;</span>, <span class="st">&quot;cluster_diff_day_vir_time_neg_svc_corrp_atlas.txt&quot;</span>)</span>
<span id="cb457-4"><a href="rsa-on-pattern-similarity-change.html#cb457-4" aria-hidden="true" tabindex="-1"></a>corrp_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(fn, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;ccdddddddddd&quot;</span>))</span>
<span id="cb457-5"><a href="rsa-on-pattern-similarity-change.html#cb457-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-6"><a href="rsa-on-pattern-similarity-change.html#cb457-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen </span></span>
<span id="cb457-7"><a href="rsa-on-pattern-similarity-change.html#cb457-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;no significant clusters in across-day virtual time (negative) searchlight:&quot;</span>,</span>
<span id="cb457-8"><a href="rsa-on-pattern-similarity-change.html#cb457-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">cluster file has %d rows&quot;</span>,</span>
<span id="cb457-9"><a href="rsa-on-pattern-similarity-change.html#cb457-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nrow</span>(corrp_df)))</span></code></pre></div>
<pre><code>## no significant clusters in across-day virtual time (negative) searchlight: 
## cluster file has 0 rows</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="rsa-on-pattern-similarity-change.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find and report peak voxel coordinates incl. p and t after SVC</span></span>
<span id="cb459-2"><a href="rsa-on-pattern-similarity-change.html#cb459-2" aria-hidden="true" tabindex="-1"></a>corrp_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb459-3"><a href="rsa-on-pattern-similarity-change.html#cb459-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;diff_day_vir_time_neg_randomise_svc_fwhm3_tfce_corrp_tstat1.nii.gz&quot;</span>)</span>
<span id="cb459-4"><a href="rsa-on-pattern-similarity-change.html#cb459-4" aria-hidden="true" tabindex="-1"></a>corrp_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(corrp_fn)</span>
<span id="cb459-5"><a href="rsa-on-pattern-similarity-change.html#cb459-5" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">which</span>(corrp_nii <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">c</span>(corrp_nii)), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb459-6"><a href="rsa-on-pattern-similarity-change.html#cb459-6" aria-hidden="true" tabindex="-1"></a>mnicoords <span class="ot">&lt;-</span> <span class="fu">vox2mni</span>(coords)</span>
<span id="cb459-7"><a href="rsa-on-pattern-similarity-change.html#cb459-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-8"><a href="rsa-on-pattern-similarity-change.html#cb459-8" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb459-9"><a href="rsa-on-pattern-similarity-change.html#cb459-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;diff_day_vir_time_neg_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb459-10"><a href="rsa-on-pattern-similarity-change.html#cb459-10" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb459-11"><a href="rsa-on-pattern-similarity-change.html#cb459-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;peak voxel in across-day virtual time (negative) searchlight:&quot;</span>,</span>
<span id="cb459-12"><a href="rsa-on-pattern-similarity-change.html#cb459-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">x=%d, y=%d, z=%d, t=%.2f, corrected p =%.3f&quot;</span>,</span>
<span id="cb459-13"><a href="rsa-on-pattern-similarity-change.html#cb459-13" aria-hidden="true" tabindex="-1"></a>            mnicoords[<span class="dv">1</span>], mnicoords[<span class="dv">2</span>], mnicoords[<span class="dv">3</span>], </span>
<span id="cb459-14"><a href="rsa-on-pattern-similarity-change.html#cb459-14" aria-hidden="true" tabindex="-1"></a>            <span class="sc">-</span>t_nii[coords[<span class="dv">1</span>], coords[<span class="dv">2</span>], coords[<span class="dv">3</span>]], <span class="dv">1</span><span class="sc">-</span><span class="fu">max</span>(<span class="fu">c</span>(corrp_nii))))</span></code></pre></div>
<pre><code>## peak voxel in across-day virtual time (negative) searchlight: 
## x=-26, y=-19, z=-15, t=-3.96, corrected p =0.071</code></pre>
<p>Report additional clusters from exploratory analysis with threshold p&lt;0.001 uncorrected and a minimum of 30 voxels per cluster.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="rsa-on-pattern-similarity-change.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the cluster file for uncorrected results</span></span>
<span id="cb461-2"><a href="rsa-on-pattern-similarity-change.html#cb461-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,</span>
<span id="cb461-3"><a href="rsa-on-pattern-similarity-change.html#cb461-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;diff_day_vir_time&quot;</span>, <span class="st">&quot;cluster_diff_day_vir_time_neg_fov_uncorrp_atlas.txt&quot;</span>)</span>
<span id="cb461-4"><a href="rsa-on-pattern-similarity-change.html#cb461-4" aria-hidden="true" tabindex="-1"></a>uncorrp_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(fn, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;ccdddddddddd&quot;</span>))</span>
<span id="cb461-5"><a href="rsa-on-pattern-similarity-change.html#cb461-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-6"><a href="rsa-on-pattern-similarity-change.html#cb461-6" aria-hidden="true" tabindex="-1"></a><span class="co"># quick print</span></span>
<span id="cb461-7"><a href="rsa-on-pattern-similarity-change.html#cb461-7" aria-hidden="true" tabindex="-1"></a><span class="co">#uncorrp_df %&gt;% huxtable::as_huxtable() %&gt;% theme_article()</span></span>
<span id="cb461-8"><a href="rsa-on-pattern-similarity-change.html#cb461-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-9"><a href="rsa-on-pattern-similarity-change.html#cb461-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with p-values (not 1-p as given by FSL) and manual labels</span></span>
<span id="cb461-10"><a href="rsa-on-pattern-similarity-change.html#cb461-10" aria-hidden="true" tabindex="-1"></a>uncorrp_df <span class="ot">&lt;-</span> uncorrp_df <span class="sc">%&gt;%</span></span>
<span id="cb461-11"><a href="rsa-on-pattern-similarity-change.html#cb461-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb461-12"><a href="rsa-on-pattern-similarity-change.html#cb461-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_extr =</span> t_extr<span class="sc">*-</span><span class="dv">1</span>, <span class="co"># multiply t-values by minus 1 because we tested the negative contrast</span></span>
<span id="cb461-13"><a href="rsa-on-pattern-similarity-change.html#cb461-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>max_1minusp,</span>
<span id="cb461-14"><a href="rsa-on-pattern-similarity-change.html#cb461-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">atlas_label =</span> <span class="fu">c</span>(</span>
<span id="cb461-15"><a href="rsa-on-pattern-similarity-change.html#cb461-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cerebellum&quot;</span>,</span>
<span id="cb461-16"><a href="rsa-on-pattern-similarity-change.html#cb461-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cerebellum&quot;</span>,</span>
<span id="cb461-17"><a href="rsa-on-pattern-similarity-change.html#cb461-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;lingual gyrus&quot;</span></span>
<span id="cb461-18"><a href="rsa-on-pattern-similarity-change.html#cb461-18" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">%&gt;%</span> </span>
<span id="cb461-19"><a href="rsa-on-pattern-similarity-change.html#cb461-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(max_1minusp, <span class="st">&quot;Harvard_Oxford_Cortical&quot;</span>, <span class="st">&quot;Harvard_Oxford_Subcortical&quot;</span>, cluster_index)) <span class="sc">%&gt;%</span></span>
<span id="cb461-20"><a href="rsa-on-pattern-similarity-change.html#cb461-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(atlas_label)</span>
<span id="cb461-21"><a href="rsa-on-pattern-similarity-change.html#cb461-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-22"><a href="rsa-on-pattern-similarity-change.html#cb461-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add p-values because small values are reported as 0 by FSL cluster</span></span>
<span id="cb461-23"><a href="rsa-on-pattern-similarity-change.html#cb461-23" aria-hidden="true" tabindex="-1"></a>uncorrp_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb461-24"><a href="rsa-on-pattern-similarity-change.html#cb461-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;diff_day_vir_time_neg_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb461-25"><a href="rsa-on-pattern-similarity-change.html#cb461-25" aria-hidden="true" tabindex="-1"></a>uncorrp_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(uncorrp_fn)</span>
<span id="cb461-26"><a href="rsa-on-pattern-similarity-change.html#cb461-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(uncorrp_df)){</span>
<span id="cb461-27"><a href="rsa-on-pattern-similarity-change.html#cb461-27" aria-hidden="true" tabindex="-1"></a>  coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(uncorrp_df[i,]<span class="sc">$</span>x,uncorrp_df[i,]<span class="sc">$</span>y,uncorrp_df[i,]<span class="sc">$</span>z))</span>
<span id="cb461-28"><a href="rsa-on-pattern-similarity-change.html#cb461-28" aria-hidden="true" tabindex="-1"></a>  uncorrp_df[i,]<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>uncorrp_nii[coords[<span class="dv">1</span>], coords[<span class="dv">2</span>], coords[<span class="dv">3</span>]]</span>
<span id="cb461-29"><a href="rsa-on-pattern-similarity-change.html#cb461-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Create pretty table that can be written to Word.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="rsa-on-pattern-similarity-change.html#cb462-1" aria-hidden="true" tabindex="-1"></a>uncorrp_ht <span class="ot">&lt;-</span> uncorrp_df <span class="sc">%&gt;%</span> </span>
<span id="cb462-2"><a href="rsa-on-pattern-similarity-change.html#cb462-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_huxtable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb462-3"><a href="rsa-on-pattern-similarity-change.html#cb462-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="fu">c</span>(<span class="st">&quot;Atlas Label&quot;</span>, <span class="st">&quot;Voxel Extent&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;COG x&quot;</span>, <span class="st">&quot;COG y&quot;</span>, <span class="st">&quot;COG z&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;p&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb462-4"><a href="rsa-on-pattern-similarity-change.html#cb462-4" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">insert_row</span>(., <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="fu">ncol</span>(.)), <span class="at">after=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb462-5"><a href="rsa-on-pattern-similarity-change.html#cb462-5" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">merge_across</span>(.,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb462-6"><a href="rsa-on-pattern-similarity-change.html#cb462-6" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="st">&quot;Exploratory searchlight results, p-values uncorrected&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb462-7"><a href="rsa-on-pattern-similarity-change.html#cb462-7" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_header_rows</span>(.,<span class="at">row=</span><span class="dv">1</span>, <span class="at">value=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb462-8"><a href="rsa-on-pattern-similarity-change.html#cb462-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_article</span>()</span>
<span id="cb462-9"><a href="rsa-on-pattern-similarity-change.html#cb462-9" aria-hidden="true" tabindex="-1"></a>uncorrp_ht</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-222">
<col><col><col><col><col><col><col><col><col><col><tr>
<th colspan="10" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Exploratory searchlight results, p-values uncorrected</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Atlas Label</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Voxel Extent</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">cerebellum</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">314</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">19</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-68</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-34</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">19.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-66.3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29.6&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-5.37</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">cerebellum</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">104</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-68</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-14</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.86</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-69.1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-14.3&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.44</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">lingual gyrus</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">100</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-70</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.68</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-70.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.56</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.73</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
</table>

<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="rsa-on-pattern-similarity-change.html#cb463-1" aria-hidden="true" tabindex="-1"></a>stable_srchlght_diff_seq <span class="ot">&lt;-</span> uncorrp_ht <span class="sc">%&gt;%</span> </span>
<span id="cb463-2"><a href="rsa-on-pattern-similarity-change.html#cb463-2" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">add_footnote</span>(<span class="st">&quot;x, y, z refer to MNI coordinates of minimum p-value in cluster, t denotes the most extreme t-value, COG: center of gravity&quot;</span>, <span class="at">border =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb463-3"><a href="rsa-on-pattern-similarity-change.html#cb463-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">as_flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb463-4"><a href="rsa-on-pattern-similarity-change.html#cb463-4" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb463-5"><a href="rsa-on-pattern-similarity-change.html#cb463-5" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">font</span>(<span class="at">fontname =</span> font2use) <span class="sc">%&gt;%</span></span>
<span id="cb463-6"><a href="rsa-on-pattern-similarity-change.html#cb463-6" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">style</span>(<span class="at">i=</span><span class="fu">c</span>(<span class="dv">1</span>), </span>
<span id="cb463-7"><a href="rsa-on-pattern-similarity-change.html#cb463-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pr_c =</span> officer<span class="sc">::</span><span class="fu">fp_cell</span>(<span class="at">border.bottom =</span> <span class="fu">fp_border</span>(),</span>
<span id="cb463-8"><a href="rsa-on-pattern-similarity-change.html#cb463-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">border.top =</span> <span class="fu">fp_border</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb463-9"><a href="rsa-on-pattern-similarity-change.html#cb463-9" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">bg</span>(<span class="at">i=</span><span class="dv">1</span>, <span class="at">bg=</span><span class="st">&quot;lightgrey&quot;</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb463-10"><a href="rsa-on-pattern-similarity-change.html#cb463-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">padding</span>(., <span class="at">padding =</span> <span class="dv">3</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span>  <span class="fu">set_table_properties</span>(., <span class="at">width=</span><span class="dv">1</span>, <span class="at">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb463-11"><a href="rsa-on-pattern-similarity-change.html#cb463-11" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(., <span class="at">caption =</span> <span class="st">&quot;Searchlight Analysis: Virtual time explains representational change for different-sequence events&quot;</span>, </span>
<span id="cb463-12"><a href="rsa-on-pattern-similarity-change.html#cb463-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style=</span><span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="rsa-on-pattern-similarity-change.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb464-2"><a href="rsa-on-pattern-similarity-change.html#cb464-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">25</span>,<span class="sc">-</span><span class="dv">19</span>,<span class="sc">-</span><span class="dv">15</span>))</span>
<span id="cb464-3"><a href="rsa-on-pattern-similarity-change.html#cb464-3" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="fu">vox2mni</span>(coords)),</span>
<span id="cb464-4"><a href="rsa-on-pattern-similarity-change.html#cb464-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="fu">vox2mni</span>(coords)))</span>
<span id="cb464-5"><a href="rsa-on-pattern-similarity-change.html#cb464-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-6"><a href="rsa-on-pattern-similarity-change.html#cb464-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb464-7"><a href="rsa-on-pattern-similarity-change.html#cb464-7" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb464-8"><a href="rsa-on-pattern-similarity-change.html#cb464-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb464-9"><a href="rsa-on-pattern-similarity-change.html#cb464-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb464-10"><a href="rsa-on-pattern-similarity-change.html#cb464-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb464-11"><a href="rsa-on-pattern-similarity-change.html#cb464-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-12"><a href="rsa-on-pattern-similarity-change.html#cb464-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb464-13"><a href="rsa-on-pattern-similarity-change.html#cb464-13" aria-hidden="true" tabindex="-1"></a>pfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb464-14"><a href="rsa-on-pattern-similarity-change.html#cb464-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;diff_day_vir_time_neg_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb464-15"><a href="rsa-on-pattern-similarity-change.html#cb464-15" aria-hidden="true" tabindex="-1"></a>pfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(pfov_fn)</span>
<span id="cb464-16"><a href="rsa-on-pattern-similarity-change.html#cb464-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-17"><a href="rsa-on-pattern-similarity-change.html#cb464-17" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (FOV)</span></span>
<span id="cb464-18"><a href="rsa-on-pattern-similarity-change.html#cb464-18" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb464-19"><a href="rsa-on-pattern-similarity-change.html#cb464-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;diff_day_vir_time_neg_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb464-20"><a href="rsa-on-pattern-similarity-change.html#cb464-20" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb464-21"><a href="rsa-on-pattern-similarity-change.html#cb464-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-22"><a href="rsa-on-pattern-similarity-change.html#cb464-22" aria-hidden="true" tabindex="-1"></a><span class="co"># CAVE: because we are looking at the negative contrast, multiply the t-values by -1 to actually show</span></span>
<span id="cb464-23"><a href="rsa-on-pattern-similarity-change.html#cb464-23" aria-hidden="true" tabindex="-1"></a><span class="co"># negative t-values (they have previously been multiplied by -1 to run randomise, now revert this)</span></span>
<span id="cb464-24"><a href="rsa-on-pattern-similarity-change.html#cb464-24" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> t_nii <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb464-25"><a href="rsa-on-pattern-similarity-change.html#cb464-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-26"><a href="rsa-on-pattern-similarity-change.html#cb464-26" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb464-27"><a href="rsa-on-pattern-similarity-change.html#cb464-27" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.05</span> </span>
<span id="cb464-28"><a href="rsa-on-pattern-similarity-change.html#cb464-28" aria-hidden="true" tabindex="-1"></a>t_nii[pfov_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb464-29"><a href="rsa-on-pattern-similarity-change.html#cb464-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-30"><a href="rsa-on-pattern-similarity-change.html#cb464-30" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb464-31"><a href="rsa-on-pattern-similarity-change.html#cb464-31" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb464-32"><a href="rsa-on-pattern-similarity-change.html#cb464-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb464-33"><a href="rsa-on-pattern-similarity-change.html#cb464-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb464-34"><a href="rsa-on-pattern-similarity-change.html#cb464-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb464-35"><a href="rsa-on-pattern-similarity-change.html#cb464-35" aria-hidden="true" tabindex="-1"></a>f7c <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb464-36"><a href="rsa-on-pattern-similarity-change.html#cb464-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb464-37"><a href="rsa-on-pattern-similarity-change.html#cb464-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-38"><a href="rsa-on-pattern-similarity-change.html#cb464-38" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;lajolla&quot;</span>, </span>
<span id="cb464-39"><a href="rsa-on-pattern-similarity-change.html#cb464-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end=</span><span class="fl">0.9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb464-40"><a href="rsa-on-pattern-similarity-change.html#cb464-40" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb464-41"><a href="rsa-on-pattern-similarity-change.html#cb464-41" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb464-42"><a href="rsa-on-pattern-similarity-change.html#cb464-42" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb464-43"><a href="rsa-on-pattern-similarity-change.html#cb464-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">different</span><span class="sc">\n</span><span class="st">sequence&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-44"><a href="rsa-on-pattern-similarity-change.html#cb464-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb464-45"><a href="rsa-on-pattern-similarity-change.html#cb464-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb464-46"><a href="rsa-on-pattern-similarity-change.html#cb464-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb464-47"><a href="rsa-on-pattern-similarity-change.html#cb464-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb464-48"><a href="rsa-on-pattern-similarity-change.html#cb464-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb464-49"><a href="rsa-on-pattern-similarity-change.html#cb464-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb464-50"><a href="rsa-on-pattern-similarity-change.html#cb464-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb464-51"><a href="rsa-on-pattern-similarity-change.html#cb464-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb464-52"><a href="rsa-on-pattern-similarity-change.html#cb464-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb464-53"><a href="rsa-on-pattern-similarity-change.html#cb464-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb464-54"><a href="rsa-on-pattern-similarity-change.html#cb464-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb464-55"><a href="rsa-on-pattern-similarity-change.html#cb464-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb464-56"><a href="rsa-on-pattern-similarity-change.html#cb464-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb464-57"><a href="rsa-on-pattern-similarity-change.html#cb464-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>))<span class="sc">+</span></span>
<span id="cb464-58"><a href="rsa-on-pattern-similarity-change.html#cb464-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb464-59"><a href="rsa-on-pattern-similarity-change.html#cb464-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-60"><a href="rsa-on-pattern-similarity-change.html#cb464-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">84.7</span>,<span class="sc">-</span><span class="fl">70.37</span>,<span class="sc">-</span><span class="fl">90.69</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb464-61"><a href="rsa-on-pattern-similarity-change.html#cb464-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb464-62"><a href="rsa-on-pattern-similarity-change.html#cb464-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb464-63"><a href="rsa-on-pattern-similarity-change.html#cb464-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb464-64"><a href="rsa-on-pattern-similarity-change.html#cb464-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb464-65"><a href="rsa-on-pattern-similarity-change.html#cb464-65" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f7c)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="rsa-on-pattern-similarity-change.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> tvals_fn, <span class="at">to =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f7c.nii.gz&quot;</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="visualization-of-overlap" class="section level3 unnumbered">
<h3>Visualization of Overlap</h3>
<p>To visualize the overlap between the within- and the between-sequence effects we next create an overlap plot on a zoomed-in plot of the hippocampal region.</p>
<p>This is for visual purposes only, so we use a liberal threshold of p&lt;0.05 within our small-volume-correction mask.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="rsa-on-pattern-similarity-change.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb467-2"><a href="rsa-on-pattern-similarity-change.html#cb467-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">25</span>,<span class="sc">-</span><span class="dv">18</span>,<span class="sc">-</span><span class="dv">16</span>))</span>
<span id="cb467-3"><a href="rsa-on-pattern-similarity-change.html#cb467-3" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)),</span>
<span id="cb467-4"><a href="rsa-on-pattern-similarity-change.html#cb467-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)))</span>
<span id="cb467-5"><a href="rsa-on-pattern-similarity-change.html#cb467-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-6"><a href="rsa-on-pattern-similarity-change.html#cb467-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for this plot we want to &quot;zoom in&quot;, which we accomplish by masking out all but a small region of the brain</span></span>
<span id="cb467-7"><a href="rsa-on-pattern-similarity-change.html#cb467-7" aria-hidden="true" tabindex="-1"></a>box2remove<span class="ot">&lt;-</span><span class="fu">array</span>(<span class="dv">1</span>, <span class="at">dim =</span> <span class="fu">dim</span>(mni_nii))</span>
<span id="cb467-8"><a href="rsa-on-pattern-similarity-change.html#cb467-8" aria-hidden="true" tabindex="-1"></a>box2remove[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">51</span>, <span class="dv">131</span><span class="sc">:</span><span class="dv">182</span>),,] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb467-9"><a href="rsa-on-pattern-similarity-change.html#cb467-9" aria-hidden="true" tabindex="-1"></a>box2remove[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">68</span>, <span class="dv">150</span><span class="sc">:</span><span class="dv">218</span>),] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb467-10"><a href="rsa-on-pattern-similarity-change.html#cb467-10" aria-hidden="true" tabindex="-1"></a>box2remove[,,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>, <span class="dv">101</span><span class="sc">:</span><span class="dv">182</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb467-11"><a href="rsa-on-pattern-similarity-change.html#cb467-11" aria-hidden="true" tabindex="-1"></a>mni_zoom_nii <span class="ot">&lt;-</span> mni_nii <span class="sc">*</span> box2remove</span>
<span id="cb467-12"><a href="rsa-on-pattern-similarity-change.html#cb467-12" aria-hidden="true" tabindex="-1"></a>mni_zoom_nii[mni_zoom_nii<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb467-13"><a href="rsa-on-pattern-similarity-change.html#cb467-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-14"><a href="rsa-on-pattern-similarity-change.html#cb467-14" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb467-15"><a href="rsa-on-pattern-similarity-change.html#cb467-15" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_zoom_nii,</span>
<span id="cb467-16"><a href="rsa-on-pattern-similarity-change.html#cb467-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb467-17"><a href="rsa-on-pattern-similarity-change.html#cb467-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb467-18"><a href="rsa-on-pattern-similarity-change.html#cb467-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb467-19"><a href="rsa-on-pattern-similarity-change.html#cb467-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-20"><a href="rsa-on-pattern-similarity-change.html#cb467-20" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb467-21"><a href="rsa-on-pattern-similarity-change.html#cb467-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-22"><a href="rsa-on-pattern-similarity-change.html#cb467-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb467-23"><a href="rsa-on-pattern-similarity-change.html#cb467-23" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb467-24"><a href="rsa-on-pattern-similarity-change.html#cb467-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;same_day_vir_time_randomise_svc_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb467-25"><a href="rsa-on-pattern-similarity-change.html#cb467-25" aria-hidden="true" tabindex="-1"></a>sameday_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb467-26"><a href="rsa-on-pattern-similarity-change.html#cb467-26" aria-hidden="true" tabindex="-1"></a>sameday_nii[sameday_nii <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb467-27"><a href="rsa-on-pattern-similarity-change.html#cb467-27" aria-hidden="true" tabindex="-1"></a>sameday_nii[sameday_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb467-28"><a href="rsa-on-pattern-similarity-change.html#cb467-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-29"><a href="rsa-on-pattern-similarity-change.html#cb467-29" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb467-30"><a href="rsa-on-pattern-similarity-change.html#cb467-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;diff_day_vir_time_neg_randomise_svc_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb467-31"><a href="rsa-on-pattern-similarity-change.html#cb467-31" aria-hidden="true" tabindex="-1"></a>diffday_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb467-32"><a href="rsa-on-pattern-similarity-change.html#cb467-32" aria-hidden="true" tabindex="-1"></a>diffday_nii[diffday_nii <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb467-33"><a href="rsa-on-pattern-similarity-change.html#cb467-33" aria-hidden="true" tabindex="-1"></a>diffday_nii[diffday_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb467-34"><a href="rsa-on-pattern-similarity-change.html#cb467-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-35"><a href="rsa-on-pattern-similarity-change.html#cb467-35" aria-hidden="true" tabindex="-1"></a>overlap_nii <span class="ot">&lt;-</span> sameday_nii <span class="sc">+</span> diffday_nii</span>
<span id="cb467-36"><a href="rsa-on-pattern-similarity-change.html#cb467-36" aria-hidden="true" tabindex="-1"></a>overlap_nii[overlap_nii <span class="sc">&lt;</span> <span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb467-37"><a href="rsa-on-pattern-similarity-change.html#cb467-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-38"><a href="rsa-on-pattern-similarity-change.html#cb467-38" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb467-39"><a href="rsa-on-pattern-similarity-change.html#cb467-39" aria-hidden="true" tabindex="-1"></a>o_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>overlap_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb467-40"><a href="rsa-on-pattern-similarity-change.html#cb467-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb467-41"><a href="rsa-on-pattern-similarity-change.html#cb467-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb467-42"><a href="rsa-on-pattern-similarity-change.html#cb467-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.factor</span>(value), <span class="at">value =</span> <span class="fu">recode_factor</span>(value, <span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;same&quot;</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;different&quot;</span>, <span class="st">`</span><span class="at">3</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;overlap&quot;</span>))</span>
<span id="cb467-43"><a href="rsa-on-pattern-similarity-change.html#cb467-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-44"><a href="rsa-on-pattern-similarity-change.html#cb467-44" aria-hidden="true" tabindex="-1"></a>f7d <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb467-45"><a href="rsa-on-pattern-similarity-change.html#cb467-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>o_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb467-46"><a href="rsa-on-pattern-similarity-change.html#cb467-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb467-47"><a href="rsa-on-pattern-similarity-change.html#cb467-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], aHPC_colors[<span class="st">&quot;across_main&quot;</span>], day_time_int_color)),</span>
<span id="cb467-48"><a href="rsa-on-pattern-similarity-change.html#cb467-48" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(</span>
<span id="cb467-49"><a href="rsa-on-pattern-similarity-change.html#cb467-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>), </span>
<span id="cb467-50"><a href="rsa-on-pattern-similarity-change.html#cb467-50" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb467-51"><a href="rsa-on-pattern-similarity-change.html#cb467-51" aria-hidden="true" tabindex="-1"></a>                      <span class="at">title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb467-52"><a href="rsa-on-pattern-similarity-change.html#cb467-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label.position =</span> <span class="st">&quot;right&quot;</span>)) <span class="sc">+</span></span>
<span id="cb467-53"><a href="rsa-on-pattern-similarity-change.html#cb467-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">overlap</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb467-54"><a href="rsa-on-pattern-similarity-change.html#cb467-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb467-55"><a href="rsa-on-pattern-similarity-change.html#cb467-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb467-56"><a href="rsa-on-pattern-similarity-change.html#cb467-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb467-57"><a href="rsa-on-pattern-similarity-change.html#cb467-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb467-58"><a href="rsa-on-pattern-similarity-change.html#cb467-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb467-59"><a href="rsa-on-pattern-similarity-change.html#cb467-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb467-60"><a href="rsa-on-pattern-similarity-change.html#cb467-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb467-61"><a href="rsa-on-pattern-similarity-change.html#cb467-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb467-62"><a href="rsa-on-pattern-similarity-change.html#cb467-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb467-63"><a href="rsa-on-pattern-similarity-change.html#cb467-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb467-64"><a href="rsa-on-pattern-similarity-change.html#cb467-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">71.87</span>,<span class="sc">-</span><span class="fl">67.75</span>,<span class="sc">-</span><span class="fl">42.93</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb467-65"><a href="rsa-on-pattern-similarity-change.html#cb467-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb467-66"><a href="rsa-on-pattern-similarity-change.html#cb467-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb467-67"><a href="rsa-on-pattern-similarity-change.html#cb467-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb467-68"><a href="rsa-on-pattern-similarity-change.html#cb467-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb467-69"><a href="rsa-on-pattern-similarity-change.html#cb467-69" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f7d)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="rsa-on-pattern-similarity-change.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb468-2"><a href="rsa-on-pattern-similarity-change.html#cb468-2" aria-hidden="true" tabindex="-1"></a>overlap_nii[<span class="fu">is.na</span>(overlap_nii)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># replace NAs with 0 to avoid trouble</span></span>
<span id="cb468-3"><a href="rsa-on-pattern-similarity-change.html#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeNIfTI2</span>(<span class="at">nim =</span> overlap_nii, <span class="at">filename =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f7d&quot;</span>), <span class="at">dtype =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="virtual-time-sequence-interaction" class="section level3 unnumbered">
<h3>Virtual Time &amp; Sequence Interaction</h3>
<p>In our searchlight analyses, we also directly looked for voxels where the effect of virtual time differs depending on whether we are looking at events from the same sequence or from different sequences, i.e. an interaction of virtual temporal distances and a sequence factor (same/different).</p>
<p>Report significant clusters after small volume correction.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="rsa-on-pattern-similarity-change.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the cluster file for corrected results</span></span>
<span id="cb469-2"><a href="rsa-on-pattern-similarity-change.html#cb469-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,</span>
<span id="cb469-3"><a href="rsa-on-pattern-similarity-change.html#cb469-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;day_time_interaction&quot;</span>, <span class="st">&quot;cluster_day_time_interaction_svc_corrp_atlas.txt&quot;</span>)</span>
<span id="cb469-4"><a href="rsa-on-pattern-similarity-change.html#cb469-4" aria-hidden="true" tabindex="-1"></a>corrp_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(fn, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;ccdddddddddd&quot;</span>))</span>
<span id="cb469-5"><a href="rsa-on-pattern-similarity-change.html#cb469-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-6"><a href="rsa-on-pattern-similarity-change.html#cb469-6" aria-hidden="true" tabindex="-1"></a><span class="co"># quick print</span></span>
<span id="cb469-7"><a href="rsa-on-pattern-similarity-change.html#cb469-7" aria-hidden="true" tabindex="-1"></a><span class="co">#corrp_df %&gt;% huxtable::as_huxtable() %&gt;% theme_article()</span></span>
<span id="cb469-8"><a href="rsa-on-pattern-similarity-change.html#cb469-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-9"><a href="rsa-on-pattern-similarity-change.html#cb469-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with p-values (not 1-p as given by FSL) and manual labels</span></span>
<span id="cb469-10"><a href="rsa-on-pattern-similarity-change.html#cb469-10" aria-hidden="true" tabindex="-1"></a>corrp_df <span class="ot">&lt;-</span> corrp_df <span class="sc">%&gt;%</span></span>
<span id="cb469-11"><a href="rsa-on-pattern-similarity-change.html#cb469-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb469-12"><a href="rsa-on-pattern-similarity-change.html#cb469-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>max_1minusp,</span>
<span id="cb469-13"><a href="rsa-on-pattern-similarity-change.html#cb469-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">atlas_label =</span> <span class="fu">c</span>(<span class="st">&quot;left hippocampus&quot;</span>, <span class="st">&quot;right hippocampus&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb469-14"><a href="rsa-on-pattern-similarity-change.html#cb469-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(max_1minusp, <span class="st">&quot;Harvard_Oxford_Cortical&quot;</span>, <span class="st">&quot;Harvard_Oxford_Subcortical&quot;</span>, cluster_index)) <span class="sc">%&gt;%</span></span>
<span id="cb469-15"><a href="rsa-on-pattern-similarity-change.html#cb469-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(atlas_label)</span>
<span id="cb469-16"><a href="rsa-on-pattern-similarity-change.html#cb469-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-17"><a href="rsa-on-pattern-similarity-change.html#cb469-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen </span></span>
<span id="cb469-18"><a href="rsa-on-pattern-similarity-change.html#cb469-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;significant clusters in day-time interaction searchlight:&quot;</span>,</span>
<span id="cb469-19"><a href="rsa-on-pattern-similarity-change.html#cb469-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">%s, peak voxel at x=%d, y=%d, z=%d; t=%.2f, corrected p=%.3f&quot;</span>,</span>
<span id="cb469-20"><a href="rsa-on-pattern-similarity-change.html#cb469-20" aria-hidden="true" tabindex="-1"></a>            corrp_df<span class="sc">$</span>atlas_label, corrp_df<span class="sc">$</span>x, corrp_df<span class="sc">$</span>y, corrp_df<span class="sc">$</span>z, corrp_df<span class="sc">$</span>t_extr, corrp_df<span class="sc">$</span>p))</span></code></pre></div>
<pre><code>## significant clusters in day-time interaction searchlight: 
## left hippocampus, peak voxel at x=-26, y=-20, z=-15; t=4.15, corrected p=0.014 
## right hippocampus, peak voxel at x=31, y=-16, z=-21; t=4.25, corrected p=0.007</code></pre>
<p>Report additional clusters from exploratory analysis with threshold p&lt;0.001 uncorrected and a minimum of 30 voxels per cluster.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="rsa-on-pattern-similarity-change.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the cluster file for uncorrected results</span></span>
<span id="cb471-2"><a href="rsa-on-pattern-similarity-change.html#cb471-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,</span>
<span id="cb471-3"><a href="rsa-on-pattern-similarity-change.html#cb471-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;day_time_interaction&quot;</span>, <span class="st">&quot;cluster_day_time_interaction_fov_uncorrp_atlas.txt&quot;</span>)</span>
<span id="cb471-4"><a href="rsa-on-pattern-similarity-change.html#cb471-4" aria-hidden="true" tabindex="-1"></a>uncorrp_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(fn, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;ccdddddddddd&quot;</span>))</span>
<span id="cb471-5"><a href="rsa-on-pattern-similarity-change.html#cb471-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-6"><a href="rsa-on-pattern-similarity-change.html#cb471-6" aria-hidden="true" tabindex="-1"></a><span class="co"># quick print</span></span>
<span id="cb471-7"><a href="rsa-on-pattern-similarity-change.html#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="co">#uncorrp_df %&gt;% huxtable::as_huxtable() %&gt;% theme_article()</span></span>
<span id="cb471-8"><a href="rsa-on-pattern-similarity-change.html#cb471-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-9"><a href="rsa-on-pattern-similarity-change.html#cb471-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with p-values (not 1-p as given by FSL) and manual labels</span></span>
<span id="cb471-10"><a href="rsa-on-pattern-similarity-change.html#cb471-10" aria-hidden="true" tabindex="-1"></a>uncorrp_df <span class="ot">&lt;-</span> uncorrp_df <span class="sc">%&gt;%</span></span>
<span id="cb471-11"><a href="rsa-on-pattern-similarity-change.html#cb471-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb471-12"><a href="rsa-on-pattern-similarity-change.html#cb471-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>max_1minusp,</span>
<span id="cb471-13"><a href="rsa-on-pattern-similarity-change.html#cb471-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">atlas_label =</span> <span class="fu">c</span>(</span>
<span id="cb471-14"><a href="rsa-on-pattern-similarity-change.html#cb471-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;left hippocampus&quot;</span>,</span>
<span id="cb471-15"><a href="rsa-on-pattern-similarity-change.html#cb471-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;right hippocampus&quot;</span>,</span>
<span id="cb471-16"><a href="rsa-on-pattern-similarity-change.html#cb471-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;occipital pole&quot;</span>,</span>
<span id="cb471-17"><a href="rsa-on-pattern-similarity-change.html#cb471-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;lingual gyrus&quot;</span>,</span>
<span id="cb471-18"><a href="rsa-on-pattern-similarity-change.html#cb471-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;frontal pole&quot;</span>,</span>
<span id="cb471-19"><a href="rsa-on-pattern-similarity-change.html#cb471-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;frontal pole&quot;</span>,</span>
<span id="cb471-20"><a href="rsa-on-pattern-similarity-change.html#cb471-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;temporal fusiform cortex&quot;</span>,</span>
<span id="cb471-21"><a href="rsa-on-pattern-similarity-change.html#cb471-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;intracalcarine sulcus&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb471-22"><a href="rsa-on-pattern-similarity-change.html#cb471-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(max_1minusp, <span class="st">&quot;Harvard_Oxford_Cortical&quot;</span>, <span class="st">&quot;Harvard_Oxford_Subcortical&quot;</span>, cluster_index)) <span class="sc">%&gt;%</span></span>
<span id="cb471-23"><a href="rsa-on-pattern-similarity-change.html#cb471-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(atlas_label, <span class="st">&quot;hippocampus&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove hippocampal clusters (already reported with SVC)</span></span>
<span id="cb471-24"><a href="rsa-on-pattern-similarity-change.html#cb471-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(atlas_label)</span>
<span id="cb471-25"><a href="rsa-on-pattern-similarity-change.html#cb471-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-26"><a href="rsa-on-pattern-similarity-change.html#cb471-26" aria-hidden="true" tabindex="-1"></a><span class="co"># add p-values because small values are reported as 0 by FSL cluster</span></span>
<span id="cb471-27"><a href="rsa-on-pattern-similarity-change.html#cb471-27" aria-hidden="true" tabindex="-1"></a>uncorrp_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb471-28"><a href="rsa-on-pattern-similarity-change.html#cb471-28" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb471-29"><a href="rsa-on-pattern-similarity-change.html#cb471-29" aria-hidden="true" tabindex="-1"></a>uncorrp_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(uncorrp_fn)</span>
<span id="cb471-30"><a href="rsa-on-pattern-similarity-change.html#cb471-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(uncorrp_df)){</span>
<span id="cb471-31"><a href="rsa-on-pattern-similarity-change.html#cb471-31" aria-hidden="true" tabindex="-1"></a>  coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(uncorrp_df[i,]<span class="sc">$</span>x,uncorrp_df[i,]<span class="sc">$</span>y,uncorrp_df[i,]<span class="sc">$</span>z))</span>
<span id="cb471-32"><a href="rsa-on-pattern-similarity-change.html#cb471-32" aria-hidden="true" tabindex="-1"></a>  uncorrp_df[i,]<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>uncorrp_nii[coords[<span class="dv">1</span>], coords[<span class="dv">2</span>], coords[<span class="dv">3</span>]]</span>
<span id="cb471-33"><a href="rsa-on-pattern-similarity-change.html#cb471-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Make pretty overview table that can be saved to Word.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="rsa-on-pattern-similarity-change.html#cb472-1" aria-hidden="true" tabindex="-1"></a>corrp_ht <span class="ot">&lt;-</span> corrp_df <span class="sc">%&gt;%</span> </span>
<span id="cb472-2"><a href="rsa-on-pattern-similarity-change.html#cb472-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_huxtable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb472-3"><a href="rsa-on-pattern-similarity-change.html#cb472-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="fu">c</span>(<span class="st">&quot;Atlas Label&quot;</span>, <span class="st">&quot;Voxel Extent&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;COG x&quot;</span>, <span class="st">&quot;COG y&quot;</span>, <span class="st">&quot;COG z&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;p&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb472-4"><a href="rsa-on-pattern-similarity-change.html#cb472-4" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">insert_row</span>(., <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="fu">ncol</span>(.)), <span class="at">after=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb472-5"><a href="rsa-on-pattern-similarity-change.html#cb472-5" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">merge_across</span>(.,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb472-6"><a href="rsa-on-pattern-similarity-change.html#cb472-6" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="st">&quot;Searchlight results in a priori regions of interest, p-values corrected using small volume correction&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb472-7"><a href="rsa-on-pattern-similarity-change.html#cb472-7" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_header_rows</span>(.,<span class="at">row=</span><span class="dv">1</span>, <span class="at">value=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb472-8"><a href="rsa-on-pattern-similarity-change.html#cb472-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_article</span>()</span>
<span id="cb472-9"><a href="rsa-on-pattern-similarity-change.html#cb472-9" aria-hidden="true" tabindex="-1"></a>corrp_ht</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-227">
<col><col><col><col><col><col><col><col><col><col><tr>
<th colspan="10" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Searchlight results in a priori regions of interest, p-values corrected using small volume correction</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Atlas Label</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Voxel Extent</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">left hippocampus</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">359</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-26</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-23.4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-15.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-18.6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.014</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">right hippocampus</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">335</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">31</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-16</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-21</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">30.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-15.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-20.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.007</td></tr>
</table>

<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="rsa-on-pattern-similarity-change.html#cb473-1" aria-hidden="true" tabindex="-1"></a>uncorrp_ht <span class="ot">&lt;-</span> uncorrp_df <span class="sc">%&gt;%</span> </span>
<span id="cb473-2"><a href="rsa-on-pattern-similarity-change.html#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_huxtable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb473-3"><a href="rsa-on-pattern-similarity-change.html#cb473-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="fu">c</span>(<span class="st">&quot;Atlas Label&quot;</span>, <span class="st">&quot;Voxel Extent&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;COG x&quot;</span>, <span class="st">&quot;COG y&quot;</span>, <span class="st">&quot;COG z&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;p&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb473-4"><a href="rsa-on-pattern-similarity-change.html#cb473-4" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">insert_row</span>(., <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="fu">ncol</span>(.)), <span class="at">after=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb473-5"><a href="rsa-on-pattern-similarity-change.html#cb473-5" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">merge_across</span>(.,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb473-6"><a href="rsa-on-pattern-similarity-change.html#cb473-6" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_contents</span>(., <span class="at">row=</span><span class="dv">1</span>, <span class="at">value =</span><span class="st">&quot;Exploratory searchlight results, p-values uncorrected&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb473-7"><a href="rsa-on-pattern-similarity-change.html#cb473-7" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">set_header_rows</span>(.,<span class="at">row=</span><span class="dv">1</span>, <span class="at">value=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb473-8"><a href="rsa-on-pattern-similarity-change.html#cb473-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_article</span>()</span>
<span id="cb473-9"><a href="rsa-on-pattern-similarity-change.html#cb473-9" aria-hidden="true" tabindex="-1"></a>uncorrp_ht</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-227">
<col><col><col><col><col><col><col><col><col><col><tr>
<th colspan="10" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Exploratory searchlight results, p-values uncorrected</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Atlas Label</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Voxel Extent</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG x</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG y</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">COG z</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">occipital pole</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">103</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">17</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-91</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">17.7&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-90.6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-6.62</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.08</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">lingual gyrus</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">102</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-73</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.59</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-70.4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.01</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.72</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">frontal pole</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">96</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">43</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">43</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">45.4&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">43.4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">19.7&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.31</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0006</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">frontal pole</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">35</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">43</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">17</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">37&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">43.2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.81</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0006</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">temporal fusiform cortex</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">40</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-25</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-10</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-45</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-25.3&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-10.3</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-42.9&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.14</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0004</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">intracalcarine sulcus</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">33</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-77</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.85</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-75.8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.56</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.0002</td></tr>
</table>

<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="rsa-on-pattern-similarity-change.html#cb474-1" aria-hidden="true" tabindex="-1"></a>stable_srchlght_interaction <span class="ot">&lt;-</span> <span class="fu">rbind</span>(corrp_ht, uncorrp_ht) <span class="sc">%&gt;%</span> </span>
<span id="cb474-2"><a href="rsa-on-pattern-similarity-change.html#cb474-2" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">add_footnote</span>(<span class="st">&quot;x, y, z refer to MNI coordinates of minimum p-value in cluster, t denotes the most extreme t-value, COG: center of gravity&quot;</span>, <span class="at">border =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb474-3"><a href="rsa-on-pattern-similarity-change.html#cb474-3" aria-hidden="true" tabindex="-1"></a>  huxtable<span class="sc">::</span><span class="fu">as_flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb474-4"><a href="rsa-on-pattern-similarity-change.html#cb474-4" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb474-5"><a href="rsa-on-pattern-similarity-change.html#cb474-5" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">font</span>(<span class="at">fontname =</span> font2use) <span class="sc">%&gt;%</span></span>
<span id="cb474-6"><a href="rsa-on-pattern-similarity-change.html#cb474-6" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">style</span>(<span class="at">i=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(corrp_ht)<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb474-7"><a href="rsa-on-pattern-similarity-change.html#cb474-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pr_c =</span> officer<span class="sc">::</span><span class="fu">fp_cell</span>(<span class="at">border.bottom =</span> <span class="fu">fp_border</span>(),</span>
<span id="cb474-8"><a href="rsa-on-pattern-similarity-change.html#cb474-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">border.top =</span> <span class="fu">fp_border</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb474-9"><a href="rsa-on-pattern-similarity-change.html#cb474-9" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">bg</span>(<span class="at">i=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(corrp_ht)<span class="sc">+</span><span class="dv">1</span>), <span class="at">bg=</span><span class="st">&quot;lightgrey&quot;</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb474-10"><a href="rsa-on-pattern-similarity-change.html#cb474-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">padding</span>(., <span class="at">padding =</span> <span class="dv">3</span>, <span class="at">part=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb474-11"><a href="rsa-on-pattern-similarity-change.html#cb474-11" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(., <span class="at">width=</span><span class="dv">1</span>, <span class="at">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb474-12"><a href="rsa-on-pattern-similarity-change.html#cb474-12" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(., <span class="at">caption =</span> <span class="st">&quot;Searchlight Analysis: Interaction of virtual time and sequence membership&quot;</span>, </span>
<span id="cb474-13"><a href="rsa-on-pattern-similarity-change.html#cb474-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style=</span><span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<p>As for the within-day effect, we show the t-values at p&lt;0.01 uncorrected (based on field of view) and outline voxels surviving corrections (small volume correction) in black.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="rsa-on-pattern-similarity-change.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb475-2"><a href="rsa-on-pattern-similarity-change.html#cb475-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="dv">31</span>,<span class="sc">-</span><span class="dv">15</span>,<span class="sc">-</span><span class="dv">19</span>))</span>
<span id="cb475-3"><a href="rsa-on-pattern-similarity-change.html#cb475-3" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)),</span>
<span id="cb475-4"><a href="rsa-on-pattern-similarity-change.html#cb475-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)))</span>
<span id="cb475-5"><a href="rsa-on-pattern-similarity-change.html#cb475-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-6"><a href="rsa-on-pattern-similarity-change.html#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb475-7"><a href="rsa-on-pattern-similarity-change.html#cb475-7" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb475-8"><a href="rsa-on-pattern-similarity-change.html#cb475-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb475-9"><a href="rsa-on-pattern-similarity-change.html#cb475-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb475-10"><a href="rsa-on-pattern-similarity-change.html#cb475-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb475-11"><a href="rsa-on-pattern-similarity-change.html#cb475-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-12"><a href="rsa-on-pattern-similarity-change.html#cb475-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb475-13"><a href="rsa-on-pattern-similarity-change.html#cb475-13" aria-hidden="true" tabindex="-1"></a>pfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb475-14"><a href="rsa-on-pattern-similarity-change.html#cb475-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb475-15"><a href="rsa-on-pattern-similarity-change.html#cb475-15" aria-hidden="true" tabindex="-1"></a>pfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(pfov_fn)</span>
<span id="cb475-16"><a href="rsa-on-pattern-similarity-change.html#cb475-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-17"><a href="rsa-on-pattern-similarity-change.html#cb475-17" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (FOV)</span></span>
<span id="cb475-18"><a href="rsa-on-pattern-similarity-change.html#cb475-18" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb475-19"><a href="rsa-on-pattern-similarity-change.html#cb475-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb475-20"><a href="rsa-on-pattern-similarity-change.html#cb475-20" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb475-21"><a href="rsa-on-pattern-similarity-change.html#cb475-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-22"><a href="rsa-on-pattern-similarity-change.html#cb475-22" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb475-23"><a href="rsa-on-pattern-similarity-change.html#cb475-23" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.01</span> </span>
<span id="cb475-24"><a href="rsa-on-pattern-similarity-change.html#cb475-24" aria-hidden="true" tabindex="-1"></a>t_nii[pfov_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb475-25"><a href="rsa-on-pattern-similarity-change.html#cb475-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-26"><a href="rsa-on-pattern-similarity-change.html#cb475-26" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb475-27"><a href="rsa-on-pattern-similarity-change.html#cb475-27" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb475-28"><a href="rsa-on-pattern-similarity-change.html#cb475-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb475-29"><a href="rsa-on-pattern-similarity-change.html#cb475-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb475-30"><a href="rsa-on-pattern-similarity-change.html#cb475-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-31"><a href="rsa-on-pattern-similarity-change.html#cb475-31" aria-hidden="true" tabindex="-1"></a><span class="co"># load outline</span></span>
<span id="cb475-32"><a href="rsa-on-pattern-similarity-change.html#cb475-32" aria-hidden="true" tabindex="-1"></a>outl_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb475-33"><a href="rsa-on-pattern-similarity-change.html#cb475-33" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;day_time_interaction_randomise_svc_fwhm3_tfce_corrp_outline.nii.gz&quot;</span>)</span>
<span id="cb475-34"><a href="rsa-on-pattern-similarity-change.html#cb475-34" aria-hidden="true" tabindex="-1"></a>outl_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(outl_fn)</span>
<span id="cb475-35"><a href="rsa-on-pattern-similarity-change.html#cb475-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-36"><a href="rsa-on-pattern-similarity-change.html#cb475-36" aria-hidden="true" tabindex="-1"></a><span class="co"># remove zero voxels and get dataframe at coordinates</span></span>
<span id="cb475-37"><a href="rsa-on-pattern-similarity-change.html#cb475-37" aria-hidden="true" tabindex="-1"></a>outl_nii[outl_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb475-38"><a href="rsa-on-pattern-similarity-change.html#cb475-38" aria-hidden="true" tabindex="-1"></a>o_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>outl_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb475-39"><a href="rsa-on-pattern-similarity-change.html#cb475-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb475-40"><a href="rsa-on-pattern-similarity-change.html#cb475-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb475-41"><a href="rsa-on-pattern-similarity-change.html#cb475-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-42"><a href="rsa-on-pattern-similarity-change.html#cb475-42" aria-hidden="true" tabindex="-1"></a>f7e <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb475-43"><a href="rsa-on-pattern-similarity-change.html#cb475-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb475-44"><a href="rsa-on-pattern-similarity-change.html#cb475-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>o_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col), <span class="at">fill=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb475-45"><a href="rsa-on-pattern-similarity-change.html#cb475-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-46"><a href="rsa-on-pattern-similarity-change.html#cb475-46" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;buda&quot;</span>, </span>
<span id="cb475-47"><a href="rsa-on-pattern-similarity-change.html#cb475-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end=</span><span class="dv">1</span>,</span>
<span id="cb475-48"><a href="rsa-on-pattern-similarity-change.html#cb475-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb475-49"><a href="rsa-on-pattern-similarity-change.html#cb475-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb475-50"><a href="rsa-on-pattern-similarity-change.html#cb475-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb475-51"><a href="rsa-on-pattern-similarity-change.html#cb475-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">same vs.</span><span class="sc">\n</span><span class="st">different&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-52"><a href="rsa-on-pattern-similarity-change.html#cb475-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb475-53"><a href="rsa-on-pattern-similarity-change.html#cb475-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb475-54"><a href="rsa-on-pattern-similarity-change.html#cb475-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb475-55"><a href="rsa-on-pattern-similarity-change.html#cb475-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb475-56"><a href="rsa-on-pattern-similarity-change.html#cb475-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb475-57"><a href="rsa-on-pattern-similarity-change.html#cb475-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb475-58"><a href="rsa-on-pattern-similarity-change.html#cb475-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb475-59"><a href="rsa-on-pattern-similarity-change.html#cb475-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb475-60"><a href="rsa-on-pattern-similarity-change.html#cb475-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb475-61"><a href="rsa-on-pattern-similarity-change.html#cb475-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb475-62"><a href="rsa-on-pattern-similarity-change.html#cb475-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb475-63"><a href="rsa-on-pattern-similarity-change.html#cb475-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb475-64"><a href="rsa-on-pattern-similarity-change.html#cb475-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb475-65"><a href="rsa-on-pattern-similarity-change.html#cb475-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>))<span class="sc">+</span></span>
<span id="cb475-66"><a href="rsa-on-pattern-similarity-change.html#cb475-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb475-67"><a href="rsa-on-pattern-similarity-change.html#cb475-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-68"><a href="rsa-on-pattern-similarity-change.html#cb475-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">84.64</span>,<span class="sc">-</span><span class="fl">67.25</span>,<span class="sc">-</span><span class="fl">86.51</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb475-69"><a href="rsa-on-pattern-similarity-change.html#cb475-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb475-70"><a href="rsa-on-pattern-similarity-change.html#cb475-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb475-71"><a href="rsa-on-pattern-similarity-change.html#cb475-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb475-72"><a href="rsa-on-pattern-similarity-change.html#cb475-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb475-73"><a href="rsa-on-pattern-similarity-change.html#cb475-73" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f7e)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="rsa-on-pattern-similarity-change.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="at">from =</span> tvals_fn, <span class="at">to =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f7e.nii.gz&quot;</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Let’s compose figure 7.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="rsa-on-pattern-similarity-change.html#cb478-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="st">&quot;ABCDE&quot;</span></span>
<span id="cb478-2"><a href="rsa-on-pattern-similarity-change.html#cb478-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-3"><a href="rsa-on-pattern-similarity-change.html#cb478-3" aria-hidden="true" tabindex="-1"></a>f7 <span class="ot">&lt;-</span> f7a<span class="sc">+</span>f7b<span class="sc">+</span>f7c<span class="sc">+</span>f7d<span class="sc">+</span>f7e <span class="sc">+</span></span>
<span id="cb478-4"><a href="rsa-on-pattern-similarity-change.html#cb478-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb478-5"><a href="rsa-on-pattern-similarity-change.html#cb478-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="sc">-</span><span class="dv">8</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">19</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb478-6"><a href="rsa-on-pattern-similarity-change.html#cb478-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb478-7"><a href="rsa-on-pattern-similarity-change.html#cb478-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb478-8"><a href="rsa-on-pattern-similarity-change.html#cb478-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb478-9"><a href="rsa-on-pattern-similarity-change.html#cb478-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb478-10"><a href="rsa-on-pattern-similarity-change.html#cb478-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb478-11"><a href="rsa-on-pattern-similarity-change.html#cb478-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span>font2use, <span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;plain&quot;</span>))</span>
<span id="cb478-12"><a href="rsa-on-pattern-similarity-change.html#cb478-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-13"><a href="rsa-on-pattern-similarity-change.html#cb478-13" aria-hidden="true" tabindex="-1"></a>f7[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> f7[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb478-14"><a href="rsa-on-pattern-similarity-change.html#cb478-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">l =</span><span class="dv">13</span>)))</span>
<span id="cb478-15"><a href="rsa-on-pattern-similarity-change.html#cb478-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-16"><a href="rsa-on-pattern-similarity-change.html#cb478-16" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print</span></span>
<span id="cb478-17"><a href="rsa-on-pattern-similarity-change.html#cb478-17" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;f7&quot;</span>)</span>
<span id="cb478-18"><a href="rsa-on-pattern-similarity-change.html#cb478-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>f7, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb478-19"><a href="rsa-on-pattern-similarity-change.html#cb478-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb478-20"><a href="rsa-on-pattern-similarity-change.html#cb478-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>f7, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb478-21"><a href="rsa-on-pattern-similarity-change.html#cb478-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/f7.png" alt="" />
<p class="caption">Figure 7. Overlapping representations of within- and across-sequence relations. A. Searchlight analysis results show a positive relationship between representational change and virtual temporal distances for event pairs from the same sequence in the bilateral anterior hippocampus. Statistical image is thresholded at puncorrected&lt;0.01; voxels within black outline are significant after correction for multiple comparisons using small volume correction. B. In the peak cluster from the independent within-sequence searchlight analysis (A), representational change was negatively related to virtual temporal distances between events from different sequences. Circles show individual participant Z-values from summary statistics approach; boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points. C. Searchlight analysis results show negative relationship between representational change and temporal distances for different-sequence event pairs. Statistical image is thresholded at puncorrected &lt;0.05. D. Within the anterior hippocampus, the effects for events from the same sequence and from two different sequences overlap. Visualization is based on statistical images thresholded at puncorrected &lt;0.05 within small volume correction mask. E. Searchlight analysis results show a bilateral interaction effect in the anterior hippocampus that is defined by a differential relationship of virtual temporal distances and representational change for events from the same and different sequences. Statistical image is thresholded at puncorrected&lt;0.01; voxels within black outline are significant after correction for multiple comparisons using small volume correction. A, C-E. Results are shown on the MNI template with voxels outside the field of view displayed in lighter shades of gray. See Supplemental Figure 9 for additional exploratory results. * p&lt;0.05</p>
</div>
</div>
<div id="exploratory-searchlight-results" class="section level3 unnumbered">
<h3>Exploratory Searchlight Results</h3>
<blockquote>
<p>Further, we used a liberal threshold of puncorrected&lt;0.001 to explore the data for additional effects within our field of view. Exploratory searchlight results are shown in Supplemental Figure 9 and clusters with a minimum extent of 30 voxels are listed in Supplemental Tables 12, 14 and 15.</p>
</blockquote>
<p>For completeness, let’s create a supplemental figure that shows the additional clusters outside of our a priori regions of interest.</p>
<div id="same-sequence" class="section level4 unnumbered">
<h4>Same Sequence</h4>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="rsa-on-pattern-similarity-change.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb479-2"><a href="rsa-on-pattern-similarity-change.html#cb479-2" aria-hidden="true" tabindex="-1"></a>mni_coords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">6</span>, <span class="sc">-</span><span class="dv">13</span>)</span>
<span id="cb479-3"><a href="rsa-on-pattern-similarity-change.html#cb479-3" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="dv">48</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))[<span class="dv">1</span>], <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))[<span class="dv">1</span>], <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="sc">-</span><span class="dv">13</span>,<span class="cn">NA</span>))[<span class="dv">2</span>])</span>
<span id="cb479-4"><a href="rsa-on-pattern-similarity-change.html#cb479-4" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),mni_coords),</span>
<span id="cb479-5"><a href="rsa-on-pattern-similarity-change.html#cb479-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>),mni_coords))</span>
<span id="cb479-6"><a href="rsa-on-pattern-similarity-change.html#cb479-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-7"><a href="rsa-on-pattern-similarity-change.html#cb479-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb479-8"><a href="rsa-on-pattern-similarity-change.html#cb479-8" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb479-9"><a href="rsa-on-pattern-similarity-change.html#cb479-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb479-10"><a href="rsa-on-pattern-similarity-change.html#cb479-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb479-11"><a href="rsa-on-pattern-similarity-change.html#cb479-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),mni_coords), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb479-12"><a href="rsa-on-pattern-similarity-change.html#cb479-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-13"><a href="rsa-on-pattern-similarity-change.html#cb479-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb479-14"><a href="rsa-on-pattern-similarity-change.html#cb479-14" aria-hidden="true" tabindex="-1"></a>pfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb479-15"><a href="rsa-on-pattern-similarity-change.html#cb479-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb479-16"><a href="rsa-on-pattern-similarity-change.html#cb479-16" aria-hidden="true" tabindex="-1"></a>pfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(pfov_fn)</span>
<span id="cb479-17"><a href="rsa-on-pattern-similarity-change.html#cb479-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-18"><a href="rsa-on-pattern-similarity-change.html#cb479-18" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (FOV)</span></span>
<span id="cb479-19"><a href="rsa-on-pattern-similarity-change.html#cb479-19" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb479-20"><a href="rsa-on-pattern-similarity-change.html#cb479-20" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb479-21"><a href="rsa-on-pattern-similarity-change.html#cb479-21" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb479-22"><a href="rsa-on-pattern-similarity-change.html#cb479-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-23"><a href="rsa-on-pattern-similarity-change.html#cb479-23" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb479-24"><a href="rsa-on-pattern-similarity-change.html#cb479-24" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.01</span> </span>
<span id="cb479-25"><a href="rsa-on-pattern-similarity-change.html#cb479-25" aria-hidden="true" tabindex="-1"></a>t_nii[pfov_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb479-26"><a href="rsa-on-pattern-similarity-change.html#cb479-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-27"><a href="rsa-on-pattern-similarity-change.html#cb479-27" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb479-28"><a href="rsa-on-pattern-similarity-change.html#cb479-28" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb479-29"><a href="rsa-on-pattern-similarity-change.html#cb479-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),mni_coords), </span>
<span id="cb479-30"><a href="rsa-on-pattern-similarity-change.html#cb479-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb479-31"><a href="rsa-on-pattern-similarity-change.html#cb479-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-32"><a href="rsa-on-pattern-similarity-change.html#cb479-32" aria-hidden="true" tabindex="-1"></a>sfiga_srchlght <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb479-33"><a href="rsa-on-pattern-similarity-change.html#cb479-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb479-34"><a href="rsa-on-pattern-similarity-change.html#cb479-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb479-35"><a href="rsa-on-pattern-similarity-change.html#cb479-35" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>, </span>
<span id="cb479-36"><a href="rsa-on-pattern-similarity-change.html#cb479-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end=</span><span class="fl">0.7</span>,</span>
<span id="cb479-37"><a href="rsa-on-pattern-similarity-change.html#cb479-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb479-38"><a href="rsa-on-pattern-similarity-change.html#cb479-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb479-39"><a href="rsa-on-pattern-similarity-change.html#cb479-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb479-40"><a href="rsa-on-pattern-similarity-change.html#cb479-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">same</span><span class="sc">\n</span><span class="st">sequence&quot;</span>) <span class="sc">+</span></span>
<span id="cb479-41"><a href="rsa-on-pattern-similarity-change.html#cb479-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb479-42"><a href="rsa-on-pattern-similarity-change.html#cb479-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb479-43"><a href="rsa-on-pattern-similarity-change.html#cb479-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb479-44"><a href="rsa-on-pattern-similarity-change.html#cb479-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb479-45"><a href="rsa-on-pattern-similarity-change.html#cb479-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb479-46"><a href="rsa-on-pattern-similarity-change.html#cb479-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb479-47"><a href="rsa-on-pattern-similarity-change.html#cb479-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb479-48"><a href="rsa-on-pattern-similarity-change.html#cb479-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb479-49"><a href="rsa-on-pattern-similarity-change.html#cb479-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb479-50"><a href="rsa-on-pattern-similarity-change.html#cb479-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb479-51"><a href="rsa-on-pattern-similarity-change.html#cb479-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb479-52"><a href="rsa-on-pattern-similarity-change.html#cb479-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb479-53"><a href="rsa-on-pattern-similarity-change.html#cb479-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb479-54"><a href="rsa-on-pattern-similarity-change.html#cb479-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>))<span class="sc">+</span></span>
<span id="cb479-55"><a href="rsa-on-pattern-similarity-change.html#cb479-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb479-56"><a href="rsa-on-pattern-similarity-change.html#cb479-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb479-57"><a href="rsa-on-pattern-similarity-change.html#cb479-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.13</span>,<span class="sc">-</span><span class="fl">94.03</span>,<span class="sc">-</span><span class="fl">68.28</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb479-58"><a href="rsa-on-pattern-similarity-change.html#cb479-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb479-59"><a href="rsa-on-pattern-similarity-change.html#cb479-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb479-60"><a href="rsa-on-pattern-similarity-change.html#cb479-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb479-61"><a href="rsa-on-pattern-similarity-change.html#cb479-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb479-62"><a href="rsa-on-pattern-similarity-change.html#cb479-62" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sfiga_srchlght)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
<div id="different-sequence" class="section level4 unnumbered">
<h4>Different Sequence</h4>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="rsa-on-pattern-similarity-change.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb480-2"><a href="rsa-on-pattern-similarity-change.html#cb480-2" aria-hidden="true" tabindex="-1"></a>mni_coords  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">19</span>, <span class="sc">-</span><span class="dv">70</span>)</span>
<span id="cb480-3"><a href="rsa-on-pattern-similarity-change.html#cb480-3" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))[<span class="dv">1</span>], </span>
<span id="cb480-4"><a href="rsa-on-pattern-similarity-change.html#cb480-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="dv">19</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))[<span class="dv">1</span>],</span>
<span id="cb480-5"><a href="rsa-on-pattern-similarity-change.html#cb480-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="sc">-</span><span class="dv">70</span>,<span class="cn">NA</span>))[<span class="dv">2</span>])</span>
<span id="cb480-6"><a href="rsa-on-pattern-similarity-change.html#cb480-6" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),mni_coords),</span>
<span id="cb480-7"><a href="rsa-on-pattern-similarity-change.html#cb480-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),mni_coords))</span>
<span id="cb480-8"><a href="rsa-on-pattern-similarity-change.html#cb480-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-9"><a href="rsa-on-pattern-similarity-change.html#cb480-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb480-10"><a href="rsa-on-pattern-similarity-change.html#cb480-10" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb480-11"><a href="rsa-on-pattern-similarity-change.html#cb480-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb480-12"><a href="rsa-on-pattern-similarity-change.html#cb480-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb480-13"><a href="rsa-on-pattern-similarity-change.html#cb480-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),mni_coords), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb480-14"><a href="rsa-on-pattern-similarity-change.html#cb480-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-15"><a href="rsa-on-pattern-similarity-change.html#cb480-15" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb480-16"><a href="rsa-on-pattern-similarity-change.html#cb480-16" aria-hidden="true" tabindex="-1"></a>pfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb480-17"><a href="rsa-on-pattern-similarity-change.html#cb480-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;diff_day_vir_time_neg_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb480-18"><a href="rsa-on-pattern-similarity-change.html#cb480-18" aria-hidden="true" tabindex="-1"></a>pfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(pfov_fn)</span>
<span id="cb480-19"><a href="rsa-on-pattern-similarity-change.html#cb480-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-20"><a href="rsa-on-pattern-similarity-change.html#cb480-20" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (FOV)</span></span>
<span id="cb480-21"><a href="rsa-on-pattern-similarity-change.html#cb480-21" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb480-22"><a href="rsa-on-pattern-similarity-change.html#cb480-22" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;diff_day_vir_time_neg_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb480-23"><a href="rsa-on-pattern-similarity-change.html#cb480-23" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb480-24"><a href="rsa-on-pattern-similarity-change.html#cb480-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-25"><a href="rsa-on-pattern-similarity-change.html#cb480-25" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb480-26"><a href="rsa-on-pattern-similarity-change.html#cb480-26" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.01</span> </span>
<span id="cb480-27"><a href="rsa-on-pattern-similarity-change.html#cb480-27" aria-hidden="true" tabindex="-1"></a>t_nii[pfov_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb480-28"><a href="rsa-on-pattern-similarity-change.html#cb480-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-29"><a href="rsa-on-pattern-similarity-change.html#cb480-29" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb480-30"><a href="rsa-on-pattern-similarity-change.html#cb480-30" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb480-31"><a href="rsa-on-pattern-similarity-change.html#cb480-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),mni_coords), </span>
<span id="cb480-32"><a href="rsa-on-pattern-similarity-change.html#cb480-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb480-33"><a href="rsa-on-pattern-similarity-change.html#cb480-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-34"><a href="rsa-on-pattern-similarity-change.html#cb480-34" aria-hidden="true" tabindex="-1"></a>sfigb_srchlght <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb480-35"><a href="rsa-on-pattern-similarity-change.html#cb480-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb480-36"><a href="rsa-on-pattern-similarity-change.html#cb480-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb480-37"><a href="rsa-on-pattern-similarity-change.html#cb480-37" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;lajolla&quot;</span>, </span>
<span id="cb480-38"><a href="rsa-on-pattern-similarity-change.html#cb480-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end=</span><span class="fl">0.9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb480-39"><a href="rsa-on-pattern-similarity-change.html#cb480-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb480-40"><a href="rsa-on-pattern-similarity-change.html#cb480-40" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb480-41"><a href="rsa-on-pattern-similarity-change.html#cb480-41" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb480-42"><a href="rsa-on-pattern-similarity-change.html#cb480-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">different</span><span class="sc">\n</span><span class="st">sequence&quot;</span>) <span class="sc">+</span></span>
<span id="cb480-43"><a href="rsa-on-pattern-similarity-change.html#cb480-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb480-44"><a href="rsa-on-pattern-similarity-change.html#cb480-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb480-45"><a href="rsa-on-pattern-similarity-change.html#cb480-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb480-46"><a href="rsa-on-pattern-similarity-change.html#cb480-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb480-47"><a href="rsa-on-pattern-similarity-change.html#cb480-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb480-48"><a href="rsa-on-pattern-similarity-change.html#cb480-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb480-49"><a href="rsa-on-pattern-similarity-change.html#cb480-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb480-50"><a href="rsa-on-pattern-similarity-change.html#cb480-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb480-51"><a href="rsa-on-pattern-similarity-change.html#cb480-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb480-52"><a href="rsa-on-pattern-similarity-change.html#cb480-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb480-53"><a href="rsa-on-pattern-similarity-change.html#cb480-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb480-54"><a href="rsa-on-pattern-similarity-change.html#cb480-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb480-55"><a href="rsa-on-pattern-similarity-change.html#cb480-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb480-56"><a href="rsa-on-pattern-similarity-change.html#cb480-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>))<span class="sc">+</span></span>
<span id="cb480-57"><a href="rsa-on-pattern-similarity-change.html#cb480-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb480-58"><a href="rsa-on-pattern-similarity-change.html#cb480-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb480-59"><a href="rsa-on-pattern-similarity-change.html#cb480-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">93.97</span>,<span class="sc">-</span><span class="fl">84.79</span>,<span class="sc">-</span><span class="fl">82.34</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb480-60"><a href="rsa-on-pattern-similarity-change.html#cb480-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb480-61"><a href="rsa-on-pattern-similarity-change.html#cb480-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb480-62"><a href="rsa-on-pattern-similarity-change.html#cb480-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb480-63"><a href="rsa-on-pattern-similarity-change.html#cb480-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb480-64"><a href="rsa-on-pattern-similarity-change.html#cb480-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sfigb_srchlght)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
</div>
<div id="virtual-time-and-sequence-interaction" class="section level4 unnumbered">
<h4>Virtual Time and Sequence Interaction</h4>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="rsa-on-pattern-similarity-change.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose coordinates (these are chosen manually now) and get a data frame for labeling the plots</span></span>
<span id="cb481-2"><a href="rsa-on-pattern-similarity-change.html#cb481-2" aria-hidden="true" tabindex="-1"></a>mni_coords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">17</span>,<span class="dv">20</span>)</span>
<span id="cb481-3"><a href="rsa-on-pattern-similarity-change.html#cb481-3" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))[<span class="dv">1</span>],</span>
<span id="cb481-4"><a href="rsa-on-pattern-similarity-change.html#cb481-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="dv">17</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))[<span class="dv">1</span>],</span>
<span id="cb481-5"><a href="rsa-on-pattern-similarity-change.html#cb481-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mni2vox</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">20</span>))[<span class="dv">3</span>])</span>
<span id="cb481-6"><a href="rsa-on-pattern-similarity-change.html#cb481-6" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>),mni_coords),</span>
<span id="cb481-7"><a href="rsa-on-pattern-similarity-change.html#cb481-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>),mni_coords))</span>
<span id="cb481-8"><a href="rsa-on-pattern-similarity-change.html#cb481-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-9"><a href="rsa-on-pattern-similarity-change.html#cb481-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb481-10"><a href="rsa-on-pattern-similarity-change.html#cb481-10" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb481-11"><a href="rsa-on-pattern-similarity-change.html#cb481-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb481-12"><a href="rsa-on-pattern-similarity-change.html#cb481-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb481-13"><a href="rsa-on-pattern-similarity-change.html#cb481-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>),mni_coords), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb481-14"><a href="rsa-on-pattern-similarity-change.html#cb481-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-15"><a href="rsa-on-pattern-similarity-change.html#cb481-15" aria-hidden="true" tabindex="-1"></a><span class="co"># get uncorrected p-values in FOV</span></span>
<span id="cb481-16"><a href="rsa-on-pattern-similarity-change.html#cb481-16" aria-hidden="true" tabindex="-1"></a>pfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb481-17"><a href="rsa-on-pattern-similarity-change.html#cb481-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb481-18"><a href="rsa-on-pattern-similarity-change.html#cb481-18" aria-hidden="true" tabindex="-1"></a>pfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(pfov_fn)</span>
<span id="cb481-19"><a href="rsa-on-pattern-similarity-change.html#cb481-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-20"><a href="rsa-on-pattern-similarity-change.html#cb481-20" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (FOV)</span></span>
<span id="cb481-21"><a href="rsa-on-pattern-similarity-change.html#cb481-21" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;day_time_interaction&quot;</span>,</span>
<span id="cb481-22"><a href="rsa-on-pattern-similarity-change.html#cb481-22" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;day_time_interaction_randomise_fov_fwhm3_tstat1.nii.gz&quot;</span>)</span>
<span id="cb481-23"><a href="rsa-on-pattern-similarity-change.html#cb481-23" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb481-24"><a href="rsa-on-pattern-similarity-change.html#cb481-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-25"><a href="rsa-on-pattern-similarity-change.html#cb481-25" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb481-26"><a href="rsa-on-pattern-similarity-change.html#cb481-26" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.01</span> </span>
<span id="cb481-27"><a href="rsa-on-pattern-similarity-change.html#cb481-27" aria-hidden="true" tabindex="-1"></a>t_nii[pfov_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb481-28"><a href="rsa-on-pattern-similarity-change.html#cb481-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-29"><a href="rsa-on-pattern-similarity-change.html#cb481-29" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb481-30"><a href="rsa-on-pattern-similarity-change.html#cb481-30" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>), </span>
<span id="cb481-31"><a href="rsa-on-pattern-similarity-change.html#cb481-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>),mni_coords), </span>
<span id="cb481-32"><a href="rsa-on-pattern-similarity-change.html#cb481-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb481-33"><a href="rsa-on-pattern-similarity-change.html#cb481-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-34"><a href="rsa-on-pattern-similarity-change.html#cb481-34" aria-hidden="true" tabindex="-1"></a>sfigc_srchlght <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb481-35"><a href="rsa-on-pattern-similarity-change.html#cb481-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb481-36"><a href="rsa-on-pattern-similarity-change.html#cb481-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">strip.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb481-37"><a href="rsa-on-pattern-similarity-change.html#cb481-37" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;buda&quot;</span>, </span>
<span id="cb481-38"><a href="rsa-on-pattern-similarity-change.html#cb481-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end=</span><span class="dv">1</span>,</span>
<span id="cb481-39"><a href="rsa-on-pattern-similarity-change.html#cb481-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb481-40"><a href="rsa-on-pattern-similarity-change.html#cb481-40" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb481-41"><a href="rsa-on-pattern-similarity-change.html#cb481-41" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb481-42"><a href="rsa-on-pattern-similarity-change.html#cb481-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">same vs.</span><span class="sc">\n</span><span class="st">different&quot;</span>) <span class="sc">+</span></span>
<span id="cb481-43"><a href="rsa-on-pattern-similarity-change.html#cb481-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb481-44"><a href="rsa-on-pattern-similarity-change.html#cb481-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb481-45"><a href="rsa-on-pattern-similarity-change.html#cb481-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb481-46"><a href="rsa-on-pattern-similarity-change.html#cb481-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb481-47"><a href="rsa-on-pattern-similarity-change.html#cb481-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb481-48"><a href="rsa-on-pattern-similarity-change.html#cb481-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb481-49"><a href="rsa-on-pattern-similarity-change.html#cb481-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb481-50"><a href="rsa-on-pattern-similarity-change.html#cb481-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb481-51"><a href="rsa-on-pattern-similarity-change.html#cb481-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb481-52"><a href="rsa-on-pattern-similarity-change.html#cb481-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb481-53"><a href="rsa-on-pattern-similarity-change.html#cb481-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb481-54"><a href="rsa-on-pattern-similarity-change.html#cb481-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb481-55"><a href="rsa-on-pattern-similarity-change.html#cb481-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb481-56"><a href="rsa-on-pattern-similarity-change.html#cb481-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>))<span class="sc">+</span></span>
<span id="cb481-57"><a href="rsa-on-pattern-similarity-change.html#cb481-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb481-58"><a href="rsa-on-pattern-similarity-change.html#cb481-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb481-59"><a href="rsa-on-pattern-similarity-change.html#cb481-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">94</span>,<span class="sc">-</span><span class="fl">86.85</span>,<span class="sc">-</span><span class="fl">88.66</span>), <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb481-60"><a href="rsa-on-pattern-similarity-change.html#cb481-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb481-61"><a href="rsa-on-pattern-similarity-change.html#cb481-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y coords found via command below (to keep text aligned across panels):</span></span>
<span id="cb481-62"><a href="rsa-on-pattern-similarity-change.html#cb481-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range[1]-diff(ggplot_build(f6g)$layout$panel_scales_y[[2]]$range$range)/100*3</span></span>
<span id="cb481-63"><a href="rsa-on-pattern-similarity-change.html#cb481-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb481-64"><a href="rsa-on-pattern-similarity-change.html#cb481-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sfigc_srchlght)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-232-1.png" width="672" /></p>
</div>
<div id="overview-figure" class="section level4 unnumbered">
<h4>Overview Figure</h4>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="rsa-on-pattern-similarity-change.html#cb482-1" aria-hidden="true" tabindex="-1"></a>layout<span class="ot">=</span><span class="st">&quot;</span></span>
<span id="cb482-2"><a href="rsa-on-pattern-similarity-change.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="st">ABC</span></span>
<span id="cb482-3"><a href="rsa-on-pattern-similarity-change.html#cb482-3" aria-hidden="true" tabindex="-1"></a><span class="st">ABC</span></span>
<span id="cb482-4"><a href="rsa-on-pattern-similarity-change.html#cb482-4" aria-hidden="true" tabindex="-1"></a><span class="st">ABC&quot;</span></span>
<span id="cb482-5"><a href="rsa-on-pattern-similarity-change.html#cb482-5" aria-hidden="true" tabindex="-1"></a>sfig_srchlght <span class="ot">&lt;-</span> sfiga_srchlght <span class="sc">+</span> sfigb_srchlght <span class="sc">+</span> sfigc_srchlght <span class="sc">+</span></span>
<span id="cb482-6"><a href="rsa-on-pattern-similarity-change.html#cb482-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb482-7"><a href="rsa-on-pattern-similarity-change.html#cb482-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="sc">-</span><span class="dv">9</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">19</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb482-8"><a href="rsa-on-pattern-similarity-change.html#cb482-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb482-9"><a href="rsa-on-pattern-similarity-change.html#cb482-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb482-10"><a href="rsa-on-pattern-similarity-change.html#cb482-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb482-11"><a href="rsa-on-pattern-similarity-change.html#cb482-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb482-12"><a href="rsa-on-pattern-similarity-change.html#cb482-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb482-13"><a href="rsa-on-pattern-similarity-change.html#cb482-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span>font2use, <span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;plain&quot;</span>))</span>
<span id="cb482-14"><a href="rsa-on-pattern-similarity-change.html#cb482-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-15"><a href="rsa-on-pattern-similarity-change.html#cb482-15" aria-hidden="true" tabindex="-1"></a>sfig_srchlght[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> sfig_srchlght[[<span class="dv">1</span>]] <span class="sc">+</span> </span>
<span id="cb482-16"><a href="rsa-on-pattern-similarity-change.html#cb482-16" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">l=</span><span class="dv">19</span>)))</span>
<span id="cb482-17"><a href="rsa-on-pattern-similarity-change.html#cb482-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-18"><a href="rsa-on-pattern-similarity-change.html#cb482-18" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print</span></span>
<span id="cb482-19"><a href="rsa-on-pattern-similarity-change.html#cb482-19" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf09&quot;</span>)</span>
<span id="cb482-20"><a href="rsa-on-pattern-similarity-change.html#cb482-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig_srchlght, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb482-21"><a href="rsa-on-pattern-similarity-change.html#cb482-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">8.5</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb482-22"><a href="rsa-on-pattern-similarity-change.html#cb482-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig_srchlght, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb482-23"><a href="rsa-on-pattern-similarity-change.html#cb482-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">8.5</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf09.png" alt="" />
<p class="caption">Supplemental Figure 9. Exploratory searchlight results. A. For same-sequence event pairs, clusters of voxels in which pattern similarity change correlated positively with temporal distances were detected in the frontal pole, frontal medial cortex and left entorhinal cortex (see Supplemental Table 12). B. Pattern similarity change correlated negatively with temporal distances between events from different sequences in the cerebellum and lingual gyrus (see Supplemental Table 14). C. The interaction effect, defined as correlations of temporal distances and pattern similarity change depending on whether pairs of events belonged to the same sequence or not, was observed in the occipital pole, lingual gyrus, frontal pole, temporal fusiform cortex and the intracalcerine sulcus (see Supplemental Table 15). A-C. Statistical images are thresholded at p&lt;0.01 uncorrected for display purposes. No clusters outside the hippocampal-entorhinal region survived corrections for multiple comparisons.</p>
</div>
</div>
</div>
</div>
<div id="correlation-of-behavioral-generalization-bias-with-searchlight-effects" class="section level2" number="8.12">
<h2><span class="header-section-number">8.12</span> Correlation of behavioral generalization bias with searchlight effects</h2>
<p>We want to see whether the structure generalization bias in behavior relates to the RSA effects For that, we extract the t-value of the searchlight effect at the peak voxel for each participant and run Spearman correlations.</p>
<blockquote>
<p>We then asked whether the deviation between the average time of other events and an event’s true virtual time was systematically related to signed errors in constructed event times. A positive relationship between the relative time of other events and time construction errors indicates that, when other events at the same sequence position are relatively late, participants are biased to construct a later time for a given event than when the other events took place relatively early. In the summary statistics approach, we ran a linear regression for each participant (Figure 8B, Supplemental Figure 10A) and tested the resulting coefficients for statistical significance using the permutation-based procedures described above (Figure 8C). The regression coefficients from this approach were used to test for a relationship between the behavioral generalization bias and the hippocampal searchlight effects (see below).</p>
</blockquote>
<div id="correlation-with-across-sequence-searchlight-effect" class="section level3 unnumbered">
<h3>Correlation with across-sequence searchlight effect</h3>
<p>We start with the across-sequence searchlight effect. Note that the t-values are more negative for those subjects who show a stronger effect, so we might expect a negative correlation: Participants with stronger across-sequence generalization in the hippocampus could more strongly be biased by the abstracted structure in their specific constructions.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="rsa-on-pattern-similarity-change.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the p-values from across-sequence searchlight (SVC corrected) </span></span>
<span id="cb483-2"><a href="rsa-on-pattern-similarity-change.html#cb483-2" aria-hidden="true" tabindex="-1"></a>p_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb483-3"><a href="rsa-on-pattern-similarity-change.html#cb483-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;diff_day_vir_time_neg_randomise_svc_fwhm3_tfce_corrp_tstat1.nii.gz&quot;</span>)</span>
<span id="cb483-4"><a href="rsa-on-pattern-similarity-change.html#cb483-4" aria-hidden="true" tabindex="-1"></a>p_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(p_fn)</span>
<span id="cb483-5"><a href="rsa-on-pattern-similarity-change.html#cb483-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-6"><a href="rsa-on-pattern-similarity-change.html#cb483-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load the 4D image with searchlight t-values for each participant</span></span>
<span id="cb483-7"><a href="rsa-on-pattern-similarity-change.html#cb483-7" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>,<span class="st">&quot;diff_day_vir_time&quot;</span>,</span>
<span id="cb483-8"><a href="rsa-on-pattern-similarity-change.html#cb483-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;diff_day_vir_time_4d_smooth_fwhm3.nii.gz&quot;</span>)</span>
<span id="cb483-9"><a href="rsa-on-pattern-similarity-change.html#cb483-9" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb483-10"><a href="rsa-on-pattern-similarity-change.html#cb483-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-11"><a href="rsa-on-pattern-similarity-change.html#cb483-11" aria-hidden="true" tabindex="-1"></a><span class="co"># find the coordinates of peak voxel</span></span>
<span id="cb483-12"><a href="rsa-on-pattern-similarity-change.html#cb483-12" aria-hidden="true" tabindex="-1"></a>coords<span class="ot">&lt;-</span><span class="fu">which</span>(p_nii <span class="sc">==</span><span class="fu">max</span>(p_nii)) </span>
<span id="cb483-13"><a href="rsa-on-pattern-similarity-change.html#cb483-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-14"><a href="rsa-on-pattern-similarity-change.html#cb483-14" aria-hidden="true" tabindex="-1"></a><span class="co"># store the searchlight t-value for each subject at this voxel</span></span>
<span id="cb483-15"><a href="rsa-on-pattern-similarity-change.html#cb483-15" aria-hidden="true" tabindex="-1"></a>fit_beh_bias <span class="ot">&lt;-</span> fit_beh_bias <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">srchlght_across_t=</span><span class="cn">NA</span>)</span>
<span id="cb483-16"><a href="rsa-on-pattern-similarity-change.html#cb483-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>){</span>
<span id="cb483-17"><a href="rsa-on-pattern-similarity-change.html#cb483-17" aria-hidden="true" tabindex="-1"></a>  curr_nii <span class="ot">&lt;-</span> t_nii[,,,i]</span>
<span id="cb483-18"><a href="rsa-on-pattern-similarity-change.html#cb483-18" aria-hidden="true" tabindex="-1"></a>  fit_beh_bias<span class="sc">$</span>srchlght_across_t[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(curr_nii[<span class="fu">cbind</span>(coords)])</span>
<span id="cb483-19"><a href="rsa-on-pattern-similarity-change.html#cb483-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb483-20"><a href="rsa-on-pattern-similarity-change.html#cb483-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-21"><a href="rsa-on-pattern-similarity-change.html#cb483-21" aria-hidden="true" tabindex="-1"></a><span class="co"># correlate the same-sequence searchlight effect with the behavioral bias</span></span>
<span id="cb483-22"><a href="rsa-on-pattern-similarity-change.html#cb483-22" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">cor.test</span>(fit_beh_bias<span class="sc">$</span>beta_rel_time_other_events, fit_beh_bias<span class="sc">$</span>srchlght_across_t, </span>
<span id="cb483-23"><a href="rsa-on-pattern-similarity-change.html#cb483-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb483-24"><a href="rsa-on-pattern-similarity-change.html#cb483-24" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb483-25"><a href="rsa-on-pattern-similarity-change.html#cb483-25" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>() </span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-234">
<col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">alternative</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.194</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.36e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.322</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Spearman's rank correlation rho</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">two.sided</td></tr>
</table>

<p>Spearman correlation of across-sequence searchlight effect in aHPC and behavioral generalization bias:
r=-0.19, p=0.322</p>
<p>The effect is not significant, but let’s still visualize it as a scatter plot.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="rsa-on-pattern-similarity-change.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot </span></span>
<span id="cb484-2"><a href="rsa-on-pattern-similarity-change.html#cb484-2" aria-hidden="true" tabindex="-1"></a>f8e <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit_beh_bias, <span class="fu">aes</span>(<span class="at">x=</span>srchlght_across_t, <span class="at">y=</span>beta_rel_time_other_events))<span class="sc">+</span></span>
<span id="cb484-3"><a href="rsa-on-pattern-similarity-change.html#cb484-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb484-4"><a href="rsa-on-pattern-similarity-change.html#cb484-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, </span>
<span id="cb484-5"><a href="rsa-on-pattern-similarity-change.html#cb484-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]),</span>
<span id="cb484-6"><a href="rsa-on-pattern-similarity-change.html#cb484-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]),</span>
<span id="cb484-7"><a href="rsa-on-pattern-similarity-change.html#cb484-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb484-8"><a href="rsa-on-pattern-similarity-change.html#cb484-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb484-9"><a href="rsa-on-pattern-similarity-change.html#cb484-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;diff. sequence</span><span class="sc">\n</span><span class="st">searchlight (t)&quot;</span>) <span class="sc">+</span></span>
<span id="cb484-10"><a href="rsa-on-pattern-similarity-change.html#cb484-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;behavioral bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb484-11"><a href="rsa-on-pattern-similarity-change.html#cb484-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>, <span class="at">hjust=</span><span class="dv">1</span>,<span class="at">vjust=</span><span class="dv">1</span>,</span>
<span id="cb484-12"><a href="rsa-on-pattern-similarity-change.html#cb484-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">family =</span> font2use,</span>
<span id="cb484-13"><a href="rsa-on-pattern-similarity-change.html#cb484-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">&quot;r=%.2f,</span><span class="sc">\n</span><span class="st">p=%.3f&quot;</span>,</span>
<span id="cb484-14"><a href="rsa-on-pattern-similarity-change.html#cb484-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(stats<span class="sc">$</span>estimate,<span class="dv">2</span>), <span class="fu">round</span>(stats<span class="sc">$</span>p.value, <span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb484-15"><a href="rsa-on-pattern-similarity-change.html#cb484-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb484-16"><a href="rsa-on-pattern-similarity-change.html#cb484-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb484-17"><a href="rsa-on-pattern-similarity-change.html#cb484-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb484-18"><a href="rsa-on-pattern-similarity-change.html#cb484-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb484-19"><a href="rsa-on-pattern-similarity-change.html#cb484-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb484-20"><a href="rsa-on-pattern-similarity-change.html#cb484-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb484-21"><a href="rsa-on-pattern-similarity-change.html#cb484-21" aria-hidden="true" tabindex="-1"></a>f8e</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="rsa-on-pattern-similarity-change.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb485-2"><a href="rsa-on-pattern-similarity-change.html#cb485-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f8e)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb485-3"><a href="rsa-on-pattern-similarity-change.html#cb485-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb485-4"><a href="rsa-on-pattern-similarity-change.html#cb485-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f8e.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="correlation-with-same-sequence-searchlight-effect" class="section level3 unnumbered">
<h3>Correlation with same-sequence searchlight effect</h3>
<p>Next, we look for a correlation with the same-sequence searchlight effect. Again, we might expect to see a negative correlation: Participants with a stronger representation of the within-sequence relationships might be less biased in their construction by the overall structure.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="rsa-on-pattern-similarity-change.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the p-values from same-sequence searchlight (SVC corrected) </span></span>
<span id="cb486-2"><a href="rsa-on-pattern-similarity-change.html#cb486-2" aria-hidden="true" tabindex="-1"></a>p_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>, <span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb486-3"><a href="rsa-on-pattern-similarity-change.html#cb486-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;same_day_vir_time_randomise_svc_fwhm3_tfce_corrp_tstat1.nii.gz&quot;</span>)</span>
<span id="cb486-4"><a href="rsa-on-pattern-similarity-change.html#cb486-4" aria-hidden="true" tabindex="-1"></a>p_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(p_fn)</span>
<span id="cb486-5"><a href="rsa-on-pattern-similarity-change.html#cb486-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-6"><a href="rsa-on-pattern-similarity-change.html#cb486-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load the 4D image with searchlight t-values for each participant</span></span>
<span id="cb486-7"><a href="rsa-on-pattern-similarity-change.html#cb486-7" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;searchlight_results&quot;</span>, <span class="st">&quot;same_day_vir_time&quot;</span>,</span>
<span id="cb486-8"><a href="rsa-on-pattern-similarity-change.html#cb486-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;same_day_vir_time_4d_smooth_fwhm3.nii.gz&quot;</span>)</span>
<span id="cb486-9"><a href="rsa-on-pattern-similarity-change.html#cb486-9" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb486-10"><a href="rsa-on-pattern-similarity-change.html#cb486-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-11"><a href="rsa-on-pattern-similarity-change.html#cb486-11" aria-hidden="true" tabindex="-1"></a><span class="co"># find the coordinates of peak voxel</span></span>
<span id="cb486-12"><a href="rsa-on-pattern-similarity-change.html#cb486-12" aria-hidden="true" tabindex="-1"></a>coords<span class="ot">&lt;-</span><span class="fu">which</span>(p_nii <span class="sc">==</span><span class="fu">max</span>(p_nii)) </span>
<span id="cb486-13"><a href="rsa-on-pattern-similarity-change.html#cb486-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-14"><a href="rsa-on-pattern-similarity-change.html#cb486-14" aria-hidden="true" tabindex="-1"></a><span class="co"># store the searchlight t-value for each subject at this voxel</span></span>
<span id="cb486-15"><a href="rsa-on-pattern-similarity-change.html#cb486-15" aria-hidden="true" tabindex="-1"></a>fit_beh_bias <span class="ot">&lt;-</span> fit_beh_bias <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">srchlght_t=</span><span class="cn">NA</span>)</span>
<span id="cb486-16"><a href="rsa-on-pattern-similarity-change.html#cb486-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>){</span>
<span id="cb486-17"><a href="rsa-on-pattern-similarity-change.html#cb486-17" aria-hidden="true" tabindex="-1"></a>  curr_nii <span class="ot">&lt;-</span> t_nii[,,,i]</span>
<span id="cb486-18"><a href="rsa-on-pattern-similarity-change.html#cb486-18" aria-hidden="true" tabindex="-1"></a>  fit_beh_bias<span class="sc">$</span>srchlght_t[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(curr_nii[<span class="fu">cbind</span>(coords)])</span>
<span id="cb486-19"><a href="rsa-on-pattern-similarity-change.html#cb486-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb486-20"><a href="rsa-on-pattern-similarity-change.html#cb486-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-21"><a href="rsa-on-pattern-similarity-change.html#cb486-21" aria-hidden="true" tabindex="-1"></a><span class="co"># correlate the same-sequence searchlight effect with the behavioral bias</span></span>
<span id="cb486-22"><a href="rsa-on-pattern-similarity-change.html#cb486-22" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">cor.test</span>(fit_beh_bias<span class="sc">$</span>beta_rel_time_other_events, fit_beh_bias<span class="sc">$</span>srchlght_t, </span>
<span id="cb486-23"><a href="rsa-on-pattern-similarity-change.html#cb486-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb486-24"><a href="rsa-on-pattern-similarity-change.html#cb486-24" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb486-25"><a href="rsa-on-pattern-similarity-change.html#cb486-25" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>() </span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-236">
<col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">alternative</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">-0.526</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.58e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00456</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Spearman's rank correlation rho</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">two.sided</td></tr>
</table>

<p>Spearman correlation of within-sequence searchlight effect in aHPC and behavioral generalization bias:
r=-0.53, p=0.005</p>
<p>Indeed, we observe a significant correlation. Let’s make a plot to visualize it.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="rsa-on-pattern-similarity-change.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot </span></span>
<span id="cb487-2"><a href="rsa-on-pattern-similarity-change.html#cb487-2" aria-hidden="true" tabindex="-1"></a>f8f <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit_beh_bias, <span class="fu">aes</span>(<span class="at">x=</span>srchlght_t, <span class="at">y=</span>beta_rel_time_other_events))<span class="sc">+</span></span>
<span id="cb487-3"><a href="rsa-on-pattern-similarity-change.html#cb487-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb487-4"><a href="rsa-on-pattern-similarity-change.html#cb487-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, </span>
<span id="cb487-5"><a href="rsa-on-pattern-similarity-change.html#cb487-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>]),</span>
<span id="cb487-6"><a href="rsa-on-pattern-similarity-change.html#cb487-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>]),</span>
<span id="cb487-7"><a href="rsa-on-pattern-similarity-change.html#cb487-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb487-8"><a href="rsa-on-pattern-similarity-change.html#cb487-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb487-9"><a href="rsa-on-pattern-similarity-change.html#cb487-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;same sequence</span><span class="sc">\n</span><span class="st">searchlight (t)&quot;</span>) <span class="sc">+</span></span>
<span id="cb487-10"><a href="rsa-on-pattern-similarity-change.html#cb487-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;behavioral bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb487-11"><a href="rsa-on-pattern-similarity-change.html#cb487-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>, <span class="at">hjust=</span><span class="dv">1</span>,<span class="at">vjust=</span><span class="dv">1</span>,</span>
<span id="cb487-12"><a href="rsa-on-pattern-similarity-change.html#cb487-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">family =</span> font2use,</span>
<span id="cb487-13"><a href="rsa-on-pattern-similarity-change.html#cb487-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">&quot;r=%.2f,</span><span class="sc">\n</span><span class="st">p=%.3f&quot;</span>,</span>
<span id="cb487-14"><a href="rsa-on-pattern-similarity-change.html#cb487-14" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(stats<span class="sc">$</span>estimate,<span class="dv">2</span>), <span class="fu">round</span>(stats<span class="sc">$</span>p.value, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb487-15"><a href="rsa-on-pattern-similarity-change.html#cb487-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb487-16"><a href="rsa-on-pattern-similarity-change.html#cb487-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb487-17"><a href="rsa-on-pattern-similarity-change.html#cb487-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb487-18"><a href="rsa-on-pattern-similarity-change.html#cb487-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb487-19"><a href="rsa-on-pattern-similarity-change.html#cb487-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb487-20"><a href="rsa-on-pattern-similarity-change.html#cb487-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb487-21"><a href="rsa-on-pattern-similarity-change.html#cb487-21" aria-hidden="true" tabindex="-1"></a>f8f</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="rsa-on-pattern-similarity-change.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb488-2"><a href="rsa-on-pattern-similarity-change.html#cb488-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f8f)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb488-3"><a href="rsa-on-pattern-similarity-change.html#cb488-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb488-4"><a href="rsa-on-pattern-similarity-change.html#cb488-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f8f.txt&quot;</span>))</span></code></pre></div>
<p>We are now ready to compose <strong>figure 8</strong>.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="rsa-on-pattern-similarity-change.html#cb489-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb489-2"><a href="rsa-on-pattern-similarity-change.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="st">ACDE</span></span>
<span id="cb489-3"><a href="rsa-on-pattern-similarity-change.html#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="st">BCDF&quot;</span></span>
<span id="cb489-4"><a href="rsa-on-pattern-similarity-change.html#cb489-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-5"><a href="rsa-on-pattern-similarity-change.html#cb489-5" aria-hidden="true" tabindex="-1"></a>f8 <span class="ot">&lt;-</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> f8b <span class="sc">+</span> f8c <span class="sc">+</span> f8d <span class="sc">+</span> f8e <span class="sc">+</span> f8f <span class="sc">+</span></span>
<span id="cb489-6"><a href="rsa-on-pattern-similarity-change.html#cb489-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb489-7"><a href="rsa-on-pattern-similarity-change.html#cb489-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb489-8"><a href="rsa-on-pattern-similarity-change.html#cb489-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb489-9"><a href="rsa-on-pattern-similarity-change.html#cb489-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb489-10"><a href="rsa-on-pattern-similarity-change.html#cb489-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb489-11"><a href="rsa-on-pattern-similarity-change.html#cb489-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb489-12"><a href="rsa-on-pattern-similarity-change.html#cb489-12" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">&amp;</span></span>
<span id="cb489-13"><a href="rsa-on-pattern-similarity-change.html#cb489-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb489-14"><a href="rsa-on-pattern-similarity-change.html#cb489-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;F&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;H&#39;</span>, <span class="st">&#39;I&#39;</span>, <span class="st">&#39;J&#39;</span>)))</span>
<span id="cb489-15"><a href="rsa-on-pattern-similarity-change.html#cb489-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-16"><a href="rsa-on-pattern-similarity-change.html#cb489-16" aria-hidden="true" tabindex="-1"></a><span class="co"># save as png and pdf and print to screen</span></span>
<span id="cb489-17"><a href="rsa-on-pattern-similarity-change.html#cb489-17" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;f8&quot;</span>)</span>
<span id="cb489-18"><a href="rsa-on-pattern-similarity-change.html#cb489-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>f8, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb489-19"><a href="rsa-on-pattern-similarity-change.html#cb489-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb489-20"><a href="rsa-on-pattern-similarity-change.html#cb489-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>f8, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb489-21"><a href="rsa-on-pattern-similarity-change.html#cb489-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/f8.png" alt="" />
<p class="caption">Figure 8. Structural knowledge biases construction of event times. A. The generalization bias quantifies the influence of structural knowledge on the construction of individual event times. For each event, the mean time of events at the same sequence position in the other sequences was calculated to test whether event times were biased towards the relative time of other events. B. The scatterplot illustrates the generalization bias for an example participant. Each circle corresponds to one event and the regression line highlights the relationship between the relative time of other events and the errors in constructed event times. The example participant was chosen to have a median-strength generalization bias. See Supplemental Figure 10 for the entire sample. Correlation coefficient is based on Pearson correlation. C. The relative time of events from other sequences predicted signed event time construction errors as measured in the timeline task. Positive values indicate that when other events took place late relative to a specific event, the time of that event was estimated to be later than when other events were relatively early. Circles show individual participant Z-values from participant-specific linear models (B); boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points. D. The generalization bias in event time construction through structural knowledge was replicated in an independent sample (n=46) based on Montijn et al.66. Data shown as in B. E. The behavioral generalization bias (regression coefficients from summary statistics approach) did not correlate significantly with the across-sequence generalization effect in the anterior hippocampus (searchlight peak voxel t-values). F. We observed a significant negative correlation between the same-sequence searchlight effect (peak voxel t-values) and the behavioral generalization bias (regression coefficients from summary statistics approach), suggesting that participants with strong hippocampal representations of the temporal relations between events from the same sequence were less biased by structural knowledge in their construction of event times. Statistics in E and F are based on Spearman correlation.</p>
</div>
</div>
</div>
<div id="mixed-model-summaries" class="section level2" number="8.13">
<h2><span class="header-section-number">8.13</span> Mixed Model Summaries</h2>
<div id="supplemental-figure-1" class="section level3 unnumbered">
<h3>Supplemental Figure</h3>
<p>Make supplemental mixed model figure.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="rsa-on-pattern-similarity-change.html#cb490-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb490-2"><a href="rsa-on-pattern-similarity-change.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="st">ABCDEF</span></span>
<span id="cb490-3"><a href="rsa-on-pattern-similarity-change.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="st">GHIJKL</span></span>
<span id="cb490-4"><a href="rsa-on-pattern-similarity-change.html#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="st">MNOPQR&quot;</span></span>
<span id="cb490-5"><a href="rsa-on-pattern-similarity-change.html#cb490-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-6"><a href="rsa-on-pattern-similarity-change.html#cb490-6" aria-hidden="true" tabindex="-1"></a>sfigmm_a <span class="ot">&lt;-</span> sfigmm_a <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;remembered times: all time metrics&quot;</span>)</span>
<span id="cb490-7"><a href="rsa-on-pattern-similarity-change.html#cb490-7" aria-hidden="true" tabindex="-1"></a>sfigmm_c <span class="ot">&lt;-</span> sfigmm_c <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;aHPC same seq.: virtual time&quot;</span>)</span>
<span id="cb490-8"><a href="rsa-on-pattern-similarity-change.html#cb490-8" aria-hidden="true" tabindex="-1"></a>sfigmm_e <span class="ot">&lt;-</span> sfigmm_e <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;aHPC same seq.: all time metrics&quot;</span>)</span>
<span id="cb490-9"><a href="rsa-on-pattern-similarity-change.html#cb490-9" aria-hidden="true" tabindex="-1"></a>sfigmm_g <span class="ot">&lt;-</span> sfigmm_g <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;aHPC different seq.: virtual time&quot;</span>)</span>
<span id="cb490-10"><a href="rsa-on-pattern-similarity-change.html#cb490-10" aria-hidden="true" tabindex="-1"></a>sfigmm_i <span class="ot">&lt;-</span> sfigmm_i <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;aHPC: interaction virtual time &amp; seq.&quot;</span>)</span>
<span id="cb490-11"><a href="rsa-on-pattern-similarity-change.html#cb490-11" aria-hidden="true" tabindex="-1"></a>sfigmm_k <span class="ot">&lt;-</span> sfigmm_k <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;alEC all events: virtual time&quot;</span>)</span>
<span id="cb490-12"><a href="rsa-on-pattern-similarity-change.html#cb490-12" aria-hidden="true" tabindex="-1"></a>sfigmm_m <span class="ot">&lt;-</span> sfigmm_m <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;searchlight peak different seq.: virtual time&quot;</span>)</span>
<span id="cb490-13"><a href="rsa-on-pattern-similarity-change.html#cb490-13" aria-hidden="true" tabindex="-1"></a>sfigmm_o <span class="ot">&lt;-</span> sfigmm_o <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;generalization bias (fMRI sample)&quot;</span>)</span>
<span id="cb490-14"><a href="rsa-on-pattern-similarity-change.html#cb490-14" aria-hidden="true" tabindex="-1"></a>sfigmm_q <span class="ot">&lt;-</span> sfigmm_q <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;generalization bias (replication sample)&quot;</span>)</span>
<span id="cb490-15"><a href="rsa-on-pattern-similarity-change.html#cb490-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-16"><a href="rsa-on-pattern-similarity-change.html#cb490-16" aria-hidden="true" tabindex="-1"></a>sfigmm <span class="ot">&lt;-</span> sfigmm_a <span class="sc">+</span></span>
<span id="cb490-17"><a href="rsa-on-pattern-similarity-change.html#cb490-17" aria-hidden="true" tabindex="-1"></a>  sfigmm_b <span class="sc">+</span> </span>
<span id="cb490-18"><a href="rsa-on-pattern-similarity-change.html#cb490-18" aria-hidden="true" tabindex="-1"></a>  sfigmm_c <span class="sc">+</span></span>
<span id="cb490-19"><a href="rsa-on-pattern-similarity-change.html#cb490-19" aria-hidden="true" tabindex="-1"></a>  sfigmm_d <span class="sc">+</span></span>
<span id="cb490-20"><a href="rsa-on-pattern-similarity-change.html#cb490-20" aria-hidden="true" tabindex="-1"></a>  sfigmm_e <span class="sc">+</span></span>
<span id="cb490-21"><a href="rsa-on-pattern-similarity-change.html#cb490-21" aria-hidden="true" tabindex="-1"></a>  sfigmm_f <span class="sc">+</span></span>
<span id="cb490-22"><a href="rsa-on-pattern-similarity-change.html#cb490-22" aria-hidden="true" tabindex="-1"></a>  sfigmm_g <span class="sc">+</span></span>
<span id="cb490-23"><a href="rsa-on-pattern-similarity-change.html#cb490-23" aria-hidden="true" tabindex="-1"></a>  sfigmm_h <span class="sc">+</span></span>
<span id="cb490-24"><a href="rsa-on-pattern-similarity-change.html#cb490-24" aria-hidden="true" tabindex="-1"></a>  sfigmm_i <span class="sc">+</span></span>
<span id="cb490-25"><a href="rsa-on-pattern-similarity-change.html#cb490-25" aria-hidden="true" tabindex="-1"></a>  sfigmm_j <span class="sc">+</span></span>
<span id="cb490-26"><a href="rsa-on-pattern-similarity-change.html#cb490-26" aria-hidden="true" tabindex="-1"></a>  sfigmm_k <span class="sc">+</span></span>
<span id="cb490-27"><a href="rsa-on-pattern-similarity-change.html#cb490-27" aria-hidden="true" tabindex="-1"></a>  sfigmm_l <span class="sc">+</span></span>
<span id="cb490-28"><a href="rsa-on-pattern-similarity-change.html#cb490-28" aria-hidden="true" tabindex="-1"></a>  sfigmm_m <span class="sc">+</span></span>
<span id="cb490-29"><a href="rsa-on-pattern-similarity-change.html#cb490-29" aria-hidden="true" tabindex="-1"></a>  sfigmm_n <span class="sc">+</span></span>
<span id="cb490-30"><a href="rsa-on-pattern-similarity-change.html#cb490-30" aria-hidden="true" tabindex="-1"></a>  sfigmm_o <span class="sc">+</span></span>
<span id="cb490-31"><a href="rsa-on-pattern-similarity-change.html#cb490-31" aria-hidden="true" tabindex="-1"></a>  sfigmm_p <span class="sc">+</span></span>
<span id="cb490-32"><a href="rsa-on-pattern-similarity-change.html#cb490-32" aria-hidden="true" tabindex="-1"></a>  sfigmm_q <span class="sc">+</span></span>
<span id="cb490-33"><a href="rsa-on-pattern-similarity-change.html#cb490-33" aria-hidden="true" tabindex="-1"></a>  sfigmm_r <span class="sc">+</span></span>
<span id="cb490-34"><a href="rsa-on-pattern-similarity-change.html#cb490-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb490-35"><a href="rsa-on-pattern-similarity-change.html#cb490-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb490-36"><a href="rsa-on-pattern-similarity-change.html#cb490-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb490-37"><a href="rsa-on-pattern-similarity-change.html#cb490-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb490-38"><a href="rsa-on-pattern-similarity-change.html#cb490-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb490-39"><a href="rsa-on-pattern-similarity-change.html#cb490-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb490-40"><a href="rsa-on-pattern-similarity-change.html#cb490-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb490-41"><a href="rsa-on-pattern-similarity-change.html#cb490-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="dv">0</span>,</span>
<span id="cb490-42"><a href="rsa-on-pattern-similarity-change.html#cb490-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb490-43"><a href="rsa-on-pattern-similarity-change.html#cb490-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="fl">0.1</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">unit=</span><span class="st">&#39;cm&#39;</span>),</span>
<span id="cb490-44"><a href="rsa-on-pattern-similarity-change.html#cb490-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>, <span class="at">family=</span>font2use, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="fl">0.2</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="dv">0</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb490-45"><a href="rsa-on-pattern-similarity-change.html#cb490-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb490-46"><a href="rsa-on-pattern-similarity-change.html#cb490-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb490-47"><a href="rsa-on-pattern-similarity-change.html#cb490-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>)</span>
<span id="cb490-48"><a href="rsa-on-pattern-similarity-change.html#cb490-48" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">&amp;</span></span>
<span id="cb490-49"><a href="rsa-on-pattern-similarity-change.html#cb490-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;A&quot;</span>)</span>
<span id="cb490-50"><a href="rsa-on-pattern-similarity-change.html#cb490-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb490-51"><a href="rsa-on-pattern-similarity-change.html#cb490-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb490-52"><a href="rsa-on-pattern-similarity-change.html#cb490-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-53"><a href="rsa-on-pattern-similarity-change.html#cb490-53" aria-hidden="true" tabindex="-1"></a><span class="co"># save as png and pdf and print to screen</span></span>
<span id="cb490-54"><a href="rsa-on-pattern-similarity-change.html#cb490-54" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf04&quot;</span>)</span>
<span id="cb490-55"><a href="rsa-on-pattern-similarity-change.html#cb490-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfigmm, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb490-56"><a href="rsa-on-pattern-similarity-change.html#cb490-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">18</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb490-57"><a href="rsa-on-pattern-similarity-change.html#cb490-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfigmm, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb490-58"><a href="rsa-on-pattern-similarity-change.html#cb490-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">18</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf04.png" alt="" />
<p class="caption">Supplemental Figure 4. Mixed model results. Dot plots show parameter estimates and 95% CIs for fixed effects of mixed model analyses. Line plots show estimated marginal means. A, B. Remembered times in the time line task are predicted by virtual event times with order and real time in the model (c.f. Figure 2B). C, D. Temporal distances in virtual time explain representational change in the anterior hippocampus (aHPC) for same-sequence events (c.f. Figure 4B). E, F. Temporal distances in virtual time explain representational change in the aHPC for same-sequence events when competing for variance with temporal distances based on order and real time (c.f. Figure 4D). G, H. Temporal distances in virtual time explain representational change in the aHPC for different-sequence events (c.f. Figure 5A). I, J. There was a significant interaction of virtual temporal distances and sequence membership characterized by a differential relationship between temporal distances and aHPC representational change for event pairs from the same sequence or from different sequences (c.f. Figure 5A). K, L. Virtual temporal distances explain representational change in the anterior-lateral entorhinal cortex (alEC) when collapsing across all event pairs (c.f. Figure 6B). M, N. In the aHPC peak cluster of the same-sequence searchlight analysis, virtual temporal distances were siginificantly related to representational change for events from different sequences (c.f. Figure 7B). O-R. The relative time of events from other sequences predicted signed event time construction errors as measured in the timeline task (c.f. Figure 8CD) in the main fMRI sample (O, P) and in the independent replication sample (Q, R).</p>
</div>
</div>
<div id="supplemental-tables" class="section level3 unnumbered">
<h3>Supplemental Tables</h3>
<p>Write and save the word document with the supplemental tables.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="rsa-on-pattern-similarity-change.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a list of the supplemental tables we want to write to file</span></span>
<span id="cb491-2"><a href="rsa-on-pattern-similarity-change.html#cb491-2" aria-hidden="true" tabindex="-1"></a>stables <span class="ot">&lt;-</span> <span class="fu">list</span>(stable_lme_memtime_time_metrics, <span class="co">#1</span></span>
<span id="cb491-3"><a href="rsa-on-pattern-similarity-change.html#cb491-3" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_same_seq, <span class="co">#2</span></span>
<span id="cb491-4"><a href="rsa-on-pattern-similarity-change.html#cb491-4" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_same_seq_first_last, <span class="co">#3</span></span>
<span id="cb491-5"><a href="rsa-on-pattern-similarity-change.html#cb491-5" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_same_seq_time_metrics, <span class="co">#4</span></span>
<span id="cb491-6"><a href="rsa-on-pattern-similarity-change.html#cb491-6" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_diff_seq, <span class="co">#5</span></span>
<span id="cb491-7"><a href="rsa-on-pattern-similarity-change.html#cb491-7" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_diff_seq_time_metrics, <span class="co">#6</span></span>
<span id="cb491-8"><a href="rsa-on-pattern-similarity-change.html#cb491-8" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_same_vs_diff_seq, <span class="co">#7</span></span>
<span id="cb491-9"><a href="rsa-on-pattern-similarity-change.html#cb491-9" aria-hidden="true" tabindex="-1"></a>                stable_lme_aHPC_virtime_same_vs_diff_seq_all_interactions, <span class="co">#8</span></span>
<span id="cb491-10"><a href="rsa-on-pattern-similarity-change.html#cb491-10" aria-hidden="true" tabindex="-1"></a>                stable_lme_alEC_virtime_all_events, <span class="co">#9</span></span>
<span id="cb491-11"><a href="rsa-on-pattern-similarity-change.html#cb491-11" aria-hidden="true" tabindex="-1"></a>                stable_lme_alEC_virtime_all_comps_time_metrics, <span class="co">#10</span></span>
<span id="cb491-12"><a href="rsa-on-pattern-similarity-change.html#cb491-12" aria-hidden="true" tabindex="-1"></a>                stable_lme_virtime_aHPC_vs_alEC, <span class="co">#11</span></span>
<span id="cb491-13"><a href="rsa-on-pattern-similarity-change.html#cb491-13" aria-hidden="true" tabindex="-1"></a>                stable_srchlght_same_seq, <span class="co">#12</span></span>
<span id="cb491-14"><a href="rsa-on-pattern-similarity-change.html#cb491-14" aria-hidden="true" tabindex="-1"></a>                stable_lme_same_seq_cluster_virtime_diff_seq, <span class="co">#13</span></span>
<span id="cb491-15"><a href="rsa-on-pattern-similarity-change.html#cb491-15" aria-hidden="true" tabindex="-1"></a>                stable_srchlght_diff_seq, <span class="co">#14</span></span>
<span id="cb491-16"><a href="rsa-on-pattern-similarity-change.html#cb491-16" aria-hidden="true" tabindex="-1"></a>                stable_srchlght_interaction, <span class="co">#15</span></span>
<span id="cb491-17"><a href="rsa-on-pattern-similarity-change.html#cb491-17" aria-hidden="true" tabindex="-1"></a>                stable_lme_beh_gen_bias, <span class="co"># 16</span></span>
<span id="cb491-18"><a href="rsa-on-pattern-similarity-change.html#cb491-18" aria-hidden="true" tabindex="-1"></a>                stable_lme_beh_gen_bias_replication) <span class="co">#17</span></span>
<span id="cb491-19"><a href="rsa-on-pattern-similarity-change.html#cb491-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-20"><a href="rsa-on-pattern-similarity-change.html#cb491-20" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over tables and write to file</span></span>
<span id="cb491-21"><a href="rsa-on-pattern-similarity-change.html#cb491-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(stables)){</span>
<span id="cb491-22"><a href="rsa-on-pattern-similarity-change.html#cb491-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb491-23"><a href="rsa-on-pattern-similarity-change.html#cb491-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run auto-numbering to find table number and define table heading</span></span>
<span id="cb491-24"><a href="rsa-on-pattern-similarity-change.html#cb491-24" aria-hidden="true" tabindex="-1"></a>  f_par <span class="ot">&lt;-</span> officer<span class="sc">::</span><span class="fu">fpar</span>(officer<span class="sc">::</span><span class="fu">run_autonum</span>(<span class="at">seq_id =</span> <span class="st">&quot;tab&quot;</span>, </span>
<span id="cb491-25"><a href="rsa-on-pattern-similarity-change.html#cb491-25" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">pre_label =</span> <span class="st">&quot;Supplemental Table &quot;</span>, </span>
<span id="cb491-26"><a href="rsa-on-pattern-similarity-change.html#cb491-26" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">post_label =</span> <span class="st">&quot;&quot;</span>))  </span>
<span id="cb491-27"><a href="rsa-on-pattern-similarity-change.html#cb491-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb491-28"><a href="rsa-on-pattern-similarity-change.html#cb491-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add table heading and table to the document</span></span>
<span id="cb491-29"><a href="rsa-on-pattern-similarity-change.html#cb491-29" aria-hidden="true" tabindex="-1"></a>  stables_docx <span class="ot">&lt;-</span> stables_docx <span class="sc">%&gt;%</span> </span>
<span id="cb491-30"><a href="rsa-on-pattern-similarity-change.html#cb491-30" aria-hidden="true" tabindex="-1"></a>    officer<span class="sc">::</span><span class="fu">body_add_fpar</span>(f_par, <span class="at">style =</span> <span class="st">&quot;heading 2&quot;</span>, <span class="at">pos =</span> <span class="st">&quot;after&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># table heading</span></span>
<span id="cb491-31"><a href="rsa-on-pattern-similarity-change.html#cb491-31" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">body_add_flextable</span>(stables[[i]], <span class="at">align =</span> <span class="st">&quot;left&quot;</span>) <span class="co"># table</span></span>
<span id="cb491-32"><a href="rsa-on-pattern-similarity-change.html#cb491-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb491-33"><a href="rsa-on-pattern-similarity-change.html#cb491-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># page break if not the last table</span></span>
<span id="cb491-34"><a href="rsa-on-pattern-similarity-change.html#cb491-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i<span class="sc">&lt;</span><span class="fu">length</span>(stables)){</span>
<span id="cb491-35"><a href="rsa-on-pattern-similarity-change.html#cb491-35" aria-hidden="true" tabindex="-1"></a>    stables_docx <span class="ot">&lt;-</span> stables_docx <span class="sc">%&gt;%</span></span>
<span id="cb491-36"><a href="rsa-on-pattern-similarity-change.html#cb491-36" aria-hidden="true" tabindex="-1"></a>      officer<span class="sc">::</span><span class="fu">body_add_break</span>(<span class="at">pos =</span> <span class="st">&quot;after&quot;</span>) <span class="co"># page break</span></span>
<span id="cb491-37"><a href="rsa-on-pattern-similarity-change.html#cb491-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb491-38"><a href="rsa-on-pattern-similarity-change.html#cb491-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb491-39"><a href="rsa-on-pattern-similarity-change.html#cb491-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-40"><a href="rsa-on-pattern-similarity-change.html#cb491-40" aria-hidden="true" tabindex="-1"></a><span class="co"># save the document</span></span>
<span id="cb491-41"><a href="rsa-on-pattern-similarity-change.html#cb491-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stables_docx, <span class="at">target =</span> <span class="fu">here</span>(<span class="st">&quot;virtem_code&quot;</span>, <span class="st">&quot;docs&quot;</span>, <span class="st">&quot;supplemental_tables.docx&quot;</span>))</span></code></pre></div>
</div>
<div id="source-data" class="section level3" number="8.13.1">
<h3><span class="header-section-number">8.13.1</span> Source data</h3>
<p>Let’s also put all the source data into a zipped folder.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="rsa-on-pattern-similarity-change.html#cb492-1" aria-hidden="true" tabindex="-1"></a>zip<span class="sc">::</span><span class="fu">zip</span>(<span class="at">zipfile =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;SourceData.zip&quot;</span>),</span>
<span id="cb492-2"><a href="rsa-on-pattern-similarity-change.html#cb492-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">files =</span> <span class="fu">dir</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="at">full.names =</span> <span class="cn">TRUE</span>),</span>
<span id="cb492-3"><a href="rsa-on-pattern-similarity-change.html#cb492-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mode =</span> <span class="st">&quot;cherry-pick&quot;</span>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="run-rsa-searchlight.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="signal-to-noise-ratio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
