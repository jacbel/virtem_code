<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Univariate GLM: Relative time | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</title>
  <meta name="description" content="11 Univariate GLM: Relative time | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Univariate GLM: Relative time | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jacbel.github.io/virtem_code/" />
  
  <meta property="og:description" content="11 Univariate GLM: Relative time | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="github-repo" content="jacbel/virtem_code" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Univariate GLM: Relative time | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  
  <meta name="twitter:description" content="11 Univariate GLM: Relative time | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  

<meta name="author" content="Jacob L. S. Bellmund" />


<meta name="date" content="2022-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rsa-in-searchlight-peak-with-different-threshold.html"/>
<link rel="next" href="credit.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contents"><i class="fa fa-check"></i><b>1.2</b> Contents</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.3</b> Contact</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#license-information"><i class="fa fa-check"></i><b>1.4</b> License Information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analysis-setup.html"><a href="analysis-setup.html"><i class="fa fa-check"></i><b>2</b> Analysis Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analysis-setup.html"><a href="analysis-setup.html#defining-variables-and-folders"><i class="fa fa-check"></i><b>2.1</b> Defining Variables and Folders</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#folder-structure"><i class="fa fa-check"></i>Folder Structure</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="analysis-setup.html"><a href="analysis-setup.html#define-analysis-functions"><i class="fa fa-check"></i><b>2.2</b> Define Analysis Functions</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#analysis-logic"><i class="fa fa-check"></i>Analysis Logic</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#brain-plots-in-ggplot"><i class="fa fa-check"></i>Brain Plots in ggplot</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#ggbrain-functions-to-get-template-background"><i class="fa fa-check"></i>ggBrain functions to get template background</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#waiting-for-cluster-jobs"><i class="fa fa-check"></i>Waiting for Cluster Jobs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html"><i class="fa fa-check"></i><b>3</b> Illustrations of Task Design and Analysis Logic</a>
<ul>
<li class="chapter" data-level="3.1" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#day-learning-task-design"><i class="fa fa-check"></i><b>3.1</b> Day Learning Task Design</a>
<ul>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-and-real-time"><i class="fa fa-check"></i>Events in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-time"><i class="fa fa-check"></i>Events in virtual time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-real-time"><i class="fa fa-check"></i>Events in real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#correlations-of-virtual-time-with-order-and-real-time"><i class="fa fa-check"></i>Correlations of virtual time with order and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#time-cues-in-virtual-and-real-time"><i class="fa fa-check"></i>Time cues in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#supplemental-figure-for-task-design"><i class="fa fa-check"></i>Supplemental figure for task design</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#representational-similarity-analysis-logic"><i class="fa fa-check"></i><b>3.2</b> Representational Similarity Analysis Logic</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html"><i class="fa fa-check"></i><b>4</b> Prepare behavioral data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#sorting-task"><i class="fa fa-check"></i><b>4.1</b> Sorting task</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#timeline-task"><i class="fa fa-check"></i><b>4.2</b> Timeline task</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#picture-viewing-tasks"><i class="fa fa-check"></i><b>4.3</b> Picture viewing tasks</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html"><i class="fa fa-check"></i><b>5</b> Behavioral Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-task-1"><i class="fa fa-check"></i><b>5.1</b> Sorting Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#calculate-percentage-of-correct-responses"><i class="fa fa-check"></i>Calculate percentage of correct responses</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#plot-sorting-performance"><i class="fa fa-check"></i>Plot sorting performance</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Sorting errors as a function of sequence position</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#timeline-task-1"><i class="fa fa-check"></i><b>5.2</b> Timeline Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#visualize-the-raw-data"><i class="fa fa-check"></i>Visualize the raw data</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#accuracy-of-remembered-times"><i class="fa fa-check"></i>Accuracy of remembered times</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#relationship-of-sorting-errors-and-timeline-errors"><i class="fa fa-check"></i>Relationship of sorting errors and timeline errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#time-metrics-underlying-remembered-times"><i class="fa fa-check"></i>Time metrics underlying remembered times</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#compose-figure-for-behavioral-data"><i class="fa fa-check"></i>Compose Figure for Behavioral Data</a></li>
<li class="chapter" data-level="5.3" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#generalization-bias"><i class="fa fa-check"></i><b>5.3</b> Generalization bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#test-generalization-bias"><i class="fa fa-check"></i>Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-of-generalization-bias"><i class="fa fa-check"></i><b>5.4</b> Replication of Generalization Bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Replication data: Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-test-generalization-bias"><i class="fa fa-check"></i>Replication data: Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors"><i class="fa fa-check"></i><b>5.5</b> Swap Errors</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#descriptives-of-swap-errors"><i class="fa fa-check"></i>Descriptives of swap errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Swap errors as a function of sequence position</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-error-more-frequent-than-expected-from-chance"><i class="fa fa-check"></i>Swap error: More frequent than expected from chance?</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-and-generalization-bias"><i class="fa fa-check"></i>Swap errors and generalization bias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html"><i class="fa fa-check"></i><b>6</b> Prepare (f)MRI Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#regions-of-interest"><i class="fa fa-check"></i><b>6.1</b> Regions of Interest</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#freesurfer-masks"><i class="fa fa-check"></i>FreeSurfer Masks</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#subregion-masks-mni"><i class="fa fa-check"></i>Subregion masks (MNI)</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#final-rois-from-intersection-of-masks"><i class="fa fa-check"></i>Final ROIs from intersection of masks</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#group-level-masks"><i class="fa fa-check"></i><b>6.2</b> Group-Level Masks</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#probabilistic-rois-for-visualization"><i class="fa fa-check"></i>Probabilistic ROIs for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#field-of-view-mask-for-visualization"><i class="fa fa-check"></i>Field of view mask for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#gray-matter-mask"><i class="fa fa-check"></i>Gray matter mask</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#small-volume-correction-mask"><i class="fa fa-check"></i>Small Volume Correction Mask</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#quantify-representational-change"><i class="fa fa-check"></i><b>6.3</b> Quantify Representational Change</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#get-multi-voxel-patterns-from-rois"><i class="fa fa-check"></i>Get multi-voxel patterns from ROIs</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-correlation-matrices"><i class="fa fa-check"></i>Calculate correlation matrices</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-pattern-similarity-change"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#combine-behavioral-and-fmri-data-for-rsa"><i class="fa fa-check"></i><b>6.4</b> Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html"><i class="fa fa-check"></i><b>7</b> Run RSA Searchlight</a>
<ul>
<li class="chapter" data-level="7.1" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-functional-data"><i class="fa fa-check"></i><b>7.1</b> Prepare functional data</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#data-cleaning-extract-residuals-from-motion-parameter-regression"><i class="fa fa-check"></i>Data cleaning: Extract residuals from motion parameter regression</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#extract-relevant-volumes-1"><i class="fa fa-check"></i>Extract relevant volumes</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#concatenate-relevant-volumes"><i class="fa fa-check"></i>Concatenate relevant volumes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#first-level-rsa-searchlight"><i class="fa fa-check"></i><b>7.2</b> First-level RSA searchlight</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#set-analysis-parameters"><i class="fa fa-check"></i>Set analysis parameters</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-predictions"><i class="fa fa-check"></i>Prepare RSA-predictions</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-lookup-table-for-searchlight"><i class="fa fa-check"></i>Create lookup table for searchlight</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#dataframe-with-input-for-analysis"><i class="fa fa-check"></i>Dataframe with input for analysis</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#searchlight-implementation"><i class="fa fa-check"></i>Searchlight implementation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#group-level-searchlight-analysis"><i class="fa fa-check"></i><b>7.3</b> Group-level searchlight analysis</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#move-first-level-images-to-mni-space"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#merge-and-smooth-first-level-images"><i class="fa fa-check"></i>Merge and smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#run-fsl-randomise"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#find-searchlight-clusters-and-atlas-labels"><i class="fa fa-check"></i>Find searchlight clusters and atlas labels</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-outlines-of-significant-clusters"><i class="fa fa-check"></i>Create outlines of significant clusters</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-in-searchlight-peak"><i class="fa fa-check"></i><b>7.4</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-the-roi-mask"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculating-the-correlation-matrices"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculate-pattern-similarity-change-1"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#combine-behavioral-and-fmri-data-for-rsa-1"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html"><i class="fa fa-check"></i><b>8</b> RSA on Pattern Similarity Change</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#time-metrics-to-quantify-event-relations"><i class="fa fa-check"></i><b>8.1</b> Time metrics to quantify event relations</a></li>
<li class="chapter" data-level="8.2" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualize-regions-of-interests"><i class="fa fa-check"></i><b>8.2</b> Visualize Regions of Interests</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#template-background-image-with-fov"><i class="fa fa-check"></i>Template background image with FOV</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-hippocampus-roi"><i class="fa fa-check"></i>Anterior hippocampus ROI</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-lateral-entorhinal-cortex"><i class="fa fa-check"></i>Anterior-lateral entorhinal cortex</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#first-level-rsa"><i class="fa fa-check"></i><b>8.3</b> First-level RSA</a></li>
<li class="chapter" data-level="8.4" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence"><i class="fa fa-check"></i><b>8.4</b> aHPC: virtual time within sequence</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-3"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-2"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#not-driven-by-first-last-event-pairs"><i class="fa fa-check"></i>Not driven by first &amp; last event pairs</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.5</b> aHPC: virtual time within sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#one-model-with-multiple-predictors"><i class="fa fa-check"></i>One model with multiple predictors</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-explains-residuals-of-order-and-real-time"><i class="fa fa-check"></i>Virtual time explains residuals of order and real time</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequences"><i class="fa fa-check"></i><b>8.6</b> aHPC: virtual time across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-7"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-5"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization-1"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.7</b> aHPC: virtual time across sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-8"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-6"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i><b>8.8</b> aHPC: virtual time within vs. across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#second-level-analysis"><i class="fa fa-check"></i>Second-level analysis</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-7"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-order"><i class="fa fa-check"></i>Interaction of sequence membership and order</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-real-time"><i class="fa fa-check"></i>Interaction of sequence membership and real time</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-virtual-time-when-including-interactions-with-other-time-metrics"><i class="fa fa-check"></i>Interaction of sequence membership and virtual time when including interactions with other time metrics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mds"><i class="fa fa-check"></i>MDS</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#umap"><i class="fa fa-check"></i>UMAP</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec"><i class="fa fa-check"></i><b>8.9</b> alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-withinacross-sequences-separately"><i class="fa fa-check"></i>alEC: virtual time within/across sequences separately</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i>alEC: virtual time within vs. across sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs"><i class="fa fa-check"></i>alEC: virtual time for all event pairs</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs-when-including-order-real-time"><i class="fa fa-check"></i>alEC: virtual time for all event pairs when including order &amp; real time</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-vs.-alec"><i class="fa fa-check"></i><b>8.10</b> aHPC vs. alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-12"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-10"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#searchlight-results"><i class="fa fa-check"></i><b>8.11</b> Searchlight Results</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-within-sequence"><i class="fa fa-check"></i>Virtual Time Within Sequence</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences-in-within-searchlight-cluster"><i class="fa fa-check"></i>Virtual Time Across Sequences in Within-Searchlight Cluster</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences"><i class="fa fa-check"></i>Virtual Time Across Sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualization-of-overlap"><i class="fa fa-check"></i>Visualization of Overlap</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-sequence-interaction"><i class="fa fa-check"></i>Virtual Time &amp; Sequence Interaction</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#exploratory-searchlight-results"><i class="fa fa-check"></i>Exploratory Searchlight Results</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-of-behavioral-generalization-bias-with-searchlight-effects"><i class="fa fa-check"></i><b>8.12</b> Correlation of behavioral generalization bias with searchlight effects</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-across-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with across-sequence searchlight effect</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-same-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with same-sequence searchlight effect</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mixed-model-summaries"><i class="fa fa-check"></i><b>8.13</b> Mixed Model Summaries</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-figure-1"><i class="fa fa-check"></i>Supplemental Figure</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-tables"><i class="fa fa-check"></i>Supplemental Tables</a></li>
<li class="chapter" data-level="8.13.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#source-data"><i class="fa fa-check"></i><b>8.13.1</b> Source data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html"><i class="fa fa-check"></i><b>9</b> Signal to noise ratio</a>
<ul>
<li class="chapter" data-level="9.1" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#calculate-voxel-wise-temporal-snr"><i class="fa fa-check"></i><b>9.1</b> Calculate voxel-wise temporal SNR</a></li>
<li class="chapter" data-level="9.2" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#average-tsnr-per-roi"><i class="fa fa-check"></i><b>9.2</b> Average tSNR per ROI</a></li>
<li class="chapter" data-level="9.3" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#contrast-tsnr-between-ahpc-and-alec"><i class="fa fa-check"></i><b>9.3</b> Contrast tSNR between aHPC and alEC</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html"><i class="fa fa-check"></i><b>10</b> RSA in searchlight peak with different threshold</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#prepare-rsa-in-searchlight-peak-1"><i class="fa fa-check"></i><b>10.1</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#create-the-roi-mask-1"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculating-the-correlation-matrices-1"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculate-pattern-similarity-change-2"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#combine-behavioral-and-fmri-data-for-rsa-2"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#rsa"><i class="fa fa-check"></i><b>10.2</b> RSA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html"><i class="fa fa-check"></i><b>11</b> Univariate GLM: Relative time</a>
<ul>
<li class="chapter" data-level="11.1" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#copy-feat-folder-from-preprocessing-to-first-level-glm-directory"><i class="fa fa-check"></i><b>11.1</b> Copy FEAT-folder from Preprocessing to First-Level GLM directory</a></li>
<li class="chapter" data-level="11.2" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-glm"><i class="fa fa-check"></i><b>11.2</b> Prepare GLM</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#compute-relative-time"><i class="fa fa-check"></i>Compute relative time</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#write-custom-ev-files-for-fsl-feat"><i class="fa fa-check"></i>Write custom EV files for FSL FEAT</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#glm-design-files"><i class="fa fa-check"></i>GLM Design files</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-confound-ev"><i class="fa fa-check"></i>Prepare confound EV</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#create-design-matrix"><i class="fa fa-check"></i>Create design matrix</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-1st-level-glm-on-htcondor"><i class="fa fa-check"></i><b>11.3</b> Run 1st-level GLM on HTCondor</a></li>
<li class="chapter" data-level="11.4" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#group-level-1"><i class="fa fa-check"></i><b>11.4</b> Group-level</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#move-first-level-images-to-mni-space-1"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#merge-first-level-images"><i class="fa fa-check"></i>Merge first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#smooth-first-level-images"><i class="fa fa-check"></i>Smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#average-first-level-images"><i class="fa fa-check"></i>Average first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#ahpc-roi-analysis"><i class="fa fa-check"></i>aHPC ROI analysis</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-fsl-randomise-1"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#results-in-ahpc-and-alec"><i class="fa fa-check"></i>Results in aHPC and alEC</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#fov-results"><i class="fa fa-check"></i>FOV results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="credit.html"><a href="credit.html"><i class="fa fa-check"></i><b>12</b> Credit</a>
<ul>
<li class="chapter" data-level="12.1" data-path="credit.html"><a href="credit.html#list-of-packages"><i class="fa fa-check"></i><b>12.1</b> List of packages</a></li>
<li class="chapter" data-level="12.2" data-path="credit.html"><a href="credit.html#references"><i class="fa fa-check"></i><b>12.2</b> References</a></li>
<li class="chapter" data-level="12.3" data-path="credit.html"><a href="credit.html#session-info"><i class="fa fa-check"></i><b>12.3</b> Session Info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="univariate-glm-relative-time" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Univariate GLM: Relative time</h1>
<p>We want to run a GLM with the relative time of other events as a parametric modulator for activity evoked by picture presentations in the picture viewing task. We will use the already-preprocessed data and use some FSL tools to implement the GLM</p>
<div id="copy-feat-folder-from-preprocessing-to-first-level-glm-directory" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Copy FEAT-folder from Preprocessing to First-Level GLM directory</h2>
<p>First, set up the folder we are working in. Make sure it’s empty when we start and then copy the preprocessed data there because we don’t need to repeat the preprocessing.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="univariate-glm-relative-time.html#cb523-1" aria-hidden="true" tabindex="-1"></a>dirs<span class="sc">$</span>level1glm_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;mri&quot;</span>, <span class="st">&quot;processed&quot;</span>, <span class="st">&quot;glm_rel_time&quot;</span> )</span></code></pre></div>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="univariate-glm-relative-time.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if the directory is not empty delete everything for a fresh start</span></span>
<span id="cb524-2"><a href="univariate-glm-relative-time.html#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is_empty</span>(<span class="fu">dir</span>(<span class="at">path =</span> dirs<span class="sc">$</span>level1glm_dir)) <span class="sc">|</span> <span class="sc">!</span><span class="fu">length</span>(<span class="fu">dir</span>(<span class="at">path =</span> dirs<span class="sc">$</span>level1glm_dir)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb524-3"><a href="univariate-glm-relative-time.html#cb524-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb524-4"><a href="univariate-glm-relative-time.html#cb524-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delete the entire directory and create it again</span></span>
<span id="cb524-5"><a href="univariate-glm-relative-time.html#cb524-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># unlink(dirs$level1glm_dir, recursive = TRUE)</span></span>
<span id="cb524-6"><a href="univariate-glm-relative-time.html#cb524-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(dirs<span class="sc">$</span>level1glm_dir)</span>
<span id="cb524-7"><a href="univariate-glm-relative-time.html#cb524-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb524-8"><a href="univariate-glm-relative-time.html#cb524-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-9"><a href="univariate-glm-relative-time.html#cb524-9" aria-hidden="true" tabindex="-1"></a><span class="co"># copy preprocessing FEATs to directory (~45 mins)</span></span>
<span id="cb524-10"><a href="univariate-glm-relative-time.html#cb524-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">dir</span>(<span class="at">path =</span> dirs<span class="sc">$</span>level1glm_dir)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb524-11"><a href="univariate-glm-relative-time.html#cb524-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb524-12"><a href="univariate-glm-relative-time.html#cb524-12" aria-hidden="true" tabindex="-1"></a>  start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb524-13"><a href="univariate-glm-relative-time.html#cb524-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Copying preprocessed data to first level folder&#39;</span>)</span>
<span id="cb524-14"><a href="univariate-glm-relative-time.html#cb524-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-15"><a href="univariate-glm-relative-time.html#cb524-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb524-16"><a href="univariate-glm-relative-time.html#cb524-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb524-17"><a href="univariate-glm-relative-time.html#cb524-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># copy the preprocessed data</span></span>
<span id="cb524-18"><a href="univariate-glm-relative-time.html#cb524-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>, i_sub)), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb524-19"><a href="univariate-glm-relative-time.html#cb524-19" aria-hidden="true" tabindex="-1"></a>    to_copy <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="fu">file.path</span>(dirs<span class="sc">$</span>feat_dir, <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>, i_sub)), <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb524-20"><a href="univariate-glm-relative-time.html#cb524-20" aria-hidden="true" tabindex="-1"></a>    to_copy <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;RSA_02&quot;</span>, to_copy, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb524-21"><a href="univariate-glm-relative-time.html#cb524-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">file.copy</span>(<span class="at">from =</span> to_copy, <span class="at">to =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>, i_sub)), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb524-22"><a href="univariate-glm-relative-time.html#cb524-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb524-23"><a href="univariate-glm-relative-time.html#cb524-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb524-24"><a href="univariate-glm-relative-time.html#cb524-24" aria-hidden="true" tabindex="-1"></a>  end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb524-25"><a href="univariate-glm-relative-time.html#cb524-25" aria-hidden="true" tabindex="-1"></a>  end_time<span class="sc">-</span>start_time</span>
<span id="cb524-26"><a href="univariate-glm-relative-time.html#cb524-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="prepare-glm" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Prepare GLM</h2>
<div id="compute-relative-time" class="section level3 unnumbered">
<h3>Compute relative time</h3>
<p>First, we need to calculate, for each event, the mean relative time of events at the same sequence position in the other sequences. As a difference to the main behavioral analyses, we use the absolute relative time of other events.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="univariate-glm-relative-time.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data from CSV</span></span>
<span id="cb525-2"><a href="univariate-glm-relative-time.html#cb525-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;behavioral_data.txt&quot;</span>)</span>
<span id="cb525-3"><a href="univariate-glm-relative-time.html#cb525-3" aria-hidden="true" tabindex="-1"></a>col_types_list <span class="ot">&lt;-</span> <span class="fu">cols_only</span>(</span>
<span id="cb525-4"><a href="univariate-glm-relative-time.html#cb525-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_id =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb525-5"><a href="univariate-glm-relative-time.html#cb525-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">day =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb525-6"><a href="univariate-glm-relative-time.html#cb525-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">event =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb525-7"><a href="univariate-glm-relative-time.html#cb525-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">pic =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb525-8"><a href="univariate-glm-relative-time.html#cb525-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">virtual_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb525-9"><a href="univariate-glm-relative-time.html#cb525-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">real_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb525-10"><a href="univariate-glm-relative-time.html#cb525-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">memory_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb525-11"><a href="univariate-glm-relative-time.html#cb525-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">memory_order =</span> <span class="fu">col_double</span>(),</span>
<span id="cb525-12"><a href="univariate-glm-relative-time.html#cb525-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">sorted_day =</span> <span class="fu">col_integer</span>()</span>
<span id="cb525-13"><a href="univariate-glm-relative-time.html#cb525-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb525-14"><a href="univariate-glm-relative-time.html#cb525-14" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_csv</span>(fname, <span class="at">col_types =</span> col_types_list))</span>
<span id="cb525-15"><a href="univariate-glm-relative-time.html#cb525-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-16"><a href="univariate-glm-relative-time.html#cb525-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(beh_data)</span>
<span id="cb525-17"><a href="univariate-glm-relative-time.html#cb525-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-18"><a href="univariate-glm-relative-time.html#cb525-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-19"><a href="univariate-glm-relative-time.html#cb525-19" aria-hidden="true" tabindex="-1"></a><span class="co"># quantify the deviation in virtual time for each event relative to other events </span></span>
<span id="cb525-20"><a href="univariate-glm-relative-time.html#cb525-20" aria-hidden="true" tabindex="-1"></a><span class="co"># at the same sequence position</span></span>
<span id="cb525-21"><a href="univariate-glm-relative-time.html#cb525-21" aria-hidden="true" tabindex="-1"></a>beh_data<span class="sc">$</span>rel_time_other_events<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb525-22"><a href="univariate-glm-relative-time.html#cb525-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-23"><a href="univariate-glm-relative-time.html#cb525-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_day <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_days){</span>
<span id="cb525-24"><a href="univariate-glm-relative-time.html#cb525-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_event <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_events_day){</span>
<span id="cb525-25"><a href="univariate-glm-relative-time.html#cb525-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb525-26"><a href="univariate-glm-relative-time.html#cb525-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the events at this sequence position from all four sequences</span></span>
<span id="cb525-27"><a href="univariate-glm-relative-time.html#cb525-27" aria-hidden="true" tabindex="-1"></a>    curr_events <span class="ot">&lt;-</span> beh_data[beh_data<span class="sc">$</span>event <span class="sc">==</span> i_event,]</span>
<span id="cb525-28"><a href="univariate-glm-relative-time.html#cb525-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb525-29"><a href="univariate-glm-relative-time.html#cb525-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the average virtual time of the other events at this sequence position</span></span>
<span id="cb525-30"><a href="univariate-glm-relative-time.html#cb525-30" aria-hidden="true" tabindex="-1"></a>    avg_vir_time_other_events <span class="ot">&lt;-</span> curr_events <span class="sc">%&gt;%</span> </span>
<span id="cb525-31"><a href="univariate-glm-relative-time.html#cb525-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(day <span class="sc">!=</span> i_day) <span class="sc">%&gt;%</span></span>
<span id="cb525-32"><a href="univariate-glm-relative-time.html#cb525-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">avg_vir_time =</span> <span class="fu">mean</span>(virtual_time)) <span class="sc">%&gt;%</span></span>
<span id="cb525-33"><a href="univariate-glm-relative-time.html#cb525-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(avg_vir_time) <span class="sc">%&gt;%</span></span>
<span id="cb525-34"><a href="univariate-glm-relative-time.html#cb525-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(.)</span>
<span id="cb525-35"><a href="univariate-glm-relative-time.html#cb525-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb525-36"><a href="univariate-glm-relative-time.html#cb525-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for the given event, store the relative time of the other events,</span></span>
<span id="cb525-37"><a href="univariate-glm-relative-time.html#cb525-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># as the absolute difference in virtual time (positive values mean other events happen later)</span></span>
<span id="cb525-38"><a href="univariate-glm-relative-time.html#cb525-38" aria-hidden="true" tabindex="-1"></a>    event_idx <span class="ot">&lt;-</span> beh_data<span class="sc">$</span>day<span class="sc">==</span>i_day <span class="sc">&amp;</span> beh_data<span class="sc">$</span>event<span class="sc">==</span>i_event</span>
<span id="cb525-39"><a href="univariate-glm-relative-time.html#cb525-39" aria-hidden="true" tabindex="-1"></a>    beh_data<span class="sc">$</span>rel_time_other_events[event_idx] <span class="ot">&lt;-</span> <span class="fu">abs</span>(avg_vir_time_other_events <span class="sc">-</span> beh_data<span class="sc">$</span>virtual_time[event_idx])</span>
<span id="cb525-40"><a href="univariate-glm-relative-time.html#cb525-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb525-41"><a href="univariate-glm-relative-time.html#cb525-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb525-42"><a href="univariate-glm-relative-time.html#cb525-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-43"><a href="univariate-glm-relative-time.html#cb525-43" aria-hidden="true" tabindex="-1"></a><span class="co"># center the relative time</span></span>
<span id="cb525-44"><a href="univariate-glm-relative-time.html#cb525-44" aria-hidden="true" tabindex="-1"></a>beh_data <span class="sc">%&gt;%</span></span>
<span id="cb525-45"><a href="univariate-glm-relative-time.html#cb525-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_time_other_events =</span> <span class="fu">scale</span>(rel_time_other_events, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
</div>
<div id="write-custom-ev-files-for-fsl-feat" class="section level3 unnumbered">
<h3>Write custom EV files for FSL FEAT</h3>
<p>As a first step, let’s write the EVs to file. For that we load the log from the post-learning picture viewing, split it into the ten blocks of each of those runs, and reference the onset times of the event image presentations to the first volume of the scanning runs. Then we write out the custom EV files:</p>
<ul>
<li>picture presentations</li>
<li>relative time parametric modulator for picture presentations</li>
<li>catch trial picture presentations</li>
</ul>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="univariate-glm-relative-time.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Write custom EV files for FSL FEAT</span></span>
<span id="cb526-2"><a href="univariate-glm-relative-time.html#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="univariate-glm-relative-time.html#cb526-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb526-4"><a href="univariate-glm-relative-time.html#cb526-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb526-5"><a href="univariate-glm-relative-time.html#cb526-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define the directory we want to use</span></span>
<span id="cb526-6"><a href="univariate-glm-relative-time.html#cb526-6" aria-hidden="true" tabindex="-1"></a>  feat_in_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;feat_evs&quot;</span>, i_sub)</span>
<span id="cb526-7"><a href="univariate-glm-relative-time.html#cb526-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(feat_in_dir)){<span class="fu">dir.create</span>(feat_in_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb526-8"><a href="univariate-glm-relative-time.html#cb526-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb526-9"><a href="univariate-glm-relative-time.html#cb526-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_runs){</span>
<span id="cb526-10"><a href="univariate-glm-relative-time.html#cb526-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb526-11"><a href="univariate-glm-relative-time.html#cb526-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># load the logfile for this run (pre or post)</span></span>
<span id="cb526-12"><a href="univariate-glm-relative-time.html#cb526-12" aria-hidden="true" tabindex="-1"></a>    log_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>pvt_log_dir, <span class="fu">sprintf</span>(<span class="st">&#39;P%s_%svirtem.txt&#39;</span>, i_sub, runs[i_run]))</span>
<span id="cb526-13"><a href="univariate-glm-relative-time.html#cb526-13" aria-hidden="true" tabindex="-1"></a>    log <span class="ot">&lt;-</span> <span class="fu">read.table</span>(log_fn)</span>
<span id="cb526-14"><a href="univariate-glm-relative-time.html#cb526-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(log) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pic&quot;</span>, <span class="st">&quot;fix_start&quot;</span>, <span class="st">&quot;pic_start&quot;</span>, <span class="st">&quot;volume&quot;</span>, <span class="st">&quot;response&quot;</span>, <span class="st">&quot;RT&quot;</span>, <span class="st">&quot;trial_end&quot;</span>)</span>
<span id="cb526-15"><a href="univariate-glm-relative-time.html#cb526-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb526-16"><a href="univariate-glm-relative-time.html#cb526-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># split the log file into the 10 blocks</span></span>
<span id="cb526-17"><a href="univariate-glm-relative-time.html#cb526-17" aria-hidden="true" tabindex="-1"></a>    log_split <span class="ot">&lt;-</span> <span class="fu">split</span>(log, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each =</span> <span class="dv">21</span>))</span>
<span id="cb526-18"><a href="univariate-glm-relative-time.html#cb526-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb526-19"><a href="univariate-glm-relative-time.html#cb526-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reference volume numbers to the first volume of that block</span></span>
<span id="cb526-20"><a href="univariate-glm-relative-time.html#cb526-20" aria-hidden="true" tabindex="-1"></a>    vol_block <span class="ot">&lt;-</span> <span class="fu">lapply</span>(log_split, <span class="cf">function</span>(x){x<span class="sc">$</span>volume <span class="sc">-</span> x<span class="sc">$</span>volume[<span class="dv">1</span>]})</span>
<span id="cb526-21"><a href="univariate-glm-relative-time.html#cb526-21" aria-hidden="true" tabindex="-1"></a>    log_split <span class="ot">&lt;-</span> <span class="fu">mapply</span>(cbind, log_split, <span class="st">&quot;vol_block&quot;</span><span class="ot">=</span>vol_block, <span class="at">SIMPLIFY=</span><span class="cn">FALSE</span>)</span>
<span id="cb526-22"><a href="univariate-glm-relative-time.html#cb526-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb526-23"><a href="univariate-glm-relative-time.html#cb526-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reference picture starts to 0 for each block</span></span>
<span id="cb526-24"><a href="univariate-glm-relative-time.html#cb526-24" aria-hidden="true" tabindex="-1"></a>    pic_start_block <span class="ot">&lt;-</span> <span class="fu">lapply</span>(log_split, <span class="cf">function</span>(x){((x<span class="sc">$</span>vol_block)<span class="sc">*</span><span class="dv">2270</span>)<span class="sc">/</span><span class="dv">1000</span>})</span>
<span id="cb526-25"><a href="univariate-glm-relative-time.html#cb526-25" aria-hidden="true" tabindex="-1"></a>    log_split <span class="ot">&lt;-</span> <span class="fu">mapply</span>(cbind, log_split, <span class="st">&quot;pic_start_block&quot;</span><span class="ot">=</span>pic_start_block, <span class="at">SIMPLIFY=</span><span class="cn">FALSE</span>)</span>
<span id="cb526-26"><a href="univariate-glm-relative-time.html#cb526-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb526-27"><a href="univariate-glm-relative-time.html#cb526-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_block <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb526-28"><a href="univariate-glm-relative-time.html#cb526-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-29"><a href="univariate-glm-relative-time.html#cb526-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-30"><a href="univariate-glm-relative-time.html#cb526-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write picture onset EV file</span></span>
<span id="cb526-31"><a href="univariate-glm-relative-time.html#cb526-31" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(feat_in_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%02d_%s.txt&quot;</span>,</span>
<span id="cb526-32"><a href="univariate-glm-relative-time.html#cb526-32" aria-hidden="true" tabindex="-1"></a>                                           i_sub, runs[i_run], i_block, <span class="st">&quot;pic_on&quot;</span>))</span>
<span id="cb526-33"><a href="univariate-glm-relative-time.html#cb526-33" aria-hidden="true" tabindex="-1"></a>      log_split[[i_block]] <span class="sc">%&gt;%</span></span>
<span id="cb526-34"><a href="univariate-glm-relative-time.html#cb526-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(pic <span class="sc">!=</span> <span class="dv">21</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-35"><a href="univariate-glm-relative-time.html#cb526-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(pic_start_block) <span class="sc">%&gt;%</span></span>
<span id="cb526-36"><a href="univariate-glm-relative-time.html#cb526-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fl">2.5</span>,</span>
<span id="cb526-37"><a href="univariate-glm-relative-time.html#cb526-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">weight =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-38"><a href="univariate-glm-relative-time.html#cb526-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write.table</span>(., <span class="at">file =</span> fn, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb526-39"><a href="univariate-glm-relative-time.html#cb526-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-40"><a href="univariate-glm-relative-time.html#cb526-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write parametric regressor for picture onsets to EV file based on relative time of other events</span></span>
<span id="cb526-41"><a href="univariate-glm-relative-time.html#cb526-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># get the relative times for pictures (sorted 1-20)</span></span>
<span id="cb526-42"><a href="univariate-glm-relative-time.html#cb526-42" aria-hidden="true" tabindex="-1"></a>      rel_times <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_id <span class="sc">==</span> <span class="fu">as.numeric</span>(i_sub)) <span class="sc">%&gt;%</span> </span>
<span id="cb526-43"><a href="univariate-glm-relative-time.html#cb526-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(pic) <span class="sc">%&gt;%</span></span>
<span id="cb526-44"><a href="univariate-glm-relative-time.html#cb526-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pull</span>(rel_time_other_events)</span>
<span id="cb526-45"><a href="univariate-glm-relative-time.html#cb526-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb526-46"><a href="univariate-glm-relative-time.html#cb526-46" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-47"><a href="univariate-glm-relative-time.html#cb526-47" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(feat_in_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%02d_%s.txt&quot;</span>,</span>
<span id="cb526-48"><a href="univariate-glm-relative-time.html#cb526-48" aria-hidden="true" tabindex="-1"></a>                                           i_sub, runs[i_run], i_block, <span class="st">&quot;rel_time&quot;</span>))</span>
<span id="cb526-49"><a href="univariate-glm-relative-time.html#cb526-49" aria-hidden="true" tabindex="-1"></a>      log_split[[i_block]] <span class="sc">%&gt;%</span></span>
<span id="cb526-50"><a href="univariate-glm-relative-time.html#cb526-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(pic <span class="sc">!=</span> <span class="dv">21</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-51"><a href="univariate-glm-relative-time.html#cb526-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(pic) <span class="sc">%&gt;%</span></span>
<span id="cb526-52"><a href="univariate-glm-relative-time.html#cb526-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">rel_time =</span> rel_times) <span class="sc">%&gt;%</span></span>
<span id="cb526-53"><a href="univariate-glm-relative-time.html#cb526-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(pic_start_block) <span class="sc">%&gt;%</span></span>
<span id="cb526-54"><a href="univariate-glm-relative-time.html#cb526-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(pic_start_block, rel_time) <span class="sc">%&gt;%</span></span>
<span id="cb526-55"><a href="univariate-glm-relative-time.html#cb526-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fl">2.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb526-56"><a href="univariate-glm-relative-time.html#cb526-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">relocate</span>(duration, <span class="at">.before =</span> <span class="st">&quot;rel_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-57"><a href="univariate-glm-relative-time.html#cb526-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write.table</span>(., <span class="at">file =</span> fn, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb526-58"><a href="univariate-glm-relative-time.html#cb526-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-59"><a href="univariate-glm-relative-time.html#cb526-59" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-60"><a href="univariate-glm-relative-time.html#cb526-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write catch picture onset EV file</span></span>
<span id="cb526-61"><a href="univariate-glm-relative-time.html#cb526-61" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(feat_in_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%02d_%s.txt&quot;</span>,</span>
<span id="cb526-62"><a href="univariate-glm-relative-time.html#cb526-62" aria-hidden="true" tabindex="-1"></a>                                           i_sub, runs[i_run], i_block, <span class="st">&quot;catch_pic_on&quot;</span>))</span>
<span id="cb526-63"><a href="univariate-glm-relative-time.html#cb526-63" aria-hidden="true" tabindex="-1"></a>      log_split[[i_block]] <span class="sc">%&gt;%</span></span>
<span id="cb526-64"><a href="univariate-glm-relative-time.html#cb526-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(pic <span class="sc">==</span> <span class="dv">21</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-65"><a href="univariate-glm-relative-time.html#cb526-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(pic_start_block) <span class="sc">%&gt;%</span></span>
<span id="cb526-66"><a href="univariate-glm-relative-time.html#cb526-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fl">2.5</span>,</span>
<span id="cb526-67"><a href="univariate-glm-relative-time.html#cb526-67" aria-hidden="true" tabindex="-1"></a>               <span class="at">weight =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-68"><a href="univariate-glm-relative-time.html#cb526-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write.table</span>(., <span class="at">file =</span> fn, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb526-69"><a href="univariate-glm-relative-time.html#cb526-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb526-70"><a href="univariate-glm-relative-time.html#cb526-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write button press EV file</span></span>
<span id="cb526-71"><a href="univariate-glm-relative-time.html#cb526-71" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(feat_in_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%02d_%s.txt&quot;</span>,</span>
<span id="cb526-72"><a href="univariate-glm-relative-time.html#cb526-72" aria-hidden="true" tabindex="-1"></a>                                           i_sub, runs[i_run], i_block, <span class="st">&quot;button_press&quot;</span>))</span>
<span id="cb526-73"><a href="univariate-glm-relative-time.html#cb526-73" aria-hidden="true" tabindex="-1"></a>      log_split[[i_block]] <span class="sc">%&gt;%</span></span>
<span id="cb526-74"><a href="univariate-glm-relative-time.html#cb526-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(response <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-75"><a href="univariate-glm-relative-time.html#cb526-75" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">press =</span> pic_start_block <span class="sc">+</span> RT<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb526-76"><a href="univariate-glm-relative-time.html#cb526-76" aria-hidden="true" tabindex="-1"></a>               <span class="at">duration =</span> <span class="dv">0</span>,</span>
<span id="cb526-77"><a href="univariate-glm-relative-time.html#cb526-77" aria-hidden="true" tabindex="-1"></a>               <span class="at">weight =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb526-78"><a href="univariate-glm-relative-time.html#cb526-78" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(press, duration, weight) <span class="sc">%&gt;%</span></span>
<span id="cb526-79"><a href="univariate-glm-relative-time.html#cb526-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write.table</span>(., <span class="at">file =</span> fn, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb526-80"><a href="univariate-glm-relative-time.html#cb526-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb526-81"><a href="univariate-glm-relative-time.html#cb526-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb526-82"><a href="univariate-glm-relative-time.html#cb526-82" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="glm-design-files" class="section level3 unnumbered">
<h3>GLM Design files</h3>
<p>Now that we have the relevant EV files, let’s set up the GLM using the tools from FSL FEAT. We create a configuration file for each block of each participant.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="univariate-glm-relative-time.html#cb527-1" aria-hidden="true" tabindex="-1"></a>dsgn <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb527-2"><a href="univariate-glm-relative-time.html#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="st"># FEAT version number</span></span>
<span id="cb527-3"><a href="univariate-glm-relative-time.html#cb527-3" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(version) 6.00</span></span>
<span id="cb527-4"><a href="univariate-glm-relative-time.html#cb527-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-5"><a href="univariate-glm-relative-time.html#cb527-5" aria-hidden="true" tabindex="-1"></a><span class="st"># Are we in MELODIC?</span></span>
<span id="cb527-6"><a href="univariate-glm-relative-time.html#cb527-6" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(inmelodic) 0</span></span>
<span id="cb527-7"><a href="univariate-glm-relative-time.html#cb527-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-8"><a href="univariate-glm-relative-time.html#cb527-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Analysis level</span></span>
<span id="cb527-9"><a href="univariate-glm-relative-time.html#cb527-9" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : First-level analysis</span></span>
<span id="cb527-10"><a href="univariate-glm-relative-time.html#cb527-10" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Higher-level analysis</span></span>
<span id="cb527-11"><a href="univariate-glm-relative-time.html#cb527-11" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(level) 1</span></span>
<span id="cb527-12"><a href="univariate-glm-relative-time.html#cb527-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-13"><a href="univariate-glm-relative-time.html#cb527-13" aria-hidden="true" tabindex="-1"></a><span class="st"># Which stages to run</span></span>
<span id="cb527-14"><a href="univariate-glm-relative-time.html#cb527-14" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : No first-level analysis (registration and/or group stats only)</span></span>
<span id="cb527-15"><a href="univariate-glm-relative-time.html#cb527-15" aria-hidden="true" tabindex="-1"></a><span class="st"># 7 : Full first-level analysis</span></span>
<span id="cb527-16"><a href="univariate-glm-relative-time.html#cb527-16" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Pre-processing</span></span>
<span id="cb527-17"><a href="univariate-glm-relative-time.html#cb527-17" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Statistics</span></span>
<span id="cb527-18"><a href="univariate-glm-relative-time.html#cb527-18" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(analysis) 2</span></span>
<span id="cb527-19"><a href="univariate-glm-relative-time.html#cb527-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-20"><a href="univariate-glm-relative-time.html#cb527-20" aria-hidden="true" tabindex="-1"></a><span class="st"># Use relative filenames</span></span>
<span id="cb527-21"><a href="univariate-glm-relative-time.html#cb527-21" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(relative_yn) 0</span></span>
<span id="cb527-22"><a href="univariate-glm-relative-time.html#cb527-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-23"><a href="univariate-glm-relative-time.html#cb527-23" aria-hidden="true" tabindex="-1"></a><span class="st"># Balloon help</span></span>
<span id="cb527-24"><a href="univariate-glm-relative-time.html#cb527-24" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(help_yn) 1</span></span>
<span id="cb527-25"><a href="univariate-glm-relative-time.html#cb527-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-26"><a href="univariate-glm-relative-time.html#cb527-26" aria-hidden="true" tabindex="-1"></a><span class="st"># Run Featwatcher</span></span>
<span id="cb527-27"><a href="univariate-glm-relative-time.html#cb527-27" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(featwatcher_yn) 0</span></span>
<span id="cb527-28"><a href="univariate-glm-relative-time.html#cb527-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-29"><a href="univariate-glm-relative-time.html#cb527-29" aria-hidden="true" tabindex="-1"></a><span class="st"># Cleanup first-level standard-space images</span></span>
<span id="cb527-30"><a href="univariate-glm-relative-time.html#cb527-30" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(sscleanup_yn) 0</span></span>
<span id="cb527-31"><a href="univariate-glm-relative-time.html#cb527-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-32"><a href="univariate-glm-relative-time.html#cb527-32" aria-hidden="true" tabindex="-1"></a><span class="st"># Output directory</span></span>
<span id="cb527-33"><a href="univariate-glm-relative-time.html#cb527-33" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(outputdir) &quot;&quot;</span></span>
<span id="cb527-34"><a href="univariate-glm-relative-time.html#cb527-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-35"><a href="univariate-glm-relative-time.html#cb527-35" aria-hidden="true" tabindex="-1"></a><span class="st"># TR(s)</span></span>
<span id="cb527-36"><a href="univariate-glm-relative-time.html#cb527-36" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tr) 2.270000</span></span>
<span id="cb527-37"><a href="univariate-glm-relative-time.html#cb527-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-38"><a href="univariate-glm-relative-time.html#cb527-38" aria-hidden="true" tabindex="-1"></a><span class="st"># Total volumes</span></span>
<span id="cb527-39"><a href="univariate-glm-relative-time.html#cb527-39" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(npts) @n_vols@</span></span>
<span id="cb527-40"><a href="univariate-glm-relative-time.html#cb527-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-41"><a href="univariate-glm-relative-time.html#cb527-41" aria-hidden="true" tabindex="-1"></a><span class="st"># Delete volumes</span></span>
<span id="cb527-42"><a href="univariate-glm-relative-time.html#cb527-42" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ndelete) 0</span></span>
<span id="cb527-43"><a href="univariate-glm-relative-time.html#cb527-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-44"><a href="univariate-glm-relative-time.html#cb527-44" aria-hidden="true" tabindex="-1"></a><span class="st"># Perfusion tag/control order</span></span>
<span id="cb527-45"><a href="univariate-glm-relative-time.html#cb527-45" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tagfirst) 1</span></span>
<span id="cb527-46"><a href="univariate-glm-relative-time.html#cb527-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-47"><a href="univariate-glm-relative-time.html#cb527-47" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of first-level analyses</span></span>
<span id="cb527-48"><a href="univariate-glm-relative-time.html#cb527-48" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(multiple) 1</span></span>
<span id="cb527-49"><a href="univariate-glm-relative-time.html#cb527-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-50"><a href="univariate-glm-relative-time.html#cb527-50" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level input type</span></span>
<span id="cb527-51"><a href="univariate-glm-relative-time.html#cb527-51" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Inputs are lower-level FEAT directories</span></span>
<span id="cb527-52"><a href="univariate-glm-relative-time.html#cb527-52" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Inputs are cope images from FEAT directories</span></span>
<span id="cb527-53"><a href="univariate-glm-relative-time.html#cb527-53" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(inputtype) 1</span></span>
<span id="cb527-54"><a href="univariate-glm-relative-time.html#cb527-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-55"><a href="univariate-glm-relative-time.html#cb527-55" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out pre-stats processing?</span></span>
<span id="cb527-56"><a href="univariate-glm-relative-time.html#cb527-56" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(filtering_yn) 0</span></span>
<span id="cb527-57"><a href="univariate-glm-relative-time.html#cb527-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-58"><a href="univariate-glm-relative-time.html#cb527-58" aria-hidden="true" tabindex="-1"></a><span class="st"># Brain/background threshold, %</span></span>
<span id="cb527-59"><a href="univariate-glm-relative-time.html#cb527-59" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(brain_thresh) 10</span></span>
<span id="cb527-60"><a href="univariate-glm-relative-time.html#cb527-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-61"><a href="univariate-glm-relative-time.html#cb527-61" aria-hidden="true" tabindex="-1"></a><span class="st"># Critical z for design efficiency calculation</span></span>
<span id="cb527-62"><a href="univariate-glm-relative-time.html#cb527-62" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(critical_z) 5.3</span></span>
<span id="cb527-63"><a href="univariate-glm-relative-time.html#cb527-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-64"><a href="univariate-glm-relative-time.html#cb527-64" aria-hidden="true" tabindex="-1"></a><span class="st"># Noise level</span></span>
<span id="cb527-65"><a href="univariate-glm-relative-time.html#cb527-65" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(noise) 0.66</span></span>
<span id="cb527-66"><a href="univariate-glm-relative-time.html#cb527-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-67"><a href="univariate-glm-relative-time.html#cb527-67" aria-hidden="true" tabindex="-1"></a><span class="st"># Noise AR(1)</span></span>
<span id="cb527-68"><a href="univariate-glm-relative-time.html#cb527-68" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(noisear) 0.34</span></span>
<span id="cb527-69"><a href="univariate-glm-relative-time.html#cb527-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-70"><a href="univariate-glm-relative-time.html#cb527-70" aria-hidden="true" tabindex="-1"></a><span class="st"># Motion correction</span></span>
<span id="cb527-71"><a href="univariate-glm-relative-time.html#cb527-71" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb527-72"><a href="univariate-glm-relative-time.html#cb527-72" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : MCFLIRT</span></span>
<span id="cb527-73"><a href="univariate-glm-relative-time.html#cb527-73" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(mc) 1</span></span>
<span id="cb527-74"><a href="univariate-glm-relative-time.html#cb527-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-75"><a href="univariate-glm-relative-time.html#cb527-75" aria-hidden="true" tabindex="-1"></a><span class="st"># Spin-history (currently obsolete)</span></span>
<span id="cb527-76"><a href="univariate-glm-relative-time.html#cb527-76" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(sh_yn) 0</span></span>
<span id="cb527-77"><a href="univariate-glm-relative-time.html#cb527-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-78"><a href="univariate-glm-relative-time.html#cb527-78" aria-hidden="true" tabindex="-1"></a><span class="st"># B0 fieldmap unwarping?</span></span>
<span id="cb527-79"><a href="univariate-glm-relative-time.html#cb527-79" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regunwarp_yn) 0</span></span>
<span id="cb527-80"><a href="univariate-glm-relative-time.html#cb527-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-81"><a href="univariate-glm-relative-time.html#cb527-81" aria-hidden="true" tabindex="-1"></a><span class="st"># EPI dwell time (ms)</span></span>
<span id="cb527-82"><a href="univariate-glm-relative-time.html#cb527-82" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(dwell) 0.235</span></span>
<span id="cb527-83"><a href="univariate-glm-relative-time.html#cb527-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-84"><a href="univariate-glm-relative-time.html#cb527-84" aria-hidden="true" tabindex="-1"></a><span class="st"># EPI TE (ms)</span></span>
<span id="cb527-85"><a href="univariate-glm-relative-time.html#cb527-85" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(te) 24</span></span>
<span id="cb527-86"><a href="univariate-glm-relative-time.html#cb527-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-87"><a href="univariate-glm-relative-time.html#cb527-87" aria-hidden="true" tabindex="-1"></a><span class="st"># % Signal loss threshold</span></span>
<span id="cb527-88"><a href="univariate-glm-relative-time.html#cb527-88" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(signallossthresh) 10</span></span>
<span id="cb527-89"><a href="univariate-glm-relative-time.html#cb527-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-90"><a href="univariate-glm-relative-time.html#cb527-90" aria-hidden="true" tabindex="-1"></a><span class="st"># Unwarp direction</span></span>
<span id="cb527-91"><a href="univariate-glm-relative-time.html#cb527-91" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(unwarp_dir) y-</span></span>
<span id="cb527-92"><a href="univariate-glm-relative-time.html#cb527-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-93"><a href="univariate-glm-relative-time.html#cb527-93" aria-hidden="true" tabindex="-1"></a><span class="st"># Slice timing correction</span></span>
<span id="cb527-94"><a href="univariate-glm-relative-time.html#cb527-94" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb527-95"><a href="univariate-glm-relative-time.html#cb527-95" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Regular up (0, 1, 2, 3, ...)</span></span>
<span id="cb527-96"><a href="univariate-glm-relative-time.html#cb527-96" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Regular down</span></span>
<span id="cb527-97"><a href="univariate-glm-relative-time.html#cb527-97" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Use slice order file</span></span>
<span id="cb527-98"><a href="univariate-glm-relative-time.html#cb527-98" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Use slice timings file</span></span>
<span id="cb527-99"><a href="univariate-glm-relative-time.html#cb527-99" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Interleaved (0, 2, 4 ... 1, 3, 5 ... )</span></span>
<span id="cb527-100"><a href="univariate-glm-relative-time.html#cb527-100" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(st) 0</span></span>
<span id="cb527-101"><a href="univariate-glm-relative-time.html#cb527-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-102"><a href="univariate-glm-relative-time.html#cb527-102" aria-hidden="true" tabindex="-1"></a><span class="st"># Slice timings file</span></span>
<span id="cb527-103"><a href="univariate-glm-relative-time.html#cb527-103" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(st_file) &quot;&quot;</span></span>
<span id="cb527-104"><a href="univariate-glm-relative-time.html#cb527-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-105"><a href="univariate-glm-relative-time.html#cb527-105" aria-hidden="true" tabindex="-1"></a><span class="st"># BET brain extraction</span></span>
<span id="cb527-106"><a href="univariate-glm-relative-time.html#cb527-106" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(bet_yn) 1</span></span>
<span id="cb527-107"><a href="univariate-glm-relative-time.html#cb527-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-108"><a href="univariate-glm-relative-time.html#cb527-108" aria-hidden="true" tabindex="-1"></a><span class="st"># Spatial smoothing FWHM (mm)</span></span>
<span id="cb527-109"><a href="univariate-glm-relative-time.html#cb527-109" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(smooth) 0</span></span>
<span id="cb527-110"><a href="univariate-glm-relative-time.html#cb527-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-111"><a href="univariate-glm-relative-time.html#cb527-111" aria-hidden="true" tabindex="-1"></a><span class="st"># Intensity normalization</span></span>
<span id="cb527-112"><a href="univariate-glm-relative-time.html#cb527-112" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(norm_yn) 0</span></span>
<span id="cb527-113"><a href="univariate-glm-relative-time.html#cb527-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-114"><a href="univariate-glm-relative-time.html#cb527-114" aria-hidden="true" tabindex="-1"></a><span class="st"># Perfusion subtraction</span></span>
<span id="cb527-115"><a href="univariate-glm-relative-time.html#cb527-115" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(perfsub_yn) 0</span></span>
<span id="cb527-116"><a href="univariate-glm-relative-time.html#cb527-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-117"><a href="univariate-glm-relative-time.html#cb527-117" aria-hidden="true" tabindex="-1"></a><span class="st"># Highpass temporal filtering</span></span>
<span id="cb527-118"><a href="univariate-glm-relative-time.html#cb527-118" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(temphp_yn) 1</span></span>
<span id="cb527-119"><a href="univariate-glm-relative-time.html#cb527-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-120"><a href="univariate-glm-relative-time.html#cb527-120" aria-hidden="true" tabindex="-1"></a><span class="st"># Lowpass temporal filtering</span></span>
<span id="cb527-121"><a href="univariate-glm-relative-time.html#cb527-121" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(templp_yn) 0</span></span>
<span id="cb527-122"><a href="univariate-glm-relative-time.html#cb527-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-123"><a href="univariate-glm-relative-time.html#cb527-123" aria-hidden="true" tabindex="-1"></a><span class="st"># MELODIC ICA data exploration</span></span>
<span id="cb527-124"><a href="univariate-glm-relative-time.html#cb527-124" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(melodic_yn) 0</span></span>
<span id="cb527-125"><a href="univariate-glm-relative-time.html#cb527-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-126"><a href="univariate-glm-relative-time.html#cb527-126" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out main stats?</span></span>
<span id="cb527-127"><a href="univariate-glm-relative-time.html#cb527-127" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(stats_yn) 1</span></span>
<span id="cb527-128"><a href="univariate-glm-relative-time.html#cb527-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-129"><a href="univariate-glm-relative-time.html#cb527-129" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out prewhitening?</span></span>
<span id="cb527-130"><a href="univariate-glm-relative-time.html#cb527-130" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(prewhiten_yn) 1</span></span>
<span id="cb527-131"><a href="univariate-glm-relative-time.html#cb527-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-132"><a href="univariate-glm-relative-time.html#cb527-132" aria-hidden="true" tabindex="-1"></a><span class="st"># Add motion parameters to model</span></span>
<span id="cb527-133"><a href="univariate-glm-relative-time.html#cb527-133" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : No</span></span>
<span id="cb527-134"><a href="univariate-glm-relative-time.html#cb527-134" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Yes</span></span>
<span id="cb527-135"><a href="univariate-glm-relative-time.html#cb527-135" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(motionevs) 0</span></span>
<span id="cb527-136"><a href="univariate-glm-relative-time.html#cb527-136" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(motionevsbeta) &quot;&quot;</span></span>
<span id="cb527-137"><a href="univariate-glm-relative-time.html#cb527-137" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(scriptevsbeta) &quot;&quot;</span></span>
<span id="cb527-138"><a href="univariate-glm-relative-time.html#cb527-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-139"><a href="univariate-glm-relative-time.html#cb527-139" aria-hidden="true" tabindex="-1"></a><span class="st"># Robust outlier detection in FLAME?</span></span>
<span id="cb527-140"><a href="univariate-glm-relative-time.html#cb527-140" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(robust_yn) 0</span></span>
<span id="cb527-141"><a href="univariate-glm-relative-time.html#cb527-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-142"><a href="univariate-glm-relative-time.html#cb527-142" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level modelling</span></span>
<span id="cb527-143"><a href="univariate-glm-relative-time.html#cb527-143" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Fixed effects</span></span>
<span id="cb527-144"><a href="univariate-glm-relative-time.html#cb527-144" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Mixed Effects: Simple OLS</span></span>
<span id="cb527-145"><a href="univariate-glm-relative-time.html#cb527-145" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Mixed Effects: FLAME 1</span></span>
<span id="cb527-146"><a href="univariate-glm-relative-time.html#cb527-146" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Mixed Effects: FLAME 1+2</span></span>
<span id="cb527-147"><a href="univariate-glm-relative-time.html#cb527-147" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(mixed_yn) 2</span></span>
<span id="cb527-148"><a href="univariate-glm-relative-time.html#cb527-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-149"><a href="univariate-glm-relative-time.html#cb527-149" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of EVs</span></span>
<span id="cb527-150"><a href="univariate-glm-relative-time.html#cb527-150" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_orig) 3</span></span>
<span id="cb527-151"><a href="univariate-glm-relative-time.html#cb527-151" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_real) 6</span></span>
<span id="cb527-152"><a href="univariate-glm-relative-time.html#cb527-152" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_vox) 0</span></span>
<span id="cb527-153"><a href="univariate-glm-relative-time.html#cb527-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-154"><a href="univariate-glm-relative-time.html#cb527-154" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of contrasts</span></span>
<span id="cb527-155"><a href="univariate-glm-relative-time.html#cb527-155" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncon_orig) 1</span></span>
<span id="cb527-156"><a href="univariate-glm-relative-time.html#cb527-156" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncon_real) 1</span></span>
<span id="cb527-157"><a href="univariate-glm-relative-time.html#cb527-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-158"><a href="univariate-glm-relative-time.html#cb527-158" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of F-tests</span></span>
<span id="cb527-159"><a href="univariate-glm-relative-time.html#cb527-159" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(nftests_orig) 0</span></span>
<span id="cb527-160"><a href="univariate-glm-relative-time.html#cb527-160" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(nftests_real) 0</span></span>
<span id="cb527-161"><a href="univariate-glm-relative-time.html#cb527-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-162"><a href="univariate-glm-relative-time.html#cb527-162" aria-hidden="true" tabindex="-1"></a><span class="st"># Add constant column to design matrix? (obsolete)</span></span>
<span id="cb527-163"><a href="univariate-glm-relative-time.html#cb527-163" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(constcol) 0</span></span>
<span id="cb527-164"><a href="univariate-glm-relative-time.html#cb527-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-165"><a href="univariate-glm-relative-time.html#cb527-165" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out post-stats steps?</span></span>
<span id="cb527-166"><a href="univariate-glm-relative-time.html#cb527-166" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(poststats_yn) 0</span></span>
<span id="cb527-167"><a href="univariate-glm-relative-time.html#cb527-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-168"><a href="univariate-glm-relative-time.html#cb527-168" aria-hidden="true" tabindex="-1"></a><span class="st"># Pre-threshold masking?</span></span>
<span id="cb527-169"><a href="univariate-glm-relative-time.html#cb527-169" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(threshmask) &quot;&quot;</span></span>
<span id="cb527-170"><a href="univariate-glm-relative-time.html#cb527-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-171"><a href="univariate-glm-relative-time.html#cb527-171" aria-hidden="true" tabindex="-1"></a><span class="st"># Thresholding</span></span>
<span id="cb527-172"><a href="univariate-glm-relative-time.html#cb527-172" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb527-173"><a href="univariate-glm-relative-time.html#cb527-173" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Uncorrected</span></span>
<span id="cb527-174"><a href="univariate-glm-relative-time.html#cb527-174" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Voxel</span></span>
<span id="cb527-175"><a href="univariate-glm-relative-time.html#cb527-175" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Cluster</span></span>
<span id="cb527-176"><a href="univariate-glm-relative-time.html#cb527-176" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(thresh) 3</span></span>
<span id="cb527-177"><a href="univariate-glm-relative-time.html#cb527-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-178"><a href="univariate-glm-relative-time.html#cb527-178" aria-hidden="true" tabindex="-1"></a><span class="st"># P threshold</span></span>
<span id="cb527-179"><a href="univariate-glm-relative-time.html#cb527-179" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(prob_thresh) 0.05</span></span>
<span id="cb527-180"><a href="univariate-glm-relative-time.html#cb527-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-181"><a href="univariate-glm-relative-time.html#cb527-181" aria-hidden="true" tabindex="-1"></a><span class="st"># Z threshold</span></span>
<span id="cb527-182"><a href="univariate-glm-relative-time.html#cb527-182" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(z_thresh) 2.3</span></span>
<span id="cb527-183"><a href="univariate-glm-relative-time.html#cb527-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-184"><a href="univariate-glm-relative-time.html#cb527-184" aria-hidden="true" tabindex="-1"></a><span class="st"># Z min/max for colour rendering</span></span>
<span id="cb527-185"><a href="univariate-glm-relative-time.html#cb527-185" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Use actual Z min/max</span></span>
<span id="cb527-186"><a href="univariate-glm-relative-time.html#cb527-186" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Use preset Z min/max</span></span>
<span id="cb527-187"><a href="univariate-glm-relative-time.html#cb527-187" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zdisplay) 0</span></span>
<span id="cb527-188"><a href="univariate-glm-relative-time.html#cb527-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-189"><a href="univariate-glm-relative-time.html#cb527-189" aria-hidden="true" tabindex="-1"></a><span class="st"># Z min in colour rendering</span></span>
<span id="cb527-190"><a href="univariate-glm-relative-time.html#cb527-190" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zmin) 2</span></span>
<span id="cb527-191"><a href="univariate-glm-relative-time.html#cb527-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-192"><a href="univariate-glm-relative-time.html#cb527-192" aria-hidden="true" tabindex="-1"></a><span class="st"># Z max in colour rendering</span></span>
<span id="cb527-193"><a href="univariate-glm-relative-time.html#cb527-193" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zmax) 8</span></span>
<span id="cb527-194"><a href="univariate-glm-relative-time.html#cb527-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-195"><a href="univariate-glm-relative-time.html#cb527-195" aria-hidden="true" tabindex="-1"></a><span class="st"># Colour rendering type</span></span>
<span id="cb527-196"><a href="univariate-glm-relative-time.html#cb527-196" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Solid blobs</span></span>
<span id="cb527-197"><a href="univariate-glm-relative-time.html#cb527-197" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Transparent blobs</span></span>
<span id="cb527-198"><a href="univariate-glm-relative-time.html#cb527-198" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(rendertype) 1</span></span>
<span id="cb527-199"><a href="univariate-glm-relative-time.html#cb527-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-200"><a href="univariate-glm-relative-time.html#cb527-200" aria-hidden="true" tabindex="-1"></a><span class="st"># Background image for higher-level stats overlays</span></span>
<span id="cb527-201"><a href="univariate-glm-relative-time.html#cb527-201" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Mean highres</span></span>
<span id="cb527-202"><a href="univariate-glm-relative-time.html#cb527-202" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : First highres</span></span>
<span id="cb527-203"><a href="univariate-glm-relative-time.html#cb527-203" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Mean functional</span></span>
<span id="cb527-204"><a href="univariate-glm-relative-time.html#cb527-204" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : First functional</span></span>
<span id="cb527-205"><a href="univariate-glm-relative-time.html#cb527-205" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Standard space template</span></span>
<span id="cb527-206"><a href="univariate-glm-relative-time.html#cb527-206" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(bgimage) 1</span></span>
<span id="cb527-207"><a href="univariate-glm-relative-time.html#cb527-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-208"><a href="univariate-glm-relative-time.html#cb527-208" aria-hidden="true" tabindex="-1"></a><span class="st"># Create time series plots</span></span>
<span id="cb527-209"><a href="univariate-glm-relative-time.html#cb527-209" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tsplot_yn) 1</span></span>
<span id="cb527-210"><a href="univariate-glm-relative-time.html#cb527-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-211"><a href="univariate-glm-relative-time.html#cb527-211" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to initial structural</span></span>
<span id="cb527-212"><a href="univariate-glm-relative-time.html#cb527-212" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_yn) 0</span></span>
<span id="cb527-213"><a href="univariate-glm-relative-time.html#cb527-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-214"><a href="univariate-glm-relative-time.html#cb527-214" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to initial structural</span></span>
<span id="cb527-215"><a href="univariate-glm-relative-time.html#cb527-215" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb527-216"><a href="univariate-glm-relative-time.html#cb527-216" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb527-217"><a href="univariate-glm-relative-time.html#cb527-217" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb527-218"><a href="univariate-glm-relative-time.html#cb527-218" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_search) 90</span></span>
<span id="cb527-219"><a href="univariate-glm-relative-time.html#cb527-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-220"><a href="univariate-glm-relative-time.html#cb527-220" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to initial structural</span></span>
<span id="cb527-221"><a href="univariate-glm-relative-time.html#cb527-221" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_dof) 6</span></span>
<span id="cb527-222"><a href="univariate-glm-relative-time.html#cb527-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-223"><a href="univariate-glm-relative-time.html#cb527-223" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to main structural</span></span>
<span id="cb527-224"><a href="univariate-glm-relative-time.html#cb527-224" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_yn) 0</span></span>
<span id="cb527-225"><a href="univariate-glm-relative-time.html#cb527-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-226"><a href="univariate-glm-relative-time.html#cb527-226" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to main structural</span></span>
<span id="cb527-227"><a href="univariate-glm-relative-time.html#cb527-227" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb527-228"><a href="univariate-glm-relative-time.html#cb527-228" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb527-229"><a href="univariate-glm-relative-time.html#cb527-229" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb527-230"><a href="univariate-glm-relative-time.html#cb527-230" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_search) 90</span></span>
<span id="cb527-231"><a href="univariate-glm-relative-time.html#cb527-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-232"><a href="univariate-glm-relative-time.html#cb527-232" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to main structural</span></span>
<span id="cb527-233"><a href="univariate-glm-relative-time.html#cb527-233" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_dof) BBR</span></span>
<span id="cb527-234"><a href="univariate-glm-relative-time.html#cb527-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-235"><a href="univariate-glm-relative-time.html#cb527-235" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to standard image?</span></span>
<span id="cb527-236"><a href="univariate-glm-relative-time.html#cb527-236" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_yn) 1</span></span>
<span id="cb527-237"><a href="univariate-glm-relative-time.html#cb527-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-238"><a href="univariate-glm-relative-time.html#cb527-238" aria-hidden="true" tabindex="-1"></a><span class="st"># Use alternate reference images?</span></span>
<span id="cb527-239"><a href="univariate-glm-relative-time.html#cb527-239" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(alternateReference_yn) 0</span></span>
<span id="cb527-240"><a href="univariate-glm-relative-time.html#cb527-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-241"><a href="univariate-glm-relative-time.html#cb527-241" aria-hidden="true" tabindex="-1"></a><span class="st"># Standard image</span></span>
<span id="cb527-242"><a href="univariate-glm-relative-time.html#cb527-242" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard) &quot;/afs/cbs/software/fsl/6.0.3/ubuntu-bionic-amd64/data/standard/MNI152_T1_1mm_brain&quot;</span></span>
<span id="cb527-243"><a href="univariate-glm-relative-time.html#cb527-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-244"><a href="univariate-glm-relative-time.html#cb527-244" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to standard space</span></span>
<span id="cb527-245"><a href="univariate-glm-relative-time.html#cb527-245" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb527-246"><a href="univariate-glm-relative-time.html#cb527-246" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb527-247"><a href="univariate-glm-relative-time.html#cb527-247" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb527-248"><a href="univariate-glm-relative-time.html#cb527-248" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_search) 90</span></span>
<span id="cb527-249"><a href="univariate-glm-relative-time.html#cb527-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-250"><a href="univariate-glm-relative-time.html#cb527-250" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to standard space</span></span>
<span id="cb527-251"><a href="univariate-glm-relative-time.html#cb527-251" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_dof) 12</span></span>
<span id="cb527-252"><a href="univariate-glm-relative-time.html#cb527-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-253"><a href="univariate-glm-relative-time.html#cb527-253" aria-hidden="true" tabindex="-1"></a><span class="st"># Do nonlinear registration from structural to standard space?</span></span>
<span id="cb527-254"><a href="univariate-glm-relative-time.html#cb527-254" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_nonlinear_yn) 0</span></span>
<span id="cb527-255"><a href="univariate-glm-relative-time.html#cb527-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-256"><a href="univariate-glm-relative-time.html#cb527-256" aria-hidden="true" tabindex="-1"></a><span class="st"># Control nonlinear warp field resolution</span></span>
<span id="cb527-257"><a href="univariate-glm-relative-time.html#cb527-257" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_nonlinear_warpres) 10 </span></span>
<span id="cb527-258"><a href="univariate-glm-relative-time.html#cb527-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-259"><a href="univariate-glm-relative-time.html#cb527-259" aria-hidden="true" tabindex="-1"></a><span class="st"># High pass filter cutoff</span></span>
<span id="cb527-260"><a href="univariate-glm-relative-time.html#cb527-260" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(paradigm_hp) 100</span></span>
<span id="cb527-261"><a href="univariate-glm-relative-time.html#cb527-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-262"><a href="univariate-glm-relative-time.html#cb527-262" aria-hidden="true" tabindex="-1"></a><span class="st"># Total voxels</span></span>
<span id="cb527-263"><a href="univariate-glm-relative-time.html#cb527-263" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(totalVoxels) 366912000</span></span>
<span id="cb527-264"><a href="univariate-glm-relative-time.html#cb527-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-265"><a href="univariate-glm-relative-time.html#cb527-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-266"><a href="univariate-glm-relative-time.html#cb527-266" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of lower-level copes feeding into higher-level analysis</span></span>
<span id="cb527-267"><a href="univariate-glm-relative-time.html#cb527-267" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncopeinputs) 0</span></span>
<span id="cb527-268"><a href="univariate-glm-relative-time.html#cb527-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-269"><a href="univariate-glm-relative-time.html#cb527-269" aria-hidden="true" tabindex="-1"></a><span class="st"># 4D AVW data or FEAT directory (1)</span></span>
<span id="cb527-270"><a href="univariate-glm-relative-time.html#cb527-270" aria-hidden="true" tabindex="-1"></a><span class="st">set feat_files(1) &quot;@level1glm_dir@/VIRTEM_P@sub_ID@/RSA_@run_no@_Block@block_no@.feat&quot;</span></span>
<span id="cb527-271"><a href="univariate-glm-relative-time.html#cb527-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-272"><a href="univariate-glm-relative-time.html#cb527-272" aria-hidden="true" tabindex="-1"></a><span class="st"># Add confound EVs text file</span></span>
<span id="cb527-273"><a href="univariate-glm-relative-time.html#cb527-273" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(confoundevs) 1</span></span>
<span id="cb527-274"><a href="univariate-glm-relative-time.html#cb527-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-275"><a href="univariate-glm-relative-time.html#cb527-275" aria-hidden="true" tabindex="-1"></a><span class="st"># Confound EVs text file for analysis 1</span></span>
<span id="cb527-276"><a href="univariate-glm-relative-time.html#cb527-276" aria-hidden="true" tabindex="-1"></a><span class="st">set confoundev_files(1) &quot;@level1glm_dir@/VIRTEM_P@sub_ID@/RSA_@run_no@_Block@block_no@.feat/mc/prefiltered_func_data_mcf.par&quot;</span></span>
<span id="cb527-277"><a href="univariate-glm-relative-time.html#cb527-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-278"><a href="univariate-glm-relative-time.html#cb527-278" aria-hidden="true" tabindex="-1"></a><span class="st"># Subjects structural image for analysis 1</span></span>
<span id="cb527-279"><a href="univariate-glm-relative-time.html#cb527-279" aria-hidden="true" tabindex="-1"></a><span class="st">set highres_files(1) &quot;/home/memspa/lordeu/Projects/virtem/mri/raw/Nifti/VIRTEM_P@sub_ID@/VIRTEM_P@sub_ID@_t1_co_brain&quot;</span></span>
<span id="cb527-280"><a href="univariate-glm-relative-time.html#cb527-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-281"><a href="univariate-glm-relative-time.html#cb527-281" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 1 title</span></span>
<span id="cb527-282"><a href="univariate-glm-relative-time.html#cb527-282" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle1) &quot;pic_onset&quot;</span></span>
<span id="cb527-283"><a href="univariate-glm-relative-time.html#cb527-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-284"><a href="univariate-glm-relative-time.html#cb527-284" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 1)</span></span>
<span id="cb527-285"><a href="univariate-glm-relative-time.html#cb527-285" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb527-286"><a href="univariate-glm-relative-time.html#cb527-286" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb527-287"><a href="univariate-glm-relative-time.html#cb527-287" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb527-288"><a href="univariate-glm-relative-time.html#cb527-288" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb527-289"><a href="univariate-glm-relative-time.html#cb527-289" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb527-290"><a href="univariate-glm-relative-time.html#cb527-290" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb527-291"><a href="univariate-glm-relative-time.html#cb527-291" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape1) 3</span></span>
<span id="cb527-292"><a href="univariate-glm-relative-time.html#cb527-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-293"><a href="univariate-glm-relative-time.html#cb527-293" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 1)</span></span>
<span id="cb527-294"><a href="univariate-glm-relative-time.html#cb527-294" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb527-295"><a href="univariate-glm-relative-time.html#cb527-295" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb527-296"><a href="univariate-glm-relative-time.html#cb527-296" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb527-297"><a href="univariate-glm-relative-time.html#cb527-297" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb527-298"><a href="univariate-glm-relative-time.html#cb527-298" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb527-299"><a href="univariate-glm-relative-time.html#cb527-299" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb527-300"><a href="univariate-glm-relative-time.html#cb527-300" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb527-301"><a href="univariate-glm-relative-time.html#cb527-301" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve1) 2</span></span>
<span id="cb527-302"><a href="univariate-glm-relative-time.html#cb527-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-303"><a href="univariate-glm-relative-time.html#cb527-303" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 1)</span></span>
<span id="cb527-304"><a href="univariate-glm-relative-time.html#cb527-304" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase1) 0</span></span>
<span id="cb527-305"><a href="univariate-glm-relative-time.html#cb527-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-306"><a href="univariate-glm-relative-time.html#cb527-306" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 1)</span></span>
<span id="cb527-307"><a href="univariate-glm-relative-time.html#cb527-307" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn1) 1</span></span>
<span id="cb527-308"><a href="univariate-glm-relative-time.html#cb527-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-309"><a href="univariate-glm-relative-time.html#cb527-309" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 1)</span></span>
<span id="cb527-310"><a href="univariate-glm-relative-time.html#cb527-310" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn1) 1</span></span>
<span id="cb527-311"><a href="univariate-glm-relative-time.html#cb527-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-312"><a href="univariate-glm-relative-time.html#cb527-312" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 1)</span></span>
<span id="cb527-313"><a href="univariate-glm-relative-time.html#cb527-313" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom1) &quot;@level1glm_dir@/feat_evs/@sub_ID@/@sub_ID@_@run_name@_@block_no@_pic_on.txt&quot;</span></span>
<span id="cb527-314"><a href="univariate-glm-relative-time.html#cb527-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-315"><a href="univariate-glm-relative-time.html#cb527-315" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 1)</span></span>
<span id="cb527-316"><a href="univariate-glm-relative-time.html#cb527-316" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma1) 3</span></span>
<span id="cb527-317"><a href="univariate-glm-relative-time.html#cb527-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-318"><a href="univariate-glm-relative-time.html#cb527-318" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 1)</span></span>
<span id="cb527-319"><a href="univariate-glm-relative-time.html#cb527-319" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay1) 6</span></span>
<span id="cb527-320"><a href="univariate-glm-relative-time.html#cb527-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-321"><a href="univariate-glm-relative-time.html#cb527-321" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 0</span></span>
<span id="cb527-322"><a href="univariate-glm-relative-time.html#cb527-322" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.0) 0</span></span>
<span id="cb527-323"><a href="univariate-glm-relative-time.html#cb527-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-324"><a href="univariate-glm-relative-time.html#cb527-324" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 1</span></span>
<span id="cb527-325"><a href="univariate-glm-relative-time.html#cb527-325" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.1) 0</span></span>
<span id="cb527-326"><a href="univariate-glm-relative-time.html#cb527-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-327"><a href="univariate-glm-relative-time.html#cb527-327" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 2</span></span>
<span id="cb527-328"><a href="univariate-glm-relative-time.html#cb527-328" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.2) 0</span></span>
<span id="cb527-329"><a href="univariate-glm-relative-time.html#cb527-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-330"><a href="univariate-glm-relative-time.html#cb527-330" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 3</span></span>
<span id="cb527-331"><a href="univariate-glm-relative-time.html#cb527-331" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.3) 0</span></span>
<span id="cb527-332"><a href="univariate-glm-relative-time.html#cb527-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-333"><a href="univariate-glm-relative-time.html#cb527-333" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 2 title</span></span>
<span id="cb527-334"><a href="univariate-glm-relative-time.html#cb527-334" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle2) &quot;rel_time_other&quot;</span></span>
<span id="cb527-335"><a href="univariate-glm-relative-time.html#cb527-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-336"><a href="univariate-glm-relative-time.html#cb527-336" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 2)</span></span>
<span id="cb527-337"><a href="univariate-glm-relative-time.html#cb527-337" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb527-338"><a href="univariate-glm-relative-time.html#cb527-338" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb527-339"><a href="univariate-glm-relative-time.html#cb527-339" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb527-340"><a href="univariate-glm-relative-time.html#cb527-340" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb527-341"><a href="univariate-glm-relative-time.html#cb527-341" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb527-342"><a href="univariate-glm-relative-time.html#cb527-342" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb527-343"><a href="univariate-glm-relative-time.html#cb527-343" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape2) 3</span></span>
<span id="cb527-344"><a href="univariate-glm-relative-time.html#cb527-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-345"><a href="univariate-glm-relative-time.html#cb527-345" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 2)</span></span>
<span id="cb527-346"><a href="univariate-glm-relative-time.html#cb527-346" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb527-347"><a href="univariate-glm-relative-time.html#cb527-347" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb527-348"><a href="univariate-glm-relative-time.html#cb527-348" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb527-349"><a href="univariate-glm-relative-time.html#cb527-349" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb527-350"><a href="univariate-glm-relative-time.html#cb527-350" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb527-351"><a href="univariate-glm-relative-time.html#cb527-351" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb527-352"><a href="univariate-glm-relative-time.html#cb527-352" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb527-353"><a href="univariate-glm-relative-time.html#cb527-353" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve2) 2</span></span>
<span id="cb527-354"><a href="univariate-glm-relative-time.html#cb527-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-355"><a href="univariate-glm-relative-time.html#cb527-355" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 2)</span></span>
<span id="cb527-356"><a href="univariate-glm-relative-time.html#cb527-356" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase2) 0</span></span>
<span id="cb527-357"><a href="univariate-glm-relative-time.html#cb527-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-358"><a href="univariate-glm-relative-time.html#cb527-358" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 2)</span></span>
<span id="cb527-359"><a href="univariate-glm-relative-time.html#cb527-359" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn2) 1</span></span>
<span id="cb527-360"><a href="univariate-glm-relative-time.html#cb527-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-361"><a href="univariate-glm-relative-time.html#cb527-361" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 2)</span></span>
<span id="cb527-362"><a href="univariate-glm-relative-time.html#cb527-362" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn2) 1</span></span>
<span id="cb527-363"><a href="univariate-glm-relative-time.html#cb527-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-364"><a href="univariate-glm-relative-time.html#cb527-364" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 2)</span></span>
<span id="cb527-365"><a href="univariate-glm-relative-time.html#cb527-365" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom2) &quot;@level1glm_dir@/feat_evs/@sub_ID@/@sub_ID@_@run_name@_@block_no@_rel_time.txt&quot;</span></span>
<span id="cb527-366"><a href="univariate-glm-relative-time.html#cb527-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-367"><a href="univariate-glm-relative-time.html#cb527-367" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 2)</span></span>
<span id="cb527-368"><a href="univariate-glm-relative-time.html#cb527-368" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma2) 3</span></span>
<span id="cb527-369"><a href="univariate-glm-relative-time.html#cb527-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-370"><a href="univariate-glm-relative-time.html#cb527-370" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 2)</span></span>
<span id="cb527-371"><a href="univariate-glm-relative-time.html#cb527-371" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay2) 6</span></span>
<span id="cb527-372"><a href="univariate-glm-relative-time.html#cb527-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-373"><a href="univariate-glm-relative-time.html#cb527-373" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 0</span></span>
<span id="cb527-374"><a href="univariate-glm-relative-time.html#cb527-374" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.0) 0</span></span>
<span id="cb527-375"><a href="univariate-glm-relative-time.html#cb527-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-376"><a href="univariate-glm-relative-time.html#cb527-376" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 1</span></span>
<span id="cb527-377"><a href="univariate-glm-relative-time.html#cb527-377" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.1) 0</span></span>
<span id="cb527-378"><a href="univariate-glm-relative-time.html#cb527-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-379"><a href="univariate-glm-relative-time.html#cb527-379" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 2</span></span>
<span id="cb527-380"><a href="univariate-glm-relative-time.html#cb527-380" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.2) 0</span></span>
<span id="cb527-381"><a href="univariate-glm-relative-time.html#cb527-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-382"><a href="univariate-glm-relative-time.html#cb527-382" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 3</span></span>
<span id="cb527-383"><a href="univariate-glm-relative-time.html#cb527-383" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.3) 0</span></span>
<span id="cb527-384"><a href="univariate-glm-relative-time.html#cb527-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-385"><a href="univariate-glm-relative-time.html#cb527-385" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 3 title</span></span>
<span id="cb527-386"><a href="univariate-glm-relative-time.html#cb527-386" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle3) &quot;catch_pic_on&quot;</span></span>
<span id="cb527-387"><a href="univariate-glm-relative-time.html#cb527-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-388"><a href="univariate-glm-relative-time.html#cb527-388" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 3)</span></span>
<span id="cb527-389"><a href="univariate-glm-relative-time.html#cb527-389" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb527-390"><a href="univariate-glm-relative-time.html#cb527-390" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb527-391"><a href="univariate-glm-relative-time.html#cb527-391" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb527-392"><a href="univariate-glm-relative-time.html#cb527-392" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb527-393"><a href="univariate-glm-relative-time.html#cb527-393" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb527-394"><a href="univariate-glm-relative-time.html#cb527-394" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb527-395"><a href="univariate-glm-relative-time.html#cb527-395" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape3) 3</span></span>
<span id="cb527-396"><a href="univariate-glm-relative-time.html#cb527-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-397"><a href="univariate-glm-relative-time.html#cb527-397" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 3)</span></span>
<span id="cb527-398"><a href="univariate-glm-relative-time.html#cb527-398" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb527-399"><a href="univariate-glm-relative-time.html#cb527-399" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb527-400"><a href="univariate-glm-relative-time.html#cb527-400" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb527-401"><a href="univariate-glm-relative-time.html#cb527-401" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb527-402"><a href="univariate-glm-relative-time.html#cb527-402" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb527-403"><a href="univariate-glm-relative-time.html#cb527-403" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb527-404"><a href="univariate-glm-relative-time.html#cb527-404" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb527-405"><a href="univariate-glm-relative-time.html#cb527-405" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve3) 2</span></span>
<span id="cb527-406"><a href="univariate-glm-relative-time.html#cb527-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-407"><a href="univariate-glm-relative-time.html#cb527-407" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 3)</span></span>
<span id="cb527-408"><a href="univariate-glm-relative-time.html#cb527-408" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase3) 0</span></span>
<span id="cb527-409"><a href="univariate-glm-relative-time.html#cb527-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-410"><a href="univariate-glm-relative-time.html#cb527-410" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 3)</span></span>
<span id="cb527-411"><a href="univariate-glm-relative-time.html#cb527-411" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn3) 1</span></span>
<span id="cb527-412"><a href="univariate-glm-relative-time.html#cb527-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-413"><a href="univariate-glm-relative-time.html#cb527-413" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 3)</span></span>
<span id="cb527-414"><a href="univariate-glm-relative-time.html#cb527-414" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn3) 1</span></span>
<span id="cb527-415"><a href="univariate-glm-relative-time.html#cb527-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-416"><a href="univariate-glm-relative-time.html#cb527-416" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 3)</span></span>
<span id="cb527-417"><a href="univariate-glm-relative-time.html#cb527-417" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom3) &quot;@level1glm_dir@/feat_evs/@sub_ID@/@sub_ID@_@run_name@_@block_no@_catch_pic_on.txt&quot;</span></span>
<span id="cb527-418"><a href="univariate-glm-relative-time.html#cb527-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-419"><a href="univariate-glm-relative-time.html#cb527-419" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 3)</span></span>
<span id="cb527-420"><a href="univariate-glm-relative-time.html#cb527-420" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma3) 3</span></span>
<span id="cb527-421"><a href="univariate-glm-relative-time.html#cb527-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-422"><a href="univariate-glm-relative-time.html#cb527-422" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 3)</span></span>
<span id="cb527-423"><a href="univariate-glm-relative-time.html#cb527-423" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay3) 6</span></span>
<span id="cb527-424"><a href="univariate-glm-relative-time.html#cb527-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-425"><a href="univariate-glm-relative-time.html#cb527-425" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 0</span></span>
<span id="cb527-426"><a href="univariate-glm-relative-time.html#cb527-426" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.0) 0</span></span>
<span id="cb527-427"><a href="univariate-glm-relative-time.html#cb527-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-428"><a href="univariate-glm-relative-time.html#cb527-428" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 1</span></span>
<span id="cb527-429"><a href="univariate-glm-relative-time.html#cb527-429" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.1) 0</span></span>
<span id="cb527-430"><a href="univariate-glm-relative-time.html#cb527-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-431"><a href="univariate-glm-relative-time.html#cb527-431" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 2</span></span>
<span id="cb527-432"><a href="univariate-glm-relative-time.html#cb527-432" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.2) 0</span></span>
<span id="cb527-433"><a href="univariate-glm-relative-time.html#cb527-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-434"><a href="univariate-glm-relative-time.html#cb527-434" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 3</span></span>
<span id="cb527-435"><a href="univariate-glm-relative-time.html#cb527-435" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.3) 0</span></span>
<span id="cb527-436"><a href="univariate-glm-relative-time.html#cb527-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-437"><a href="univariate-glm-relative-time.html#cb527-437" aria-hidden="true" tabindex="-1"></a><span class="st"># Contrast &amp; F-tests mode</span></span>
<span id="cb527-438"><a href="univariate-glm-relative-time.html#cb527-438" aria-hidden="true" tabindex="-1"></a><span class="st"># real : control real EVs</span></span>
<span id="cb527-439"><a href="univariate-glm-relative-time.html#cb527-439" aria-hidden="true" tabindex="-1"></a><span class="st"># orig : control original EVs</span></span>
<span id="cb527-440"><a href="univariate-glm-relative-time.html#cb527-440" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_mode_old) orig</span></span>
<span id="cb527-441"><a href="univariate-glm-relative-time.html#cb527-441" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_mode) orig</span></span>
<span id="cb527-442"><a href="univariate-glm-relative-time.html#cb527-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-443"><a href="univariate-glm-relative-time.html#cb527-443" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_real 1</span></span>
<span id="cb527-444"><a href="univariate-glm-relative-time.html#cb527-444" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_real.1) 1</span></span>
<span id="cb527-445"><a href="univariate-glm-relative-time.html#cb527-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-446"><a href="univariate-glm-relative-time.html#cb527-446" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_real 1</span></span>
<span id="cb527-447"><a href="univariate-glm-relative-time.html#cb527-447" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_real.1) &quot;&quot;</span></span>
<span id="cb527-448"><a href="univariate-glm-relative-time.html#cb527-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-449"><a href="univariate-glm-relative-time.html#cb527-449" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 1</span></span>
<span id="cb527-450"><a href="univariate-glm-relative-time.html#cb527-450" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.1) 0.0</span></span>
<span id="cb527-451"><a href="univariate-glm-relative-time.html#cb527-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-452"><a href="univariate-glm-relative-time.html#cb527-452" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 2</span></span>
<span id="cb527-453"><a href="univariate-glm-relative-time.html#cb527-453" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.2) 0</span></span>
<span id="cb527-454"><a href="univariate-glm-relative-time.html#cb527-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-455"><a href="univariate-glm-relative-time.html#cb527-455" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 3</span></span>
<span id="cb527-456"><a href="univariate-glm-relative-time.html#cb527-456" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.3) 1.0</span></span>
<span id="cb527-457"><a href="univariate-glm-relative-time.html#cb527-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-458"><a href="univariate-glm-relative-time.html#cb527-458" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 4</span></span>
<span id="cb527-459"><a href="univariate-glm-relative-time.html#cb527-459" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.4) 0</span></span>
<span id="cb527-460"><a href="univariate-glm-relative-time.html#cb527-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-461"><a href="univariate-glm-relative-time.html#cb527-461" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 5</span></span>
<span id="cb527-462"><a href="univariate-glm-relative-time.html#cb527-462" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.5) 0</span></span>
<span id="cb527-463"><a href="univariate-glm-relative-time.html#cb527-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-464"><a href="univariate-glm-relative-time.html#cb527-464" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 6</span></span>
<span id="cb527-465"><a href="univariate-glm-relative-time.html#cb527-465" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.6) 0</span></span>
<span id="cb527-466"><a href="univariate-glm-relative-time.html#cb527-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-467"><a href="univariate-glm-relative-time.html#cb527-467" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_orig 1</span></span>
<span id="cb527-468"><a href="univariate-glm-relative-time.html#cb527-468" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_orig.1) 1</span></span>
<span id="cb527-469"><a href="univariate-glm-relative-time.html#cb527-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-470"><a href="univariate-glm-relative-time.html#cb527-470" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_orig 1</span></span>
<span id="cb527-471"><a href="univariate-glm-relative-time.html#cb527-471" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_orig.1) &quot;&quot;</span></span>
<span id="cb527-472"><a href="univariate-glm-relative-time.html#cb527-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-473"><a href="univariate-glm-relative-time.html#cb527-473" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 1</span></span>
<span id="cb527-474"><a href="univariate-glm-relative-time.html#cb527-474" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.1) 0.0</span></span>
<span id="cb527-475"><a href="univariate-glm-relative-time.html#cb527-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-476"><a href="univariate-glm-relative-time.html#cb527-476" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 2</span></span>
<span id="cb527-477"><a href="univariate-glm-relative-time.html#cb527-477" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.2) 1.0</span></span>
<span id="cb527-478"><a href="univariate-glm-relative-time.html#cb527-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-479"><a href="univariate-glm-relative-time.html#cb527-479" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 3</span></span>
<span id="cb527-480"><a href="univariate-glm-relative-time.html#cb527-480" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.3) 0</span></span>
<span id="cb527-481"><a href="univariate-glm-relative-time.html#cb527-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-482"><a href="univariate-glm-relative-time.html#cb527-482" aria-hidden="true" tabindex="-1"></a><span class="st"># Contrast masking - use &gt;0 instead of thresholding?</span></span>
<span id="cb527-483"><a href="univariate-glm-relative-time.html#cb527-483" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask_zerothresh_yn) 0</span></span>
<span id="cb527-484"><a href="univariate-glm-relative-time.html#cb527-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-485"><a href="univariate-glm-relative-time.html#cb527-485" aria-hidden="true" tabindex="-1"></a><span class="st"># Do contrast masking at all?</span></span>
<span id="cb527-486"><a href="univariate-glm-relative-time.html#cb527-486" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask1_1) 0</span></span>
<span id="cb527-487"><a href="univariate-glm-relative-time.html#cb527-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-488"><a href="univariate-glm-relative-time.html#cb527-488" aria-hidden="true" tabindex="-1"></a><span class="st">##########################################################</span></span>
<span id="cb527-489"><a href="univariate-glm-relative-time.html#cb527-489" aria-hidden="true" tabindex="-1"></a><span class="st"># Now options that do not appear in the GUI</span></span>
<span id="cb527-490"><a href="univariate-glm-relative-time.html#cb527-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-491"><a href="univariate-glm-relative-time.html#cb527-491" aria-hidden="true" tabindex="-1"></a><span class="st"># Alternative (to BETting) mask image</span></span>
<span id="cb527-492"><a href="univariate-glm-relative-time.html#cb527-492" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(alternative_mask) &quot;&quot;</span></span>
<span id="cb527-493"><a href="univariate-glm-relative-time.html#cb527-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-494"><a href="univariate-glm-relative-time.html#cb527-494" aria-hidden="true" tabindex="-1"></a><span class="st"># Initial structural space registration initialisation transform</span></span>
<span id="cb527-495"><a href="univariate-glm-relative-time.html#cb527-495" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_initial_highres) &quot;&quot;</span></span>
<span id="cb527-496"><a href="univariate-glm-relative-time.html#cb527-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-497"><a href="univariate-glm-relative-time.html#cb527-497" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural space registration initialisation transform</span></span>
<span id="cb527-498"><a href="univariate-glm-relative-time.html#cb527-498" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_highres) &quot;&quot;</span></span>
<span id="cb527-499"><a href="univariate-glm-relative-time.html#cb527-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-500"><a href="univariate-glm-relative-time.html#cb527-500" aria-hidden="true" tabindex="-1"></a><span class="st"># Standard space registration initialisation transform</span></span>
<span id="cb527-501"><a href="univariate-glm-relative-time.html#cb527-501" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_standard) &quot;&quot;</span></span>
<span id="cb527-502"><a href="univariate-glm-relative-time.html#cb527-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-503"><a href="univariate-glm-relative-time.html#cb527-503" aria-hidden="true" tabindex="-1"></a><span class="st"># For full FEAT analysis: overwrite existing .feat output dir?</span></span>
<span id="cb527-504"><a href="univariate-glm-relative-time.html#cb527-504" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(overwrite_yn) 0</span></span>
<span id="cb527-505"><a href="univariate-glm-relative-time.html#cb527-505" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="univariate-glm-relative-time.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># folder for fsf files and copy template there</span></span>
<span id="cb528-2"><a href="univariate-glm-relative-time.html#cb528-2" aria-hidden="true" tabindex="-1"></a>fsf_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;fsf&quot;</span>)</span>
<span id="cb528-3"><a href="univariate-glm-relative-time.html#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(fsf_dir)){<span class="fu">dir.create</span>(fsf_dir)}</span>
<span id="cb528-4"><a href="univariate-glm-relative-time.html#cb528-4" aria-hidden="true" tabindex="-1"></a><span class="co">#file.copy(from = here(&quot;virtem_code&quot;, &quot;unused_do_not_delete&quot;, &quot;feat_level1glm_relTimeOther.fsf&quot;), </span></span>
<span id="cb528-5"><a href="univariate-glm-relative-time.html#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          to = file.path(fsf_dir, &quot;feat_level1glm_template.fsf&quot;))</span></span>
<span id="cb528-6"><a href="univariate-glm-relative-time.html#cb528-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-7"><a href="univariate-glm-relative-time.html#cb528-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set up data frame</span></span>
<span id="cb528-8"><a href="univariate-glm-relative-time.html#cb528-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sub_id =</span> subjects <span class="sc">%&gt;%</span> <span class="fu">rep</span>(<span class="at">each =</span> n_blocks))</span>
<span id="cb528-9"><a href="univariate-glm-relative-time.html#cb528-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>run_name <span class="ot">&lt;-</span> <span class="st">&quot;post&quot;</span>  <span class="co">#runs %&gt;% rep(each = 10) %&gt;% rep(n_subs)</span></span>
<span id="cb528-10"><a href="univariate-glm-relative-time.html#cb528-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>run_no <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#c(1,2) %&gt;% rep(each = 10) %&gt;% rep(n_subs)</span></span>
<span id="cb528-11"><a href="univariate-glm-relative-time.html#cb528-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">rep</span>(n_subs) <span class="co"># c(1:10) %&gt;% rep(n_runs) %&gt;% rep(n_subs)</span></span>
<span id="cb528-12"><a href="univariate-glm-relative-time.html#cb528-12" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(fsf_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%02d.fsf&quot;</span>, df<span class="sc">$</span>sub_id, df<span class="sc">$</span>run_name, df<span class="sc">$</span>block))</span>
<span id="cb528-13"><a href="univariate-glm-relative-time.html#cb528-13" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>in_dir <span class="ot">&lt;-</span> dirs<span class="sc">$</span>level1glm_dir</span>
<span id="cb528-14"><a href="univariate-glm-relative-time.html#cb528-14" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>filtered_func <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>, df<span class="sc">$</span>sub_id),</span>
<span id="cb528-15"><a href="univariate-glm-relative-time.html#cb528-15" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no, df<span class="sc">$</span>block),</span>
<span id="cb528-16"><a href="univariate-glm-relative-time.html#cb528-16" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;filtered_func_data.nii.gz&quot;</span>)</span>
<span id="cb528-17"><a href="univariate-glm-relative-time.html#cb528-17" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fsf_dir <span class="ot">&lt;-</span> fsf_dir</span>
<span id="cb528-18"><a href="univariate-glm-relative-time.html#cb528-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-19"><a href="univariate-glm-relative-time.html#cb528-19" aria-hidden="true" tabindex="-1"></a><span class="co"># define function to substitute placeholders</span></span>
<span id="cb528-20"><a href="univariate-glm-relative-time.html#cb528-20" aria-hidden="true" tabindex="-1"></a>replace_fsf <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">df =</span> df[<span class="dv">1</span>,], <span class="at">fsf_lines =</span> dsgn){</span>
<span id="cb528-21"><a href="univariate-glm-relative-time.html#cb528-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-22"><a href="univariate-glm-relative-time.html#cb528-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read in the template file</span></span>
<span id="cb528-23"><a href="univariate-glm-relative-time.html#cb528-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fn &lt;- file.path(df$fsf_dir, &quot;feat_level1glm_template.fsf&quot;)</span></span>
<span id="cb528-24"><a href="univariate-glm-relative-time.html#cb528-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fsf_lines &lt;- read_delim(fn, delim = &quot;\r&quot;, </span></span>
<span id="cb528-25"><a href="univariate-glm-relative-time.html#cb528-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                        col_names = FALSE, col_types = cols(col_character()))</span></span>
<span id="cb528-26"><a href="univariate-glm-relative-time.html#cb528-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-27"><a href="univariate-glm-relative-time.html#cb528-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replace the path</span></span>
<span id="cb528-28"><a href="univariate-glm-relative-time.html#cb528-28" aria-hidden="true" tabindex="-1"></a>    fsf_lines <span class="ot">&lt;-</span> <span class="fu">mgsub</span>(<span class="at">pattern =</span> <span class="st">&quot;@level1glm_dir@&quot;</span>, </span>
<span id="cb528-29"><a href="univariate-glm-relative-time.html#cb528-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replacement =</span> df<span class="sc">$</span>in_dir, <span class="at">string =</span> fsf_lines)</span>
<span id="cb528-30"><a href="univariate-glm-relative-time.html#cb528-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-31"><a href="univariate-glm-relative-time.html#cb528-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replace the subject ID</span></span>
<span id="cb528-32"><a href="univariate-glm-relative-time.html#cb528-32" aria-hidden="true" tabindex="-1"></a>    fsf_lines <span class="ot">&lt;-</span> <span class="fu">mgsub</span>(<span class="at">pattern =</span> <span class="st">&quot;@sub_ID@&quot;</span>, </span>
<span id="cb528-33"><a href="univariate-glm-relative-time.html#cb528-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replacement =</span> df<span class="sc">$</span>sub_id, <span class="at">string =</span> fsf_lines)</span>
<span id="cb528-34"><a href="univariate-glm-relative-time.html#cb528-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-35"><a href="univariate-glm-relative-time.html#cb528-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replace character run name</span></span>
<span id="cb528-36"><a href="univariate-glm-relative-time.html#cb528-36" aria-hidden="true" tabindex="-1"></a>    fsf_lines <span class="ot">&lt;-</span> <span class="fu">mgsub</span>(<span class="at">pattern =</span> <span class="st">&quot;@run_name@&quot;</span>, </span>
<span id="cb528-37"><a href="univariate-glm-relative-time.html#cb528-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replacement =</span> df<span class="sc">$</span>run_name, <span class="at">string =</span> fsf_lines)</span>
<span id="cb528-38"><a href="univariate-glm-relative-time.html#cb528-38" aria-hidden="true" tabindex="-1"></a>    fsf_lines <span class="ot">&lt;-</span> <span class="fu">mgsub</span>(<span class="at">pattern =</span> <span class="st">&quot;@run_no@&quot;</span>, </span>
<span id="cb528-39"><a href="univariate-glm-relative-time.html#cb528-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replacement =</span> <span class="fu">str_pad</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>run_no),</span>
<span id="cb528-40"><a href="univariate-glm-relative-time.html#cb528-40" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&quot;left&quot;</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>),</span>
<span id="cb528-41"><a href="univariate-glm-relative-time.html#cb528-41" aria-hidden="true" tabindex="-1"></a>                          <span class="at">string =</span> fsf_lines)</span>
<span id="cb528-42"><a href="univariate-glm-relative-time.html#cb528-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-43"><a href="univariate-glm-relative-time.html#cb528-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replace block number</span></span>
<span id="cb528-44"><a href="univariate-glm-relative-time.html#cb528-44" aria-hidden="true" tabindex="-1"></a>    fsf_lines <span class="ot">&lt;-</span> <span class="fu">mgsub</span>(<span class="at">pattern =</span> <span class="st">&quot;@block_no@&quot;</span>, </span>
<span id="cb528-45"><a href="univariate-glm-relative-time.html#cb528-45" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replacement =</span> <span class="fu">str_pad</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>block), </span>
<span id="cb528-46"><a href="univariate-glm-relative-time.html#cb528-46" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&quot;left&quot;</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>),</span>
<span id="cb528-47"><a href="univariate-glm-relative-time.html#cb528-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">string =</span> fsf_lines)</span>
<span id="cb528-48"><a href="univariate-glm-relative-time.html#cb528-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-49"><a href="univariate-glm-relative-time.html#cb528-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replace the number of volumes in 4D-nifti based on Header info</span></span>
<span id="cb528-50"><a href="univariate-glm-relative-time.html#cb528-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># min throws a warning because min is called with no data, but much faster</span></span>
<span id="cb528-51"><a href="univariate-glm-relative-time.html#cb528-51" aria-hidden="true" tabindex="-1"></a>    nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(df<span class="sc">$</span>filtered_func, <span class="at">read_data =</span> <span class="cn">FALSE</span>)</span>
<span id="cb528-52"><a href="univariate-glm-relative-time.html#cb528-52" aria-hidden="true" tabindex="-1"></a>    fsf_lines <span class="ot">&lt;-</span> <span class="fu">mgsub</span>(<span class="at">pattern =</span> <span class="st">&quot;@n_vols@&quot;</span>, </span>
<span id="cb528-53"><a href="univariate-glm-relative-time.html#cb528-53" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replacement =</span> nii<span class="sc">@</span>dim_[<span class="dv">5</span>], <span class="at">string =</span> fsf_lines)</span>
<span id="cb528-54"><a href="univariate-glm-relative-time.html#cb528-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb528-55"><a href="univariate-glm-relative-time.html#cb528-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write to file</span></span>
<span id="cb528-56"><a href="univariate-glm-relative-time.html#cb528-56" aria-hidden="true" tabindex="-1"></a>    con <span class="ot">&lt;-</span> <span class="fu">file</span>(df<span class="sc">$</span>fn)</span>
<span id="cb528-57"><a href="univariate-glm-relative-time.html#cb528-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(fsf_lines, con)</span>
<span id="cb528-58"><a href="univariate-glm-relative-time.html#cb528-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">close</span>(con)</span>
<span id="cb528-59"><a href="univariate-glm-relative-time.html#cb528-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb528-60"><a href="univariate-glm-relative-time.html#cb528-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-61"><a href="univariate-glm-relative-time.html#cb528-61" aria-hidden="true" tabindex="-1"></a><span class="co"># create FSF info for each row of the data frame (i.e. each block of each subject)</span></span>
<span id="cb528-62"><a href="univariate-glm-relative-time.html#cb528-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)){<span class="fu">replace_fsf</span>(<span class="at">df =</span> df[i,], <span class="at">fsf_lines =</span> dsgn)}</span></code></pre></div>
</div>
<div id="prepare-confound-ev" class="section level3 unnumbered">
<h3>Prepare confound EV</h3>
<p>We want to include the motion parameters from FEAT as confound regressors. Thus, we copy them from the mc subfolder of the FEAT directory and save them using just one space as a delimiter so they can be used with feat_model.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="univariate-glm-relative-time.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)){</span>
<span id="cb529-2"><a href="univariate-glm-relative-time.html#cb529-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb529-3"><a href="univariate-glm-relative-time.html#cb529-3" aria-hidden="true" tabindex="-1"></a>  mcpar_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb529-4"><a href="univariate-glm-relative-time.html#cb529-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), </span>
<span id="cb529-5"><a href="univariate-glm-relative-time.html#cb529-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;mc&quot;</span>, <span class="st">&quot;prefiltered_func_data_mcf.par&quot;</span>)</span>
<span id="cb529-6"><a href="univariate-glm-relative-time.html#cb529-6" aria-hidden="true" tabindex="-1"></a>  conf_ev_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb529-7"><a href="univariate-glm-relative-time.html#cb529-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), <span class="st">&quot;mcf.txt&quot;</span>)</span>
<span id="cb529-8"><a href="univariate-glm-relative-time.html#cb529-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb529-9"><a href="univariate-glm-relative-time.html#cb529-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># paste to the correct file using only one space as delimiter</span></span>
<span id="cb529-10"><a href="univariate-glm-relative-time.html#cb529-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;paste -d &#39; &#39; %s &gt; %s&quot;</span>, mcpar_fn, conf_ev_fn))</span>
<span id="cb529-11"><a href="univariate-glm-relative-time.html#cb529-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="create-design-matrix" class="section level3 unnumbered">
<h3>Create design matrix</h3>
<p>Next, we call feat_model to create the design matrix and contrast file needed to run the GLM from the fsf-configuration.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="univariate-glm-relative-time.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)){</span>
<span id="cb530-2"><a href="univariate-glm-relative-time.html#cb530-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb530-3"><a href="univariate-glm-relative-time.html#cb530-3" aria-hidden="true" tabindex="-1"></a>  fsf_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb530-4"><a href="univariate-glm-relative-time.html#cb530-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), </span>
<span id="cb530-5"><a href="univariate-glm-relative-time.html#cb530-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;design.fsf&quot;</span>)</span>
<span id="cb530-6"><a href="univariate-glm-relative-time.html#cb530-6" aria-hidden="true" tabindex="-1"></a>  conf_ev_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb530-7"><a href="univariate-glm-relative-time.html#cb530-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), <span class="st">&quot;mcf.txt&quot;</span>)</span>
<span id="cb530-8"><a href="univariate-glm-relative-time.html#cb530-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb530-9"><a href="univariate-glm-relative-time.html#cb530-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># copy fsf to Feat folder</span></span>
<span id="cb530-10"><a href="univariate-glm-relative-time.html#cb530-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.copy</span>(<span class="at">from =</span> df<span class="sc">$</span>fn[i],</span>
<span id="cb530-11"><a href="univariate-glm-relative-time.html#cb530-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb530-12"><a href="univariate-glm-relative-time.html#cb530-12" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), </span>
<span id="cb530-13"><a href="univariate-glm-relative-time.html#cb530-13" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;design.fsf&quot;</span>),</span>
<span id="cb530-14"><a href="univariate-glm-relative-time.html#cb530-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb530-15"><a href="univariate-glm-relative-time.html#cb530-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb530-16"><a href="univariate-glm-relative-time.html#cb530-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run feat_model design to create files for film_gls</span></span>
<span id="cb530-17"><a href="univariate-glm-relative-time.html#cb530-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;feat_model %s %s&quot;</span>, tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(fsf_fn), conf_ev_fn))</span>
<span id="cb530-18"><a href="univariate-glm-relative-time.html#cb530-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="run-1st-level-glm-on-htcondor" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Run 1st-level GLM on HTCondor</h2>
<p>Finally, we can run the GLM. For that, we create a small shell script that has the film_gls command and that deletes the residual file after finishing. This is used as the executable for a task list that specifies the specific files to use for each block of each participant.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="univariate-glm-relative-time.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="co"># folder for condor output</span></span>
<span id="cb531-2"><a href="univariate-glm-relative-time.html#cb531-2" aria-hidden="true" tabindex="-1"></a>htc_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;htc_logs&quot;</span>, <span class="st">&quot;rel_time_glm_level1&quot;</span>)</span>
<span id="cb531-3"><a href="univariate-glm-relative-time.html#cb531-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">exists</span>(htc_dir)){<span class="fu">dir.create</span>(htc_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb531-4"><a href="univariate-glm-relative-time.html#cb531-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-5"><a href="univariate-glm-relative-time.html#cb531-5" aria-hidden="true" tabindex="-1"></a><span class="co"># write shell script that runs the GLM and removes the residuals afterwards</span></span>
<span id="cb531-6"><a href="univariate-glm-relative-time.html#cb531-6" aria-hidden="true" tabindex="-1"></a>fn_sh <span class="ot">&lt;-</span> <span class="fu">file.path</span>(htc_dir, <span class="st">&quot;rel_time_glm_level1&quot;</span>)</span>
<span id="cb531-7"><a href="univariate-glm-relative-time.html#cb531-7" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">file</span>(fn_sh)</span>
<span id="cb531-8"><a href="univariate-glm-relative-time.html#cb531-8" aria-hidden="true" tabindex="-1"></a><span class="fu">open</span>(con, <span class="st">&quot;w&quot;</span>)</span>
<span id="cb531-9"><a href="univariate-glm-relative-time.html#cb531-9" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="st">&quot;#!/bin/bash</span></span>
<span id="cb531-10"><a href="univariate-glm-relative-time.html#cb531-10" aria-hidden="true" tabindex="-1"></a><span class="st">/usr/share/fsl/5.0/bin/film_gls --in=$1 --rn=$2 --pd=$3 --thr=1000.0 --sa --ms=5 --con=$4</span></span>
<span id="cb531-11"><a href="univariate-glm-relative-time.html#cb531-11" aria-hidden="true" tabindex="-1"></a><span class="st">rm $5</span></span>
<span id="cb531-12"><a href="univariate-glm-relative-time.html#cb531-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>, con)</span>
<span id="cb531-13"><a href="univariate-glm-relative-time.html#cb531-13" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb531-14"><a href="univariate-glm-relative-time.html#cb531-14" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;chmod +x %s&quot;</span>,fn_sh))</span>
<span id="cb531-15"><a href="univariate-glm-relative-time.html#cb531-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-16"><a href="univariate-glm-relative-time.html#cb531-16" aria-hidden="true" tabindex="-1"></a><span class="co"># write the submit file</span></span>
<span id="cb531-17"><a href="univariate-glm-relative-time.html#cb531-17" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(htc_dir, <span class="st">&quot;rel_time_glm_level1_tasklist.txt&quot;</span>)</span>
<span id="cb531-18"><a href="univariate-glm-relative-time.html#cb531-18" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">file</span>(fn)</span>
<span id="cb531-19"><a href="univariate-glm-relative-time.html#cb531-19" aria-hidden="true" tabindex="-1"></a><span class="fu">open</span>(con, <span class="st">&quot;w&quot;</span>)</span>
<span id="cb531-20"><a href="univariate-glm-relative-time.html#cb531-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-21"><a href="univariate-glm-relative-time.html#cb531-21" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">c</span>(</span>
<span id="cb531-22"><a href="univariate-glm-relative-time.html#cb531-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;universe = vanilla&quot;</span>,</span>
<span id="cb531-23"><a href="univariate-glm-relative-time.html#cb531-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;executable = %s&quot;</span>, fn_sh),</span>
<span id="cb531-24"><a href="univariate-glm-relative-time.html#cb531-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;request_memory = 5000&quot;</span>,</span>
<span id="cb531-25"><a href="univariate-glm-relative-time.html#cb531-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;request_cpus = 1&quot;</span>,</span>
<span id="cb531-26"><a href="univariate-glm-relative-time.html#cb531-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;getenv = True&quot;</span>,</span>
<span id="cb531-27"><a href="univariate-glm-relative-time.html#cb531-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;notification = error&quot;</span></span>
<span id="cb531-28"><a href="univariate-glm-relative-time.html#cb531-28" aria-hidden="true" tabindex="-1"></a>    ),con)</span>
<span id="cb531-29"><a href="univariate-glm-relative-time.html#cb531-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-30"><a href="univariate-glm-relative-time.html#cb531-30" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb531-31"><a href="univariate-glm-relative-time.html#cb531-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)){</span>
<span id="cb531-32"><a href="univariate-glm-relative-time.html#cb531-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-33"><a href="univariate-glm-relative-time.html#cb531-33" aria-hidden="true" tabindex="-1"></a>  stat_pth <span class="ot">&lt;-</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb531-34"><a href="univariate-glm-relative-time.html#cb531-34" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), <span class="st">&quot;stats&quot;</span>)</span>
<span id="cb531-35"><a href="univariate-glm-relative-time.html#cb531-35" aria-hidden="true" tabindex="-1"></a>  chk_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(stat_pth, <span class="st">&quot;zstat1.nii.gz&quot;</span>)</span>
<span id="cb531-36"><a href="univariate-glm-relative-time.html#cb531-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb531-37"><a href="univariate-glm-relative-time.html#cb531-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(chk_fn)){</span>
<span id="cb531-38"><a href="univariate-glm-relative-time.html#cb531-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb531-39"><a href="univariate-glm-relative-time.html#cb531-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">dir.exists</span>(stat_pth)){<span class="fu">unlink</span>(stat_pth, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb531-40"><a href="univariate-glm-relative-time.html#cb531-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(<span class="fu">c</span>(</span>
<span id="cb531-41"><a href="univariate-glm-relative-time.html#cb531-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;arguments = %s %s %s %s %s&quot;</span>,</span>
<span id="cb531-42"><a href="univariate-glm-relative-time.html#cb531-42" aria-hidden="true" tabindex="-1"></a>              df<span class="sc">$</span>filtered_func[i],</span>
<span id="cb531-43"><a href="univariate-glm-relative-time.html#cb531-43" aria-hidden="true" tabindex="-1"></a>              stat_pth,</span>
<span id="cb531-44"><a href="univariate-glm-relative-time.html#cb531-44" aria-hidden="true" tabindex="-1"></a>              <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb531-45"><a href="univariate-glm-relative-time.html#cb531-45" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), </span>
<span id="cb531-46"><a href="univariate-glm-relative-time.html#cb531-46" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;design.mat&quot;</span>),</span>
<span id="cb531-47"><a href="univariate-glm-relative-time.html#cb531-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>,df<span class="sc">$</span>sub_id[i]),</span>
<span id="cb531-48"><a href="univariate-glm-relative-time.html#cb531-48" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, df<span class="sc">$</span>run_no[i], df<span class="sc">$</span>block[i]), </span>
<span id="cb531-49"><a href="univariate-glm-relative-time.html#cb531-49" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;design.con&quot;</span>),</span>
<span id="cb531-50"><a href="univariate-glm-relative-time.html#cb531-50" aria-hidden="true" tabindex="-1"></a>              <span class="fu">file.path</span>(stat_pth, <span class="st">&quot;res4d.nii.gz&quot;</span>)</span>
<span id="cb531-51"><a href="univariate-glm-relative-time.html#cb531-51" aria-hidden="true" tabindex="-1"></a>              ),</span>
<span id="cb531-52"><a href="univariate-glm-relative-time.html#cb531-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;output = %s&quot;</span>, </span>
<span id="cb531-53"><a href="univariate-glm-relative-time.html#cb531-53" aria-hidden="true" tabindex="-1"></a>              <span class="fu">file.path</span>(htc_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_block%d.out&quot;</span>,</span>
<span id="cb531-54"><a href="univariate-glm-relative-time.html#cb531-54" aria-hidden="true" tabindex="-1"></a>                                         df<span class="sc">$</span>sub_id[i], df<span class="sc">$</span>run_name[i], df<span class="sc">$</span>block[i]))),</span>
<span id="cb531-55"><a href="univariate-glm-relative-time.html#cb531-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;error = %s&quot;</span>, </span>
<span id="cb531-56"><a href="univariate-glm-relative-time.html#cb531-56" aria-hidden="true" tabindex="-1"></a>              <span class="fu">file.path</span>(htc_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_block%d.err&quot;</span>,</span>
<span id="cb531-57"><a href="univariate-glm-relative-time.html#cb531-57" aria-hidden="true" tabindex="-1"></a>                                         df<span class="sc">$</span>sub_id[i], df<span class="sc">$</span>run_name[i], df<span class="sc">$</span>block[i]))),</span>
<span id="cb531-58"><a href="univariate-glm-relative-time.html#cb531-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;log = %s&quot;</span>, </span>
<span id="cb531-59"><a href="univariate-glm-relative-time.html#cb531-59" aria-hidden="true" tabindex="-1"></a>              <span class="fu">file.path</span>(htc_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_block%d.log&quot;</span>,</span>
<span id="cb531-60"><a href="univariate-glm-relative-time.html#cb531-60" aria-hidden="true" tabindex="-1"></a>                                         df<span class="sc">$</span>sub_id[i], df<span class="sc">$</span>run_name[i], df<span class="sc">$</span>block[i]))),</span>
<span id="cb531-61"><a href="univariate-glm-relative-time.html#cb531-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;queue&quot;</span>)</span>
<span id="cb531-62"><a href="univariate-glm-relative-time.html#cb531-62" aria-hidden="true" tabindex="-1"></a>    ),con)</span>
<span id="cb531-63"><a href="univariate-glm-relative-time.html#cb531-63" aria-hidden="true" tabindex="-1"></a>    c<span class="ot">=</span>c<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb531-64"><a href="univariate-glm-relative-time.html#cb531-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb531-65"><a href="univariate-glm-relative-time.html#cb531-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb531-66"><a href="univariate-glm-relative-time.html#cb531-66" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb531-67"><a href="univariate-glm-relative-time.html#cb531-67" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb531-68"><a href="univariate-glm-relative-time.html#cb531-68" aria-hidden="true" tabindex="-1"></a><span class="co"># submit to cluster</span></span>
<span id="cb531-69"><a href="univariate-glm-relative-time.html#cb531-69" aria-hidden="true" tabindex="-1"></a>batch_id <span class="ot">&lt;-</span> <span class="fu">system</span>(<span class="fu">paste</span>(<span class="st">&quot;condor_submit&quot;</span>, fn), <span class="at">intern =</span> <span class="cn">TRUE</span>)</span>
<span id="cb531-70"><a href="univariate-glm-relative-time.html#cb531-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-71"><a href="univariate-glm-relative-time.html#cb531-71" aria-hidden="true" tabindex="-1"></a><span class="co"># find batch ID and wait</span></span>
<span id="cb531-72"><a href="univariate-glm-relative-time.html#cb531-72" aria-hidden="true" tabindex="-1"></a>batch_id <span class="ot">&lt;-</span> <span class="fu">regmatches</span>(batch_id[<span class="dv">2</span>], <span class="fu">gregexpr</span>(<span class="st">&quot;[[:digit:]]+&quot;</span>, batch_id[<span class="dv">2</span>]))[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb531-73"><a href="univariate-glm-relative-time.html#cb531-73" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;submitted jobs (ID = %s) for 1st level GLM for parametric modulation by relative time. Time to wait...&quot;</span>, batch_id)</span>
<span id="cb531-74"><a href="univariate-glm-relative-time.html#cb531-74" aria-hidden="true" tabindex="-1"></a><span class="fu">pause_until_batch_done</span>(<span class="at">batch_id =</span> batch_id, <span class="at">wait_interval =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="group-level-1" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Group-level</h2>
<div id="move-first-level-images-to-mni-space-1" class="section level3 unnumbered">
<h3>Move first-level images to MNI space</h3>
<p>The first level output of each block is in each participant’s common functional space. For group-level stats we need to register the outputs to MNI (1mm) space.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="univariate-glm-relative-time.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># name of transformation matrix file to move from functional space to MNI 1mm</span></span>
<span id="cb532-2"><a href="univariate-glm-relative-time.html#cb532-2" aria-hidden="true" tabindex="-1"></a>func2standard <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>, <span class="fu">rep</span>(subjects, <span class="at">each =</span> n_blocks)),</span>
<span id="cb532-3"><a href="univariate-glm-relative-time.html#cb532-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, <span class="dv">2</span>, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_blocks, n_subs)), </span>
<span id="cb532-4"><a href="univariate-glm-relative-time.html#cb532-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;reg&quot;</span>, <span class="st">&quot;example_func2standard.mat&quot;</span>)</span>
<span id="cb532-5"><a href="univariate-glm-relative-time.html#cb532-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-6"><a href="univariate-glm-relative-time.html#cb532-6" aria-hidden="true" tabindex="-1"></a><span class="co"># parametric modulation result in whole-brain functional space</span></span>
<span id="cb532-7"><a href="univariate-glm-relative-time.html#cb532-7" aria-hidden="true" tabindex="-1"></a>in_nii_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(df<span class="sc">$</span>in_dir[i], <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s&quot;</span>, <span class="fu">rep</span>(subjects, <span class="at">each =</span> n_blocks)),</span>
<span id="cb532-8"><a href="univariate-glm-relative-time.html#cb532-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sprintf</span>(<span class="st">&quot;RSA_%02d_Block%02d.feat&quot;</span>, <span class="dv">2</span>, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_blocks, n_subs)), </span>
<span id="cb532-9"><a href="univariate-glm-relative-time.html#cb532-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;zstat1.nii.gz&quot;</span>)</span>
<span id="cb532-10"><a href="univariate-glm-relative-time.html#cb532-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-11"><a href="univariate-glm-relative-time.html#cb532-11" aria-hidden="true" tabindex="-1"></a><span class="co"># output folder &amp; file name in MNI space</span></span>
<span id="cb532-12"><a href="univariate-glm-relative-time.html#cb532-12" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, subjects), </span>
<span id="cb532-13"><a href="univariate-glm-relative-time.html#cb532-13" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(x) <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(x)) <span class="fu">dir.create</span>(x, <span class="at">recursive=</span><span class="cn">TRUE</span>)))</span>
<span id="cb532-14"><a href="univariate-glm-relative-time.html#cb532-14" aria-hidden="true" tabindex="-1"></a>out_nii_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="fu">rep</span>(subjects, <span class="at">each =</span> n_blocks),</span>
<span id="cb532-15"><a href="univariate-glm-relative-time.html#cb532-15" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_block%02d_rel_time_parametric_modulation.nii.gz&quot;</span>, </span>
<span id="cb532-16"><a href="univariate-glm-relative-time.html#cb532-16" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rep</span>(subjects, <span class="at">each =</span> n_blocks), <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_blocks, n_subs)))</span>
<span id="cb532-17"><a href="univariate-glm-relative-time.html#cb532-17" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb532-18"><a href="univariate-glm-relative-time.html#cb532-18" aria-hidden="true" tabindex="-1"></a><span class="co"># apply FSL flirt to move from whole-brain functional space to 1mm MNI space</span></span>
<span id="cb532-19"><a href="univariate-glm-relative-time.html#cb532-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">mapply</span>(flirt_apply,</span>
<span id="cb532-20"><a href="univariate-glm-relative-time.html#cb532-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">infile =</span> in_nii_fn, </span>
<span id="cb532-21"><a href="univariate-glm-relative-time.html#cb532-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">reffile =</span> <span class="fu">mni_fname</span>(<span class="st">&quot;1&quot;</span>),</span>
<span id="cb532-22"><a href="univariate-glm-relative-time.html#cb532-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">initmat =</span> func2standard,</span>
<span id="cb532-23"><a href="univariate-glm-relative-time.html#cb532-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">outfile =</span> out_nii_fn,</span>
<span id="cb532-24"><a href="univariate-glm-relative-time.html#cb532-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">retimg =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
</div>
<div id="merge-first-level-images" class="section level3 unnumbered">
<h3>Merge first-level images</h3>
<p>For each subject, we merge the results files from each block.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="univariate-glm-relative-time.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb533-2"><a href="univariate-glm-relative-time.html#cb533-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb533-3"><a href="univariate-glm-relative-time.html#cb533-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># input files</span></span>
<span id="cb533-4"><a href="univariate-glm-relative-time.html#cb533-4" aria-hidden="true" tabindex="-1"></a>  in_files <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, i_sub,</span>
<span id="cb533-5"><a href="univariate-glm-relative-time.html#cb533-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_block%02d_rel_time_parametric_modulation.nii.gz&quot;</span>, </span>
<span id="cb533-6"><a href="univariate-glm-relative-time.html#cb533-6" aria-hidden="true" tabindex="-1"></a>                                i_sub, <span class="dv">1</span><span class="sc">:</span>n_blocks))</span>
<span id="cb533-7"><a href="univariate-glm-relative-time.html#cb533-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb533-8"><a href="univariate-glm-relative-time.html#cb533-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output file name</span></span>
<span id="cb533-9"><a href="univariate-glm-relative-time.html#cb533-9" aria-hidden="true" tabindex="-1"></a>  fn_4d <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, i_sub,</span>
<span id="cb533-10"><a href="univariate-glm-relative-time.html#cb533-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_rel_time_parametric_modulation_merged.nii.gz&quot;</span>, i_sub))</span>
<span id="cb533-11"><a href="univariate-glm-relative-time.html#cb533-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb533-12"><a href="univariate-glm-relative-time.html#cb533-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># concatenate the images</span></span>
<span id="cb533-13"><a href="univariate-glm-relative-time.html#cb533-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fslmerge</span>(<span class="at">infiles =</span> in_files, <span class="at">direction =</span> <span class="st">&quot;t&quot;</span>, <span class="at">outfile =</span> fn_4d, <span class="at">retimg =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb533-14"><a href="univariate-glm-relative-time.html#cb533-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="smooth-first-level-images" class="section level3 unnumbered">
<h3>Smooth first-level images</h3>
<p>We smooth the first level images for each participant.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="univariate-glm-relative-time.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what smoothing to apply</span></span>
<span id="cb534-2"><a href="univariate-glm-relative-time.html#cb534-2" aria-hidden="true" tabindex="-1"></a>FWHM <span class="ot">=</span> <span class="dv">3</span> <span class="co"># in mm</span></span>
<span id="cb534-3"><a href="univariate-glm-relative-time.html#cb534-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> FWHM<span class="sc">/</span><span class="fl">2.3548</span> <span class="co"># fslmaths needs sigma not FWHM of kernel</span></span>
<span id="cb534-4"><a href="univariate-glm-relative-time.html#cb534-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-5"><a href="univariate-glm-relative-time.html#cb534-5" aria-hidden="true" tabindex="-1"></a><span class="co"># field of view mask</span></span>
<span id="cb534-6"><a href="univariate-glm-relative-time.html#cb534-6" aria-hidden="true" tabindex="-1"></a>fov_mask <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>mask_dir, <span class="st">&quot;fov&quot;</span>, <span class="st">&quot;fov_mask_mni.nii.gz&quot;</span>)</span>
<span id="cb534-7"><a href="univariate-glm-relative-time.html#cb534-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-8"><a href="univariate-glm-relative-time.html#cb534-8" aria-hidden="true" tabindex="-1"></a><span class="co"># open the task list</span></span>
<span id="cb534-9"><a href="univariate-glm-relative-time.html#cb534-9" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(htc_dir, <span class="st">&quot;smooth_rel_time_tasklist.txt&quot;</span>)</span>
<span id="cb534-10"><a href="univariate-glm-relative-time.html#cb534-10" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">file</span>(fn)</span>
<span id="cb534-11"><a href="univariate-glm-relative-time.html#cb534-11" aria-hidden="true" tabindex="-1"></a><span class="fu">open</span>(con, <span class="st">&quot;w&quot;</span>)</span>
<span id="cb534-12"><a href="univariate-glm-relative-time.html#cb534-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb534-13"><a href="univariate-glm-relative-time.html#cb534-13" aria-hidden="true" tabindex="-1"></a><span class="co"># file name of 4D output file</span></span>
<span id="cb534-14"><a href="univariate-glm-relative-time.html#cb534-14" aria-hidden="true" tabindex="-1"></a>fn_4d <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, subjects,</span>
<span id="cb534-15"><a href="univariate-glm-relative-time.html#cb534-15" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_rel_time_parametric_modulation_merged.nii.gz&quot;</span>, subjects))</span>
<span id="cb534-16"><a href="univariate-glm-relative-time.html#cb534-16" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb534-17"><a href="univariate-glm-relative-time.html#cb534-17" aria-hidden="true" tabindex="-1"></a><span class="co"># name of smoothed output file</span></span>
<span id="cb534-18"><a href="univariate-glm-relative-time.html#cb534-18" aria-hidden="true" tabindex="-1"></a>fn_4d_smooth <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, subjects,</span>
<span id="cb534-19"><a href="univariate-glm-relative-time.html#cb534-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_rel_time_parametric_modulation_merged_smoothed.nii.gz&quot;</span>, subjects))</span>
<span id="cb534-20"><a href="univariate-glm-relative-time.html#cb534-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-21"><a href="univariate-glm-relative-time.html#cb534-21" aria-hidden="true" tabindex="-1"></a><span class="co"># write smoothing command to file</span></span>
<span id="cb534-22"><a href="univariate-glm-relative-time.html#cb534-22" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">sprintf</span>(<span class="st">&quot;fslmaths %s -s %f -mas %s %s&quot;</span>, </span>
<span id="cb534-23"><a href="univariate-glm-relative-time.html#cb534-23" aria-hidden="true" tabindex="-1"></a>                   fn_4d, sigma, fov_mask, fn_4d_smooth), con)</span>
<span id="cb534-24"><a href="univariate-glm-relative-time.html#cb534-24" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb534-25"><a href="univariate-glm-relative-time.html#cb534-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-26"><a href="univariate-glm-relative-time.html#cb534-26" aria-hidden="true" tabindex="-1"></a><span class="co"># submit to cluster</span></span>
<span id="cb534-27"><a href="univariate-glm-relative-time.html#cb534-27" aria-hidden="true" tabindex="-1"></a>cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;fsl_sub -T 30 -t %s -l %s -M bellmund@cbs.mpg.de -N smooth_rel_time&quot;</span>, fn, htc_dir)</span>
<span id="cb534-28"><a href="univariate-glm-relative-time.html#cb534-28" aria-hidden="true" tabindex="-1"></a>batch_id <span class="ot">&lt;-</span> <span class="fu">system</span>(cmd, <span class="at">intern =</span> <span class="cn">TRUE</span>)</span>
<span id="cb534-29"><a href="univariate-glm-relative-time.html#cb534-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-30"><a href="univariate-glm-relative-time.html#cb534-30" aria-hidden="true" tabindex="-1"></a><span class="fu">pause_until_batch_done</span>(<span class="at">batch_id =</span> batch_id, <span class="at">wait_interval =</span> <span class="dv">20</span>)</span></code></pre></div>
</div>
<div id="average-first-level-images" class="section level3 unnumbered">
<h3>Average first-level images</h3>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="univariate-glm-relative-time.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb535-2"><a href="univariate-glm-relative-time.html#cb535-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fslmaths</span>(<span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, i_sub,</span>
<span id="cb535-3"><a href="univariate-glm-relative-time.html#cb535-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_rel_time_parametric_modulation_merged_smoothed.nii.gz&quot;</span>, i_sub)),</span>
<span id="cb535-4"><a href="univariate-glm-relative-time.html#cb535-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">outfile =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, i_sub,</span>
<span id="cb535-5"><a href="univariate-glm-relative-time.html#cb535-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_rel_time_parametric_modulation_merged_smoothed_mean.nii.gz&quot;</span>, i_sub)),</span>
<span id="cb535-6"><a href="univariate-glm-relative-time.html#cb535-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">retimg =</span> <span class="cn">FALSE</span>,</span>
<span id="cb535-7"><a href="univariate-glm-relative-time.html#cb535-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">opts =</span> <span class="st">&quot;-Tmean&quot;</span>,</span>
<span id="cb535-8"><a href="univariate-glm-relative-time.html#cb535-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb535-9"><a href="univariate-glm-relative-time.html#cb535-9" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb535-10"><a href="univariate-glm-relative-time.html#cb535-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that we have the mean parametric modulation effect for each participant, we concatenate the images across participants.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="univariate-glm-relative-time.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file names of files to merge</span></span>
<span id="cb536-2"><a href="univariate-glm-relative-time.html#cb536-2" aria-hidden="true" tabindex="-1"></a>in_files <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, subjects,</span>
<span id="cb536-3"><a href="univariate-glm-relative-time.html#cb536-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sprintf</span>(<span class="st">&quot;%s_post_rel_time_parametric_modulation_merged_smoothed_mean.nii.gz&quot;</span>, subjects))</span>
<span id="cb536-4"><a href="univariate-glm-relative-time.html#cb536-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-5"><a href="univariate-glm-relative-time.html#cb536-5" aria-hidden="true" tabindex="-1"></a><span class="co"># file name of 4D output file</span></span>
<span id="cb536-6"><a href="univariate-glm-relative-time.html#cb536-6" aria-hidden="true" tabindex="-1"></a>fn_4d <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;4D_rel_time_parametric_modulation.nii.gz&quot;</span>)</span>
<span id="cb536-7"><a href="univariate-glm-relative-time.html#cb536-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb536-8"><a href="univariate-glm-relative-time.html#cb536-8" aria-hidden="true" tabindex="-1"></a><span class="co"># concatenate the images</span></span>
<span id="cb536-9"><a href="univariate-glm-relative-time.html#cb536-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fslmerge</span>(<span class="at">infiles =</span> in_files, <span class="at">direction =</span> <span class="st">&quot;t&quot;</span>, <span class="at">outfile =</span> fn_4d, <span class="at">retimg =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="ahpc-roi-analysis" class="section level3 unnumbered">
<h3>aHPC ROI analysis</h3>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="univariate-glm-relative-time.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load 4D file with data of each participant</span></span>
<span id="cb537-2"><a href="univariate-glm-relative-time.html#cb537-2" aria-hidden="true" tabindex="-1"></a>in_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;4D_rel_time_parametric_modulation.nii.gz&quot;</span>)</span>
<span id="cb537-3"><a href="univariate-glm-relative-time.html#cb537-3" aria-hidden="true" tabindex="-1"></a>in_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(in_fn)</span>
<span id="cb537-4"><a href="univariate-glm-relative-time.html#cb537-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-5"><a href="univariate-glm-relative-time.html#cb537-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load ROI mask and binarize it and linearize </span></span>
<span id="cb537-6"><a href="univariate-glm-relative-time.html#cb537-6" aria-hidden="true" tabindex="-1"></a>aHPC_fn <span class="ot">&lt;-</span> aHPC_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;mri&quot;</span>, <span class="st">&quot;rois&quot;</span>, <span class="st">&quot;aHPC_lr&quot;</span>,</span>
<span id="cb537-7"><a href="univariate-glm-relative-time.html#cb537-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">sprintf</span>(<span class="st">&quot;%s_group_prob_mni1mm.nii.gz&quot;</span>, <span class="st">&quot;aHPC_lr&quot;</span>))</span>
<span id="cb537-8"><a href="univariate-glm-relative-time.html#cb537-8" aria-hidden="true" tabindex="-1"></a>aHPC_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(aHPC_fn)</span>
<span id="cb537-9"><a href="univariate-glm-relative-time.html#cb537-9" aria-hidden="true" tabindex="-1"></a>aHPC_nii[aHPC_nii <span class="sc">&gt;</span><span class="fl">0.99</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb537-10"><a href="univariate-glm-relative-time.html#cb537-10" aria-hidden="true" tabindex="-1"></a>aHPC_nii[aHPC_nii <span class="sc">!=</span><span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb537-11"><a href="univariate-glm-relative-time.html#cb537-11" aria-hidden="true" tabindex="-1"></a>aHPC_lin <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(<span class="fu">c</span>(aHPC_nii))</span>
<span id="cb537-12"><a href="univariate-glm-relative-time.html#cb537-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb537-13"><a href="univariate-glm-relative-time.html#cb537-13" aria-hidden="true" tabindex="-1"></a>aHPC_rel_time <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">pmod =</span> <span class="fu">rep</span>(<span class="dv">0</span>,n_subs))</span>
<span id="cb537-14"><a href="univariate-glm-relative-time.html#cb537-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_subs){</span>
<span id="cb537-15"><a href="univariate-glm-relative-time.html#cb537-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-16"><a href="univariate-glm-relative-time.html#cb537-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get this subject&#39;s data from aHPC</span></span>
<span id="cb537-17"><a href="univariate-glm-relative-time.html#cb537-17" aria-hidden="true" tabindex="-1"></a>  curr_nii <span class="ot">&lt;-</span> in_nii[,,,i_sub]</span>
<span id="cb537-18"><a href="univariate-glm-relative-time.html#cb537-18" aria-hidden="true" tabindex="-1"></a>  curr_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(curr_nii)</span>
<span id="cb537-19"><a href="univariate-glm-relative-time.html#cb537-19" aria-hidden="true" tabindex="-1"></a>  curr_dat <span class="ot">&lt;-</span> curr_dat[aHPC_lin]</span>
<span id="cb537-20"><a href="univariate-glm-relative-time.html#cb537-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb537-21"><a href="univariate-glm-relative-time.html#cb537-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># store mean across aHPC voxels</span></span>
<span id="cb537-22"><a href="univariate-glm-relative-time.html#cb537-22" aria-hidden="true" tabindex="-1"></a>  aHPC_rel_time<span class="sc">$</span>pmod[i_sub] <span class="ot">&lt;-</span> <span class="fu">mean</span>(curr_dat)</span>
<span id="cb537-23"><a href="univariate-glm-relative-time.html#cb537-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb537-24"><a href="univariate-glm-relative-time.html#cb537-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb537-25"><a href="univariate-glm-relative-time.html#cb537-25" aria-hidden="true" tabindex="-1"></a><span class="co"># across subject statistics</span></span>
<span id="cb537-26"><a href="univariate-glm-relative-time.html#cb537-26" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">paired_t_perm_jb</span> (aHPC_rel_time<span class="sc">$</span>pmod, <span class="at">n_perm =</span> n_perm)</span></code></pre></div>
</div>
<div id="run-fsl-randomise-1" class="section level3 unnumbered">
<h3>Run FSL Randomise</h3>
<p>Now we are ready to run FSL Randomise.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="univariate-glm-relative-time.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># open the task list</span></span>
<span id="cb538-2"><a href="univariate-glm-relative-time.html#cb538-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(htc_dir, <span class="st">&quot;glm_rel_time_randomise_tasklist.txt&quot;</span>)</span>
<span id="cb538-3"><a href="univariate-glm-relative-time.html#cb538-3" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">file</span>(fn)</span>
<span id="cb538-4"><a href="univariate-glm-relative-time.html#cb538-4" aria-hidden="true" tabindex="-1"></a><span class="fu">open</span>(con, <span class="st">&quot;w&quot;</span>)</span>
<span id="cb538-5"><a href="univariate-glm-relative-time.html#cb538-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-6"><a href="univariate-glm-relative-time.html#cb538-6" aria-hidden="true" tabindex="-1"></a><span class="co"># masks to use</span></span>
<span id="cb538-7"><a href="univariate-glm-relative-time.html#cb538-7" aria-hidden="true" tabindex="-1"></a>gm_mask_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>mask_dir, <span class="st">&quot;gray_matter&quot;</span>, <span class="st">&quot;gray_matter_mask.nii.gz&quot;</span>)</span>
<span id="cb538-8"><a href="univariate-glm-relative-time.html#cb538-8" aria-hidden="true" tabindex="-1"></a>svc_mask_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>mask_dir, <span class="st">&quot;svc&quot;</span>, <span class="st">&quot;svc_mask.nii.gz&quot;</span>)</span>
<span id="cb538-9"><a href="univariate-glm-relative-time.html#cb538-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-10"><a href="univariate-glm-relative-time.html#cb538-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4D input image to run randomise on</span></span>
<span id="cb538-11"><a href="univariate-glm-relative-time.html#cb538-11" aria-hidden="true" tabindex="-1"></a>in_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;4D_rel_time_parametric_modulation.nii.gz&quot;</span>)</span>
<span id="cb538-12"><a href="univariate-glm-relative-time.html#cb538-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb538-13"><a href="univariate-glm-relative-time.html#cb538-13" aria-hidden="true" tabindex="-1"></a><span class="co"># output file name for FOV</span></span>
<span id="cb538-14"><a href="univariate-glm-relative-time.html#cb538-14" aria-hidden="true" tabindex="-1"></a>out_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;randomise_rel_time_parametric_modulation_fov&quot;</span>)</span>
<span id="cb538-15"><a href="univariate-glm-relative-time.html#cb538-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-16"><a href="univariate-glm-relative-time.html#cb538-16" aria-hidden="true" tabindex="-1"></a><span class="co"># define randomise command for full FOV and write to file</span></span>
<span id="cb538-17"><a href="univariate-glm-relative-time.html#cb538-17" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">sprintf</span>(<span class="st">&quot;randomise -i %s -o %s -1 -T --uncorrp -m %s -n 5000&quot;</span>,</span>
<span id="cb538-18"><a href="univariate-glm-relative-time.html#cb538-18" aria-hidden="true" tabindex="-1"></a>                   in_fn, out_fn, gm_mask_fn),con)</span>
<span id="cb538-19"><a href="univariate-glm-relative-time.html#cb538-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-20"><a href="univariate-glm-relative-time.html#cb538-20" aria-hidden="true" tabindex="-1"></a><span class="co"># output file name for SVC</span></span>
<span id="cb538-21"><a href="univariate-glm-relative-time.html#cb538-21" aria-hidden="true" tabindex="-1"></a>out_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;randomise_rel_time_parametric_modulation_svc&quot;</span>)</span>
<span id="cb538-22"><a href="univariate-glm-relative-time.html#cb538-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-23"><a href="univariate-glm-relative-time.html#cb538-23" aria-hidden="true" tabindex="-1"></a><span class="co"># define randomise command for small-volume correction and and write to file</span></span>
<span id="cb538-24"><a href="univariate-glm-relative-time.html#cb538-24" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">sprintf</span>(<span class="st">&quot;randomise -i %s -o %s -1 -T --uncorrp -m %s -n 5000&quot;</span>,</span>
<span id="cb538-25"><a href="univariate-glm-relative-time.html#cb538-25" aria-hidden="true" tabindex="-1"></a>                   in_fn, out_fn, svc_mask_fn),con)</span>
<span id="cb538-26"><a href="univariate-glm-relative-time.html#cb538-26" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb538-27"><a href="univariate-glm-relative-time.html#cb538-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-28"><a href="univariate-glm-relative-time.html#cb538-28" aria-hidden="true" tabindex="-1"></a><span class="co"># submit to cluster</span></span>
<span id="cb538-29"><a href="univariate-glm-relative-time.html#cb538-29" aria-hidden="true" tabindex="-1"></a>cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;fsl_sub -T 300 -t %s -l %s -M bellmund@cbs.mpg.de -N randomise_rel_time&quot;</span>, fn, htc_dir)</span>
<span id="cb538-30"><a href="univariate-glm-relative-time.html#cb538-30" aria-hidden="true" tabindex="-1"></a>batch_id <span class="ot">&lt;-</span> <span class="fu">system</span>(cmd, <span class="at">intern =</span> <span class="cn">TRUE</span>)</span>
<span id="cb538-31"><a href="univariate-glm-relative-time.html#cb538-31" aria-hidden="true" tabindex="-1"></a><span class="fu">pause_until_batch_done</span>(<span class="at">batch_id =</span> batch_id, <span class="at">wait_interval =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="results-in-ahpc-and-alec" class="section level3 unnumbered">
<h3>Results in aHPC and alEC</h3>
<p>Let’s first have a look at the results in our a priori regions of interest, the aHPC and the alEC. For this we have run randomise using the small volume correction mask that includes these areas. We create a figure of the results at a liberal threshold.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="univariate-glm-relative-time.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 mm MNI template as background image</span></span>
<span id="cb539-2"><a href="univariate-glm-relative-time.html#cb539-2" aria-hidden="true" tabindex="-1"></a>mni_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;MNI152_T1_1mm_brain.nii.gz&quot;</span>)</span>
<span id="cb539-3"><a href="univariate-glm-relative-time.html#cb539-3" aria-hidden="true" tabindex="-1"></a>mni_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(mni_fn)</span>
<span id="cb539-4"><a href="univariate-glm-relative-time.html#cb539-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-5"><a href="univariate-glm-relative-time.html#cb539-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load FOV mask and binarize it</span></span>
<span id="cb539-6"><a href="univariate-glm-relative-time.html#cb539-6" aria-hidden="true" tabindex="-1"></a>fov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;mni1mm_masks&quot;</span>, <span class="st">&quot;fov_mask_mni.nii.gz&quot;</span>)</span>
<span id="cb539-7"><a href="univariate-glm-relative-time.html#cb539-7" aria-hidden="true" tabindex="-1"></a>fov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fov_fn)</span>
<span id="cb539-8"><a href="univariate-glm-relative-time.html#cb539-8" aria-hidden="true" tabindex="-1"></a>fov_nii[fov_nii <span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb539-9"><a href="univariate-glm-relative-time.html#cb539-9" aria-hidden="true" tabindex="-1"></a>fov_nii[fov_nii <span class="sc">!=</span><span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb539-10"><a href="univariate-glm-relative-time.html#cb539-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-11"><a href="univariate-glm-relative-time.html#cb539-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make a mask for the brain area outside our FOV</span></span>
<span id="cb539-12"><a href="univariate-glm-relative-time.html#cb539-12" aria-hidden="true" tabindex="-1"></a>out_fov <span class="ot">&lt;-</span> (fov_nii <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (mni_nii<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb539-13"><a href="univariate-glm-relative-time.html#cb539-13" aria-hidden="true" tabindex="-1"></a>mni_nii[out_fov] <span class="ot">&lt;-</span> scales<span class="sc">::</span><span class="fu">rescale</span>(mni_nii[out_fov], <span class="at">from=</span><span class="fu">range</span>(mni_nii[out_fov]), <span class="at">to=</span><span class="fu">c</span>(<span class="dv">6000</span>, <span class="dv">8207</span>))</span>
<span id="cb539-14"><a href="univariate-glm-relative-time.html#cb539-14" aria-hidden="true" tabindex="-1"></a>mni_nii[mni_nii <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb539-15"><a href="univariate-glm-relative-time.html#cb539-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-16"><a href="univariate-glm-relative-time.html#cb539-16" aria-hidden="true" tabindex="-1"></a><span class="co"># load image with uncorrected p-values in SVC</span></span>
<span id="cb539-17"><a href="univariate-glm-relative-time.html#cb539-17" aria-hidden="true" tabindex="-1"></a>uncorrpsvc_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;randomise_rel_time_parametric_modulation_svc_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb539-18"><a href="univariate-glm-relative-time.html#cb539-18" aria-hidden="true" tabindex="-1"></a>uncorrpsvc_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(uncorrpsvc_fn)</span>
<span id="cb539-19"><a href="univariate-glm-relative-time.html#cb539-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-20"><a href="univariate-glm-relative-time.html#cb539-20" aria-hidden="true" tabindex="-1"></a><span class="co"># load image with corrected p-values in SVC</span></span>
<span id="cb539-21"><a href="univariate-glm-relative-time.html#cb539-21" aria-hidden="true" tabindex="-1"></a>corrpsvc_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;randomise_rel_time_parametric_modulation_svc_tfce_corrp_tstat1.nii.gz&quot;</span>)</span>
<span id="cb539-22"><a href="univariate-glm-relative-time.html#cb539-22" aria-hidden="true" tabindex="-1"></a>corrpsvc_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(corrpsvc_fn)</span>
<span id="cb539-23"><a href="univariate-glm-relative-time.html#cb539-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-24"><a href="univariate-glm-relative-time.html#cb539-24" aria-hidden="true" tabindex="-1"></a><span class="co"># t-values to plot (SVC)</span></span>
<span id="cb539-25"><a href="univariate-glm-relative-time.html#cb539-25" aria-hidden="true" tabindex="-1"></a>tvals_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;randomise_rel_time_parametric_modulation_svc_tstat1.nii.gz&quot;</span>)</span>
<span id="cb539-26"><a href="univariate-glm-relative-time.html#cb539-26" aria-hidden="true" tabindex="-1"></a>t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(tvals_fn)</span>
<span id="cb539-27"><a href="univariate-glm-relative-time.html#cb539-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-28"><a href="univariate-glm-relative-time.html#cb539-28" aria-hidden="true" tabindex="-1"></a><span class="co"># find coordinates of voxel with minimum p-value (image is 1-p) and get a data frame for labeling the plots</span></span>
<span id="cb539-29"><a href="univariate-glm-relative-time.html#cb539-29" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">which</span>(t_nii <span class="sc">==</span> <span class="fu">max</span>(t_nii), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb539-30"><a href="univariate-glm-relative-time.html#cb539-30" aria-hidden="true" tabindex="-1"></a><span class="co">#coords &lt;- mni2vox(coords)</span></span>
<span id="cb539-31"><a href="univariate-glm-relative-time.html#cb539-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-32"><a href="univariate-glm-relative-time.html#cb539-32" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb539-33"><a href="univariate-glm-relative-time.html#cb539-33" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;peak voxel of relative time parametric modulation in SVC at MNI x=%d, y=%d, z=%d, t=%.2f, puncorr=%.3f, pcorr=%.3f&quot;</span>,</span>
<span id="cb539-34"><a href="univariate-glm-relative-time.html#cb539-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">vox2mni</span>(coords)[<span class="dv">1</span>], <span class="fu">vox2mni</span>(coords)[<span class="dv">2</span>], <span class="fu">vox2mni</span>(coords)[<span class="dv">3</span>], t_nii[coords], <span class="dv">1</span><span class="sc">-</span>uncorrpsvc_nii[coords], <span class="dv">1</span><span class="sc">-</span>corrpsvc_nii[coords])</span></code></pre></div>
<pre><code>## [1] &quot;peak voxel of relative time parametric modulation in SVC at MNI x=22, y=-13, z=-16, t=3.93, puncorr=0.001, pcorr=0.173&quot;</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="univariate-glm-relative-time.html#cb541-1" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="fu">vox2mni</span>(coords)),</span>
<span id="cb541-2"><a href="univariate-glm-relative-time.html#cb541-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="fu">vox2mni</span>(coords)))</span>
<span id="cb541-3"><a href="univariate-glm-relative-time.html#cb541-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-4"><a href="univariate-glm-relative-time.html#cb541-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get ggplot object for template as background</span></span>
<span id="cb541-5"><a href="univariate-glm-relative-time.html#cb541-5" aria-hidden="true" tabindex="-1"></a>ggTemplate<span class="ot">&lt;-</span><span class="fu">getggTemplate</span>(<span class="at">col_template=</span><span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&#39;Greys&#39;</span>)),<span class="at">brains=</span>mni_nii,</span>
<span id="cb541-6"><a href="univariate-glm-relative-time.html#cb541-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">all_brain_and_time_inds_one=</span><span class="cn">TRUE</span>,</span>
<span id="cb541-7"><a href="univariate-glm-relative-time.html#cb541-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar_ind=</span>coords, <span class="at">row_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb541-8"><a href="univariate-glm-relative-time.html#cb541-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col_ind=</span><span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb541-9"><a href="univariate-glm-relative-time.html#cb541-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-10"><a href="univariate-glm-relative-time.html#cb541-10" aria-hidden="true" tabindex="-1"></a><span class="co"># threshold t-values for plotting</span></span>
<span id="cb541-11"><a href="univariate-glm-relative-time.html#cb541-11" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.05</span> </span>
<span id="cb541-12"><a href="univariate-glm-relative-time.html#cb541-12" aria-hidden="true" tabindex="-1"></a>t_nii[uncorrpsvc_nii <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">-</span>thresh] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb541-13"><a href="univariate-glm-relative-time.html#cb541-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-14"><a href="univariate-glm-relative-time.html#cb541-14" aria-hidden="true" tabindex="-1"></a><span class="co"># get data frame for the t-values</span></span>
<span id="cb541-15"><a href="univariate-glm-relative-time.html#cb541-15" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">getBrainFrame</span>(<span class="at">brains=</span>t_nii, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb541-16"><a href="univariate-glm-relative-time.html#cb541-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_ind =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s=%d&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>),<span class="fu">vox2mni</span>(coords)), </span>
<span id="cb541-17"><a href="univariate-glm-relative-time.html#cb541-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar_ind=</span>coords, <span class="at">mask=</span><span class="cn">NULL</span>, <span class="at">center_coords=</span><span class="cn">TRUE</span>)</span>
<span id="cb541-18"><a href="univariate-glm-relative-time.html#cb541-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-19"><a href="univariate-glm-relative-time.html#cb541-19" aria-hidden="true" tabindex="-1"></a>fig_rel_time <span class="ot">&lt;-</span> ggTemplate <span class="sc">+</span></span>
<span id="cb541-20"><a href="univariate-glm-relative-time.html#cb541-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>t_df, <span class="fu">aes</span>(<span class="at">x=</span>row,<span class="at">y=</span>col,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb541-21"><a href="univariate-glm-relative-time.html#cb541-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>col_ind, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">strip.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb541-22"><a href="univariate-glm-relative-time.html#cb541-22" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">palette =</span> <span class="st">&quot;lajolla&quot;</span>, </span>
<span id="cb541-23"><a href="univariate-glm-relative-time.html#cb541-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end=</span><span class="fl">0.9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb541-24"><a href="univariate-glm-relative-time.html#cb541-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">name =</span> <span class="fu">element_text</span>(<span class="st">&quot;t&quot;</span>),</span>
<span id="cb541-25"><a href="univariate-glm-relative-time.html#cb541-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">limits =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb541-26"><a href="univariate-glm-relative-time.html#cb541-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">range</span>(t_df<span class="sc">$</span>value), <span class="at">digits=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb541-27"><a href="univariate-glm-relative-time.html#cb541-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(label = &quot;\ndifferent\nsequence&quot;) +</span></span>
<span id="cb541-28"><a href="univariate-glm-relative-time.html#cb541-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>(<span class="at">line_size =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb541-29"><a href="univariate-glm-relative-time.html#cb541-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb541-30"><a href="univariate-glm-relative-time.html#cb541-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb541-31"><a href="univariate-glm-relative-time.html#cb541-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>, <span class="at">family=</span>font2use),</span>
<span id="cb541-32"><a href="univariate-glm-relative-time.html#cb541-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>, <span class="at">family=</span>font2use), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>, <span class="at">family=</span>font2use),</span>
<span id="cb541-33"><a href="univariate-glm-relative-time.html#cb541-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb541-34"><a href="univariate-glm-relative-time.html#cb541-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb541-35"><a href="univariate-glm-relative-time.html#cb541-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb541-36"><a href="univariate-glm-relative-time.html#cb541-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb541-37"><a href="univariate-glm-relative-time.html#cb541-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb541-38"><a href="univariate-glm-relative-time.html#cb541-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb541-39"><a href="univariate-glm-relative-time.html#cb541-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb541-40"><a href="univariate-glm-relative-time.html#cb541-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="dv">0</span>,</span>
<span id="cb541-41"><a href="univariate-glm-relative-time.html#cb541-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;right&quot;</span>))<span class="sc">+</span></span>
<span id="cb541-42"><a href="univariate-glm-relative-time.html#cb541-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb541-43"><a href="univariate-glm-relative-time.html#cb541-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb541-44"><a href="univariate-glm-relative-time.html#cb541-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> label_df, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb541-45"><a href="univariate-glm-relative-time.html#cb541-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">vjust=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb541-46"><a href="univariate-glm-relative-time.html#cb541-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_no_ticks</span>()</span>
<span id="cb541-47"><a href="univariate-glm-relative-time.html#cb541-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-48"><a href="univariate-glm-relative-time.html#cb541-48" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;letter_glm_rel_time_aHPC_svc&quot;</span>)</span>
<span id="cb541-49"><a href="univariate-glm-relative-time.html#cb541-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>fig_rel_time, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb541-50"><a href="univariate-glm-relative-time.html#cb541-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb541-51"><a href="univariate-glm-relative-time.html#cb541-51" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>fig_rel_time, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb541-52"><a href="univariate-glm-relative-time.html#cb541-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span>
<span id="cb541-53"><a href="univariate-glm-relative-time.html#cb541-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig_rel_time)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-276-1.png" width="672" /></p>
</div>
<div id="fov-results" class="section level3 unnumbered">
<h3>FOV results</h3>
<p>We check how many voxels survive at an uncorrected p-threshold of 0.001 in our FOV.
No clusters are visible at an uncorrected threshold of p&lt;0.001.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="univariate-glm-relative-time.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load image with uncorrected p-values in FOV</span></span>
<span id="cb542-2"><a href="univariate-glm-relative-time.html#cb542-2" aria-hidden="true" tabindex="-1"></a>uncorrpfov_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>level1glm_dir, <span class="st">&quot;mni&quot;</span>, <span class="st">&quot;randomise_rel_time_parametric_modulation_fov_tfce_p_tstat1.nii.gz&quot;</span>)</span>
<span id="cb542-3"><a href="univariate-glm-relative-time.html#cb542-3" aria-hidden="true" tabindex="-1"></a>uncorrpfov_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(uncorrpfov_fn)</span>
<span id="cb542-4"><a href="univariate-glm-relative-time.html#cb542-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-5"><a href="univariate-glm-relative-time.html#cb542-5" aria-hidden="true" tabindex="-1"></a>thresh <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb542-6"><a href="univariate-glm-relative-time.html#cb542-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">c</span>(uncorrpfov_nii)<span class="sc">&gt;</span>(<span class="dv">1</span><span class="sc">-</span>thresh)) <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb542-7"><a href="univariate-glm-relative-time.html#cb542-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print to screen </span></span>
<span id="cb542-8"><a href="univariate-glm-relative-time.html#cb542-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;no significant voxels in parametric modulation analysis at p&lt;&quot;</span>,</span>
<span id="cb542-9"><a href="univariate-glm-relative-time.html#cb542-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sprintf</span>(<span class="st">&quot;%.3f (uncorrected)&quot;</span>,thresh))</span>
<span id="cb542-10"><a href="univariate-glm-relative-time.html#cb542-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## no significant voxels in parametric modulation analysis at p&lt; 0.001 (uncorrected)</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rsa-in-searchlight-peak-with-different-threshold.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="credit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
