<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Behavioral Analysis | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</title>
  <meta name="description" content="5 Behavioral Analysis | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Behavioral Analysis | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jacbel.github.io/virtem_code/" />
  
  <meta property="og:description" content="5 Behavioral Analysis | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="github-repo" content="jacbel/virtem_code" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Behavioral Analysis | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  
  <meta name="twitter:description" content="5 Behavioral Analysis | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  

<meta name="author" content="Jacob L. S. Bellmund" />


<meta name="date" content="2022-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prepare-behavioral-data.html"/>
<link rel="next" href="prepare-fmri-data.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contents"><i class="fa fa-check"></i><b>1.2</b> Contents</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.3</b> Contact</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#license-information"><i class="fa fa-check"></i><b>1.4</b> License Information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analysis-setup.html"><a href="analysis-setup.html"><i class="fa fa-check"></i><b>2</b> Analysis Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analysis-setup.html"><a href="analysis-setup.html#defining-variables-and-folders"><i class="fa fa-check"></i><b>2.1</b> Defining Variables and Folders</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#folder-structure"><i class="fa fa-check"></i>Folder Structure</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="analysis-setup.html"><a href="analysis-setup.html#define-analysis-functions"><i class="fa fa-check"></i><b>2.2</b> Define Analysis Functions</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#analysis-logic"><i class="fa fa-check"></i>Analysis Logic</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#brain-plots-in-ggplot"><i class="fa fa-check"></i>Brain Plots in ggplot</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#ggbrain-functions-to-get-template-background"><i class="fa fa-check"></i>ggBrain functions to get template background</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#waiting-for-cluster-jobs"><i class="fa fa-check"></i>Waiting for Cluster Jobs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html"><i class="fa fa-check"></i><b>3</b> Illustrations of Task Design and Analysis Logic</a>
<ul>
<li class="chapter" data-level="3.1" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#day-learning-task-design"><i class="fa fa-check"></i><b>3.1</b> Day Learning Task Design</a>
<ul>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-and-real-time"><i class="fa fa-check"></i>Events in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-time"><i class="fa fa-check"></i>Events in virtual time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-real-time"><i class="fa fa-check"></i>Events in real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#correlations-of-virtual-time-with-order-and-real-time"><i class="fa fa-check"></i>Correlations of virtual time with order and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#time-cues-in-virtual-and-real-time"><i class="fa fa-check"></i>Time cues in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#supplemental-figure-for-task-design"><i class="fa fa-check"></i>Supplemental figure for task design</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#representational-similarity-analysis-logic"><i class="fa fa-check"></i><b>3.2</b> Representational Similarity Analysis Logic</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html"><i class="fa fa-check"></i><b>4</b> Prepare behavioral data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#sorting-task"><i class="fa fa-check"></i><b>4.1</b> Sorting task</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#timeline-task"><i class="fa fa-check"></i><b>4.2</b> Timeline task</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#picture-viewing-tasks"><i class="fa fa-check"></i><b>4.3</b> Picture viewing tasks</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html"><i class="fa fa-check"></i><b>5</b> Behavioral Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-task-1"><i class="fa fa-check"></i><b>5.1</b> Sorting Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#calculate-percentage-of-correct-responses"><i class="fa fa-check"></i>Calculate percentage of correct responses</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#plot-sorting-performance"><i class="fa fa-check"></i>Plot sorting performance</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Sorting errors as a function of sequence position</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#timeline-task-1"><i class="fa fa-check"></i><b>5.2</b> Timeline Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#visualize-the-raw-data"><i class="fa fa-check"></i>Visualize the raw data</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#accuracy-of-remembered-times"><i class="fa fa-check"></i>Accuracy of remembered times</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#relationship-of-sorting-errors-and-timeline-errors"><i class="fa fa-check"></i>Relationship of sorting errors and timeline errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#time-metrics-underlying-remembered-times"><i class="fa fa-check"></i>Time metrics underlying remembered times</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#compose-figure-for-behavioral-data"><i class="fa fa-check"></i>Compose Figure for Behavioral Data</a></li>
<li class="chapter" data-level="5.3" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#generalization-bias"><i class="fa fa-check"></i><b>5.3</b> Generalization bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#test-generalization-bias"><i class="fa fa-check"></i>Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-of-generalization-bias"><i class="fa fa-check"></i><b>5.4</b> Replication of Generalization Bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Replication data: Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-test-generalization-bias"><i class="fa fa-check"></i>Replication data: Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors"><i class="fa fa-check"></i><b>5.5</b> Swap Errors</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#descriptives-of-swap-errors"><i class="fa fa-check"></i>Descriptives of swap errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Swap errors as a function of sequence position</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-error-more-frequent-than-expected-from-chance"><i class="fa fa-check"></i>Swap error: More frequent than expected from chance?</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-and-generalization-bias"><i class="fa fa-check"></i>Swap errors and generalization bias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html"><i class="fa fa-check"></i><b>6</b> Prepare (f)MRI Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#regions-of-interest"><i class="fa fa-check"></i><b>6.1</b> Regions of Interest</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#freesurfer-masks"><i class="fa fa-check"></i>FreeSurfer Masks</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#subregion-masks-mni"><i class="fa fa-check"></i>Subregion masks (MNI)</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#final-rois-from-intersection-of-masks"><i class="fa fa-check"></i>Final ROIs from intersection of masks</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#group-level-masks"><i class="fa fa-check"></i><b>6.2</b> Group-Level Masks</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#probabilistic-rois-for-visualization"><i class="fa fa-check"></i>Probabilistic ROIs for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#field-of-view-mask-for-visualization"><i class="fa fa-check"></i>Field of view mask for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#gray-matter-mask"><i class="fa fa-check"></i>Gray matter mask</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#small-volume-correction-mask"><i class="fa fa-check"></i>Small Volume Correction Mask</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#quantify-representational-change"><i class="fa fa-check"></i><b>6.3</b> Quantify Representational Change</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#get-multi-voxel-patterns-from-rois"><i class="fa fa-check"></i>Get multi-voxel patterns from ROIs</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-correlation-matrices"><i class="fa fa-check"></i>Calculate correlation matrices</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-pattern-similarity-change"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#combine-behavioral-and-fmri-data-for-rsa"><i class="fa fa-check"></i><b>6.4</b> Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html"><i class="fa fa-check"></i><b>7</b> Run RSA Searchlight</a>
<ul>
<li class="chapter" data-level="7.1" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-functional-data"><i class="fa fa-check"></i><b>7.1</b> Prepare functional data</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#data-cleaning-extract-residuals-from-motion-parameter-regression"><i class="fa fa-check"></i>Data cleaning: Extract residuals from motion parameter regression</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#extract-relevant-volumes-1"><i class="fa fa-check"></i>Extract relevant volumes</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#concatenate-relevant-volumes"><i class="fa fa-check"></i>Concatenate relevant volumes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#first-level-rsa-searchlight"><i class="fa fa-check"></i><b>7.2</b> First-level RSA searchlight</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#set-analysis-parameters"><i class="fa fa-check"></i>Set analysis parameters</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-predictions"><i class="fa fa-check"></i>Prepare RSA-predictions</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-lookup-table-for-searchlight"><i class="fa fa-check"></i>Create lookup table for searchlight</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#dataframe-with-input-for-analysis"><i class="fa fa-check"></i>Dataframe with input for analysis</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#searchlight-implementation"><i class="fa fa-check"></i>Searchlight implementation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#group-level-searchlight-analysis"><i class="fa fa-check"></i><b>7.3</b> Group-level searchlight analysis</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#move-first-level-images-to-mni-space"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#merge-and-smooth-first-level-images"><i class="fa fa-check"></i>Merge and smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#run-fsl-randomise"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#find-searchlight-clusters-and-atlas-labels"><i class="fa fa-check"></i>Find searchlight clusters and atlas labels</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-outlines-of-significant-clusters"><i class="fa fa-check"></i>Create outlines of significant clusters</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-in-searchlight-peak"><i class="fa fa-check"></i><b>7.4</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-the-roi-mask"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculating-the-correlation-matrices"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculate-pattern-similarity-change-1"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#combine-behavioral-and-fmri-data-for-rsa-1"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html"><i class="fa fa-check"></i><b>8</b> RSA on Pattern Similarity Change</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#time-metrics-to-quantify-event-relations"><i class="fa fa-check"></i><b>8.1</b> Time metrics to quantify event relations</a></li>
<li class="chapter" data-level="8.2" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualize-regions-of-interests"><i class="fa fa-check"></i><b>8.2</b> Visualize Regions of Interests</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#template-background-image-with-fov"><i class="fa fa-check"></i>Template background image with FOV</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-hippocampus-roi"><i class="fa fa-check"></i>Anterior hippocampus ROI</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-lateral-entorhinal-cortex"><i class="fa fa-check"></i>Anterior-lateral entorhinal cortex</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#first-level-rsa"><i class="fa fa-check"></i><b>8.3</b> First-level RSA</a></li>
<li class="chapter" data-level="8.4" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence"><i class="fa fa-check"></i><b>8.4</b> aHPC: virtual time within sequence</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-3"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-2"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#not-driven-by-first-last-event-pairs"><i class="fa fa-check"></i>Not driven by first &amp; last event pairs</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.5</b> aHPC: virtual time within sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#one-model-with-multiple-predictors"><i class="fa fa-check"></i>One model with multiple predictors</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-explains-residuals-of-order-and-real-time"><i class="fa fa-check"></i>Virtual time explains residuals of order and real time</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequences"><i class="fa fa-check"></i><b>8.6</b> aHPC: virtual time across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-7"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-5"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization-1"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.7</b> aHPC: virtual time across sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-8"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-6"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i><b>8.8</b> aHPC: virtual time within vs. across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#second-level-analysis"><i class="fa fa-check"></i>Second-level analysis</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-7"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-order"><i class="fa fa-check"></i>Interaction of sequence membership and order</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-real-time"><i class="fa fa-check"></i>Interaction of sequence membership and real time</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-virtual-time-when-including-interactions-with-other-time-metrics"><i class="fa fa-check"></i>Interaction of sequence membership and virtual time when including interactions with other time metrics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mds"><i class="fa fa-check"></i>MDS</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#umap"><i class="fa fa-check"></i>UMAP</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec"><i class="fa fa-check"></i><b>8.9</b> alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-withinacross-sequences-separately"><i class="fa fa-check"></i>alEC: virtual time within/across sequences separately</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i>alEC: virtual time within vs. across sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs"><i class="fa fa-check"></i>alEC: virtual time for all event pairs</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs-when-including-order-real-time"><i class="fa fa-check"></i>alEC: virtual time for all event pairs when including order &amp; real time</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-vs.-alec"><i class="fa fa-check"></i><b>8.10</b> aHPC vs. alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-12"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-10"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#searchlight-results"><i class="fa fa-check"></i><b>8.11</b> Searchlight Results</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-within-sequence"><i class="fa fa-check"></i>Virtual Time Within Sequence</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences-in-within-searchlight-cluster"><i class="fa fa-check"></i>Virtual Time Across Sequences in Within-Searchlight Cluster</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences"><i class="fa fa-check"></i>Virtual Time Across Sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualization-of-overlap"><i class="fa fa-check"></i>Visualization of Overlap</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-sequence-interaction"><i class="fa fa-check"></i>Virtual Time &amp; Sequence Interaction</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#exploratory-searchlight-results"><i class="fa fa-check"></i>Exploratory Searchlight Results</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-of-behavioral-generalization-bias-with-searchlight-effects"><i class="fa fa-check"></i><b>8.12</b> Correlation of behavioral generalization bias with searchlight effects</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-across-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with across-sequence searchlight effect</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-same-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with same-sequence searchlight effect</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mixed-model-summaries"><i class="fa fa-check"></i><b>8.13</b> Mixed Model Summaries</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-figure-1"><i class="fa fa-check"></i>Supplemental Figure</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-tables"><i class="fa fa-check"></i>Supplemental Tables</a></li>
<li class="chapter" data-level="8.13.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#source-data"><i class="fa fa-check"></i><b>8.13.1</b> Source data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html"><i class="fa fa-check"></i><b>9</b> Signal to noise ratio</a>
<ul>
<li class="chapter" data-level="9.1" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#calculate-voxel-wise-temporal-snr"><i class="fa fa-check"></i><b>9.1</b> Calculate voxel-wise temporal SNR</a></li>
<li class="chapter" data-level="9.2" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#average-tsnr-per-roi"><i class="fa fa-check"></i><b>9.2</b> Average tSNR per ROI</a></li>
<li class="chapter" data-level="9.3" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#contrast-tsnr-between-ahpc-and-alec"><i class="fa fa-check"></i><b>9.3</b> Contrast tSNR between aHPC and alEC</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html"><i class="fa fa-check"></i><b>10</b> RSA in searchlight peak with different threshold</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#prepare-rsa-in-searchlight-peak-1"><i class="fa fa-check"></i><b>10.1</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#create-the-roi-mask-1"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculating-the-correlation-matrices-1"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculate-pattern-similarity-change-2"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#combine-behavioral-and-fmri-data-for-rsa-2"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#rsa"><i class="fa fa-check"></i><b>10.2</b> RSA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html"><i class="fa fa-check"></i><b>11</b> Univariate GLM: Relative time</a>
<ul>
<li class="chapter" data-level="11.1" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#copy-feat-folder-from-preprocessing-to-first-level-glm-directory"><i class="fa fa-check"></i><b>11.1</b> Copy FEAT-folder from Preprocessing to First-Level GLM directory</a></li>
<li class="chapter" data-level="11.2" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-glm"><i class="fa fa-check"></i><b>11.2</b> Prepare GLM</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#compute-relative-time"><i class="fa fa-check"></i>Compute relative time</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#write-custom-ev-files-for-fsl-feat"><i class="fa fa-check"></i>Write custom EV files for FSL FEAT</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#glm-design-files"><i class="fa fa-check"></i>GLM Design files</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-confound-ev"><i class="fa fa-check"></i>Prepare confound EV</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#create-design-matrix"><i class="fa fa-check"></i>Create design matrix</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-1st-level-glm-on-htcondor"><i class="fa fa-check"></i><b>11.3</b> Run 1st-level GLM on HTCondor</a></li>
<li class="chapter" data-level="11.4" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#group-level-1"><i class="fa fa-check"></i><b>11.4</b> Group-level</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#move-first-level-images-to-mni-space-1"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#merge-first-level-images"><i class="fa fa-check"></i>Merge first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#smooth-first-level-images"><i class="fa fa-check"></i>Smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#average-first-level-images"><i class="fa fa-check"></i>Average first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#ahpc-roi-analysis"><i class="fa fa-check"></i>aHPC ROI analysis</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-fsl-randomise-1"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#results-in-ahpc-and-alec"><i class="fa fa-check"></i>Results in aHPC and alEC</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#fov-results"><i class="fa fa-check"></i>FOV results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="credit.html"><a href="credit.html"><i class="fa fa-check"></i><b>12</b> Credit</a>
<ul>
<li class="chapter" data-level="12.1" data-path="credit.html"><a href="credit.html#list-of-packages"><i class="fa fa-check"></i><b>12.1</b> List of packages</a></li>
<li class="chapter" data-level="12.2" data-path="credit.html"><a href="credit.html#references"><i class="fa fa-check"></i><b>12.2</b> References</a></li>
<li class="chapter" data-level="12.3" data-path="credit.html"><a href="credit.html#session-info"><i class="fa fa-check"></i><b>12.3</b> Session Info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="behavioral-analysis" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Behavioral Analysis</h1>
<p>We are now ready to analyze and plot the behavioral data. Let’s start with a quick recap of the data and tasks we have:</p>
<p><strong><em>Sorting Task</em></strong></p>
<blockquote>
<p>The day sorting task (Figure 1D) was performed in front of a computer screen. The 20 event images from the day learning task were presented on the screen in a miniature version. They were arranged in a circle around a central area displaying 4 rectangles. Participants were instructed to drag and drop all events of the same sequence into the same rectangle with a computer mouse. Participants freely chose which rectangle corresponded to which sequence as the sequences were not identifiable by any label and were presented in differing orders across mini-blocks during learning.</p>
</blockquote>
<p>Thus, in analysis, we took the grouping as provided by the rectangles and assigned the four groups of events to the four days in a way that there was maximal overlap between actual days and sorted days. We found the best solution for this by trying all combinations in a preparation step.</p>
<p><strong><em>Timeline task</em></strong></p>
<blockquote>
<p>In this task, participants saw a timeline ranging from 6 a.m. to midnight together with miniature versions of the five event images belonging to one sequence (Figure 1E). Participants were instructed to drag and drop the event images next to the timeline so that scene positions reflected the event times they had inferred in the day learning task. To facilitate precise alignment to the timeline, event images were shown with an outward pointing triangle on their left side, on which participants were instructed to base their responses.</p>
</blockquote>
<p>Participants responses were read out from the logfiles of this task and converted to virtual hours. The data are saved in the text file including all behavioral data (<em>virtem_behavioral_data.txt</em>).</p>
<p>Let’s begin by loading the data into a tibble (dataframe) with the following columns:</p>
<ul>
<li>sub_id = subject identifier for all rows of this subject</li>
<li>day = virtual day. There are 4 virtual days</li>
<li>event = number of event in a day, i.e. order. Each day has 5 events.</li>
<li>pic = picture identifier. Pictures were randomly assigned to events and days for each subject</li>
<li>virtual_time = true virtual time of an event</li>
<li>real_time = real time of an event</li>
<li>memory_time = data from the timeline task, where participants indicated remembered (virtual) time of each event</li>
<li>memory_order = remembered ordinal position of an event</li>
<li>sorted_day = data from the day sorting task, where participants sorted all event pictures into the 4 days.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="behavioral-analysis.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data from CSV</span></span>
<span id="cb34-2"><a href="behavioral-analysis.html#cb34-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;behavioral_data.txt&quot;</span>)</span>
<span id="cb34-3"><a href="behavioral-analysis.html#cb34-3" aria-hidden="true" tabindex="-1"></a>col_types_list <span class="ot">&lt;-</span> <span class="fu">cols_only</span>(</span>
<span id="cb34-4"><a href="behavioral-analysis.html#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_id =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb34-5"><a href="behavioral-analysis.html#cb34-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">day =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb34-6"><a href="behavioral-analysis.html#cb34-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">event =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb34-7"><a href="behavioral-analysis.html#cb34-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">pic =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb34-8"><a href="behavioral-analysis.html#cb34-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">virtual_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb34-9"><a href="behavioral-analysis.html#cb34-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">real_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb34-10"><a href="behavioral-analysis.html#cb34-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">memory_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb34-11"><a href="behavioral-analysis.html#cb34-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">memory_order =</span> <span class="fu">col_double</span>(),</span>
<span id="cb34-12"><a href="behavioral-analysis.html#cb34-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">sorted_day =</span> <span class="fu">col_integer</span>()</span>
<span id="cb34-13"><a href="behavioral-analysis.html#cb34-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-14"><a href="behavioral-analysis.html#cb34-14" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_csv</span>(fname, <span class="at">col_types =</span> col_types_list))</span>
<span id="cb34-15"><a href="behavioral-analysis.html#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="behavioral-analysis.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(beh_data)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-29">
<col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sub_id</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">day</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">event</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">pic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual_time</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">real_time</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_time</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_order</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sorted_day</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">31</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7.81</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.45</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">31</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">23.4&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">31</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">42.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">31</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">51.6&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">31</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">19</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">18.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">64.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">19&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">31</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.38</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.53</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td></tr>
</table>

<div id="sorting-task-1" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Sorting Task</h2>
<blockquote>
<p>For analysis of the sorting task, we took the grouping of event images as provided by the participants and assigned them to the four sequences to ensure maximal overlap between actual and sorted sequence memberships. While the assignment of groupings to sequences is unambiguous when performance is, as in our sample, high, this procedure is potentially liberal at lower performance levels. We then calculated the percentage of correctly sorted event images for each participant, see the raincloud plot(100) in Figure 2A.</p>
</blockquote>
<div id="calculate-percentage-of-correct-responses" class="section level3 unnumbered">
<h3>Calculate percentage of correct responses</h3>
<p>So to calculate participants’ accuracy in this task we need to figure out how often the true day label matches the label of the quadrant into which an event was sorted.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="behavioral-analysis.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the number and percentages of correct sorts</span></span>
<span id="cb35-2"><a href="behavioral-analysis.html#cb35-2" aria-hidden="true" tabindex="-1"></a>day_sorting <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="behavioral-analysis.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb35-4"><a href="behavioral-analysis.html#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_correct =</span> <span class="fu">sum</span>(day <span class="sc">==</span> sorted_day), </span>
<span id="cb35-5"><a href="behavioral-analysis.html#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">prcnt_correct =</span> <span class="fu">sum</span>(day <span class="sc">==</span> sorted_day)<span class="sc">/</span>(n_days<span class="sc">*</span>n_events_day)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb35-6"><a href="behavioral-analysis.html#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="dv">1</span>),</span>
<span id="cb35-7"><a href="behavioral-analysis.html#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb35-8"><a href="behavioral-analysis.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-9"><a href="behavioral-analysis.html#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="behavioral-analysis.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print a simple summary of descriptive statistics</span></span>
<span id="cb35-11"><a href="behavioral-analysis.html#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(day_sorting<span class="sc">$</span>prcnt_correct)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   40.00   75.00   95.00   86.43  100.00  100.00</code></pre>
<p>Results of the sorting task:
86.43 ± 16.82 mean±standard deviation of correct sorts</p>
</div>
<div id="plot-sorting-performance" class="section level3 unnumbered">
<h3>Plot sorting performance</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="behavioral-analysis.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb37-2"><a href="behavioral-analysis.html#cb37-2" aria-hidden="true" tabindex="-1"></a>f2a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(day_sorting,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>prcnt_correct, <span class="at">fill =</span> group, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="behavioral-analysis.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the violin</span></span>
<span id="cb37-4"><a href="behavioral-analysis.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb37-5"><a href="behavioral-analysis.html#cb37-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">fill=</span>ultimate_gray, <span class="at">color=</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="behavioral-analysis.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># single subject data points with horizontal jitter</span></span>
<span id="cb37-7"><a href="behavioral-analysis.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="fl">-.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb37-8"><a href="behavioral-analysis.html#cb37-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">colour=</span>ultimate_gray, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb37-9"><a href="behavioral-analysis.html#cb37-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb37-10"><a href="behavioral-analysis.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># box plot of distribution</span></span>
<span id="cb37-11"><a href="behavioral-analysis.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="behavioral-analysis.html#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add plot of mean and SEM  </span></span>
<span id="cb37-13"><a href="behavioral-analysis.html#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb37-14"><a href="behavioral-analysis.html#cb37-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb37-15"><a href="behavioral-analysis.html#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb37-16"><a href="behavioral-analysis.html#cb37-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-17"><a href="behavioral-analysis.html#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># edit axis labels and limit</span></span>
<span id="cb37-18"><a href="behavioral-analysis.html#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;% correct&#39;</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb37-19"><a href="behavioral-analysis.html#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;sorting task&#39;</span>) <span class="sc">+</span> </span>
<span id="cb37-20"><a href="behavioral-analysis.html#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make it pretty</span></span>
<span id="cb37-21"><a href="behavioral-analysis.html#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb37-22"><a href="behavioral-analysis.html#cb37-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb37-23"><a href="behavioral-analysis.html#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change color </span></span>
<span id="cb37-24"><a href="behavioral-analysis.html#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> ultimate_gray) <span class="sc">+</span></span>
<span id="cb37-25"><a href="behavioral-analysis.html#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> ultimate_gray) <span class="sc">+</span></span>
<span id="cb37-26"><a href="behavioral-analysis.html#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb37-27"><a href="behavioral-analysis.html#cb37-27" aria-hidden="true" tabindex="-1"></a>f2a</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/raincloud-1.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="behavioral-analysis.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb38-2"><a href="behavioral-analysis.html#cb38-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f2a)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb38-3"><a href="behavioral-analysis.html#cb38-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb38-4"><a href="behavioral-analysis.html#cb38-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f2a.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="sorting-errors-as-a-function-of-sequence-position" class="section level3 unnumbered">
<h3>Sorting errors as a function of sequence position</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="behavioral-analysis.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DISTRIBUTION OF SORTING ERRORS</span></span>
<span id="cb39-2"><a href="behavioral-analysis.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># test whether frequencies of sorting errors for the sequence positions differs from uniformity</span></span>
<span id="cb39-3"><a href="behavioral-analysis.html#cb39-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sorted_day <span class="sc">!=</span> day) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="behavioral-analysis.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(event) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="behavioral-analysis.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_sort_errs =</span> <span class="fu">sum</span>(sorted_day <span class="sc">!=</span> day), <span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="behavioral-analysis.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n_sort_errs) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="behavioral-analysis.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="behavioral-analysis.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb39-9"><a href="behavioral-analysis.html#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="behavioral-analysis.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of sorting errors as a function of sequence position</span></span>
<span id="cb39-11"><a href="behavioral-analysis.html#cb39-11" aria-hidden="true" tabindex="-1"></a>fig_sort_err_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sorted_day <span class="sc">!=</span> day), <span class="fu">aes</span>(<span class="at">x=</span>event, <span class="at">fill =</span> event)) <span class="sc">+</span></span>
<span id="cb39-12"><a href="behavioral-analysis.html#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="behavioral-analysis.html#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> event_colors) <span class="sc">+</span></span>
<span id="cb39-14"><a href="behavioral-analysis.html#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb39-15"><a href="behavioral-analysis.html#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb39-16"><a href="behavioral-analysis.html#cb39-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb39-17"><a href="behavioral-analysis.html#cb39-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb39-18"><a href="behavioral-analysis.html#cb39-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb39-19"><a href="behavioral-analysis.html#cb39-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb39-20"><a href="behavioral-analysis.html#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="behavioral-analysis.html#cb39-21" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;letter_sort_errors_histogram&quot;</span>)</span>
<span id="cb39-22"><a href="behavioral-analysis.html#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>fig_sort_err_hist, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb39-23"><a href="behavioral-analysis.html#cb39-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="fl">5.5</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb39-24"><a href="behavioral-analysis.html#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>fig_sort_err_hist, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb39-25"><a href="behavioral-analysis.html#cb39-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="fl">5.5</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span>
<span id="cb39-26"><a href="behavioral-analysis.html#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig_sort_err_hist)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p><span class="math inline">\(\chi^2\)</span> test against uniformity for distribution of sorting errors:
<span class="math inline">\(\chi^2\)</span>=2.55, p=0.635</p>
</div>
</div>
<div id="timeline-task-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Timeline Task</h2>
<div id="visualize-the-raw-data" class="section level3 unnumbered">
<h3>Visualize the raw data</h3>
<p>First, let’s get an overview of participants’ behavior in this task. For this, we plot the responses from the timeline task for all participants. In these plots, each row is one virtual day. The circles along the gray lines represent the true virtual times that participants were supposed to learn. For each event on each day, we then add a full plot of the behavior. This includes the single-subject data points (colored circles), their mean and standard error across subjects (black circle and line) as well as the boxplot and kernel density plot of the distribution.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="behavioral-analysis.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reduce data frame to the times specified by the design</span></span>
<span id="cb40-2"><a href="behavioral-analysis.html#cb40-2" aria-hidden="true" tabindex="-1"></a>design_temp_struct <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(day, event) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="behavioral-analysis.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">virtual_time =</span> <span class="fu">unique</span>(virtual_time), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb40-4"><a href="behavioral-analysis.html#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="behavioral-analysis.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb40-6"><a href="behavioral-analysis.html#cb40-6" aria-hidden="true" tabindex="-1"></a>f2b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_data, <span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>memory_time, </span>
<span id="cb40-7"><a href="behavioral-analysis.html#cb40-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> virtual_time, <span class="at">colour =</span> virtual_time, </span>
<span id="cb40-8"><a href="behavioral-analysis.html#cb40-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">group=</span><span class="fu">paste</span>(day, event, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))) <span class="sc">+</span></span>
<span id="cb40-9"><a href="behavioral-analysis.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="behavioral-analysis.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the violin</span></span>
<span id="cb40-11"><a href="behavioral-analysis.html#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_flat_violin(position = position_nudge(x = 0.1, y = 0),adjust = 1, trim = TRUE) +</span></span>
<span id="cb40-12"><a href="behavioral-analysis.html#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># single subject data points with horizontal jitter</span></span>
<span id="cb40-13"><a href="behavioral-analysis.html#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(day)<span class="sc">-</span><span class="fl">0.25</span>, <span class="at">y =</span> memory_time, <span class="at">fill =</span> virtual_time), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb40-14"><a href="behavioral-analysis.html#cb40-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">05</span>, <span class="at">height =</span> <span class="dv">0</span>), </span>
<span id="cb40-15"><a href="behavioral-analysis.html#cb40-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-16"><a href="behavioral-analysis.html#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># box plot of distribution</span></span>
<span id="cb40-17"><a href="behavioral-analysis.html#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">y =</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> memory_time), </span>
<span id="cb40-18"><a href="behavioral-analysis.html#cb40-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">05</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb40-19"><a href="behavioral-analysis.html#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add plot of mean and SEM  </span></span>
<span id="cb40-20"><a href="behavioral-analysis.html#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb40-21"><a href="behavioral-analysis.html#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb40-22"><a href="behavioral-analysis.html#cb40-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb40-23"><a href="behavioral-analysis.html#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot point and line for true virtual times</span></span>
<span id="cb40-24"><a href="behavioral-analysis.html#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> design_temp_struct, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> virtual_time, <span class="at">group =</span> day), </span>
<span id="cb40-25"><a href="behavioral-analysis.html#cb40-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.45</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> ultimate_gray)<span class="sc">+</span></span>
<span id="cb40-26"><a href="behavioral-analysis.html#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> design_temp_struct, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> virtual_time, <span class="at">fill =</span> virtual_time), </span>
<span id="cb40-27"><a href="behavioral-analysis.html#cb40-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.45</span>), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> ultimate_gray, <span class="at">stroke =</span> <span class="fl">0.5</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb40-28"><a href="behavioral-analysis.html#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;virtual time&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;sequence&#39;</span>) <span class="sc">+</span> </span>
<span id="cb40-29"><a href="behavioral-analysis.html#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">24</span>), <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">24</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb40-30"><a href="behavioral-analysis.html#cb40-30" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_fill_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-31"><a href="behavioral-analysis.html#cb40-31" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_color_scico</span>(<span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">palette =</span> <span class="st">&quot;devon&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-32"><a href="behavioral-analysis.html#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb40-33"><a href="behavioral-analysis.html#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_colorbar</span>(<span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb40-34"><a href="behavioral-analysis.html#cb40-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-35"><a href="behavioral-analysis.html#cb40-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">barwidth =</span> <span class="fu">unit</span>(<span class="dv">20</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;mm&quot;</span>)),</span>
<span id="cb40-36"><a href="behavioral-analysis.html#cb40-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-37"><a href="behavioral-analysis.html#cb40-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb40-38"><a href="behavioral-analysis.html#cb40-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb40-39"><a href="behavioral-analysis.html#cb40-39" aria-hidden="true" tabindex="-1"></a>f2b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="behavioral-analysis.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb41-2"><a href="behavioral-analysis.html#cb41-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f2b)<span class="sc">$</span>data[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="behavioral-analysis.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x=</span>y,<span class="at">y=</span>x) <span class="co"># rename because of flipped coordinates </span></span>
<span id="cb41-4"><a href="behavioral-analysis.html#cb41-4" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb41-5"><a href="behavioral-analysis.html#cb41-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f2b.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="accuracy-of-remembered-times" class="section level3 unnumbered">
<h3>Accuracy of remembered times</h3>
<blockquote>
<p>We analyzed how well participants constructed the event times based on the day learning task. We quantified absolute errors across all events (Figure 2C) as well as separately for the five sequence positions (Figure 2D), the four sequences (Supplemental Figure 3A) and as a function of virtual clock speed (Supplemental Figure 3B).</p>
</blockquote>
<div id="average-absolute-error-per-participant" class="section level4 unnumbered">
<h4>Average absolute error per participant</h4>
<p>Now, let’s look at the average error per participant collapsed across all trials.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="behavioral-analysis.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate signed timeline error as difference between virtual time and response</span></span>
<span id="cb42-2"><a href="behavioral-analysis.html#cb42-2" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="behavioral-analysis.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timeline_error =</span> virtual_time <span class="sc">-</span> memory_time)</span>
<span id="cb42-4"><a href="behavioral-analysis.html#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="behavioral-analysis.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># average absolute timeline error across subjects</span></span>
<span id="cb42-6"><a href="behavioral-analysis.html#cb42-6" aria-hidden="true" tabindex="-1"></a>timeline_group <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb42-7"><a href="behavioral-analysis.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span> </span>
<span id="cb42-8"><a href="behavioral-analysis.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-9"><a href="behavioral-analysis.html#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_error =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(timeline_error)),</span>
<span id="cb42-10"><a href="behavioral-analysis.html#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb42-11"><a href="behavioral-analysis.html#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="behavioral-analysis.html#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print summary of the average error</span></span>
<span id="cb42-13"><a href="behavioral-analysis.html#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(timeline_group<span class="sc">$</span>avg_error)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2377  0.5625  0.9093  0.9103  1.1221  2.0963</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="behavioral-analysis.html#cb44-1" aria-hidden="true" tabindex="-1"></a>f2c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(timeline_group, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>avg_error), <span class="at">colour=</span> time_colors[<span class="dv">1</span>], <span class="at">fill=</span>time_colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb44-2"><a href="behavioral-analysis.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the violin</span></span>
<span id="cb44-3"><a href="behavioral-analysis.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb44-4"><a href="behavioral-analysis.html#cb44-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">fill=</span>time_colors[<span class="dv">1</span>], <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="behavioral-analysis.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># single subject data points with horizontal jitter</span></span>
<span id="cb44-6"><a href="behavioral-analysis.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="fl">-.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb44-7"><a href="behavioral-analysis.html#cb44-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb44-8"><a href="behavioral-analysis.html#cb44-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">colour=</span>time_colors[<span class="dv">1</span>], <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb44-9"><a href="behavioral-analysis.html#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># box plot of distribution</span></span>
<span id="cb44-10"><a href="behavioral-analysis.html#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">fill=</span>time_colors[<span class="dv">1</span>], <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="behavioral-analysis.html#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add plot of mean and SEM  </span></span>
<span id="cb44-12"><a href="behavioral-analysis.html#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb44-13"><a href="behavioral-analysis.html#cb44-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb44-14"><a href="behavioral-analysis.html#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb44-15"><a href="behavioral-analysis.html#cb44-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb44-16"><a href="behavioral-analysis.html#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># edit axis labels</span></span>
<span id="cb44-17"><a href="behavioral-analysis.html#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;absolute error&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;timeline task&#39;</span>) <span class="sc">+</span> </span>
<span id="cb44-18"><a href="behavioral-analysis.html#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-19"><a href="behavioral-analysis.html#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-20"><a href="behavioral-analysis.html#cb44-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb44-21"><a href="behavioral-analysis.html#cb44-21" aria-hidden="true" tabindex="-1"></a>f2c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="behavioral-analysis.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb45-2"><a href="behavioral-analysis.html#cb45-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f2c)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb45-3"><a href="behavioral-analysis.html#cb45-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb45-4"><a href="behavioral-analysis.html#cb45-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f2c.txt&quot;</span>))</span></code></pre></div>
<p>Timeline task:
0.91 ± 0.47 mean±standard deviation of average absolute errors.</p>
</div>
<div id="event-wise-average-absolute-errors" class="section level4 unnumbered">
<h4>Event-wise average absolute errors</h4>
<p>We can also aggregate the data across days by group the events as a function of event position (i.e. the order). Let’s look at the absolute errors in the timeline task for the events at positions 1-5, averaged across days.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="behavioral-analysis.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean absolute error per event for each subject</span></span>
<span id="cb46-2"><a href="behavioral-analysis.html#cb46-2" aria-hidden="true" tabindex="-1"></a>timeline_per_event <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="behavioral-analysis.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id, event) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="behavioral-analysis.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-5"><a href="behavioral-analysis.html#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_abs_error =</span><span class="fu">mean</span>(<span class="fu">abs</span>(timeline_error)),</span>
<span id="cb46-6"><a href="behavioral-analysis.html#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb46-7"><a href="behavioral-analysis.html#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="behavioral-analysis.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb46-9"><a href="behavioral-analysis.html#cb46-9" aria-hidden="true" tabindex="-1"></a>f2d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(timeline_per_event,<span class="fu">aes</span>(<span class="at">x=</span>event,<span class="at">y=</span>mean_abs_error, <span class="at">fill =</span> event)) <span class="sc">+</span></span>
<span id="cb46-10"><a href="behavioral-analysis.html#cb46-10" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="behavioral-analysis.html#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(event)<span class="sc">-</span>.<span class="dv">2</span>, <span class="at">y =</span> mean_abs_error, <span class="at">colour=</span>event), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb46-12"><a href="behavioral-analysis.html#cb46-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb46-13"><a href="behavioral-analysis.html#cb46-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-14"><a href="behavioral-analysis.html#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> event, <span class="at">y =</span> mean_abs_error), </span>
<span id="cb46-15"><a href="behavioral-analysis.html#cb46-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-16"><a href="behavioral-analysis.html#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb46-17"><a href="behavioral-analysis.html#cb46-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span> </span>
<span id="cb46-18"><a href="behavioral-analysis.html#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb46-19"><a href="behavioral-analysis.html#cb46-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb46-20"><a href="behavioral-analysis.html#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;absolute error&#39;</span>)<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;event&#39;</span>) <span class="sc">+</span> </span>
<span id="cb46-21"><a href="behavioral-analysis.html#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> event_colors, <span class="at">name=</span><span class="st">&quot;event position&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-22"><a href="behavioral-analysis.html#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> event_colors) <span class="sc">+</span></span>
<span id="cb46-23"><a href="behavioral-analysis.html#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb46-24"><a href="behavioral-analysis.html#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb46-25"><a href="behavioral-analysis.html#cb46-25" aria-hidden="true" tabindex="-1"></a>f2d</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/calculate%20timeline%20errors%20and%20average%20based%20on%20event%20positions-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="behavioral-analysis.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb47-2"><a href="behavioral-analysis.html#cb47-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f2d)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb47-3"><a href="behavioral-analysis.html#cb47-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y, group), </span>
<span id="cb47-4"><a href="behavioral-analysis.html#cb47-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f2d.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="timeline-error-differences-between-sequences" class="section level4 unnumbered">
<h4>Timeline error differences between sequences</h4>
<p>Let’s test if absolute errors differ between sequences. We use a permutation-based repeated measures ANOVA with permutation-based t-tests for post-hoc comparisons.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="behavioral-analysis.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean absolute timeline error per day</span></span>
<span id="cb48-2"><a href="behavioral-analysis.html#cb48-2" aria-hidden="true" tabindex="-1"></a>timeline_group_by_day <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id, day) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="behavioral-analysis.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_timeline_error =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(virtual_time<span class="sc">-</span>memory_time)), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb48-4"><a href="behavioral-analysis.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="behavioral-analysis.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation repeated measures from permuco package with day as the only factor</span></span>
<span id="cb48-6"><a href="behavioral-analysis.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">511</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb48-7"><a href="behavioral-analysis.html#cb48-7" aria-hidden="true" tabindex="-1"></a>aov_fit_perm <span class="ot">&lt;-</span> permuco<span class="sc">::</span><span class="fu">aovperm</span>(<span class="at">formula =</span> avg_timeline_error <span class="sc">~</span> day <span class="sc">+</span> <span class="fu">Error</span>(sub_id<span class="sc">/</span>day),</span>
<span id="cb48-8"><a href="behavioral-analysis.html#cb48-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> timeline_group_by_day, <span class="at">method =</span> <span class="st">&quot;Rd_kheradPajouh_renaud&quot;</span>, <span class="at">np =</span>n_perm)</span>
<span id="cb48-9"><a href="behavioral-analysis.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_fit_perm)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-34">
<col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SSn</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dfn</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SSd</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dfd</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">MSEn</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">MSEd</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">F</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parametric P(&gt;F)</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">permutation P(&gt;F)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5.54</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">25.5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">81</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.85</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.315</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5.86</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.00113</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.0008</td></tr>
</table>

<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="behavioral-analysis.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posthoc pairwise t-tests</span></span>
<span id="cb49-2"><a href="behavioral-analysis.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">511</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb49-3"><a href="behavioral-analysis.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_days<span class="dv">-1</span>)){</span>
<span id="cb49-4"><a href="behavioral-analysis.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_days){</span>
<span id="cb49-5"><a href="behavioral-analysis.html#cb49-5" aria-hidden="true" tabindex="-1"></a>    stats <span class="ot">&lt;-</span> <span class="fu">paired_t_perm_jb</span>(timeline_group_by_day<span class="sc">$</span>avg_timeline_error[timeline_group_by_day<span class="sc">$</span>day<span class="sc">==</span>i]<span class="sc">-</span></span>
<span id="cb49-6"><a href="behavioral-analysis.html#cb49-6" aria-hidden="true" tabindex="-1"></a>                                timeline_group_by_day<span class="sc">$</span>avg_timeline_error[timeline_group_by_day<span class="sc">$</span>day<span class="sc">==</span>j],</span>
<span id="cb49-7"><a href="behavioral-analysis.html#cb49-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n_perm =</span> n_perm)</span>
<span id="cb49-8"><a href="behavioral-analysis.html#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">&quot;sequence %d vs. %d: t=%.2f, p=%.3f&quot;</span>, </span>
<span id="cb49-9"><a href="behavioral-analysis.html#cb49-9" aria-hidden="true" tabindex="-1"></a>                  i, j, stats<span class="sc">$</span>statistic, <span class="fu">round</span>(stats<span class="sc">$</span>p_perm, <span class="dv">3</span>)))</span>
<span id="cb49-10"><a href="behavioral-analysis.html#cb49-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-11"><a href="behavioral-analysis.html#cb49-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;sequence 1 vs. 2: t=3.38, p=0.001&quot;
## [1] &quot;sequence 1 vs. 3: t=-0.12, p=0.912&quot;
## [1] &quot;sequence 1 vs. 4: t=2.59, p=0.013&quot;
## [1] &quot;sequence 2 vs. 3: t=-2.92, p=0.001&quot;
## [1] &quot;sequence 2 vs. 4: t=-1.15, p=0.271&quot;
## [1] &quot;sequence 3 vs. 4: t=2.15, p=0.023&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="behavioral-analysis.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb51-2"><a href="behavioral-analysis.html#cb51-2" aria-hidden="true" tabindex="-1"></a>sfig_beh_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(timeline_group_by_day,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>avg_timeline_error)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="behavioral-analysis.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>, <span class="at">fill=</span>ultimate_gray) <span class="sc">+</span></span>
<span id="cb51-4"><a href="behavioral-analysis.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(day)<span class="sc">-</span>.<span class="dv">2</span>, <span class="at">y =</span> avg_timeline_error), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">fill=</span>ultimate_gray,</span>
<span id="cb51-5"><a href="behavioral-analysis.html#cb51-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb51-6"><a href="behavioral-analysis.html#cb51-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="behavioral-analysis.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> avg_timeline_error), </span>
<span id="cb51-8"><a href="behavioral-analysis.html#cb51-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill=</span>ultimate_gray, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="behavioral-analysis.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb51-10"><a href="behavioral-analysis.html#cb51-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span> </span>
<span id="cb51-11"><a href="behavioral-analysis.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb51-12"><a href="behavioral-analysis.html#cb51-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb51-13"><a href="behavioral-analysis.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;timeline error&#39;</span>)<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;sequence&#39;</span>) <span class="sc">+</span> </span>
<span id="cb51-14"><a href="behavioral-analysis.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>), <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;underline(&quot;    *    &quot;)&#39;</span>, </span>
<span id="cb51-15"><a href="behavioral-analysis.html#cb51-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb51-16"><a href="behavioral-analysis.html#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb51-17"><a href="behavioral-analysis.html#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb51-18"><a href="behavioral-analysis.html#cb51-18" aria-hidden="true" tabindex="-1"></a>sfig_beh_a</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="effect-of-clock-speed-on-timeline-errors" class="section level4 unnumbered">
<h4>Effect of Clock Speed on Timeline Errors</h4>
<p>Next, we test whether behavior differed between sequences as a function of clock speed (fast or slow).</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="behavioral-analysis.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add clock speed variable</span></span>
<span id="cb52-2"><a href="behavioral-analysis.html#cb52-2" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="behavioral-analysis.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clock_speed =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>((day <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> day <span class="sc">==</span><span class="dv">2</span>), <span class="st">&quot;slow&quot;</span>, <span class="st">&quot;fast&quot;</span>), <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;slow&quot;</span>, <span class="st">&quot;fast&quot;</span>)))</span>
<span id="cb52-4"><a href="behavioral-analysis.html#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="behavioral-analysis.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># average absolute errors as a function of speed (and jitter for plotting)</span></span>
<span id="cb52-6"><a href="behavioral-analysis.html#cb52-6" aria-hidden="true" tabindex="-1"></a>timeline_group_by_speed <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-7"><a href="behavioral-analysis.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id, clock_speed) <span class="sc">%&gt;%</span> </span>
<span id="cb52-8"><a href="behavioral-analysis.html#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_timeline_error =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(virtual_time<span class="sc">-</span>memory_time)), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="behavioral-analysis.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_jit =</span> <span class="fu">as.numeric</span>(clock_speed) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">jitter</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n_subs), <span class="at">amount=</span><span class="fl">0.05</span>), <span class="at">each=</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),n_subs))</span>
<span id="cb52-10"><a href="behavioral-analysis.html#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="behavioral-analysis.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test between errors in slow vs. fast</span></span>
<span id="cb52-12"><a href="behavioral-analysis.html#cb52-12" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">paired_t_perm_jb</span>(timeline_group_by_speed<span class="sc">$</span>avg_timeline_error[timeline_group_by_speed<span class="sc">$</span>clock_speed<span class="sc">==</span><span class="st">&quot;slow&quot;</span>] <span class="sc">-</span></span>
<span id="cb52-13"><a href="behavioral-analysis.html#cb52-13" aria-hidden="true" tabindex="-1"></a>                            timeline_group_by_speed<span class="sc">$</span>avg_timeline_error[timeline_group_by_speed<span class="sc">$</span>clock_speed<span class="sc">==</span><span class="st">&quot;fast&quot;</span>], </span>
<span id="cb52-14"><a href="behavioral-analysis.html#cb52-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n_perm=</span>n_perm)</span>
<span id="cb52-15"><a href="behavioral-analysis.html#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="behavioral-analysis.html#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot</span></span>
<span id="cb52-17"><a href="behavioral-analysis.html#cb52-17" aria-hidden="true" tabindex="-1"></a>sfig_beh_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>timeline_group_by_speed, <span class="fu">aes</span>(<span class="at">x=</span>clock_speed, <span class="at">y=</span>avg_timeline_error, <span class="at">fill =</span> clock_speed, <span class="at">color =</span> clock_speed)) <span class="sc">+</span></span>
<span id="cb52-18"><a href="behavioral-analysis.html#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span>clock_speed), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb52-19"><a href="behavioral-analysis.html#cb52-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb52-20"><a href="behavioral-analysis.html#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#ece7f2&quot;</span>, <span class="st">&quot;#a6bddb&quot;</span>)) <span class="sc">+</span></span>
<span id="cb52-21"><a href="behavioral-analysis.html#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#ece7f2&quot;</span>, <span class="st">&quot;#a6bddb&quot;</span>), </span>
<span id="cb52-22"><a href="behavioral-analysis.html#cb52-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;clock speed&quot;</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;slow&quot;</span>, <span class="st">&quot;fast&quot;</span>)) <span class="sc">+</span></span>
<span id="cb52-23"><a href="behavioral-analysis.html#cb52-23" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> timeline_group_by_speed <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clock_speed <span class="sc">==</span> <span class="st">&quot;slow&quot;</span>), </span>
<span id="cb52-24"><a href="behavioral-analysis.html#cb52-24" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>clock_speed, <span class="at">y=</span>avg_timeline_error),</span>
<span id="cb52-25"><a href="behavioral-analysis.html#cb52-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb52-26"><a href="behavioral-analysis.html#cb52-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb52-27"><a href="behavioral-analysis.html#cb52-27" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> timeline_group_by_speed <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clock_speed <span class="sc">==</span> <span class="st">&quot;fast&quot;</span>), </span>
<span id="cb52-28"><a href="behavioral-analysis.html#cb52-28" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>clock_speed, <span class="at">y=</span>avg_timeline_error),</span>
<span id="cb52-29"><a href="behavioral-analysis.html#cb52-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb52-30"><a href="behavioral-analysis.html#cb52-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb52-31"><a href="behavioral-analysis.html#cb52-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb52-32"><a href="behavioral-analysis.html#cb52-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb52-33"><a href="behavioral-analysis.html#cb52-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb52-34"><a href="behavioral-analysis.html#cb52-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb52-35"><a href="behavioral-analysis.html#cb52-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>sub_id,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb52-36"><a href="behavioral-analysis.html#cb52-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb52-37"><a href="behavioral-analysis.html#cb52-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit, <span class="at">fill =</span> clock_speed), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>)),</span>
<span id="cb52-38"><a href="behavioral-analysis.html#cb52-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb52-39"><a href="behavioral-analysis.html#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;timeline error&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;clock speed&#39;</span>) <span class="sc">+</span>    </span>
<span id="cb52-40"><a href="behavioral-analysis.html#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;underline(&quot;    n.s.    &quot;)&#39;</span>, </span>
<span id="cb52-41"><a href="behavioral-analysis.html#cb52-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb52-42"><a href="behavioral-analysis.html#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb52-43"><a href="behavioral-analysis.html#cb52-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb52-44"><a href="behavioral-analysis.html#cb52-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb52-45"><a href="behavioral-analysis.html#cb52-45" aria-hidden="true" tabindex="-1"></a>sfig_beh_b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Summary Statistics: paired t-test comparing timeline errors of slow vs. fast sequences
t<sub>27</sub>=-0.82, p=0.423</p>
</div>
</div>
<div id="relationship-of-sorting-errors-and-timeline-errors" class="section level3 unnumbered">
<h3>Relationship of sorting errors and timeline errors</h3>
<div id="correlation" class="section level4 unnumbered">
<h4>Correlation</h4>
<p>To test whether performance in the two tasks is related, we run an across-subject correlation of the number of sorting errors with mean absolute timeline errors.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="behavioral-analysis.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make usable data frame</span></span>
<span id="cb53-2"><a href="behavioral-analysis.html#cb53-2" aria-hidden="true" tabindex="-1"></a>beh_group <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(timeline_group, day_sorting)</span></code></pre></div>
<pre><code>## Joining, by = &quot;sub_id&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="behavioral-analysis.html#cb55-1" aria-hidden="true" tabindex="-1"></a>beh_group <span class="ot">&lt;-</span> beh_group <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">avg_timeline_error =</span> avg_error,</span>
<span id="cb55-2"><a href="behavioral-analysis.html#cb55-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">n_correct_sorts =</span> n_correct,</span>
<span id="cb55-3"><a href="behavioral-analysis.html#cb55-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">prcnt_correct_sorts =</span> prcnt_correct) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="behavioral-analysis.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_sorting_errors =</span> n_events_day<span class="sc">*</span>n_days <span class="sc">-</span> n_correct_sorts,</span>
<span id="cb55-5"><a href="behavioral-analysis.html#cb55-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">perfect_sort =</span> n_sorting_errors<span class="sc">==</span><span class="dv">0</span>,</span>
<span id="cb55-6"><a href="behavioral-analysis.html#cb55-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">perfect_sort =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(perfect_sort, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>)))</span>
<span id="cb55-7"><a href="behavioral-analysis.html#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="behavioral-analysis.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># SORTING AND TIMELINE ERRORS</span></span>
<span id="cb55-9"><a href="behavioral-analysis.html#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman correlation for all subjects and non-perfect sorters</span></span>
<span id="cb55-10"><a href="behavioral-analysis.html#cb55-10" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> beh_group <span class="sc">%$%</span></span>
<span id="cb55-11"><a href="behavioral-analysis.html#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(n_sorting_errors, avg_timeline_error,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-12"><a href="behavioral-analysis.html#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code></pre></div>
<pre><code>## Warning in cor.test.default(n_sorting_errors, avg_timeline_error, method = &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="behavioral-analysis.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot of errors in the two tasks</span></span>
<span id="cb57-2"><a href="behavioral-analysis.html#cb57-2" aria-hidden="true" tabindex="-1"></a>sfig_beh_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_group, <span class="fu">aes</span>(<span class="at">x=</span>n_sorting_errors, <span class="at">y=</span>avg_timeline_error)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="behavioral-analysis.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color=</span>ultimate_gray, <span class="at">fill=</span><span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="behavioral-analysis.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color=</span>ultimate_gray) <span class="sc">+</span> </span>
<span id="cb57-5"><a href="behavioral-analysis.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb57-6"><a href="behavioral-analysis.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;sorting errors&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="behavioral-analysis.html#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;timeline error&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="behavioral-analysis.html#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">hjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">vjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt,</span>
<span id="cb57-9"><a href="behavioral-analysis.html#cb57-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">&quot;r=%.2f</span><span class="sc">\n</span><span class="st">p=%.3f&quot;</span>, <span class="fu">round</span>(stats<span class="sc">$</span>estimate, <span class="at">digits =</span> <span class="dv">2</span>), <span class="fu">round</span>(stats<span class="sc">$</span>p.value, <span class="at">digits=</span><span class="dv">3</span>)),</span>
<span id="cb57-10"><a href="behavioral-analysis.html#cb57-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb57-11"><a href="behavioral-analysis.html#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb57-12"><a href="behavioral-analysis.html#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb57-13"><a href="behavioral-analysis.html#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb57-14"><a href="behavioral-analysis.html#cb57-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb57-15"><a href="behavioral-analysis.html#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb57-16"><a href="behavioral-analysis.html#cb57-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb57-17"><a href="behavioral-analysis.html#cb57-17" aria-hidden="true" tabindex="-1"></a>sfig_beh_c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Spearman correlation of number of sorting errors and mean absolute timeline errors:
r=0.23, p=0.246</p>
</div>
<div id="comparison-of-perfect-sorters-and-participants-with-sorting-errors" class="section level4 unnumbered">
<h4>Comparison of perfect sorters and participants with sorting errors</h4>
<p>The correlational approach is limited because there is limited variance for sorting errors as a large group of participants performs the sorting task at ceiling and does not make sorting errors. We thus compare in a next step the timeline errors between participants who do make at least one sorting erorr and those who don’t make sorting errors using an independent t-test.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="behavioral-analysis.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test based on perfect sorter or not</span></span>
<span id="cb58-2"><a href="behavioral-analysis.html#cb58-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">t.test</span>(beh_group<span class="sc">$</span>avg_timeline_error[beh_group<span class="sc">$</span>perfect_sort<span class="sc">==</span><span class="st">&quot;yes&quot;</span>], </span>
<span id="cb58-3"><a href="behavioral-analysis.html#cb58-3" aria-hidden="true" tabindex="-1"></a>                     beh_group<span class="sc">$</span>avg_timeline_error[beh_group<span class="sc">$</span>perfect_sort<span class="sc">==</span><span class="st">&quot;no&quot;</span>],</span>
<span id="cb58-4"><a href="behavioral-analysis.html#cb58-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">var.equal =</span> <span class="cn">TRUE</span>))</span>
<span id="cb58-5"><a href="behavioral-analysis.html#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="behavioral-analysis.html#cb58-6" aria-hidden="true" tabindex="-1"></a>sfig_beh_d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_group, <span class="fu">aes</span>(<span class="at">x=</span>perfect_sort, <span class="at">y=</span>avg_timeline_error, <span class="at">fill=</span>perfect_sort, <span class="at">color=</span>perfect_sort)) <span class="sc">+</span></span>
<span id="cb58-7"><a href="behavioral-analysis.html#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="behavioral-analysis.html#cb58-8" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data=</span>beh_group <span class="sc">%&gt;%</span> <span class="fu">filter</span>(perfect_sort<span class="sc">==</span><span class="st">&quot;yes&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>avg_timeline_error),</span>
<span id="cb58-9"><a href="behavioral-analysis.html#cb58-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="behavioral-analysis.html#cb58-10" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data=</span>beh_group <span class="sc">%&gt;%</span> <span class="fu">filter</span>(perfect_sort<span class="sc">==</span><span class="st">&quot;no&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">y=</span>avg_timeline_error),</span>
<span id="cb58-11"><a href="behavioral-analysis.html#cb58-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb58-12"><a href="behavioral-analysis.html#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">ifelse</span>(n_sorting_errors<span class="sc">==</span><span class="dv">0</span>, <span class="fl">1.2</span>, <span class="fl">1.8</span>)), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="behavioral-analysis.html#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb58-14"><a href="behavioral-analysis.html#cb58-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span> </span>
<span id="cb58-15"><a href="behavioral-analysis.html#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb58-16"><a href="behavioral-analysis.html#cb58-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb58-17"><a href="behavioral-analysis.html#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;timeline error&#39;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;sorting errors&#39;</span>) <span class="sc">+</span> </span>
<span id="cb58-18"><a href="behavioral-analysis.html#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;underline(&quot;    n.s.    &quot;)&#39;</span>, </span>
<span id="cb58-19"><a href="behavioral-analysis.html#cb58-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-20"><a href="behavioral-analysis.html#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;≥1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb58-21"><a href="behavioral-analysis.html#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#81A88D&quot;</span>, <span class="st">&quot;#972D15&quot;</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;no sorting error&quot;</span>, <span class="st">&quot;≥1 sorting error&quot;</span>)) <span class="sc">+</span></span>
<span id="cb58-22"><a href="behavioral-analysis.html#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#81A88D&quot;</span>, <span class="st">&quot;#972D15&quot;</span>)) <span class="sc">+</span></span>
<span id="cb58-23"><a href="behavioral-analysis.html#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="st">&quot;sorting task&quot;</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape=</span><span class="dv">16</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">0</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="dv">1</span>)), <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-24"><a href="behavioral-analysis.html#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb58-25"><a href="behavioral-analysis.html#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb58-26"><a href="behavioral-analysis.html#cb58-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb58-27"><a href="behavioral-analysis.html#cb58-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb58-28"><a href="behavioral-analysis.html#cb58-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb58-29"><a href="behavioral-analysis.html#cb58-29" aria-hidden="true" tabindex="-1"></a>sfig_beh_d</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>Summary Statistics: independent t-test comparing timeline errors for participants without and with sorting errors
t<sub>26</sub>=-1.79, p=0.085, 95% CI [-0.66, 0.05]</p>
</div>
</div>
<div id="time-metrics-underlying-remembered-times" class="section level3 unnumbered">
<h3>Time metrics underlying remembered times</h3>
<blockquote>
<p>Using two approaches we tested whether virtual time drove participants’ responses rather than the sequence order or objectively elapsing time.</p>
</blockquote>
<p>While participants were asked to reproduce the virtual time, any of the other two factors could have an impact on their behavioral responses. If participants had, for example, only memorized the order of scenes in a given day, they would probably do reasonably well on the timeline task by distributing the scenes evenly along the timeline in the correct order.</p>
<div id="summary-statistics-1" class="section level4 unnumbered">
<h4>Summary Statistics</h4>
<blockquote>
<p>For the summary statistics approach, we ran a multiple regression analysis for each participant with virtual time, sequence position (order), and real time since the first event of a day as predictors of responses in the timeline task. To test whether virtual time indeed explained participants’ responses even when competing for variance with order and real time, included in the model as control predictors of no interest, we compared the participant-specific t-values of the resulting regression coefficients against null distributions obtained from shuffling the remembered times against the predictors 10,000 times. We converted the resulting p-values to Z-values and tested these against zero using a permutation-based t-test (two-sided; α=0.05; 10,000 random sign-flips, Figure 2E). As a measure of effect size, we report Cohen’s d with Hedges’ correction and its 95% confidence interval as computed using the effsize-package(101).</p>
</blockquote>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="behavioral-analysis.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">115</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb59-2"><a href="behavioral-analysis.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="behavioral-analysis.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># do RSA using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb59-4"><a href="behavioral-analysis.html#cb59-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="behavioral-analysis.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model</span></span>
<span id="cb59-6"><a href="behavioral-analysis.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb59-7"><a href="behavioral-analysis.html#cb59-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;memory_time ~ virtual_time + event + real_time&quot;</span>,</span>
<span id="cb59-8"><a href="behavioral-analysis.html#cb59-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="behavioral-analysis.html#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb59-10"><a href="behavioral-analysis.html#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb59-11"><a href="behavioral-analysis.html#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="behavioral-analysis.html#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_id =</span> <span class="fu">factor</span>(z_id, </span>
<span id="cb59-13"><a href="behavioral-analysis.html#cb59-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;z_virtual_time&quot;</span>, <span class="st">&quot;z_order&quot;</span>, <span class="st">&quot;z_real_time&quot;</span>)))</span>
<span id="cb59-14"><a href="behavioral-analysis.html#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="behavioral-analysis.html#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-test for virtual time</span></span>
<span id="cb59-16"><a href="behavioral-analysis.html#cb59-16" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb59-17"><a href="behavioral-analysis.html#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-18"><a href="behavioral-analysis.html#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb59-19"><a href="behavioral-analysis.html#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb59-20"><a href="behavioral-analysis.html#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="behavioral-analysis.html#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb59-22"><a href="behavioral-analysis.html#cb59-22" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(fit <span class="sc">%&gt;%</span> <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;z_virtual_time&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(z))<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb59-23"><a href="behavioral-analysis.html#cb59-23" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb59-24"><a href="behavioral-analysis.html#cb59-24" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb59-25"><a href="behavioral-analysis.html#cb59-25" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb59-26"><a href="behavioral-analysis.html#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="behavioral-analysis.html#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb59-28"><a href="behavioral-analysis.html#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:multiple regression timeline">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">2.44</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10.6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.82e-11</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.97</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.91</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.95</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.38</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2.7</td></tr>
</table>

<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="behavioral-analysis.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot of the results</span></span>
<span id="cb60-2"><a href="behavioral-analysis.html#cb60-2" aria-hidden="true" tabindex="-1"></a>f2e <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit, <span class="fu">aes</span>(<span class="at">x=</span>z_id, <span class="at">y=</span>z, <span class="at">fill =</span> z_id, <span class="at">colour =</span> z_id)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="behavioral-analysis.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the violin</span></span>
<span id="cb60-4"><a href="behavioral-analysis.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="behavioral-analysis.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># single subject data points with horizontal jitter</span></span>
<span id="cb60-6"><a href="behavioral-analysis.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(z_id)<span class="sc">-</span>.<span class="dv">2</span>, <span class="at">y =</span> z, <span class="at">colour =</span> z_id), <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb60-7"><a href="behavioral-analysis.html#cb60-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="behavioral-analysis.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> z_id, <span class="at">y =</span> z), </span>
<span id="cb60-9"><a href="behavioral-analysis.html#cb60-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb60-10"><a href="behavioral-analysis.html#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb60-11"><a href="behavioral-analysis.html#cb60-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span> </span>
<span id="cb60-12"><a href="behavioral-analysis.html#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb60-13"><a href="behavioral-analysis.html#cb60-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="behavioral-analysis.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Z multiple regression&#39;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;time metric&#39;</span>) <span class="sc">+</span> </span>
<span id="cb60-15"><a href="behavioral-analysis.html#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virt. time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb60-16"><a href="behavioral-analysis.html#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">4.5</span>))<span class="sc">+</span></span>
<span id="cb60-17"><a href="behavioral-analysis.html#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>),<span class="at">values=</span>time_colors) <span class="sc">+</span></span>
<span id="cb60-18"><a href="behavioral-analysis.html#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>),<span class="at">values=</span>time_colors) <span class="sc">+</span></span>
<span id="cb60-19"><a href="behavioral-analysis.html#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>), </span>
<span id="cb60-20"><a href="behavioral-analysis.html#cb60-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">title =</span> <span class="fu">element_blank</span>(), <span class="at">direction =</span><span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb60-21"><a href="behavioral-analysis.html#cb60-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">title.position =</span> <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb60-22"><a href="behavioral-analysis.html#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb60-23"><a href="behavioral-analysis.html#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb60-24"><a href="behavioral-analysis.html#cb60-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb60-25"><a href="behavioral-analysis.html#cb60-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&#39;mm&#39;</span>), <span class="co">#legend.spacing.y = unit(2, &#39;mm&#39;),</span></span>
<span id="cb60-26"><a href="behavioral-analysis.html#cb60-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">3</span>,<span class="st">&quot;mm&quot;</span>), </span>
<span id="cb60-27"><a href="behavioral-analysis.html#cb60-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="st">&quot;mm&quot;</span>), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">size=</span><span class="dv">0</span>))</span>
<span id="cb60-28"><a href="behavioral-analysis.html#cb60-28" aria-hidden="true" tabindex="-1"></a>f2e</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/multiple%20regression%20timeline-1.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="behavioral-analysis.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb61-2"><a href="behavioral-analysis.html#cb61-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f2e)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb61-3"><a href="behavioral-analysis.html#cb61-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y, group), </span>
<span id="cb61-4"><a href="behavioral-analysis.html#cb61-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f2e.txt&quot;</span>))</span></code></pre></div>
<p>Summary Statistics: t-test against 0 for virtual time when order and real time are in the model<br />
t<sub>27</sub>=10.62, p=0.000, d=1.95, 95% CI [1.38, 2.70]</p>
</div>
<div id="linear-mixed-effects-1" class="section level4 unnumbered">
<h4>Linear mixed effects</h4>
<p>A potentially more elegant way of testing the above is to use linear mixed effects models. However, drawing statistical inferences from these data is less straight forward and care needs to be taken with respect to the precise hypotheses that are tested.</p>
<blockquote>
<p>Second, we addressed this question using linear mixed effects modeling. Here, we included the three z-scored time metrics as fixed effects. Starting from a maximal random effect structure(102), we simplified the random effects structure to avoid convergence failures and singular fits. The final model included random intercepts and random slopes for virtual time for participants. The model results are visualized by dot plots showing the fixed effect parameters with their 95% confidence intervals (Supplemental Figure 4A) and marginal effects (Supplemental Figure 4B) estimated using the ggeffects package103. To assess the statistical significance (α=0.05) of virtual time above and beyond the effects of order and real time, we compared this full model to a nested model without the fixed effect of virtual time, but including order and real time, using a likelihood ratio test. Supplemental Table 1 provides an overview of the final model and the model comparison.</p>
</blockquote>
<p>The main point we want to make is that virtual time explains variance above and beyond order. To test this, we run the full LMM and a reduced version of the model without virtual time. These two models are then compared using a likelihood ratio test to obtain a p-value.</p>
<p>Following Barr et al. (2013), we want to implement a maximal random effect structure. However, for the models to converge and to avoid singular fits, we have to simplify the random effects structure to include only random intercepts for each subject and a random slope for the effect of virtual time for each subject. Barr et al. (2013, p. 275) “propose the working assumption that it is not essential for one to specify random effects for control predictors to avoid anti-conservative inference, as long as interactions between the control predictors and the factors of interest are not present in the model”. However, “in the common case where one is interested in a minimally anti-conservative evaluation of the strength of evidence for the presence of an effect, our results indicate that keeping the random slope for the predictor of theoretical interest is important” (Barr et al., 2013, p. 276). Thus, we keep the random slopes for virtual time in the model.</p>
<p>More specifically, we follow these steps:</p>
<ul>
<li>we start with a model that includes random intercepts and slopes for all 3 fixed effects for each subject. This results in a singular fit</li>
<li>Thus, we drop the random effects of real time and order.</li>
</ul>
<p>We do not incorporate random intercepts for the individual events as this sampling unit cannot be dissociated from the predictors. See the description of the exception by Brauer &amp; Curtin (<a href="http://doi.apa.org/getdoi.cfm?doi=10.1037/met0000159">Psych Methods, 2018, p. 13</a>).</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="behavioral-analysis.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># center the predictor variables (set scale to true for z-score)</span></span>
<span id="cb62-2"><a href="behavioral-analysis.html#cb62-2" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="behavioral-analysis.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="behavioral-analysis.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-5"><a href="behavioral-analysis.html#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">order_z =</span> <span class="fu">scale</span>(<span class="fu">as.numeric</span>(event), <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-6"><a href="behavioral-analysis.html#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">virtual_time_z =</span> <span class="fu">scale</span>(virtual_time, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-7"><a href="behavioral-analysis.html#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">real_time_z =</span> <span class="fu">scale</span>(real_time, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-8"><a href="behavioral-analysis.html#cb62-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="behavioral-analysis.html#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb62-10"><a href="behavioral-analysis.html#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="behavioral-analysis.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># set RNG</span></span>
<span id="cb62-12"><a href="behavioral-analysis.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">27</span>)</span>
<span id="cb62-13"><a href="behavioral-analysis.html#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="behavioral-analysis.html#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># define the full model with all 3 time metrics as fixed effects and </span></span>
<span id="cb62-15"><a href="behavioral-analysis.html#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co"># by-subject random intercepts and random slopes for each time metric --&gt; singular fit</span></span>
<span id="cb62-16"><a href="behavioral-analysis.html#cb62-16" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;memory_time ~ virtual_time_z + order_z + real_time_z + (1 + virtual_time_z + order_z + real_time_z | sub_id)&quot;</span></span>
<span id="cb62-17"><a href="behavioral-analysis.html#cb62-17" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> beh_data,</span>
<span id="cb62-18"><a href="behavioral-analysis.html#cb62-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">20000</span>)))</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="behavioral-analysis.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove random slopes for the fixed effects of non-interest (order and real time)</span></span>
<span id="cb64-2"><a href="behavioral-analysis.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># by-subject random intercepts and random slopes for virtual time</span></span>
<span id="cb64-3"><a href="behavioral-analysis.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">212</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb64-4"><a href="behavioral-analysis.html#cb64-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;memory_time ~ virtual_time_z + order_z + real_time_z + (1 + virtual_time_z | sub_id)&quot;</span>   </span>
<span id="cb64-5"><a href="behavioral-analysis.html#cb64-5" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> beh_data,</span>
<span id="cb64-6"><a href="behavioral-analysis.html#cb64-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">20000</span>)))</span>
<span id="cb64-7"><a href="behavioral-analysis.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmm_full)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: memory_time ~ virtual_time_z + order_z + real_time_z + (1 + virtual_time_z |      sub_id)
##    Data: beh_data
## Control: lmerControl(optCtrl = list(maxfun = 20000))
## 
##      AIC      BIC   logLik deviance df.resid 
##   1940.0   1974.6   -962.0   1924.0      552 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -7.3874 -0.4034  0.0429  0.4259  7.8191 
## 
## Random effects:
##  Groups   Name           Variance Std.Dev. Corr
##  sub_id   (Intercept)    0.04928  0.2220       
##           virtual_time_z 0.02742  0.1656   0.23
##  Residual                1.75541  1.3249       
## Number of obs: 560, groups:  sub_id, 28
## 
## Fixed effects:
##                Estimate Std. Error t value
## (Intercept)    14.01002    0.06996 200.252
## virtual_time_z  3.06932    0.25997  11.807
## order_z         1.66763    0.43023   3.876
## real_time_z    -0.33226    0.47331  -0.702
## 
## Correlation of Fixed Effects:
##             (Intr) vrtl__ ordr_z
## virtul_tm_z  0.017              
## order_z      0.000 -0.112       
## real_time_z  0.000 -0.426 -0.841</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="behavioral-analysis.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb66-2"><a href="behavioral-analysis.html#cb66-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="behavioral-analysis.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb68-2"><a href="behavioral-analysis.html#cb68-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span></code></pre></div>
<p>To test whether virtual time is relevant to explaining the data even when order and real time are in the model, we compare the full model defined above against a reduced model. In this reduced model, we do not include the fixed effect of virtual time. We compare the full against the nested (reduced) model using a likelihood ratio test.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="behavioral-analysis.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to test for significance let&#39;s by comparing the likelihood against a simpler model.</span></span>
<span id="cb69-2"><a href="behavioral-analysis.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we drop the effect of virtual time and run an ANOVA. See e.g. Bodo Winter tutorial</span></span>
<span id="cb69-3"><a href="behavioral-analysis.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the current best way of testing the effect of virtual time on behavior</span></span>
<span id="cb69-4"><a href="behavioral-analysis.html#cb69-4" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="st">&quot;memory_time ~ order_z + real_time_z + (1 + virtual_time_z | sub_id)&quot;</span> <span class="co"># random intercepts for each subject and random slopes for virtual time </span></span>
<span id="cb69-5"><a href="behavioral-analysis.html#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">213</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb69-6"><a href="behavioral-analysis.html#cb69-6" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(formula, <span class="at">data =</span> beh_data, <span class="at">REML =</span> <span class="cn">FALSE</span>, <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="dv">20000</span>)))</span>
<span id="cb69-7"><a href="behavioral-analysis.html#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="behavioral-analysis.html#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># because the model fails to converge with a warning that the scaled gradient at the fitted (RE)ML estimates </span></span>
<span id="cb69-9"><a href="behavioral-analysis.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># is large, we restart the model as described here (https://rdrr.io/cran/lme4/man/troubleshooting.html)</span></span>
<span id="cb69-10"><a href="behavioral-analysis.html#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining consistent results (with no warning) suggests a false positive </span></span>
<span id="cb69-11"><a href="behavioral-analysis.html#cb69-11" aria-hidden="true" tabindex="-1"></a>lmm_no_vir_time <span class="ot">&lt;-</span> <span class="fu">update</span>(lmm_no_vir_time, <span class="at">start=</span><span class="fu">getME</span>(lmm_no_vir_time, <span class="st">&quot;theta&quot;</span>))</span>
<span id="cb69-12"><a href="behavioral-analysis.html#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="behavioral-analysis.html#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run the ANOVA</span></span>
<span id="cb69-14"><a href="behavioral-analysis.html#cb69-14" aria-hidden="true" tabindex="-1"></a>lmm_aov <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmm_no_vir_time, lmm_full)</span>
<span id="cb69-15"><a href="behavioral-analysis.html#cb69-15" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-39">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.05e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.08e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-1.02e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.04e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.94e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.97e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-962&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.92e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">116</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.88e-27</td></tr>
</table>

<p>Mixed Model: Fixed effect of virtual time time with order and real time in the model of remembered times
<span class="math inline">\(\chi^2\)</span>(1)=115.95, p=0.000</p>
<p>Make mixed model summary table that includes overview of fixed and random effects as well as the model comparison to the nested (reduced) model.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="behavioral-analysis.html#cb70-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)</span>
<span id="cb70-2"><a href="behavioral-analysis.html#cb70-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">3</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb70-3"><a href="behavioral-analysis.html#cb70-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;virtual time (SD)&quot;</span>, <span class="st">&quot;correlation random intercepts and random slopes&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb70-4"><a href="behavioral-analysis.html#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="behavioral-analysis.html#cb70-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb70-6"><a href="behavioral-analysis.html#cb70-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb70-7"><a href="behavioral-analysis.html#cb70-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb70-8"><a href="behavioral-analysis.html#cb70-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb70-9"><a href="behavioral-analysis.html#cb70-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb70-10"><a href="behavioral-analysis.html#cb70-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb70-11"><a href="behavioral-analysis.html#cb70-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb70-12"><a href="behavioral-analysis.html#cb70-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb70-13"><a href="behavioral-analysis.html#cb70-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Virtual time explains constructed times with order and real time in the model&quot;</span>)</span>
<span id="cb70-14"><a href="behavioral-analysis.html#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="behavioral-analysis.html#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb70-16"><a href="behavioral-analysis.html#cb70-16" aria-hidden="true" tabindex="-1"></a>stable_lme_memtime_time_metrics <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb70-17"><a href="behavioral-analysis.html#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="behavioral-analysis.html#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb70-19"><a href="behavioral-analysis.html#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-40">
<caption style="caption-side: top; text-align: left;">Mixed Model: Virtual time explains constructed times with order and real time in the model</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">14.010019</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.069962</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">200.25</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">13.868056</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">14.151981</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">virtual time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.069324</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.259967</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.81</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.558874</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3.579774</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">order</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.667630</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.430230</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.88</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.822785</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2.512476</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">real time</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.332261</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.473306</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.70</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.261696</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.597173</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.221991</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual time (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.232089</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">correlation random intercepts and random slopes</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.165592</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.324919</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">7</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2053.90</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1019.95</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">8</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1939.95</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-961.98</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">115.95</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">4.88e-27</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: memory_time~virtual_time_z+order_z+real_time_z+(1+virtual_time_z|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>To visualize the model, we use the confidence intervals to create dot plots for the model coefficients. Further, we estimate marginal means for each fixed effect while holding the other parameters constant. We do this for the quartiles (including minimum and maximum values).</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="behavioral-analysis.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the time metrics a factor</span></span>
<span id="cb71-2"><a href="behavioral-analysis.html#cb71-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> lmm_full_bm <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="behavioral-analysis.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term=</span><span class="fu">as.factor</span>(term) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="behavioral-analysis.html#cb71-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual_time_z&quot;</span>, <span class="st">&quot;order_z&quot;</span>, <span class="st">&quot;real_time_z&quot;</span>)))</span>
<span id="cb71-5"><a href="behavioral-analysis.html#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="behavioral-analysis.html#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb71-7"><a href="behavioral-analysis.html#cb71-7" aria-hidden="true" tabindex="-1"></a>sfigmm_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb71-8"><a href="behavioral-analysis.html#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-9"><a href="behavioral-analysis.html#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb71-10"><a href="behavioral-analysis.html#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb71-11"><a href="behavioral-analysis.html#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> time_colors) <span class="sc">+</span></span>
<span id="cb71-12"><a href="behavioral-analysis.html#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> time_colors, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time (same seq.)&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>), <span class="at">name =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-13"><a href="behavioral-analysis.html#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="co">#title = &quot;Fixed Effect Coefficients&quot;,</span></span>
<span id="cb71-14"><a href="behavioral-analysis.html#cb71-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y=</span><span class="st">&quot;fixed</span><span class="sc">\n</span><span class="st">effect estimate&quot;</span>, <span class="at">color =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-15"><a href="behavioral-analysis.html#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb71-16"><a href="behavioral-analysis.html#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coord_fixed(ratio = 3) +</span></span>
<span id="cb71-17"><a href="behavioral-analysis.html#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-18"><a href="behavioral-analysis.html#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">linetype=</span><span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb71-19"><a href="behavioral-analysis.html#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use)</span>
<span id="cb71-20"><a href="behavioral-analysis.html#cb71-20" aria-hidden="true" tabindex="-1"></a>sfigmm_a</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="behavioral-analysis.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb72-2"><a href="behavioral-analysis.html#cb72-2" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> get_complete_df</span>
<span id="cb72-3"><a href="behavioral-analysis.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the group variable to a factor to control the order of facets below</span></span>
<span id="cb72-4"><a href="behavioral-analysis.html#cb72-4" aria-hidden="true" tabindex="-1"></a>lmm_full_emm<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(lmm_full_emm<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual_time_z&quot;</span>, <span class="st">&quot;order_z&quot;</span>, <span class="st">&quot;real_time_z&quot;</span>))</span>
<span id="cb72-5"><a href="behavioral-analysis.html#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="behavioral-analysis.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb72-7"><a href="behavioral-analysis.html#cb72-7" aria-hidden="true" tabindex="-1"></a>sfigmm_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb72-8"><a href="behavioral-analysis.html#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb72-9"><a href="behavioral-analysis.html#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="behavioral-analysis.html#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> time_colors, <span class="at">name=</span><span class="fu">element_blank</span>(),</span>
<span id="cb72-11"><a href="behavioral-analysis.html#cb72-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;virtual time&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;real time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb72-12"><a href="behavioral-analysis.html#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> time_colors, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Virtual Time&quot;</span>, <span class="st">&quot;Order&quot;</span>, <span class="st">&quot;Real Time&quot;</span>)) <span class="sc">+</span></span>
<span id="cb72-13"><a href="behavioral-analysis.html#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb72-14"><a href="behavioral-analysis.html#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;z time metric&#39;</span>) <span class="sc">+</span></span>
<span id="cb72-15"><a href="behavioral-analysis.html#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">19</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb72-16"><a href="behavioral-analysis.html#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-17"><a href="behavioral-analysis.html#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb72-18"><a href="behavioral-analysis.html#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-19"><a href="behavioral-analysis.html#cb72-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>()) </span>
<span id="cb72-20"><a href="behavioral-analysis.html#cb72-20" aria-hidden="true" tabindex="-1"></a>sfigmm_b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<div id="lme-model-assumptions" class="section level5 unnumbered">
<h5>LME model assumptions</h5>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="behavioral-analysis.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmm_diagplots_jb</span>(lmm_full)</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<ul>
<li>Absence of collinearity: The different time metrics are correlated. This correlation is slightly reduced by z-scoring the predictors. In any case, these correlations are inherent to the design and not really a problem as long as estimated coefficients are interpreted correctly. For more info, see e.g. this <a href="https://osf.io/8x4uc/">opinion piece</a>.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="compose-figure-for-behavioral-data" class="section level2 unnumbered">
<h2>Compose Figure for Behavioral Data</h2>
<p>This figure consists of the plots showing the results of the sorting task and the timeline task. It will probably be figure 2 of the manuscript.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="behavioral-analysis.html#cb74-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb74-2"><a href="behavioral-analysis.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBBBBDDDDDD</span></span>
<span id="cb74-3"><a href="behavioral-analysis.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBBBBDDDDDD</span></span>
<span id="cb74-4"><a href="behavioral-analysis.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBBBBDDDDDD</span></span>
<span id="cb74-5"><a href="behavioral-analysis.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBBBBDDDDDD</span></span>
<span id="cb74-6"><a href="behavioral-analysis.html#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBBBBDDDDDD</span></span>
<span id="cb74-7"><a href="behavioral-analysis.html#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBBBBDDDDDD</span></span>
<span id="cb74-8"><a href="behavioral-analysis.html#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="st">CCBBBBBBEEEEEE</span></span>
<span id="cb74-9"><a href="behavioral-analysis.html#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="st">CCBBBBBBEEEEEE</span></span>
<span id="cb74-10"><a href="behavioral-analysis.html#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="st">CCBBBBBBEEEEEE</span></span>
<span id="cb74-11"><a href="behavioral-analysis.html#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="st">CCBBBBBBEEEEEE</span></span>
<span id="cb74-12"><a href="behavioral-analysis.html#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="st">CCBBBBBBEEEEEE</span></span>
<span id="cb74-13"><a href="behavioral-analysis.html#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="st">CCBBBBBBEEEEEE&quot;</span></span>
<span id="cb74-14"><a href="behavioral-analysis.html#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="behavioral-analysis.html#cb74-15" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> f2a <span class="sc">+</span> f2b <span class="sc">+</span> f2c <span class="sc">+</span> f2d <span class="sc">+</span> f2e <span class="sc">+</span> </span>
<span id="cb74-16"><a href="behavioral-analysis.html#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb74-17"><a href="behavioral-analysis.html#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb74-18"><a href="behavioral-analysis.html#cb74-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb74-19"><a href="behavioral-analysis.html#cb74-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb74-20"><a href="behavioral-analysis.html#cb74-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)</span>
<span id="cb74-21"><a href="behavioral-analysis.html#cb74-21" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">&amp;</span></span>
<span id="cb74-22"><a href="behavioral-analysis.html#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)),</span>
<span id="cb74-23"><a href="behavioral-analysis.html#cb74-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb74-24"><a href="behavioral-analysis.html#cb74-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-25"><a href="behavioral-analysis.html#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="co"># save as png and pdf and print to screen</span></span>
<span id="cb74-26"><a href="behavioral-analysis.html#cb74-26" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;f2&quot;</span>)</span>
<span id="cb74-27"><a href="behavioral-analysis.html#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>f2, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb74-28"><a href="behavioral-analysis.html#cb74-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">16</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb74-29"><a href="behavioral-analysis.html#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>f2, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb74-30"><a href="behavioral-analysis.html#cb74-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">16</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/f2.png" alt="" />
<p class="caption">Figure 2. Participants learn the temporal structure of the sequences relative to the virtual clock. A. Plot shows the percentage of correctly sorted event images in the sorting task. B. Constructed event times were assessed in the timeline task. Responses are shown separately for the five events (color coded according to true virtual time) of each sequence (rows). Colored circles with gray outline show true event times. C, D. Mean absolute errors in constructed times (in virtual hours) are shown (C) averaged across events and sequences and (D) averaged separately for the five event positions. E. Z-values for the effects of different time metrics from participant-specific multiple regression analyses and permutation tests show that virtual time explained constructed event times with event order and real time in the model as control predictors. A-E. Circles are individual participant data; boxplots show median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distributions show probability density function of data points. ***p&lt;0.001</p>
</div>
</div>
<div id="generalization-bias" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Generalization bias</h2>
<p>If participants use structural knowledge about the sequences when constructing times of events, then we might expect biases in their behavior: Errors in constructed event times could be non-random. Specifically, when constructing the time of one specific event, participants could be biased in their response by the times of the events from other sequences at that sequence position. This would indicate that knowledge about the other sequences in generalized to influence specific mnemonic constructions, resulting in a bias.</p>
<div id="quantify-relative-time-of-other-events" class="section level3 unnumbered">
<h3>Quantify relative time of other events</h3>
<blockquote>
<p>To explore whether structural knowledge about general time patterns biases the construction of event times, we assessed errors in remembered event times. Specifically, when constructing the time of one specific event, participants could be biased in their response by the times of the events from other sequences at that sequence position. For each event, we quantified the average time of events in the other sequences at the same sequence position (Figure 8A). For example, for the fourth event of the first sequence, we calculated the average time of the fourth events of sequences two, three and four.</p>
</blockquote>
<p>To test for such a bias, we quantify, for each event, the relative time of the other events at that sequence position. We then calculate by how much virtual time each individual event time deviates from the average virtual time of the other events at that sequence position (e.g. the difference in virtual time for event 1 from sequence 1 compared to the average virtual time of events 1 from sequences 2-4). We do this so that positive values of this relative time measure indicate that the other events happened later than the event of interest.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="behavioral-analysis.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantify the deviation in virtual time for each event relative to other events </span></span>
<span id="cb75-2"><a href="behavioral-analysis.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># at the same sequence position</span></span>
<span id="cb75-3"><a href="behavioral-analysis.html#cb75-3" aria-hidden="true" tabindex="-1"></a>beh_data<span class="sc">$</span>rel_time_other_events<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb75-4"><a href="behavioral-analysis.html#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="behavioral-analysis.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_day <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_days){</span>
<span id="cb75-6"><a href="behavioral-analysis.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_event <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_events_day){</span>
<span id="cb75-7"><a href="behavioral-analysis.html#cb75-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-8"><a href="behavioral-analysis.html#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the events at this sequence position from all four sequences</span></span>
<span id="cb75-9"><a href="behavioral-analysis.html#cb75-9" aria-hidden="true" tabindex="-1"></a>    curr_events <span class="ot">&lt;-</span> beh_data[beh_data<span class="sc">$</span>event <span class="sc">==</span> i_event,]</span>
<span id="cb75-10"><a href="behavioral-analysis.html#cb75-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-11"><a href="behavioral-analysis.html#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the average virtual time of the other events at this sequence position</span></span>
<span id="cb75-12"><a href="behavioral-analysis.html#cb75-12" aria-hidden="true" tabindex="-1"></a>    avg_vir_time_other_events <span class="ot">&lt;-</span> curr_events <span class="sc">%&gt;%</span> </span>
<span id="cb75-13"><a href="behavioral-analysis.html#cb75-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(day <span class="sc">!=</span> i_day) <span class="sc">%&gt;%</span></span>
<span id="cb75-14"><a href="behavioral-analysis.html#cb75-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">avg_vir_time =</span> <span class="fu">mean</span>(virtual_time)) <span class="sc">%&gt;%</span></span>
<span id="cb75-15"><a href="behavioral-analysis.html#cb75-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(avg_vir_time) <span class="sc">%&gt;%</span></span>
<span id="cb75-16"><a href="behavioral-analysis.html#cb75-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(.)</span>
<span id="cb75-17"><a href="behavioral-analysis.html#cb75-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-18"><a href="behavioral-analysis.html#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for the given event, store the relative time of the other events,</span></span>
<span id="cb75-19"><a href="behavioral-analysis.html#cb75-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># as the difference in virtual time (positive values mean other events happen later)</span></span>
<span id="cb75-20"><a href="behavioral-analysis.html#cb75-20" aria-hidden="true" tabindex="-1"></a>    event_idx <span class="ot">&lt;-</span> beh_data<span class="sc">$</span>day<span class="sc">==</span>i_day <span class="sc">&amp;</span> beh_data<span class="sc">$</span>event<span class="sc">==</span>i_event</span>
<span id="cb75-21"><a href="behavioral-analysis.html#cb75-21" aria-hidden="true" tabindex="-1"></a>    beh_data<span class="sc">$</span>rel_time_other_events[event_idx] <span class="ot">&lt;-</span> avg_vir_time_other_events <span class="sc">-</span> beh_data<span class="sc">$</span>virtual_time[event_idx]</span>
<span id="cb75-22"><a href="behavioral-analysis.html#cb75-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-23"><a href="behavioral-analysis.html#cb75-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="test-generalization-bias" class="section level3 unnumbered">
<h3>Test Generalization Bias</h3>
<blockquote>
<p>We then asked whether the deviation between the average time of other events and an event’s true virtual time was systematically related to signed errors in constructed event times. A positive relationship between the relative time of other events and time construction errors indicates that, when other events at the same sequence position are relatively late, participants are biased to construct a later time for a given event than when the other events took place relatively early.</p>
</blockquote>
<p>The crucial test is then whether over- and underestimates of remembered time can be explained by this deviation measure.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="behavioral-analysis.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate timeline error so that positive numbers mean overestimates (later than true virtual time)</span></span>
<span id="cb76-2"><a href="behavioral-analysis.html#cb76-2" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="behavioral-analysis.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timeline_error=</span>memory_time<span class="sc">-</span>virtual_time)</span></code></pre></div>
<div id="summary-statistics-2" class="section level4 unnumbered">
<h4>Summary statistics</h4>
<blockquote>
<p>In the summary statistics approach, we ran a linear regression for each participant (Figure 8B, Supplemental Figure 10A) and tested the resulting coefficients for statistical significance using the permutation-based procedures described above (Figure 8C).</p>
</blockquote>
<p>In the summary statistics approach, we run a linear regression model for each participant and test the resulting coefficients against a permutation-based null distribution. The resulting z-scores are then tested against 0 on the group level.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="behavioral-analysis.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SUMMARY STATISTICS</span></span>
<span id="cb77-2"><a href="behavioral-analysis.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">117</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb77-3"><a href="behavioral-analysis.html#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="behavioral-analysis.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test for generalization bias using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb77-5"><a href="behavioral-analysis.html#cb77-5" aria-hidden="true" tabindex="-1"></a>fit_beh_bias <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb77-6"><a href="behavioral-analysis.html#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model (also without permutation tests to get betas)</span></span>
<span id="cb77-7"><a href="behavioral-analysis.html#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">model =</span> <span class="fu">lm</span>(timeline_error <span class="sc">~</span> rel_time_other_events, <span class="at">data=</span>.),</span>
<span id="cb77-8"><a href="behavioral-analysis.html#cb77-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb77-9"><a href="behavioral-analysis.html#cb77-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;timeline_error ~ rel_time_other_events&quot;</span>,</span>
<span id="cb77-10"><a href="behavioral-analysis.html#cb77-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb77-11"><a href="behavioral-analysis.html#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># store beta estimates and their z-values</span></span>
<span id="cb77-12"><a href="behavioral-analysis.html#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">beta_rel_time_other_events =</span> <span class="fu">coef</span>(<span class="fu">summary</span>(model))[<span class="dv">2</span>,<span class="st">&quot;Estimate&quot;</span>],</span>
<span id="cb77-13"><a href="behavioral-analysis.html#cb77-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">t_rel_time_other_events =</span> <span class="fu">coef</span>(<span class="fu">summary</span>(model))[<span class="dv">2</span>,<span class="st">&quot;t value&quot;</span>],</span>
<span id="cb77-14"><a href="behavioral-analysis.html#cb77-14" aria-hidden="true" tabindex="-1"></a>         <span class="co">#p_rel_time_other_events = coef(summary(model))[2,&quot;Pr(&gt;|t|)&quot;],</span></span>
<span id="cb77-15"><a href="behavioral-analysis.html#cb77-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;rel_time_other_events&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb77-16"><a href="behavioral-analysis.html#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get rid of intercept z-values and model column</span></span>
<span id="cb77-17"><a href="behavioral-analysis.html#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb77-18"><a href="behavioral-analysis.html#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-19"><a href="behavioral-analysis.html#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (.,<span class="sc">-</span><span class="fu">c</span>(model))</span>
<span id="cb77-20"><a href="behavioral-analysis.html#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="behavioral-analysis.html#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add Pearson correlation (for plot annotation only)</span></span>
<span id="cb77-22"><a href="behavioral-analysis.html#cb77-22" aria-hidden="true" tabindex="-1"></a>fit_beh_bias<span class="sc">$</span>r <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb77-23"><a href="behavioral-analysis.html#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb77-24"><a href="behavioral-analysis.html#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r =</span> <span class="fu">cor</span>(rel_time_other_events, timeline_error)) <span class="sc">%&gt;%</span></span>
<span id="cb77-25"><a href="behavioral-analysis.html#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(r)</span>
<span id="cb77-26"><a href="behavioral-analysis.html#cb77-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-27"><a href="behavioral-analysis.html#cb77-27" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb77-28"><a href="behavioral-analysis.html#cb77-28" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> fit_beh_bias <span class="sc">%&gt;%</span> </span>
<span id="cb77-29"><a href="behavioral-analysis.html#cb77-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;rel_time_other_events&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-30"><a href="behavioral-analysis.html#cb77-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb77-31"><a href="behavioral-analysis.html#cb77-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb77-32"><a href="behavioral-analysis.html#cb77-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-33"><a href="behavioral-analysis.html#cb77-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb77-34"><a href="behavioral-analysis.html#cb77-34" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>fit_beh_bias<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span>
<span id="cb77-35"><a href="behavioral-analysis.html#cb77-35" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb77-36"><a href="behavioral-analysis.html#cb77-36" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb77-37"><a href="behavioral-analysis.html#cb77-37" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb77-38"><a href="behavioral-analysis.html#cb77-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-39"><a href="behavioral-analysis.html#cb77-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb77-40"><a href="behavioral-analysis.html#cb77-40" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-47">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">1.38</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.32</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.3e-05</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.849</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.92</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.976</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.552</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.48</td></tr>
</table>

Summary Statistics: t-test against 0 for generalization bias<br />
t<sub>27</sub>=5.32, p=0.000, d=0.98, 95% CI [0.55, 1.48]</p>
<p>We observe a significant positive effect of the virtual time of other events at the same sequence position on remembered virtual time. That means that when other events at the same sequence position are later than a given event, participants are likely to overestimate the event time. Conversely, when the other events at this sequence position relatively early, participants underestimate. This demonstrates an across-sequence effect of virtual time. Virtual time is generalized across sequences to bias remembered times at similar sequence positions.</p>
<p>To illustrate this effect, lets plot the data for one example subject (data from all subjects will be plotted below). For this, we pick a subject with an average fit.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="behavioral-analysis.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pick average subject based on t-value of regression</span></span>
<span id="cb78-2"><a href="behavioral-analysis.html#cb78-2" aria-hidden="true" tabindex="-1"></a>example_sub <span class="ot">&lt;-</span> fit_beh_bias<span class="sc">$</span>sub_id[<span class="fu">sort</span>(fit_beh_bias<span class="sc">$</span>t_rel_time_other_events, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[n_subs<span class="sc">/</span><span class="dv">2</span>]<span class="sc">==</span>fit_beh_bias<span class="sc">$</span>t_rel_time_other_events]</span>
<span id="cb78-3"><a href="behavioral-analysis.html#cb78-3" aria-hidden="true" tabindex="-1"></a>example_dat <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_id<span class="sc">==</span>example_sub)</span>
<span id="cb78-4"><a href="behavioral-analysis.html#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="behavioral-analysis.html#cb78-5" aria-hidden="true" tabindex="-1"></a>f8b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(example_dat, <span class="fu">aes</span>(<span class="at">x=</span>rel_time_other_events, <span class="at">y=</span>timeline_error)) <span class="sc">+</span></span>
<span id="cb78-6"><a href="behavioral-analysis.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, </span>
<span id="cb78-7"><a href="behavioral-analysis.html#cb78-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>],</span>
<span id="cb78-8"><a href="behavioral-analysis.html#cb78-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>])<span class="sc">+</span></span>
<span id="cb78-9"><a href="behavioral-analysis.html#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb78-10"><a href="behavioral-analysis.html#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">&quot;-2.5&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;2.5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb78-11"><a href="behavioral-analysis.html#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;relative time</span><span class="sc">\n</span><span class="st">of other events&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-12"><a href="behavioral-analysis.html#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;timeline error&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-13"><a href="behavioral-analysis.html#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>, <span class="at">hjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">vjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt,</span>
<span id="cb78-14"><a href="behavioral-analysis.html#cb78-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">&quot;r=%.2f&quot;</span>, fit_beh_bias<span class="sc">$</span>r[fit_beh_bias<span class="sc">$</span>sub_id<span class="sc">==</span>example_sub]),</span>
<span id="cb78-15"><a href="behavioral-analysis.html#cb78-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb78-16"><a href="behavioral-analysis.html#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb78-17"><a href="behavioral-analysis.html#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-18"><a href="behavioral-analysis.html#cb78-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-19"><a href="behavioral-analysis.html#cb78-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb78-20"><a href="behavioral-analysis.html#cb78-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb78-21"><a href="behavioral-analysis.html#cb78-21" aria-hidden="true" tabindex="-1"></a>f8b</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="behavioral-analysis.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb79-2"><a href="behavioral-analysis.html#cb79-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f8b)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb79-3"><a href="behavioral-analysis.html#cb79-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb79-4"><a href="behavioral-analysis.html#cb79-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f8b.txt&quot;</span>))</span></code></pre></div>
<p>To visualize the effect from the summary statistics approach on the group-level, we create a raincloud plot of the z-values from the linear model permutations for each subject.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="behavioral-analysis.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot regression z-values</span></span>
<span id="cb80-2"><a href="behavioral-analysis.html#cb80-2" aria-hidden="true" tabindex="-1"></a>f8c<span class="ot">&lt;-</span><span class="fu">ggplot</span>(fit_beh_bias, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(<span class="dv">1</span>),<span class="at">y=</span>z), <span class="at">colour=</span> aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>]) <span class="sc">+</span></span>
<span id="cb80-3"><a href="behavioral-analysis.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the violin</span></span>
<span id="cb80-4"><a href="behavioral-analysis.html#cb80-4" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb80-5"><a href="behavioral-analysis.html#cb80-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb80-6"><a href="behavioral-analysis.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="fl">-.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb80-7"><a href="behavioral-analysis.html#cb80-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb80-8"><a href="behavioral-analysis.html#cb80-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">colour=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb80-9"><a href="behavioral-analysis.html#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb80-10"><a href="behavioral-analysis.html#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb80-11"><a href="behavioral-analysis.html#cb80-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb80-12"><a href="behavioral-analysis.html#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb80-13"><a href="behavioral-analysis.html#cb80-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb80-14"><a href="behavioral-analysis.html#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Z regression&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;generalization</span><span class="sc">\n</span><span class="st"> bias&#39;</span>) <span class="sc">+</span> </span>
<span id="cb80-15"><a href="behavioral-analysis.html#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb80-16"><a href="behavioral-analysis.html#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb80-17"><a href="behavioral-analysis.html#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb80-18"><a href="behavioral-analysis.html#cb80-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb80-19"><a href="behavioral-analysis.html#cb80-19" aria-hidden="true" tabindex="-1"></a>f8c</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="behavioral-analysis.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb81-2"><a href="behavioral-analysis.html#cb81-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f8c)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb81-3"><a href="behavioral-analysis.html#cb81-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb81-4"><a href="behavioral-analysis.html#cb81-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f8c.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="mixed-model" class="section level4 unnumbered">
<h4>Mixed Model</h4>
<blockquote>
<p>Further, we analyzed these data using the linear mixed model approach (Supplemental Figure 4OP, Supplemental Table 16).</p>
</blockquote>
<p>We also want to this effect using a linear mixed model. We use the maximal random effects structure with random intercepts and random slopes for participants.</p>
<p>Let’s fit the model and get tidy summaries.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="behavioral-analysis.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z-score the relative time of other events for each participant</span></span>
<span id="cb82-2"><a href="behavioral-analysis.html#cb82-2" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="behavioral-analysis.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="behavioral-analysis.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_time_other_events_z =</span> <span class="fu">scale</span>(rel_time_other_events)) <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="behavioral-analysis.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb82-6"><a href="behavioral-analysis.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-7"><a href="behavioral-analysis.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb82-8"><a href="behavioral-analysis.html#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">245</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb82-9"><a href="behavioral-analysis.html#cb82-9" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="st">&quot;timeline_error ~ rel_time_other_events_z + (1+rel_time_other_events_z|sub_id)&quot;</span>, </span>
<span id="cb82-10"><a href="behavioral-analysis.html#cb82-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>beh_data, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb82-11"><a href="behavioral-analysis.html#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="behavioral-analysis.html#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb82-13"><a href="behavioral-analysis.html#cb82-13" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="behavioral-analysis.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb84-2"><a href="behavioral-analysis.html#cb84-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span></code></pre></div>
<p>Compare against a reduced model without the fixed effect of interest.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="behavioral-analysis.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit reduced model</span></span>
<span id="cb85-2"><a href="behavioral-analysis.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">248</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb85-3"><a href="behavioral-analysis.html#cb85-3" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="st">&quot;timeline_error ~ 1 + (1+rel_time_other_events_z|sub_id)&quot;</span>, </span>
<span id="cb85-4"><a href="behavioral-analysis.html#cb85-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>beh_data, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb85-5"><a href="behavioral-analysis.html#cb85-5" aria-hidden="true" tabindex="-1"></a>lmm_aov<span class="ot">&lt;-</span><span class="fu">anova</span>(lmm_full, lmm_reduced)</span>
<span id="cb85-6"><a href="behavioral-analysis.html#cb85-6" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-51">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.96e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.98e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-974</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.95e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.94e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.97e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-965</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.93e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">17.9</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.32e-05</td></tr>
</table>

<p>Mixed Model: Fixed effect of relative time of other events on timeline errors<br />
<span class="math inline">\(\chi^2\)</span>(1)=17.90, p=0.000</p>
<p>Make summary table.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="behavioral-analysis.html#cb86-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;relative time other events&quot;</span>)</span>
<span id="cb86-2"><a href="behavioral-analysis.html#cb86-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">3</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb86-3"><a href="behavioral-analysis.html#cb86-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;relative time other events (SD)&quot;</span>, <span class="st">&quot;correlation random intercepts and random slopes&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb86-4"><a href="behavioral-analysis.html#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="behavioral-analysis.html#cb86-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb86-6"><a href="behavioral-analysis.html#cb86-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb86-7"><a href="behavioral-analysis.html#cb86-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb86-8"><a href="behavioral-analysis.html#cb86-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb86-9"><a href="behavioral-analysis.html#cb86-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb86-10"><a href="behavioral-analysis.html#cb86-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb86-11"><a href="behavioral-analysis.html#cb86-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb86-12"><a href="behavioral-analysis.html#cb86-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb86-13"><a href="behavioral-analysis.html#cb86-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Behavioral generalization bias&quot;</span>)</span>
<span id="cb86-14"><a href="behavioral-analysis.html#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="behavioral-analysis.html#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb86-16"><a href="behavioral-analysis.html#cb86-16" aria-hidden="true" tabindex="-1"></a>stable_lme_beh_gen_bias <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb86-17"><a href="behavioral-analysis.html#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="behavioral-analysis.html#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb86-19"><a href="behavioral-analysis.html#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-52">
<caption style="caption-side: top; text-align: left;">Mixed Model: Behavioral generalization bias</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.352481</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.069962</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-5.04</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.494444</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.210518</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">relative time other events</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.337262</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.067360</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.01</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.200579</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.473945</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.220016</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">relative time other events (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.114173</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">correlation random intercepts and random slopes</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.183681</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.331485</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">5</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1958.57</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-974.29</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">6</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1942.67</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-965.34</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">17.90</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2.32e-05</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: timeline_error~rel_time_other_events_z+(1+rel_time_other_events_z|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>To visualize the mixed model we create a dot plot of the fixed effect coefficient and the estimated marginal means.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="behavioral-analysis.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb87-2"><a href="behavioral-analysis.html#cb87-2" aria-hidden="true" tabindex="-1"></a>sfigmm_o <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="behavioral-analysis.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="behavioral-analysis.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb87-5"><a href="behavioral-analysis.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb87-6"><a href="behavioral-analysis.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb87-7"><a href="behavioral-analysis.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;across sequence bias&quot;</span>)) <span class="sc">+</span></span>
<span id="cb87-8"><a href="behavioral-analysis.html#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y=</span><span class="st">&quot;fixed</span><span class="sc">\n</span><span class="st">effect estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-9"><a href="behavioral-analysis.html#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb87-10"><a href="behavioral-analysis.html#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb87-11"><a href="behavioral-analysis.html#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-12"><a href="behavioral-analysis.html#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use)</span>
<span id="cb87-13"><a href="behavioral-analysis.html#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="behavioral-analysis.html#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb87-15"><a href="behavioral-analysis.html#cb87-15" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> get_complete_df</span>
<span id="cb87-16"><a href="behavioral-analysis.html#cb87-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-17"><a href="behavioral-analysis.html#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb87-18"><a href="behavioral-analysis.html#cb87-18" aria-hidden="true" tabindex="-1"></a>sfigmm_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb87-19"><a href="behavioral-analysis.html#cb87-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb87-20"><a href="behavioral-analysis.html#cb87-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb87-21"><a href="behavioral-analysis.html#cb87-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), <span class="at">name=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb87-22"><a href="behavioral-analysis.html#cb87-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb87-23"><a href="behavioral-analysis.html#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">&quot;-1.5&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;1.5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb87-24"><a href="behavioral-analysis.html#cb87-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb87-25"><a href="behavioral-analysis.html#cb87-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;relative time</span><span class="sc">\n</span><span class="st">of other events&#39;</span>) <span class="sc">+</span></span>
<span id="cb87-26"><a href="behavioral-analysis.html#cb87-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-27"><a href="behavioral-analysis.html#cb87-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb87-28"><a href="behavioral-analysis.html#cb87-28" aria-hidden="true" tabindex="-1"></a>sfigmm_o<span class="sc">+</span>sfigmm_p</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Lastly, we show that the effect is quite visible from the single-subject plots: The slopes of the least-squares lines are, on average, positive.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="behavioral-analysis.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the relationship for each subject</span></span>
<span id="cb88-2"><a href="behavioral-analysis.html#cb88-2" aria-hidden="true" tabindex="-1"></a>sfig_bias_single_sub <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_data, <span class="fu">aes</span>(<span class="at">x=</span>rel_time_other_events, <span class="at">y=</span>timeline_error)) <span class="sc">+</span></span>
<span id="cb88-3"><a href="behavioral-analysis.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, </span>
<span id="cb88-4"><a href="behavioral-analysis.html#cb88-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>],</span>
<span id="cb88-5"><a href="behavioral-analysis.html#cb88-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>])<span class="sc">+</span></span>
<span id="cb88-6"><a href="behavioral-analysis.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb88-7"><a href="behavioral-analysis.html#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> fit_beh_bias, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;  r=%.2f&quot;</span>, <span class="fu">round</span>(r,<span class="at">digits =</span> <span class="dv">2</span>))),</span>
<span id="cb88-8"><a href="behavioral-analysis.html#cb88-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">x=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>, <span class="at">hjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">vjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt,</span>
<span id="cb88-9"><a href="behavioral-analysis.html#cb88-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb88-10"><a href="behavioral-analysis.html#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">&quot;-2.5&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;2.5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb88-11"><a href="behavioral-analysis.html#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sub_id, <span class="at">scales=</span><span class="st">&quot;free_y&quot;</span>, <span class="at">nrow=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb88-12"><a href="behavioral-analysis.html#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;relative time of other events (virtual hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-13"><a href="behavioral-analysis.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;timeline error&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-14"><a href="behavioral-analysis.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb88-15"><a href="behavioral-analysis.html#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-16"><a href="behavioral-analysis.html#cb88-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-17"><a href="behavioral-analysis.html#cb88-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb88-18"><a href="behavioral-analysis.html#cb88-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb88-19"><a href="behavioral-analysis.html#cb88-19" aria-hidden="true" tabindex="-1"></a>sfig_bias_single_sub</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="replication-of-generalization-bias" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Replication of Generalization Bias</h2>
<blockquote>
<p>To replicate the results from this exploratory analysis, we conducted the same analysis in an independent group of participants. These participants (n=46) constituted the control groups of a behavioral experiment testing the effect of stress induction on temporal memory(66). They underwent the same learning task as described above with the only difference being the duration of this learning phase (4 rather than 7 mini-blocks of training). The timeline task was administered on the day after learning. The procedures are described in detail in Montijn et al.(66). The data from this independent sample are shown in Figure 8D and Supplemental Figure 10B.</p>
</blockquote>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="behavioral-analysis.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data from CSV</span></span>
<span id="cb89-2"><a href="behavioral-analysis.html#cb89-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;beh_dataNDM.txt&quot;</span>)</span>
<span id="cb89-3"><a href="behavioral-analysis.html#cb89-3" aria-hidden="true" tabindex="-1"></a>col_types_list <span class="ot">&lt;-</span> <span class="fu">cols_only</span>(</span>
<span id="cb89-4"><a href="behavioral-analysis.html#cb89-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_id =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb89-5"><a href="behavioral-analysis.html#cb89-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">day =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb89-6"><a href="behavioral-analysis.html#cb89-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">event =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb89-7"><a href="behavioral-analysis.html#cb89-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">virtual_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb89-8"><a href="behavioral-analysis.html#cb89-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">memory_time =</span> <span class="fu">col_double</span>()</span>
<span id="cb89-9"><a href="behavioral-analysis.html#cb89-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb89-10"><a href="behavioral-analysis.html#cb89-10" aria-hidden="true" tabindex="-1"></a>beh_data_replication <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_csv</span>(fname, <span class="at">col_types =</span> col_types_list))</span>
<span id="cb89-11"><a href="behavioral-analysis.html#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="behavioral-analysis.html#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(beh_data_replication)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-55">
<col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sub_id</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">day</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">event</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">virtual_time</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">memory_time</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">P001</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.25</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9.21</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">P001</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.1&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">P001</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">16.1&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">P001</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">15&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">P001</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">18.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">18.4&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">P001</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8.5&nbsp;</td></tr>
</table>

<div id="replication-data-quantify-relative-time-of-other-events" class="section level3 unnumbered">
<h3>Replication data: Quantify relative time of other events</h3>
<p>To test for such a bias, we quantify, for each event, the relative time of the other events at that sequence position. We then calculate by how much virtual time each individual event time deviates from the average virtual time of the other events at that sequence position (e.g. the difference in virtual time for event 1 from sequence 1 compared to the average virtual time of events 1 from sequences 2-4). We do this so that positive values of this relative time measure indicate that the other events happened later than the event of interest.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="behavioral-analysis.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantify the deviation in virtual time for each event relative to other events </span></span>
<span id="cb90-2"><a href="behavioral-analysis.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># at the same sequence position</span></span>
<span id="cb90-3"><a href="behavioral-analysis.html#cb90-3" aria-hidden="true" tabindex="-1"></a>beh_data_replication <span class="ot">&lt;-</span> beh_data_replication <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="behavioral-analysis.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">rel_time_other_events=</span><span class="cn">NA</span>)</span>
<span id="cb90-5"><a href="behavioral-analysis.html#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="behavioral-analysis.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_day <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_days){</span>
<span id="cb90-7"><a href="behavioral-analysis.html#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_event <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_events_day){</span>
<span id="cb90-8"><a href="behavioral-analysis.html#cb90-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-9"><a href="behavioral-analysis.html#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the events at this sequence position from all four sequences</span></span>
<span id="cb90-10"><a href="behavioral-analysis.html#cb90-10" aria-hidden="true" tabindex="-1"></a>    curr_events <span class="ot">&lt;-</span> beh_data_replication[beh_data_replication<span class="sc">$</span>event <span class="sc">==</span> i_event,]</span>
<span id="cb90-11"><a href="behavioral-analysis.html#cb90-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-12"><a href="behavioral-analysis.html#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find the average virtual time of the other events at this sequence position</span></span>
<span id="cb90-13"><a href="behavioral-analysis.html#cb90-13" aria-hidden="true" tabindex="-1"></a>    avg_vir_time_other_events <span class="ot">&lt;-</span> curr_events <span class="sc">%&gt;%</span> </span>
<span id="cb90-14"><a href="behavioral-analysis.html#cb90-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(day <span class="sc">!=</span> i_day) <span class="sc">%&gt;%</span></span>
<span id="cb90-15"><a href="behavioral-analysis.html#cb90-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">avg_vir_time =</span> <span class="fu">mean</span>(virtual_time)) <span class="sc">%&gt;%</span></span>
<span id="cb90-16"><a href="behavioral-analysis.html#cb90-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(avg_vir_time) <span class="sc">%&gt;%</span></span>
<span id="cb90-17"><a href="behavioral-analysis.html#cb90-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(.)</span>
<span id="cb90-18"><a href="behavioral-analysis.html#cb90-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-19"><a href="behavioral-analysis.html#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for the given event, store the relative time of the other events,</span></span>
<span id="cb90-20"><a href="behavioral-analysis.html#cb90-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># as the difference in virtual time (positive values mean other events happen later)</span></span>
<span id="cb90-21"><a href="behavioral-analysis.html#cb90-21" aria-hidden="true" tabindex="-1"></a>    event_idx <span class="ot">&lt;-</span> beh_data_replication<span class="sc">$</span>day<span class="sc">==</span>i_day <span class="sc">&amp;</span> beh_data_replication<span class="sc">$</span>event<span class="sc">==</span>i_event</span>
<span id="cb90-22"><a href="behavioral-analysis.html#cb90-22" aria-hidden="true" tabindex="-1"></a>    beh_data_replication<span class="sc">$</span>rel_time_other_events[event_idx] <span class="ot">&lt;-</span> avg_vir_time_other_events <span class="sc">-</span> beh_data_replication<span class="sc">$</span>virtual_time[event_idx]</span>
<span id="cb90-23"><a href="behavioral-analysis.html#cb90-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-24"><a href="behavioral-analysis.html#cb90-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="replication-data-test-generalization-bias" class="section level3 unnumbered">
<h3>Replication data: Test Generalization Bias</h3>
<p>The crucial test is then whether over- and underestimates of remembered time can be explained by this deviation measure.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="behavioral-analysis.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate timeline error so that positive numbers mean overestimates (later than true virtual time)</span></span>
<span id="cb91-2"><a href="behavioral-analysis.html#cb91-2" aria-hidden="true" tabindex="-1"></a>beh_data_replication <span class="ot">&lt;-</span> beh_data_replication <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="behavioral-analysis.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timeline_error=</span>memory_time<span class="sc">-</span>virtual_time)</span></code></pre></div>
<div id="replication-data-summary-statistics" class="section level4 unnumbered">
<h4>Replication data: Summary statistics</h4>
<p>In the summary statistics approach, we run a linear regression model for each participant and test the resulting coefficients against a permutation-based null distribution. The resulting z-scores are then tested against 0 on the group level. Both of the tests rely on the custom stats function defined above.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="behavioral-analysis.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SUMMARY STATISTICS</span></span>
<span id="cb92-2"><a href="behavioral-analysis.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">120</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb92-3"><a href="behavioral-analysis.html#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="behavioral-analysis.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test generalization bias using linear model and calculate z-score for model fit from permutations</span></span>
<span id="cb92-5"><a href="behavioral-analysis.html#cb92-5" aria-hidden="true" tabindex="-1"></a>fit_beh_bias_replication <span class="ot">&lt;-</span> beh_data_replication <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb92-6"><a href="behavioral-analysis.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the linear model (also without permutation tests to get betas)</span></span>
<span id="cb92-7"><a href="behavioral-analysis.html#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="at">model =</span> <span class="fu">lm</span>(timeline_error <span class="sc">~</span> rel_time_other_events, <span class="at">data=</span>.),</span>
<span id="cb92-8"><a href="behavioral-analysis.html#cb92-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">z =</span> <span class="fu">lm_perm_jb</span>(<span class="at">in_dat =</span> .,</span>
<span id="cb92-9"><a href="behavioral-analysis.html#cb92-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lm_formula =</span> <span class="st">&quot;timeline_error ~ rel_time_other_events&quot;</span>,</span>
<span id="cb92-10"><a href="behavioral-analysis.html#cb92-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nsim =</span> n_perm)) <span class="sc">%&gt;%</span></span>
<span id="cb92-11"><a href="behavioral-analysis.html#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># store beta estimates and their z-values</span></span>
<span id="cb92-12"><a href="behavioral-analysis.html#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">beta_rel_time_other_events =</span> <span class="fu">coef</span>(<span class="fu">summary</span>(model))[<span class="dv">2</span>,<span class="st">&quot;Estimate&quot;</span>],</span>
<span id="cb92-13"><a href="behavioral-analysis.html#cb92-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">t_rel_time_other_events =</span> <span class="fu">coef</span>(<span class="fu">summary</span>(model))[<span class="dv">2</span>,<span class="st">&quot;t value&quot;</span>],</span>
<span id="cb92-14"><a href="behavioral-analysis.html#cb92-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">z =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(z, <span class="fu">c</span>(<span class="st">&quot;z_intercept&quot;</span>,  <span class="st">&quot;rel_time_other_events&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb92-15"><a href="behavioral-analysis.html#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get rid of intercept z-values and model column</span></span>
<span id="cb92-16"><a href="behavioral-analysis.html#cb92-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_longer</span>(z) <span class="sc">%&gt;%</span></span>
<span id="cb92-17"><a href="behavioral-analysis.html#cb92-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">!=</span> <span class="st">&quot;z_intercept&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-18"><a href="behavioral-analysis.html#cb92-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (.,<span class="sc">-</span><span class="fu">c</span>(model))</span>
<span id="cb92-19"><a href="behavioral-analysis.html#cb92-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-20"><a href="behavioral-analysis.html#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add Pearson correlation (for plot annotation only)</span></span>
<span id="cb92-21"><a href="behavioral-analysis.html#cb92-21" aria-hidden="true" tabindex="-1"></a>fit_beh_bias_replication<span class="sc">$</span>r <span class="ot">&lt;-</span> beh_data_replication <span class="sc">%&gt;%</span> </span>
<span id="cb92-22"><a href="behavioral-analysis.html#cb92-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb92-23"><a href="behavioral-analysis.html#cb92-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r =</span> <span class="fu">cor</span>(rel_time_other_events, timeline_error)) <span class="sc">%&gt;%</span></span>
<span id="cb92-24"><a href="behavioral-analysis.html#cb92-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(r)</span>
<span id="cb92-25"><a href="behavioral-analysis.html#cb92-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-26"><a href="behavioral-analysis.html#cb92-26" aria-hidden="true" tabindex="-1"></a><span class="co"># run group-level t-tests on the RSA fits from the first level in aHPC for within-day</span></span>
<span id="cb92-27"><a href="behavioral-analysis.html#cb92-27" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> fit_beh_bias_replication <span class="sc">%&gt;%</span> </span>
<span id="cb92-28"><a href="behavioral-analysis.html#cb92-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(z_id <span class="sc">==</span><span class="st">&quot;rel_time_other_events&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-29"><a href="behavioral-analysis.html#cb92-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(z) <span class="sc">%&gt;%</span> </span>
<span id="cb92-30"><a href="behavioral-analysis.html#cb92-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb92-31"><a href="behavioral-analysis.html#cb92-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-32"><a href="behavioral-analysis.html#cb92-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for one sample using non-central t-distribution for CI</span></span>
<span id="cb92-33"><a href="behavioral-analysis.html#cb92-33" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>fit_beh_bias_replication<span class="sc">$</span>z, <span class="at">f=</span><span class="cn">NA</span>, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in pt(q = t, df = df, ncp = x): full precision may not have been achieved in &#39;pnt{final}&#39;

## Warning in pt(q = t, df = df, ncp = x): full precision may not have been achieved in &#39;pnt{final}&#39;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="behavioral-analysis.html#cb94-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb94-2"><a href="behavioral-analysis.html#cb94-2" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb94-3"><a href="behavioral-analysis.html#cb94-3" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb94-4"><a href="behavioral-analysis.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="behavioral-analysis.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb94-6"><a href="behavioral-analysis.html#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-58">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">1.66</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">11.3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.76e-15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">45</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.37</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.96</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.64</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.23</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2.13</td></tr>
</table>

Summary Statistics: t-test against 0 for generalization bias in replication sample
t<sub>45</sub>=11.3, p=0.000, d=1.64, 95% CI [1.23, 2.13]</p>
<p>We observe a significant positive effect of the virtual time of other events at the same sequence position on remembered virtual time. That means that when other events at the same sequence position are later than a given event, participants are likely to overestimate the event time. Conversely, when the other events at this sequence position relatively early, participants underestimate. This demonstrates an across-sequence effect of virtual time. Virtual time is generalized across sequences to bias remembered times at similar sequence positions.</p>
<p>To visualize this effect from the summary statistics approach, we create a raincloud plot of the z-values from the linear model permutations for each subject.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="behavioral-analysis.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot regression z-values</span></span>
<span id="cb95-2"><a href="behavioral-analysis.html#cb95-2" aria-hidden="true" tabindex="-1"></a>f8d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit_beh_bias_replication, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(<span class="dv">1</span>),<span class="at">y=</span>z), <span class="at">colour=</span> aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>]) <span class="sc">+</span></span>
<span id="cb95-3"><a href="behavioral-analysis.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the violin</span></span>
<span id="cb95-4"><a href="behavioral-analysis.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), </span>
<span id="cb95-5"><a href="behavioral-analysis.html#cb95-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="behavioral-analysis.html#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="fl">-.2</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb95-7"><a href="behavioral-analysis.html#cb95-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb95-8"><a href="behavioral-analysis.html#cb95-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">colour=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb95-9"><a href="behavioral-analysis.html#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>], <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb95-10"><a href="behavioral-analysis.html#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb95-11"><a href="behavioral-analysis.html#cb95-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb95-12"><a href="behavioral-analysis.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb95-13"><a href="behavioral-analysis.html#cb95-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(.<span class="dv">1</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb95-14"><a href="behavioral-analysis.html#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Z regression&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;generalization</span><span class="sc">\n</span><span class="st">bias&#39;</span>) <span class="sc">+</span> </span>
<span id="cb95-15"><a href="behavioral-analysis.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb95-16"><a href="behavioral-analysis.html#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb95-17"><a href="behavioral-analysis.html#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb95-18"><a href="behavioral-analysis.html#cb95-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb95-19"><a href="behavioral-analysis.html#cb95-19" aria-hidden="true" tabindex="-1"></a>f8d</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="behavioral-analysis.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save source data</span></span>
<span id="cb96-2"><a href="behavioral-analysis.html#cb96-2" aria-hidden="true" tabindex="-1"></a>source_dat <span class="ot">&lt;-</span><span class="fu">ggplot_build</span>(f8d)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb96-3"><a href="behavioral-analysis.html#cb96-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(source_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(x,y), </span>
<span id="cb96-4"><a href="behavioral-analysis.html#cb96-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>source_dat_dir, <span class="st">&quot;f8d.txt&quot;</span>))</span></code></pre></div>
</div>
<div id="replication-data-mixed-model" class="section level4 unnumbered">
<h4>Replication data: Mixed Model</h4>
<p>We also want to this effect using a linear mixed model. We use the maximal random effects structure with random intercepts and random slopes for participants.</p>
<p>Let’s fit the model and get tidy summaries.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="behavioral-analysis.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z-score the relative time of other events for each participant</span></span>
<span id="cb97-2"><a href="behavioral-analysis.html#cb97-2" aria-hidden="true" tabindex="-1"></a>beh_data_replication <span class="ot">&lt;-</span> beh_data_replication <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="behavioral-analysis.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="behavioral-analysis.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_time_other_events_z =</span> <span class="fu">scale</span>(rel_time_other_events)) <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="behavioral-analysis.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb97-6"><a href="behavioral-analysis.html#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="behavioral-analysis.html#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with full random effect structure -&gt; singular</span></span>
<span id="cb97-8"><a href="behavioral-analysis.html#cb97-8" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="st">&quot;timeline_error ~ rel_time_other_events_z + (1+rel_time_other_events_z|sub_id)&quot;</span>, </span>
<span id="cb97-9"><a href="behavioral-analysis.html#cb97-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>beh_data_replication, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="behavioral-analysis.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit again after removing correlation of slope and intercept</span></span>
<span id="cb99-2"><a href="behavioral-analysis.html#cb99-2" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="st">&quot;timeline_error ~ rel_time_other_events_z + (1+rel_time_other_events_z||sub_id)&quot;</span>, </span>
<span id="cb99-3"><a href="behavioral-analysis.html#cb99-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>beh_data_replication, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="behavioral-analysis.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit again after removing correlation of also random intercept (only random slopes left)</span></span>
<span id="cb101-2"><a href="behavioral-analysis.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">278</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb101-3"><a href="behavioral-analysis.html#cb101-3" aria-hidden="true" tabindex="-1"></a>lmm_full <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="st">&quot;timeline_error ~ rel_time_other_events_z + (0+rel_time_other_events_z|sub_id)&quot;</span>, </span>
<span id="cb101-4"><a href="behavioral-analysis.html#cb101-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>beh_data_replication, <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="behavioral-analysis.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the fixed effects that calculates 95% CIs</span></span>
<span id="cb103-2"><a href="behavioral-analysis.html#cb103-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">conf.int=</span><span class="cn">TRUE</span>, <span class="at">conf.method=</span><span class="st">&quot;profile&quot;</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="behavioral-analysis.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy summary of the random effects</span></span>
<span id="cb105-2"><a href="behavioral-analysis.html#cb105-2" aria-hidden="true" tabindex="-1"></a>lmm_full_bm_re <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(lmm_full, <span class="at">effects =</span> <span class="st">&quot;ran_pars&quot;</span>)</span></code></pre></div>
<p>Compare against a reduced model without the fixed effect of interest.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="behavioral-analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit reduced model</span></span>
<span id="cb106-2"><a href="behavioral-analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">221</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb106-3"><a href="behavioral-analysis.html#cb106-3" aria-hidden="true" tabindex="-1"></a>lmm_reduced <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="st">&quot;timeline_error ~ 1 + (0+rel_time_other_events_z|sub_id)&quot;</span>, </span>
<span id="cb106-4"><a href="behavioral-analysis.html#cb106-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>beh_data_replication, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb106-5"><a href="behavioral-analysis.html#cb106-5" aria-hidden="true" tabindex="-1"></a>lmm_aov<span class="ot">&lt;-</span><span class="fu">anova</span>(lmm_full, lmm_reduced)</span>
<span id="cb106-6"><a href="behavioral-analysis.html#cb106-6" aria-hidden="true" tabindex="-1"></a>lmm_aov</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-61">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Chisq</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;Chisq)</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4.5e+03&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4.52e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-2.25e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4.5e+03&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.45e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.47e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2.22e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.44e+03</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">53.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.29e-13</td></tr>
</table>

<p>Mixed Model: Fixed effect of relative time of other events on timeline errors<br />
<span class="math inline">\(\chi^2\)</span>(1)=53.74, p=0.000</p>
<p>Make summary table.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="behavioral-analysis.html#cb107-1" aria-hidden="true" tabindex="-1"></a>fe_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;relative time other events&quot;</span>)</span>
<span id="cb107-2"><a href="behavioral-analysis.html#cb107-2" aria-hidden="true" tabindex="-1"></a>re_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;participant&quot;</span>,<span class="dv">1</span>), <span class="st">&quot;residual&quot;</span>)</span>
<span id="cb107-3"><a href="behavioral-analysis.html#cb107-3" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;relative time other events (SD)&quot;</span>, <span class="st">&quot;SD&quot;</span>)</span>
<span id="cb107-4"><a href="behavioral-analysis.html#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="behavioral-analysis.html#cb107-5" aria-hidden="true" tabindex="-1"></a>lmm_hux <span class="ot">&lt;-</span> <span class="fu">make_lme_huxtable</span>(<span class="at">fix_df=</span>lmm_full_bm, </span>
<span id="cb107-6"><a href="behavioral-analysis.html#cb107-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ran_df =</span> lmm_full_bm_re,</span>
<span id="cb107-7"><a href="behavioral-analysis.html#cb107-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">aov_mdl =</span> lmm_aov, </span>
<span id="cb107-8"><a href="behavioral-analysis.html#cb107-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fe_terms =</span>fe_names, </span>
<span id="cb107-9"><a href="behavioral-analysis.html#cb107-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_terms =</span> re_names, </span>
<span id="cb107-10"><a href="behavioral-analysis.html#cb107-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">re_groups =</span> re_groups, </span>
<span id="cb107-11"><a href="behavioral-analysis.html#cb107-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lme_form =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">paste0</span>(<span class="fu">deparse</span>(<span class="fu">formula</span>(lmm_full)), </span>
<span id="cb107-12"><a href="behavioral-analysis.html#cb107-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb107-13"><a href="behavioral-analysis.html#cb107-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">caption =</span> <span class="st">&quot;Mixed Model: Behavioral generalization bias (replication)&quot;</span>)</span>
<span id="cb107-14"><a href="behavioral-analysis.html#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="behavioral-analysis.html#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the huxtable to a flextable for word export</span></span>
<span id="cb107-16"><a href="behavioral-analysis.html#cb107-16" aria-hidden="true" tabindex="-1"></a>stable_lme_beh_gen_bias_replication <span class="ot">&lt;-</span> <span class="fu">convert_huxtable_to_flextable</span>(<span class="at">ht =</span> lmm_hux)</span>
<span id="cb107-17"><a href="behavioral-analysis.html#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="behavioral-analysis.html#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb107-19"><a href="behavioral-analysis.html#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_article</span>(lmm_hux)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-62">
<caption style="caption-side: top; text-align: left;">Mixed Model: Behavioral generalization bias (replication)</caption><col><col><col><col><col><col><col><tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">fixed effects</th><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SE</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">t-value</th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">95% CI</th></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">intercept</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.320564</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.089155</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.60</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.495488</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">-0.145640</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">relative time other events</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.863631</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.091472</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">9.44</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.684152</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">1.043110</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">random effects</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">group</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">term</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">estimate</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">participant</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">relative time other events (SD)</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">0.000000</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">residual</th><th colspan="5" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2.704218</td></tr>
<tr>
<th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model comparison</th><th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">npar</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">LL</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">X2</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">p</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">reduced model</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">3</th><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4501.04</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2247.52</td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: bold;">full model</th><th style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: bold;">4</th><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4449.30</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-2220.65</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">53.74</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td><td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">2.29e-13</td></tr>
<tr>
<th colspan="7" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">model: timeline_error~rel_time_other_events_z+(0+rel_time_other_events_z|sub_id); <br>SE: standard error, CI: confidence interval, SD: standard deviation, npar: number of parameters, LL: log likelihood, df: degrees of freedom, corr.: correlation</th></tr>
</table>

<p>To visualize the mixed model we create a dot plot of the fixed effect coefficient and the estimated marginal means.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="behavioral-analysis.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plot of Fixed Effect Coefficients with CIs</span></span>
<span id="cb108-2"><a href="behavioral-analysis.html#cb108-2" aria-hidden="true" tabindex="-1"></a>sfigmm_q <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_bm[<span class="dv">2</span>,], <span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb108-3"><a href="behavioral-analysis.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-4"><a href="behavioral-analysis.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">width =</span> <span class="cn">NA</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb108-5"><a href="behavioral-analysis.html#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb108-6"><a href="behavioral-analysis.html#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb108-7"><a href="behavioral-analysis.html#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;across sequence bias&quot;</span>)) <span class="sc">+</span></span>
<span id="cb108-8"><a href="behavioral-analysis.html#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y=</span><span class="st">&quot;fixed</span><span class="sc">\n</span><span class="st">effect estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-9"><a href="behavioral-analysis.html#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb108-10"><a href="behavioral-analysis.html#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb108-11"><a href="behavioral-analysis.html#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb108-12"><a href="behavioral-analysis.html#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;***&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use)</span>
<span id="cb108-13"><a href="behavioral-analysis.html#cb108-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-14"><a href="behavioral-analysis.html#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate marginal means for each model term by omitting the terms argument  </span></span>
<span id="cb108-15"><a href="behavioral-analysis.html#cb108-15" aria-hidden="true" tabindex="-1"></a>lmm_full_emm <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(lmm_full, <span class="at">ci.lvl =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span> get_complete_df</span>
<span id="cb108-16"><a href="behavioral-analysis.html#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="behavioral-analysis.html#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot marginal means</span></span>
<span id="cb108-18"><a href="behavioral-analysis.html#cb108-18" aria-hidden="true" tabindex="-1"></a>sfigmm_r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lmm_full_emm, <span class="fu">aes</span>(<span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb108-19"><a href="behavioral-analysis.html#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, predicted)) <span class="sc">+</span></span>
<span id="cb108-20"><a href="behavioral-analysis.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(x, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">fill =</span> group), <span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">linetype=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb108-21"><a href="behavioral-analysis.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>]), <span class="at">name=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb108-22"><a href="behavioral-analysis.html#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(aHPC_colors[<span class="st">&quot;across_main&quot;</span>])) <span class="sc">+</span></span>
<span id="cb108-23"><a href="behavioral-analysis.html#cb108-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">&quot;-1.5&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;1.5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb108-24"><a href="behavioral-analysis.html#cb108-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;estimated</span><span class="sc">\n</span><span class="st">marginal means&#39;</span>) <span class="sc">+</span> </span>
<span id="cb108-25"><a href="behavioral-analysis.html#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;relative time</span><span class="sc">\n</span><span class="st">of other events&#39;</span>) <span class="sc">+</span></span>
<span id="cb108-26"><a href="behavioral-analysis.html#cb108-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-27"><a href="behavioral-analysis.html#cb108-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb108-28"><a href="behavioral-analysis.html#cb108-28" aria-hidden="true" tabindex="-1"></a>sfigmm_q<span class="sc">+</span>sfigmm_r</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>Lastly, we show that the effect is quite visible from the single-subject plots: The slopes of the least-squares lines are, on average, positive.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="behavioral-analysis.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the relationship for each subject</span></span>
<span id="cb109-2"><a href="behavioral-analysis.html#cb109-2" aria-hidden="true" tabindex="-1"></a>sfig_bias_replication_single_sub <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_data_replication, <span class="fu">aes</span>(<span class="at">x=</span>rel_time_other_events, <span class="at">y=</span>timeline_error)) <span class="sc">+</span></span>
<span id="cb109-3"><a href="behavioral-analysis.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, </span>
<span id="cb109-4"><a href="behavioral-analysis.html#cb109-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>],</span>
<span id="cb109-5"><a href="behavioral-analysis.html#cb109-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span>aHPC_colors[<span class="st">&quot;across_main&quot;</span>])<span class="sc">+</span></span>
<span id="cb109-6"><a href="behavioral-analysis.html#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb109-7"><a href="behavioral-analysis.html#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> fit_beh_bias_replication, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;  r=%.2f&quot;</span>, <span class="fu">round</span>(r,<span class="at">digits =</span> <span class="dv">2</span>))),</span>
<span id="cb109-8"><a href="behavioral-analysis.html#cb109-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">x=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>, <span class="at">hjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">vjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt,</span>
<span id="cb109-9"><a href="behavioral-analysis.html#cb109-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb109-10"><a href="behavioral-analysis.html#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sub_id, <span class="at">scales=</span><span class="st">&quot;free_y&quot;</span>, <span class="at">ncol=</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb109-11"><a href="behavioral-analysis.html#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">&quot;-2.5&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;2.5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb109-12"><a href="behavioral-analysis.html#cb109-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;relative time of other events (virtual hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-13"><a href="behavioral-analysis.html#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;timeline error&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-14"><a href="behavioral-analysis.html#cb109-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb109-15"><a href="behavioral-analysis.html#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-16"><a href="behavioral-analysis.html#cb109-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-17"><a href="behavioral-analysis.html#cb109-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb109-18"><a href="behavioral-analysis.html#cb109-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb109-19"><a href="behavioral-analysis.html#cb109-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-20"><a href="behavioral-analysis.html#cb109-20" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb109-21"><a href="behavioral-analysis.html#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb109-22"><a href="behavioral-analysis.html#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb109-23"><a href="behavioral-analysis.html#cb109-23" aria-hidden="true" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb109-24"><a href="behavioral-analysis.html#cb109-24" aria-hidden="true" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb109-25"><a href="behavioral-analysis.html#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="st">B</span></span>
<span id="cb109-26"><a href="behavioral-analysis.html#cb109-26" aria-hidden="true" tabindex="-1"></a><span class="st">B</span></span>
<span id="cb109-27"><a href="behavioral-analysis.html#cb109-27" aria-hidden="true" tabindex="-1"></a><span class="st">B</span></span>
<span id="cb109-28"><a href="behavioral-analysis.html#cb109-28" aria-hidden="true" tabindex="-1"></a><span class="st">B</span></span>
<span id="cb109-29"><a href="behavioral-analysis.html#cb109-29" aria-hidden="true" tabindex="-1"></a><span class="st">B</span></span>
<span id="cb109-30"><a href="behavioral-analysis.html#cb109-30" aria-hidden="true" tabindex="-1"></a><span class="st">B&quot;</span></span>
<span id="cb109-31"><a href="behavioral-analysis.html#cb109-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-32"><a href="behavioral-analysis.html#cb109-32" aria-hidden="true" tabindex="-1"></a>sfig_bias_single_sub_both_samples <span class="ot">&lt;-</span> sfig_bias_single_sub <span class="sc">+</span> sfig_bias_replication_single_sub <span class="sc">+</span></span>
<span id="cb109-33"><a href="behavioral-analysis.html#cb109-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout, <span class="at">guides =</span> <span class="st">&quot;keep&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb109-34"><a href="behavioral-analysis.html#cb109-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb109-35"><a href="behavioral-analysis.html#cb109-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb109-36"><a href="behavioral-analysis.html#cb109-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb109-37"><a href="behavioral-analysis.html#cb109-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb109-38"><a href="behavioral-analysis.html#cb109-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb109-39"><a href="behavioral-analysis.html#cb109-39" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">&amp;</span></span>
<span id="cb109-40"><a href="behavioral-analysis.html#cb109-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels=</span><span class="st">&quot;A&quot;</span>,</span>
<span id="cb109-41"><a href="behavioral-analysis.html#cb109-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">unit=</span><span class="st">&quot;pt&quot;</span>)))</span>
<span id="cb109-42"><a href="behavioral-analysis.html#cb109-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-43"><a href="behavioral-analysis.html#cb109-43" aria-hidden="true" tabindex="-1"></a><span class="co"># save as png and pdf and print to screen</span></span>
<span id="cb109-44"><a href="behavioral-analysis.html#cb109-44" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf10&quot;</span>)</span>
<span id="cb109-45"><a href="behavioral-analysis.html#cb109-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig_bias_single_sub_both_samples, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb109-46"><a href="behavioral-analysis.html#cb109-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="fl">22.5</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb109-47"><a href="behavioral-analysis.html#cb109-47" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig_bias_single_sub_both_samples, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb109-48"><a href="behavioral-analysis.html#cb109-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="fl">22.5</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf10.png" alt="" />
<p class="caption">Supplemental Figure 10. Generalization bias in individual participants. A, B. Each panel shows the data from one participant. Each circle corresponds to one event. The x-axis indicates the average relative time of the events occupying the same sequence position in other sequences. The y-axis shows the signed error of constructed event times as measured in the timeline task. The regression line and its confidence interval are overlaid in red. Positive slopes of the regression line indicate that constructed event times are biased by the average time of events in the other sequences. Correlation coefficients are based on Pearson correlation. A shows data from the main sample; B from the replication sample.</p>
</div>
</div>
</div>
</div>
<div id="swap-errors" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Swap Errors</h2>
<p>Given that participants’ behavior indicates that they generalize across sequences, we next also explore whether there might be systematic errors in the sorting task as well. Specifically, it could be that events belonging to the same sequence position are swapped.</p>
<blockquote>
<p>In an exploratory analysis, we searched for systematic errors in the sorting task. Specifically, we looked for swap errors where participants interchanged events occurring at the same position between two or more sequences.</p>
</blockquote>
<p>We begin by defining a function that identifies swap errors based on the sorting task data and logic. The function takes a dataframe as an input that corresponds to the sorting task data of one participant with one row per event image. The expected columns are:</p>
<ul>
<li>day: true day (1:4)</li>
<li>event: sequence position of the image (1:5)</li>
<li>sorted day: day the event was sorted to</li>
<li>correct_sort: logical indicating whether event was sorted to correct day or not.</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="behavioral-analysis.html#cb110-1" aria-hidden="true" tabindex="-1"></a>find_swap_errors <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">in_df =</span> <span class="fu">tibble</span>(<span class="at">day =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="at">event =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">times=</span><span class="dv">4</span>), <span class="at">sorted_day =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each=</span><span class="dv">5</span>), <span class="at">correct_sort =</span> day<span class="sc">==</span>sorted_day)){</span>
<span id="cb110-2"><a href="behavioral-analysis.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-3"><a href="behavioral-analysis.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  out_df <span class="ot">&lt;-</span> in_df</span>
<span id="cb110-4"><a href="behavioral-analysis.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  out_df<span class="sc">$</span>swap_err <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb110-5"><a href="behavioral-analysis.html#cb110-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-6"><a href="behavioral-analysis.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_event <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb110-7"><a href="behavioral-analysis.html#cb110-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-8"><a href="behavioral-analysis.html#cb110-8" aria-hidden="true" tabindex="-1"></a>    n_correct <span class="ot">&lt;-</span> <span class="fu">sum</span>(in_df<span class="sc">$</span>day[in_df<span class="sc">$</span>event<span class="sc">==</span>i_event] <span class="sc">==</span> in_df<span class="sc">$</span>sorted_day[in_df<span class="sc">$</span>event<span class="sc">==</span>i_event])</span>
<span id="cb110-9"><a href="behavioral-analysis.html#cb110-9" aria-hidden="true" tabindex="-1"></a>    n_unique_days <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(in_df<span class="sc">$</span>sorted_day[in_df<span class="sc">$</span>event<span class="sc">==</span>i_event])</span>
<span id="cb110-10"><a href="behavioral-analysis.html#cb110-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-11"><a href="behavioral-analysis.html#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the four events are sorted to only two days and no event is sorted correctly,</span></span>
<span id="cb110-12"><a href="behavioral-analysis.html#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># there is a swap between the events that objectively belong to the two days that </span></span>
<span id="cb110-13"><a href="behavioral-analysis.html#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># all events were sorted to --&gt; 2 swap errors</span></span>
<span id="cb110-14"><a href="behavioral-analysis.html#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_correct<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> n_unique_days<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb110-15"><a href="behavioral-analysis.html#cb110-15" aria-hidden="true" tabindex="-1"></a>      sorted_days <span class="ot">&lt;-</span> <span class="fu">unique</span>(in_df<span class="sc">$</span>sorted_day[in_df<span class="sc">$</span>event<span class="sc">==</span>i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>correct_sort<span class="sc">==</span><span class="cn">FALSE</span>])</span>
<span id="cb110-16"><a href="behavioral-analysis.html#cb110-16" aria-hidden="true" tabindex="-1"></a>      swap_errs_idx <span class="ot">&lt;-</span> in_df<span class="sc">$</span>event <span class="sc">==</span> i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>day <span class="sc">%in%</span> sorted_days</span>
<span id="cb110-17"><a href="behavioral-analysis.html#cb110-17" aria-hidden="true" tabindex="-1"></a>      out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-18"><a href="behavioral-analysis.html#cb110-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stopifnot</span>(<span class="dv">2</span><span class="sc">==</span><span class="fu">sum</span>(swap_errs_idx))</span>
<span id="cb110-19"><a href="behavioral-analysis.html#cb110-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-20"><a href="behavioral-analysis.html#cb110-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-21"><a href="behavioral-analysis.html#cb110-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the  four events are sorted to three days and no event is sorted correctly,</span></span>
<span id="cb110-22"><a href="behavioral-analysis.html#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># there is a three-way swap error. The event belonging to the day that no event was sorted too is the error that is not a swap.</span></span>
<span id="cb110-23"><a href="behavioral-analysis.html#cb110-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_correct<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> n_unique_days<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb110-24"><a href="behavioral-analysis.html#cb110-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb110-25"><a href="behavioral-analysis.html#cb110-25" aria-hidden="true" tabindex="-1"></a>      sorted_days <span class="ot">&lt;-</span> <span class="fu">unique</span>(in_df<span class="sc">$</span>sorted_day[in_df<span class="sc">$</span>event<span class="sc">==</span>i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>correct_sort<span class="sc">==</span><span class="cn">FALSE</span>])</span>
<span id="cb110-26"><a href="behavioral-analysis.html#cb110-26" aria-hidden="true" tabindex="-1"></a>      swap_errs_idx <span class="ot">&lt;-</span> in_df<span class="sc">$</span>event <span class="sc">==</span> i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>day <span class="sc">%in%</span> sorted_days <span class="co"># selects the 3 events that objectively belong to the days that events were incorrectly sorted to</span></span>
<span id="cb110-27"><a href="behavioral-analysis.html#cb110-27" aria-hidden="true" tabindex="-1"></a>      out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-28"><a href="behavioral-analysis.html#cb110-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stopifnot</span>(<span class="dv">3</span><span class="sc">==</span><span class="fu">sum</span>(swap_errs_idx))</span>
<span id="cb110-29"><a href="behavioral-analysis.html#cb110-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-30"><a href="behavioral-analysis.html#cb110-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-31"><a href="behavioral-analysis.html#cb110-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the four events are sorted to four days and no event is sorted correctly,</span></span>
<span id="cb110-32"><a href="behavioral-analysis.html#cb110-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># all four events have been swapped</span></span>
<span id="cb110-33"><a href="behavioral-analysis.html#cb110-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_correct<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> n_unique_days<span class="sc">==</span><span class="dv">4</span>){</span>
<span id="cb110-34"><a href="behavioral-analysis.html#cb110-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb110-35"><a href="behavioral-analysis.html#cb110-35" aria-hidden="true" tabindex="-1"></a>      swap_errs_idx <span class="ot">&lt;-</span> in_df<span class="sc">$</span>event <span class="sc">==</span> i_event</span>
<span id="cb110-36"><a href="behavioral-analysis.html#cb110-36" aria-hidden="true" tabindex="-1"></a>      out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-37"><a href="behavioral-analysis.html#cb110-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-38"><a href="behavioral-analysis.html#cb110-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-39"><a href="behavioral-analysis.html#cb110-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the four events are sorted to three days and one event is sorted correctly,</span></span>
<span id="cb110-40"><a href="behavioral-analysis.html#cb110-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># there are multiple possibilities that need to be tested. </span></span>
<span id="cb110-41"><a href="behavioral-analysis.html#cb110-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_correct<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> n_unique_days<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb110-42"><a href="behavioral-analysis.html#cb110-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb110-43"><a href="behavioral-analysis.html#cb110-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># There can&#39;t be a swap error for the event(s) sorted to the day where the correct sort was.</span></span>
<span id="cb110-44"><a href="behavioral-analysis.html#cb110-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># So let&#39;s only look at the other days. This means we are looking at two or three events,</span></span>
<span id="cb110-45"><a href="behavioral-analysis.html#cb110-45" aria-hidden="true" tabindex="-1"></a>      <span class="co"># depending on whether an incorrect sort occurred to the day whose event was sorted correctly or not</span></span>
<span id="cb110-46"><a href="behavioral-analysis.html#cb110-46" aria-hidden="true" tabindex="-1"></a>      correctly_sorted_day <span class="ot">&lt;-</span> in_df<span class="sc">$</span>day[in_df<span class="sc">$</span>event<span class="sc">==</span>i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>correct_sort <span class="sc">==</span> <span class="cn">TRUE</span>]</span>
<span id="cb110-47"><a href="behavioral-analysis.html#cb110-47" aria-hidden="true" tabindex="-1"></a>      curr_dat <span class="ot">&lt;-</span> in_df[event <span class="sc">==</span> i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>sorted_day <span class="sc">!=</span> correctly_sorted_day,]</span>
<span id="cb110-48"><a href="behavioral-analysis.html#cb110-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-49"><a href="behavioral-analysis.html#cb110-49" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if there are two events left, we check for both events whether they were sorted to</span></span>
<span id="cb110-50"><a href="behavioral-analysis.html#cb110-50" aria-hidden="true" tabindex="-1"></a>      <span class="co"># the correct day of the respective other event. If yes, the two were swapped!</span></span>
<span id="cb110-51"><a href="behavioral-analysis.html#cb110-51" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(curr_dat)<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb110-52"><a href="behavioral-analysis.html#cb110-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(curr_dat<span class="sc">$</span>day[<span class="dv">1</span>]<span class="sc">==</span>curr_dat<span class="sc">$</span>sorted_day[<span class="dv">2</span>] <span class="sc">&amp;</span> curr_dat<span class="sc">$</span>day[<span class="dv">2</span>]<span class="sc">==</span>curr_dat<span class="sc">$</span>sorted_day[<span class="dv">1</span>]){</span>
<span id="cb110-53"><a href="behavioral-analysis.html#cb110-53" aria-hidden="true" tabindex="-1"></a>          swap_errs_idx <span class="ot">&lt;-</span> (in_df<span class="sc">$</span>event <span class="sc">==</span> i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>day <span class="sc">%in%</span> curr_dat<span class="sc">$</span>day)</span>
<span id="cb110-54"><a href="behavioral-analysis.html#cb110-54" aria-hidden="true" tabindex="-1"></a>          out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-55"><a href="behavioral-analysis.html#cb110-55" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb110-56"><a href="behavioral-analysis.html#cb110-56" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb110-57"><a href="behavioral-analysis.html#cb110-57" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb110-58"><a href="behavioral-analysis.html#cb110-58" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if there are three events left, two of the three are swapped.</span></span>
<span id="cb110-59"><a href="behavioral-analysis.html#cb110-59" aria-hidden="true" tabindex="-1"></a>      <span class="co"># we compare all pairwise comparisons of sorted and true days to find out for which pair</span></span>
<span id="cb110-60"><a href="behavioral-analysis.html#cb110-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># the true days match the sorted days</span></span>
<span id="cb110-61"><a href="behavioral-analysis.html#cb110-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(curr_dat)<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb110-62"><a href="behavioral-analysis.html#cb110-62" aria-hidden="true" tabindex="-1"></a>        comps <span class="ot">&lt;-</span> combinat<span class="sc">::</span><span class="fu">combn</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb110-63"><a href="behavioral-analysis.html#cb110-63" aria-hidden="true" tabindex="-1"></a>        swap_comp1 <span class="ot">&lt;-</span> <span class="fu">which</span>(curr_dat<span class="sc">$</span>day[comps[<span class="dv">1</span>,]]<span class="sc">==</span>curr_dat<span class="sc">$</span>sorted_day[comps[<span class="dv">2</span>,]])</span>
<span id="cb110-64"><a href="behavioral-analysis.html#cb110-64" aria-hidden="true" tabindex="-1"></a>        swap_comp2 <span class="ot">&lt;-</span> <span class="fu">which</span>(curr_dat<span class="sc">$</span>day[comps[<span class="dv">2</span>,]]<span class="sc">==</span>curr_dat<span class="sc">$</span>sorted_day[comps[<span class="dv">1</span>,]])</span>
<span id="cb110-65"><a href="behavioral-analysis.html#cb110-65" aria-hidden="true" tabindex="-1"></a>        swap_rows <span class="ot">&lt;-</span> comps[, <span class="fu">intersect</span>(swap_comp1, swap_comp2)]</span>
<span id="cb110-66"><a href="behavioral-analysis.html#cb110-66" aria-hidden="true" tabindex="-1"></a>        swap_errs_idx <span class="ot">&lt;-</span> (in_df<span class="sc">$</span>event <span class="sc">==</span> i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>day <span class="sc">%in%</span> curr_dat<span class="sc">$</span>day[swap_rows])</span>
<span id="cb110-67"><a href="behavioral-analysis.html#cb110-67" aria-hidden="true" tabindex="-1"></a>        out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-68"><a href="behavioral-analysis.html#cb110-68" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb110-69"><a href="behavioral-analysis.html#cb110-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-70"><a href="behavioral-analysis.html#cb110-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-71"><a href="behavioral-analysis.html#cb110-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the four events are sorted to four days and only one event is sorted correctly,</span></span>
<span id="cb110-72"><a href="behavioral-analysis.html#cb110-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># there is a three-way swap between the incorrectly sorted events</span></span>
<span id="cb110-73"><a href="behavioral-analysis.html#cb110-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_correct<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> n_unique_days<span class="sc">==</span><span class="dv">4</span>){</span>
<span id="cb110-74"><a href="behavioral-analysis.html#cb110-74" aria-hidden="true" tabindex="-1"></a>      swap_errs_idx <span class="ot">&lt;-</span> (in_df<span class="sc">$</span>event <span class="sc">==</span> i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>correct_sort <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-75"><a href="behavioral-analysis.html#cb110-75" aria-hidden="true" tabindex="-1"></a>      out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-76"><a href="behavioral-analysis.html#cb110-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-77"><a href="behavioral-analysis.html#cb110-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-78"><a href="behavioral-analysis.html#cb110-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the four events are sorted to four days and two events are sorted correctly,</span></span>
<span id="cb110-79"><a href="behavioral-analysis.html#cb110-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># there is a swap between the two incorrectly sorted events</span></span>
<span id="cb110-80"><a href="behavioral-analysis.html#cb110-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n_correct<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> n_unique_days<span class="sc">==</span><span class="dv">4</span>){</span>
<span id="cb110-81"><a href="behavioral-analysis.html#cb110-81" aria-hidden="true" tabindex="-1"></a>      swap_errs_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(in_df<span class="sc">$</span>event<span class="sc">==</span>i_event <span class="sc">&amp;</span> in_df<span class="sc">$</span>correct_sort <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-82"><a href="behavioral-analysis.html#cb110-82" aria-hidden="true" tabindex="-1"></a>      out_df<span class="sc">$</span>swap_err[swap_errs_idx] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb110-83"><a href="behavioral-analysis.html#cb110-83" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-84"><a href="behavioral-analysis.html#cb110-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-85"><a href="behavioral-analysis.html#cb110-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_df)</span>
<span id="cb110-86"><a href="behavioral-analysis.html#cb110-86" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s apply this function to the data of each participant.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="behavioral-analysis.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add variable denoting if event was sorted correctly</span></span>
<span id="cb111-2"><a href="behavioral-analysis.html#cb111-2" aria-hidden="true" tabindex="-1"></a>beh_data <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="behavioral-analysis.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">correct_sort =</span> <span class="fu">as.numeric</span>(day<span class="sc">==</span>sorted_day),</span>
<span id="cb111-4"><a href="behavioral-analysis.html#cb111-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">swap_err =</span> <span class="cn">FALSE</span>)</span>
<span id="cb111-5"><a href="behavioral-analysis.html#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="behavioral-analysis.html#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> <span class="fu">as.numeric</span>(subjects)){</span>
<span id="cb111-7"><a href="behavioral-analysis.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if a subject has sorting errors (i.e. not all 20 events were correctly sorted) run function to identify swap errors</span></span>
<span id="cb111-8"><a href="behavioral-analysis.html#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(beh_data<span class="sc">$</span>correct_sort[beh_data<span class="sc">$</span>sub_id<span class="sc">==</span>i_sub])<span class="sc">&lt;</span><span class="dv">20</span>){</span>
<span id="cb111-9"><a href="behavioral-analysis.html#cb111-9" aria-hidden="true" tabindex="-1"></a>    sub_dat <span class="ot">&lt;-</span> <span class="fu">find_swap_errors</span>(beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_id <span class="sc">==</span> i_sub))</span>
<span id="cb111-10"><a href="behavioral-analysis.html#cb111-10" aria-hidden="true" tabindex="-1"></a>    beh_data<span class="sc">$</span>swap_err[beh_data<span class="sc">$</span>sub_id<span class="sc">==</span>i_sub]<span class="ot">&lt;-</span>sub_dat<span class="sc">$</span>swap_err</span>
<span id="cb111-11"><a href="behavioral-analysis.html#cb111-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-12"><a href="behavioral-analysis.html#cb111-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="descriptives-of-swap-errors" class="section level3 unnumbered">
<h3>Descriptives of swap errors</h3>
<p>Let’s see how many swap errors were made and plot a histogram of swap errors as a function of sorting errors.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="behavioral-analysis.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of swap errors for each participant</span></span>
<span id="cb112-2"><a href="behavioral-analysis.html#cb112-2" aria-hidden="true" tabindex="-1"></a>beh_group<span class="sc">$</span>n_swap_errs <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="behavioral-analysis.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="behavioral-analysis.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_swap_errs=</span><span class="fu">sum</span>(swap_err), <span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-5"><a href="behavioral-analysis.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n_swap_errs)</span>
<span id="cb112-6"><a href="behavioral-analysis.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="behavioral-analysis.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print descriptive stats</span></span>
<span id="cb112-8"><a href="behavioral-analysis.html#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;%d of %d participants made at least one sorting error&quot;</span>, <span class="fu">sum</span>(beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>), <span class="fu">nrow</span>(beh_group))</span></code></pre></div>
<pre><code>## [1] &quot;14 of 28 participants made at least one sorting error&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="behavioral-analysis.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;Of the %d participants with sorting errors, %d made swap errors (mean±S.D: %.1f±%.1f, %.1f%%±%.1f%% of sorting errors were swap errors)&quot;</span>, </span>
<span id="cb114-2"><a href="behavioral-analysis.html#cb114-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>(beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>), </span>
<span id="cb114-3"><a href="behavioral-analysis.html#cb114-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>(beh_group<span class="sc">$</span>n_swap_errs[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>]<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb114-4"><a href="behavioral-analysis.html#cb114-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(beh_group<span class="sc">$</span>n_swap_errs[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>]),</span>
<span id="cb114-5"><a href="behavioral-analysis.html#cb114-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sd</span>(beh_group<span class="sc">$</span>n_swap_errs[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>]),</span>
<span id="cb114-6"><a href="behavioral-analysis.html#cb114-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(beh_group<span class="sc">$</span>n_swap_errs[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>]<span class="sc">/</span>beh_group<span class="sc">$</span>n_sorting_errors[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>])<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb114-7"><a href="behavioral-analysis.html#cb114-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sd</span>(beh_group<span class="sc">$</span>n_swap_errs[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>]<span class="sc">/</span>beh_group<span class="sc">$</span>n_sorting_errors[beh_group<span class="sc">$</span>n_correct_sorts<span class="sc">&lt;</span><span class="dv">20</span>])<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Of the 14 participants with sorting errors, 12 made swap errors (mean±S.D: 3.1±2.1, 57.5%±34.3% of sorting errors were swap errors)&quot;</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="behavioral-analysis.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of number swap errors</span></span>
<span id="cb116-2"><a href="behavioral-analysis.html#cb116-2" aria-hidden="true" tabindex="-1"></a>sfig_beh_e  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_group, <span class="fu">aes</span>(<span class="at">x=</span>n_swap_errs, <span class="at">group=</span>perfect_sort, <span class="at">fill=</span>perfect_sort)) <span class="sc">+</span></span>
<span id="cb116-3"><a href="behavioral-analysis.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.2</span>),<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-4"><a href="behavioral-analysis.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;count&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">14</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb116-5"><a href="behavioral-analysis.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;swap errors&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-6"><a href="behavioral-analysis.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#81A88D&quot;</span>, <span class="st">&quot;#972D15&quot;</span>), </span>
<span id="cb116-7"><a href="behavioral-analysis.html#cb116-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name=</span><span class="fu">element_blank</span>(), </span>
<span id="cb116-8"><a href="behavioral-analysis.html#cb116-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;no sorting</span><span class="sc">\n</span><span class="st">error&quot;</span>, <span class="st">&quot;≥1 sorting</span><span class="sc">\n</span><span class="st">error&quot;</span>)) <span class="sc">+</span></span>
<span id="cb116-9"><a href="behavioral-analysis.html#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb116-10"><a href="behavioral-analysis.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb116-11"><a href="behavioral-analysis.html#cb116-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb116-12"><a href="behavioral-analysis.html#cb116-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb116-13"><a href="behavioral-analysis.html#cb116-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb116-14"><a href="behavioral-analysis.html#cb116-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb116-15"><a href="behavioral-analysis.html#cb116-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb116-16"><a href="behavioral-analysis.html#cb116-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb116-17"><a href="behavioral-analysis.html#cb116-17" aria-hidden="true" tabindex="-1"></a>sfig_beh_e</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
</div>
<div id="swap-errors-as-a-function-of-sequence-position" class="section level3 unnumbered">
<h3>Swap errors as a function of sequence position</h3>
<p>Next, we test whether the distribution of swap errors across sequence positions differs from uniformity.</p>
<blockquote>
<p>We used a χ2-test to assess whether the number of swap errors deviated from uniformity across sequence positions.</p>
</blockquote>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="behavioral-analysis.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DISTRIBUTION OF SWAP ERRORS</span></span>
<span id="cb117-2"><a href="behavioral-analysis.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># test whether frequencies of swap errors for the sequence positions differs from uniformity</span></span>
<span id="cb117-3"><a href="behavioral-analysis.html#cb117-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(swap_err<span class="sc">==</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb117-4"><a href="behavioral-analysis.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(event) <span class="sc">%&gt;%</span> </span>
<span id="cb117-5"><a href="behavioral-analysis.html#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_swap_errs =</span> <span class="fu">sum</span>(swap_err), <span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb117-6"><a href="behavioral-analysis.html#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n_swap_errs) <span class="sc">%&gt;%</span></span>
<span id="cb117-7"><a href="behavioral-analysis.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>() <span class="sc">%&gt;%</span></span>
<span id="cb117-8"><a href="behavioral-analysis.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb117-9"><a href="behavioral-analysis.html#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="behavioral-analysis.html#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of swap errors as a function of sequence position</span></span>
<span id="cb117-11"><a href="behavioral-analysis.html#cb117-11" aria-hidden="true" tabindex="-1"></a>sfig_beh_f <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(swap_err<span class="sc">==</span><span class="cn">TRUE</span>), <span class="fu">aes</span>(<span class="at">x=</span>event, <span class="at">fill =</span> event)) <span class="sc">+</span></span>
<span id="cb117-12"><a href="behavioral-analysis.html#cb117-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb117-13"><a href="behavioral-analysis.html#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> event_colors) <span class="sc">+</span></span>
<span id="cb117-14"><a href="behavioral-analysis.html#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;swap error count&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb117-15"><a href="behavioral-analysis.html#cb117-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb117-16"><a href="behavioral-analysis.html#cb117-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb117-17"><a href="behavioral-analysis.html#cb117-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb117-18"><a href="behavioral-analysis.html#cb117-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb117-19"><a href="behavioral-analysis.html#cb117-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb117-20"><a href="behavioral-analysis.html#cb117-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb117-21"><a href="behavioral-analysis.html#cb117-21" aria-hidden="true" tabindex="-1"></a>sfig_beh_f</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p><span class="math inline">\(\chi^2\)</span> test against uniformity for distribution of swap errors:
<span class="math inline">\(\chi^2\)</span>=1.07, p=0.899</p>
</div>
<div id="swap-error-more-frequent-than-expected-from-chance" class="section level3 unnumbered">
<h3>Swap error: More frequent than expected from chance?</h3>
<p>So we do observe swap errors, but are they more frequent than what would be expected from chance given the number of sorting errors in our data? To test that, we run a permutation test where we generate a fake sample of participants that has the same number of swap errors as the real participants, but swap errors are introduced at random positions.</p>
<blockquote>
<p>To test whether participants made more swap errors than expected from chance we ran a permutation test where we introduced sorting errors for randomly selected events. For each of 10 000 iterations, we generated a surrogate sample of sorting results with the number of randomly introduced sorting errors matching the number of errors made by the different participants in our sample. We then quantified the proportion of swap errors across this surrogate sample. This resulted in a distribution of the proportion of swap errors that would be expected from random sorting errors. We assessed how many permutations yielded proportions of swap errors larger or equal to the proportion of swap errors observed in the fMRI sample to compute a p-value and further quantified a z-value as the difference between the observed swap error proportion and the mean of the chance distribution divided by the standard deviation of the chance distribution.</p>
</blockquote>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="behavioral-analysis.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble with a perfect sorting result</span></span>
<span id="cb118-2"><a href="behavioral-analysis.html#cb118-2" aria-hidden="true" tabindex="-1"></a>perfect_sort <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">day =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_days,<span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb118-3"><a href="behavioral-analysis.html#cb118-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">event =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_events_day, <span class="dv">4</span>), </span>
<span id="cb118-4"><a href="behavioral-analysis.html#cb118-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sorted_day =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_days, <span class="at">each=</span><span class="dv">5</span>),</span>
<span id="cb118-5"><a href="behavioral-analysis.html#cb118-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sort_err =</span> <span class="cn">FALSE</span>)</span>
<span id="cb118-6"><a href="behavioral-analysis.html#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="behavioral-analysis.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># from the data, find the participants with sorting errors and their number of swap errors</span></span>
<span id="cb118-8"><a href="behavioral-analysis.html#cb118-8" aria-hidden="true" tabindex="-1"></a>n_sort_errs <span class="ot">&lt;-</span> beh_group<span class="sc">$</span>n_sorting_errors[beh_group<span class="sc">$</span>n_sorting_errors<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb118-9"><a href="behavioral-analysis.html#cb118-9" aria-hidden="true" tabindex="-1"></a>n_swap_errs <span class="ot">&lt;-</span> beh_group<span class="sc">$</span>n_swap_errs[beh_group<span class="sc">$</span>n_sorting_errors<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb118-10"><a href="behavioral-analysis.html#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="behavioral-analysis.html#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix in which to store output</span></span>
<span id="cb118-12"><a href="behavioral-analysis.html#cb118-12" aria-hidden="true" tabindex="-1"></a>n_swap_errs_perm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(n_sort_errs), <span class="at">ncol=</span>n_perm)</span>
<span id="cb118-13"><a href="behavioral-analysis.html#cb118-13" aria-hidden="true" tabindex="-1"></a>prop_swap_errs_perm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(n_sort_errs), <span class="at">ncol=</span>n_perm)</span>
<span id="cb118-14"><a href="behavioral-analysis.html#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="behavioral-analysis.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_perm <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_perm){ <span class="co"># takes ~30min with 10000 shuffles</span></span>
<span id="cb118-16"><a href="behavioral-analysis.html#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_sub <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n_sort_errs)){</span>
<span id="cb118-17"><a href="behavioral-analysis.html#cb118-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-18"><a href="behavioral-analysis.html#cb118-18" aria-hidden="true" tabindex="-1"></a>    found_rand_sort_errs <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb118-19"><a href="behavioral-analysis.html#cb118-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(found_rand_sort_errs <span class="sc">==</span> <span class="cn">FALSE</span>){ <span class="co"># shuffle given number of sorts until we end up with the correct number of errors</span></span>
<span id="cb118-20"><a href="behavioral-analysis.html#cb118-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb118-21"><a href="behavioral-analysis.html#cb118-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># determine a random subset of trials as sorting errors (number of errors based on actual number of errors of current subject)</span></span>
<span id="cb118-22"><a href="behavioral-analysis.html#cb118-22" aria-hidden="true" tabindex="-1"></a>      error_sort <span class="ot">&lt;-</span> perfect_sort</span>
<span id="cb118-23"><a href="behavioral-analysis.html#cb118-23" aria-hidden="true" tabindex="-1"></a>      error_sort<span class="sc">$</span>sort_err[<span class="fu">sample</span>(<span class="at">x=</span>n_days<span class="sc">*</span>n_events_day,<span class="at">size=</span>n_sort_errs[i_sub])] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb118-24"><a href="behavioral-analysis.html#cb118-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb118-25"><a href="behavioral-analysis.html#cb118-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># shuffle the sorted days of the inserted sorting errors</span></span>
<span id="cb118-26"><a href="behavioral-analysis.html#cb118-26" aria-hidden="true" tabindex="-1"></a>      error_sort<span class="sc">$</span>sorted_day[error_sort<span class="sc">$</span>sort_err] <span class="ot">&lt;-</span> <span class="fu">sample</span>(error_sort<span class="sc">$</span>sorted_day[error_sort<span class="sc">$</span>sort_err])</span>
<span id="cb118-27"><a href="behavioral-analysis.html#cb118-27" aria-hidden="true" tabindex="-1"></a>      error_sort<span class="sc">$</span>correct_sort <span class="ot">&lt;-</span> error_sort<span class="sc">$</span>sorted_day <span class="sc">==</span> error_sort<span class="sc">$</span>day</span>
<span id="cb118-28"><a href="behavioral-analysis.html#cb118-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb118-29"><a href="behavioral-analysis.html#cb118-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># break loop if we end up with the correct number of sorting errors </span></span>
<span id="cb118-30"><a href="behavioral-analysis.html#cb118-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># (number of errors can be smaller if the above sample assigns to the correct day by chance)</span></span>
<span id="cb118-31"><a href="behavioral-analysis.html#cb118-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">sum</span>(<span class="sc">!</span>error_sort<span class="sc">$</span>correct_sort)<span class="sc">==</span>n_sort_errs[i_sub]){</span>
<span id="cb118-32"><a href="behavioral-analysis.html#cb118-32" aria-hidden="true" tabindex="-1"></a>        found_rand_sort_errs <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb118-33"><a href="behavioral-analysis.html#cb118-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb118-34"><a href="behavioral-analysis.html#cb118-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb118-35"><a href="behavioral-analysis.html#cb118-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-36"><a href="behavioral-analysis.html#cb118-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find swap errors</span></span>
<span id="cb118-37"><a href="behavioral-analysis.html#cb118-37" aria-hidden="true" tabindex="-1"></a>    error_sort <span class="ot">&lt;-</span> <span class="fu">find_swap_errors</span>(<span class="at">in_df =</span> error_sort)</span>
<span id="cb118-38"><a href="behavioral-analysis.html#cb118-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-39"><a href="behavioral-analysis.html#cb118-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># count swap for this permutation subject and store</span></span>
<span id="cb118-40"><a href="behavioral-analysis.html#cb118-40" aria-hidden="true" tabindex="-1"></a>    n_swap_errs_perm[i_sub, i_perm] <span class="ot">&lt;-</span> <span class="fu">sum</span>(error_sort<span class="sc">$</span>swap_err)</span>
<span id="cb118-41"><a href="behavioral-analysis.html#cb118-41" aria-hidden="true" tabindex="-1"></a>    prop_swap_errs_perm[i_sub, i_perm] <span class="ot">&lt;-</span> <span class="fu">sum</span>(error_sort<span class="sc">$</span>swap_err)<span class="sc">/</span>n_sort_errs[i_sub]</span>
<span id="cb118-42"><a href="behavioral-analysis.html#cb118-42" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># subject</span></span>
<span id="cb118-43"><a href="behavioral-analysis.html#cb118-43" aria-hidden="true" tabindex="-1"></a>} <span class="co"># permutation</span></span>
<span id="cb118-44"><a href="behavioral-analysis.html#cb118-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-45"><a href="behavioral-analysis.html#cb118-45" aria-hidden="true" tabindex="-1"></a><span class="co"># make tibble of average proportion of swap errors</span></span>
<span id="cb118-46"><a href="behavioral-analysis.html#cb118-46" aria-hidden="true" tabindex="-1"></a>perm_dist <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">prop_swap_errs =</span> <span class="fu">colMeans</span>(prop_swap_errs_perm))</span>
<span id="cb118-47"><a href="behavioral-analysis.html#cb118-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-48"><a href="behavioral-analysis.html#cb118-48" aria-hidden="true" tabindex="-1"></a><span class="co"># get p and z-value</span></span>
<span id="cb118-49"><a href="behavioral-analysis.html#cb118-49" aria-hidden="true" tabindex="-1"></a>p_sort_perm <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">c</span>(perm_dist<span class="sc">$</span>prop_swap_errs, <span class="fu">mean</span>(n_swap_errs<span class="sc">/</span>n_sort_errs)) <span class="sc">&gt;=</span> <span class="fu">mean</span>(n_swap_errs<span class="sc">/</span>n_sort_errs))<span class="sc">/</span></span>
<span id="cb118-50"><a href="behavioral-analysis.html#cb118-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">c</span>(perm_dist<span class="sc">$</span>prop_swap_errs, <span class="fu">mean</span>(n_swap_errs<span class="sc">/</span>n_sort_errs)))</span>
<span id="cb118-51"><a href="behavioral-analysis.html#cb118-51" aria-hidden="true" tabindex="-1"></a>z_sort_perm <span class="ot">&lt;-</span> (<span class="fu">mean</span>(n_swap_errs<span class="sc">/</span>n_sort_errs)<span class="sc">-</span><span class="fu">mean</span>(perm_dist<span class="sc">$</span>prop_swap_errs))<span class="sc">/</span><span class="fu">sd</span>(perm_dist<span class="sc">$</span>prop_swap_errs)</span></code></pre></div>
<p>Permutation test for proportion of swap errors given the number of sorting errors:
z=5.07, p=0.000</p>
<p>Plot histogram of the chance distribution.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="behavioral-analysis.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of average proportions</span></span>
<span id="cb119-2"><a href="behavioral-analysis.html#cb119-2" aria-hidden="true" tabindex="-1"></a>prctile <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">expression</span>(<span class="dv">95</span><span class="sc">^</span>{th}<span class="sc">*</span><span class="st">&quot; percentile&quot;</span>))</span>
<span id="cb119-3"><a href="behavioral-analysis.html#cb119-3" aria-hidden="true" tabindex="-1"></a>sfig_beh_g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(perm_dist, <span class="fu">aes</span>(<span class="at">x=</span>prop_swap_errs)) <span class="sc">+</span></span>
<span id="cb119-4"><a href="behavioral-analysis.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span> ultimate_gray) <span class="sc">+</span></span>
<span id="cb119-5"><a href="behavioral-analysis.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">x =</span> <span class="fu">quantile</span>(perm_dist<span class="sc">$</span>prop_swap_errs, <span class="at">probs=</span><span class="fl">0.95</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">color=</span><span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-6"><a href="behavioral-analysis.html#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">quantile</span>(prop_swap_errs, <span class="at">probs=</span><span class="fl">0.95</span>), <span class="at">y=</span><span class="fl">1.5</span>, <span class="at">label =</span> prctile), </span>
<span id="cb119-7"><a href="behavioral-analysis.html#cb119-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;BLACK&quot;</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-8"><a href="behavioral-analysis.html#cb119-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">label.size =</span> <span class="dv">1</span><span class="sc">/</span>.pt,) <span class="sc">+</span></span>
<span id="cb119-9"><a href="behavioral-analysis.html#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">x =</span> <span class="fu">mean</span>(n_swap_errs<span class="sc">/</span>n_sort_errs), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">color=</span><span class="st">&quot;#972D15&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-10"><a href="behavioral-analysis.html#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="dv">3</span>, <span class="at">label=</span><span class="st">&quot;% swap errors</span><span class="sc">\n</span><span class="st">in fMRI sample&quot;</span>), </span>
<span id="cb119-11"><a href="behavioral-analysis.html#cb119-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), <span class="at">label.size =</span> <span class="dv">1</span><span class="sc">/</span>.pt,</span>
<span id="cb119-12"><a href="behavioral-analysis.html#cb119-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">&quot;#972D15&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-13"><a href="behavioral-analysis.html#cb119-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb119-14"><a href="behavioral-analysis.html#cb119-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;% swaps of sorting errors&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-15"><a href="behavioral-analysis.html#cb119-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;% of shuffles&quot;</span>) <span class="sc">+</span></span>
<span id="cb119-16"><a href="behavioral-analysis.html#cb119-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb119-17"><a href="behavioral-analysis.html#cb119-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb119-18"><a href="behavioral-analysis.html#cb119-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb119-19"><a href="behavioral-analysis.html#cb119-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb119-20"><a href="behavioral-analysis.html#cb119-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb119-21"><a href="behavioral-analysis.html#cb119-21" aria-hidden="true" tabindex="-1"></a>sfig_beh_g</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="swap-errors-and-generalization-bias" class="section level3 unnumbered">
<h3>Swap errors and generalization bias</h3>
<p>Both swap errors and the generalization bias point towards subjects generalizing across sequences in memory. Let’s test if the two are related across subjects.</p>
<blockquote>
<p>We tested whether the number of swap errors was related to absolute errors in the timeline task (see below) using Spearman’s correlation and a t-test for independent samples.</p>
</blockquote>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="behavioral-analysis.html#cb120-1" aria-hidden="true" tabindex="-1"></a>beh_group <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(beh_group, fit_beh_bias)</span></code></pre></div>
<pre><code>## Joining, by = &quot;sub_id&quot;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="behavioral-analysis.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRELATION OF SWAP ERRORS AND GENERALIZATION BIAS </span></span>
<span id="cb122-2"><a href="behavioral-analysis.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman correlation</span></span>
<span id="cb122-3"><a href="behavioral-analysis.html#cb122-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> beh_group <span class="sc">%$%</span></span>
<span id="cb122-4"><a href="behavioral-analysis.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor.test</span>(n_swap_errs, beta_rel_time_other_events,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-5"><a href="behavioral-analysis.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code></pre></div>
<pre><code>## Warning in cor.test.default(n_swap_errs, beta_rel_time_other_events, method = &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="behavioral-analysis.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot of swap errors and generalization bias</span></span>
<span id="cb124-2"><a href="behavioral-analysis.html#cb124-2" aria-hidden="true" tabindex="-1"></a>sfig_beh_h <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_group, <span class="fu">aes</span>(<span class="at">x=</span>n_swap_errs, <span class="at">y=</span>beta_rel_time_other_events)) <span class="sc">+</span></span>
<span id="cb124-3"><a href="behavioral-analysis.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span> y<span class="sc">~</span>x, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color=</span>ultimate_gray, <span class="at">fill=</span><span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-4"><a href="behavioral-analysis.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color=</span>ultimate_gray) <span class="sc">+</span> </span>
<span id="cb124-5"><a href="behavioral-analysis.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb124-6"><a href="behavioral-analysis.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;swap errors&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-7"><a href="behavioral-analysis.html#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;generalization bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb124-8"><a href="behavioral-analysis.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="cn">Inf</span>, <span class="at">y=</span><span class="cn">Inf</span>, <span class="at">hjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">vjust=</span><span class="st">&quot;inward&quot;</span>, <span class="at">size=</span><span class="dv">6</span><span class="sc">/</span>.pt,</span>
<span id="cb124-9"><a href="behavioral-analysis.html#cb124-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">sprintf</span>(<span class="st">&quot;r=%.2f</span><span class="sc">\n</span><span class="st">p=%.3f&quot;</span>, <span class="fu">round</span>(stats<span class="sc">$</span>estimate, <span class="at">digits=</span><span class="dv">2</span>), <span class="fu">round</span>(stats<span class="sc">$</span>p.value, <span class="at">digits=</span><span class="dv">3</span>)),</span>
<span id="cb124-10"><a href="behavioral-analysis.html#cb124-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span>font2use) <span class="sc">+</span></span>
<span id="cb124-11"><a href="behavioral-analysis.html#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb124-12"><a href="behavioral-analysis.html#cb124-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb124-13"><a href="behavioral-analysis.html#cb124-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb124-14"><a href="behavioral-analysis.html#cb124-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb124-15"><a href="behavioral-analysis.html#cb124-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb124-16"><a href="behavioral-analysis.html#cb124-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb124-17"><a href="behavioral-analysis.html#cb124-17" aria-hidden="true" tabindex="-1"></a>sfig_beh_h</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>Spearman correlation of number of swap errors and generalization bias:
r=-0.12, p=0.528</p>
<p>Again, this correlation is limited by the fact that many subject don’t make sorting errors and thus cannot make any swap errors. So let’s contrast participants with and without swap errors.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="behavioral-analysis.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test based on swap error or not</span></span>
<span id="cb125-2"><a href="behavioral-analysis.html#cb125-2" aria-hidden="true" tabindex="-1"></a>beh_group <span class="ot">&lt;-</span> beh_group <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">min_1swap =</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(n_swap_errs<span class="sc">&gt;</span><span class="dv">0</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>)))</span>
<span id="cb125-3"><a href="behavioral-analysis.html#cb125-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">t.test</span>(beh_group<span class="sc">$</span>beta_rel_time_other_events[beh_group<span class="sc">$</span>min_1swap<span class="sc">==</span><span class="st">&quot;yes&quot;</span>], </span>
<span id="cb125-4"><a href="behavioral-analysis.html#cb125-4" aria-hidden="true" tabindex="-1"></a>                     beh_group<span class="sc">$</span>beta_rel_time_other_events[beh_group<span class="sc">$</span>min_1swap<span class="sc">==</span><span class="st">&quot;no&quot;</span>],</span>
<span id="cb125-5"><a href="behavioral-analysis.html#cb125-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">var.equal =</span> <span class="cn">TRUE</span>))</span>
<span id="cb125-6"><a href="behavioral-analysis.html#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="behavioral-analysis.html#cb125-7" aria-hidden="true" tabindex="-1"></a>sfig_beh_i <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beh_group, <span class="fu">aes</span>(<span class="at">x=</span>min_1swap, <span class="at">y=</span>beta_rel_time_other_events, <span class="at">fill=</span>min_1swap, <span class="at">color=</span>min_1swap)) <span class="sc">+</span></span>
<span id="cb125-8"><a href="behavioral-analysis.html#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb125-9"><a href="behavioral-analysis.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data=</span>beh_group <span class="sc">%&gt;%</span> <span class="fu">filter</span>(min_1swap<span class="sc">==</span><span class="st">&quot;yes&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">y=</span>beta_rel_time_other_events),</span>
<span id="cb125-10"><a href="behavioral-analysis.html#cb125-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb125-11"><a href="behavioral-analysis.html#cb125-11" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data=</span>beh_group <span class="sc">%&gt;%</span> <span class="fu">filter</span>(min_1swap<span class="sc">==</span><span class="st">&quot;no&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span>beta_rel_time_other_events),</span>
<span id="cb125-12"><a href="behavioral-analysis.html#cb125-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>), <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb125-13"><a href="behavioral-analysis.html#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">ifelse</span>(min_1swap<span class="sc">==</span><span class="st">&quot;yes&quot;</span>, <span class="fl">1.8</span>, <span class="fl">1.2</span>)), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>), <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb125-14"><a href="behavioral-analysis.html#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb125-15"><a href="behavioral-analysis.html#cb125-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>) <span class="sc">+</span> </span>
<span id="cb125-16"><a href="behavioral-analysis.html#cb125-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb125-17"><a href="behavioral-analysis.html#cb125-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;BLACK&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb125-18"><a href="behavioral-analysis.html#cb125-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;generalization bias&#39;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;swap errors&#39;</span>) <span class="sc">+</span> </span>
<span id="cb125-19"><a href="behavioral-analysis.html#cb125-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb125-20"><a href="behavioral-analysis.html#cb125-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;underline(&quot;  n.s.  &quot;)&#39;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span><span class="sc">/</span>.pt, <span class="at">family=</span>font2use, <span class="at">parse=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb125-21"><a href="behavioral-analysis.html#cb125-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;≥1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb125-22"><a href="behavioral-analysis.html#cb125-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#81A88D&quot;</span>, <span class="st">&quot;#972D15&quot;</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;no swap error&quot;</span>, <span class="st">&quot;≥1 swap error&quot;</span>)) <span class="sc">+</span></span>
<span id="cb125-23"><a href="behavioral-analysis.html#cb125-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#81A88D&quot;</span>, <span class="st">&quot;#972D15&quot;</span>)) <span class="sc">+</span></span>
<span id="cb125-24"><a href="behavioral-analysis.html#cb125-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;swap errors&quot;</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape=</span><span class="dv">16</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">0</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="dv">1</span>)), <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-25"><a href="behavioral-analysis.html#cb125-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb125-26"><a href="behavioral-analysis.html#cb125-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb125-27"><a href="behavioral-analysis.html#cb125-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb125-28"><a href="behavioral-analysis.html#cb125-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb125-29"><a href="behavioral-analysis.html#cb125-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb125-30"><a href="behavioral-analysis.html#cb125-30" aria-hidden="true" tabindex="-1"></a>sfig_beh_i</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-72-1.png" width="672" />
Summary Statistics: independent t-test comparing generalization bias for participants without and with swap errors
t<sub>26</sub>=0.18, p=0.861, 95% CI [-0.18, 0.22]</p>
<p>We can now make the Supplemental Figure with all the behavioral supplemental plots.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="behavioral-analysis.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make new supplemental figure</span></span>
<span id="cb126-2"><a href="behavioral-analysis.html#cb126-2" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb126-3"><a href="behavioral-analysis.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="st">AAAAAAAAAABBBBBBBBBBCCCCCCCCCCDDDDDDDDDD</span></span>
<span id="cb126-4"><a href="behavioral-analysis.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="st">EEEEEEFFFFGGGGGGGGGGHHHHHHHHHHIIIIIIIIII&quot;</span></span>
<span id="cb126-5"><a href="behavioral-analysis.html#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="behavioral-analysis.html#cb126-6" aria-hidden="true" tabindex="-1"></a>sfig <span class="ot">&lt;-</span> sfig_beh_a <span class="sc">+</span> sfig_beh_b <span class="sc">+</span> sfig_beh_c <span class="sc">+</span> sfig_beh_d <span class="sc">+</span> sfig_beh_e<span class="sc">+</span> sfig_beh_f <span class="sc">+</span> sfig_beh_g <span class="sc">+</span> sfig_beh_h <span class="sc">+</span> sfig_beh_i <span class="sc">+</span></span>
<span id="cb126-7"><a href="behavioral-analysis.html#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">+</span></span>
<span id="cb126-8"><a href="behavioral-analysis.html#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;A&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb126-9"><a href="behavioral-analysis.html#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb126-10"><a href="behavioral-analysis.html#cb126-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb126-11"><a href="behavioral-analysis.html#cb126-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb126-12"><a href="behavioral-analysis.html#cb126-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb126-13"><a href="behavioral-analysis.html#cb126-13" aria-hidden="true" tabindex="-1"></a>sfig[[<span class="dv">5</span>]] <span class="ot">&lt;-</span> sfig[[<span class="dv">5</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb126-14"><a href="behavioral-analysis.html#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="behavioral-analysis.html#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb126-16"><a href="behavioral-analysis.html#cb126-16" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf03&quot;</span>)</span>
<span id="cb126-17"><a href="behavioral-analysis.html#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>sfig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb126-18"><a href="behavioral-analysis.html#cb126-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">11</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb126-19"><a href="behavioral-analysis.html#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>sfig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb126-20"><a href="behavioral-analysis.html#cb126-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">17.4</span>, <span class="at">height =</span> <span class="dv">11</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="/data/pt_02261/virtem/figures/sf03.png" alt="" />
<p class="caption">Supplemental Figure 3. Memory performance. A. A permutation-based repeated measures ANOVA revealed a significant effect of sequence on mean absolute errors in the timeline task (F3,81=5.86, p&lt;0.001, post hoc contrasts: sequence 1 vs. 2: t27=3.38, p=0.001, sequence 1 vs. 3: t27=-0.12, p=0.912, sequence 1 vs. 4: t27=2.59, p=0.013, sequence 2 vs. 3: t27=-2.92, p=0.001, sequence 2 vs. 4: t27=-1.15, p=0.271, sequence 3 vs. 4: t27=2.15, p=0.023). *p &lt; Bonferroni-adjusted alpha-level of 0.008, corrected for 6 pairwise post hoc comparisons. B. Mean absolute timeline errors did not differ statistically between sequences with fast and slow clock speed (t27=-0.82, p=0.423). C. The number of errors in the sorting task did not correlate with the mean absolute error in the timeline task across participants (r=0.23, p=0.246). D. Mean absolute errors in the timeline task were not statistically different between participants who made one or more errors (red) or no errors in the sorting task (green) in the sorting task (t-test for independent samples, t26=-1.79, p=0.085). E. Histogram shows the number of swap errors for participants with (red) and without (green) errors in the sorting task. F. The distribution of swap errors over sequence positions did not deviate statistically from uniformity (𝝌2(1)=1.07, p=0.899). G. Histogram shows the null distribution of the proportion of swap errors expected under random sorting errors. The proportion of swap errors observed in our sample (red line) exceeded the 95th percentile of the null distribution (black line). H. The number of swap errors was not significantly correlated with the generalization bias (Spearman r=0.12, p=0.528). I. The generalization bias in the timeline task was not significantly different between participants who made one or more swap errors (red) or no swap errors (green) in the sorting task (t26=0.18, p=0.861). A, B, D, H. Circles show individual participant values; boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points. C, H. Each circle shows data from one participant, grey line and shaded region indicate least squares line and confidence interval.</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prepare-behavioral-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prepare-fmri-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
