<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Signal to noise ratio | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</title>
  <meta name="description" content="9 Signal to noise ratio | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Signal to noise ratio | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jacbel.github.io/virtem_code/" />
  
  <meta property="og:description" content="9 Signal to noise ratio | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  <meta name="github-repo" content="jacbel/virtem_code" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Signal to noise ratio | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  
  <meta name="twitter:description" content="9 Signal to noise ratio | Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences" />
  

<meta name="author" content="Jacob L. S. Bellmund" />


<meta name="date" content="2022-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rsa-on-pattern-similarity-change.html"/>
<link rel="next" href="rsa-in-searchlight-peak-with-different-threshold.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contents"><i class="fa fa-check"></i><b>1.2</b> Contents</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.3</b> Contact</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#license-information"><i class="fa fa-check"></i><b>1.4</b> License Information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analysis-setup.html"><a href="analysis-setup.html"><i class="fa fa-check"></i><b>2</b> Analysis Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="analysis-setup.html"><a href="analysis-setup.html#defining-variables-and-folders"><i class="fa fa-check"></i><b>2.1</b> Defining Variables and Folders</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#folder-structure"><i class="fa fa-check"></i>Folder Structure</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="analysis-setup.html"><a href="analysis-setup.html#define-analysis-functions"><i class="fa fa-check"></i><b>2.2</b> Define Analysis Functions</a>
<ul>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#analysis-logic"><i class="fa fa-check"></i>Analysis Logic</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#brain-plots-in-ggplot"><i class="fa fa-check"></i>Brain Plots in ggplot</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#ggbrain-functions-to-get-template-background"><i class="fa fa-check"></i>ggBrain functions to get template background</a></li>
<li class="chapter" data-level="" data-path="analysis-setup.html"><a href="analysis-setup.html#waiting-for-cluster-jobs"><i class="fa fa-check"></i>Waiting for Cluster Jobs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html"><i class="fa fa-check"></i><b>3</b> Illustrations of Task Design and Analysis Logic</a>
<ul>
<li class="chapter" data-level="3.1" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#day-learning-task-design"><i class="fa fa-check"></i><b>3.1</b> Day Learning Task Design</a>
<ul>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-and-real-time"><i class="fa fa-check"></i>Events in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-virtual-time"><i class="fa fa-check"></i>Events in virtual time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#events-in-real-time"><i class="fa fa-check"></i>Events in real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#correlations-of-virtual-time-with-order-and-real-time"><i class="fa fa-check"></i>Correlations of virtual time with order and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#time-cues-in-virtual-and-real-time"><i class="fa fa-check"></i>Time cues in virtual and real time</a></li>
<li class="chapter" data-level="" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#supplemental-figure-for-task-design"><i class="fa fa-check"></i>Supplemental figure for task design</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="illustrations-of-task-design-and-analysis-logic.html"><a href="illustrations-of-task-design-and-analysis-logic.html#representational-similarity-analysis-logic"><i class="fa fa-check"></i><b>3.2</b> Representational Similarity Analysis Logic</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html"><i class="fa fa-check"></i><b>4</b> Prepare behavioral data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#sorting-task"><i class="fa fa-check"></i><b>4.1</b> Sorting task</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#timeline-task"><i class="fa fa-check"></i><b>4.2</b> Timeline task</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-behavioral-data.html"><a href="prepare-behavioral-data.html#picture-viewing-tasks"><i class="fa fa-check"></i><b>4.3</b> Picture viewing tasks</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html"><i class="fa fa-check"></i><b>5</b> Behavioral Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-task-1"><i class="fa fa-check"></i><b>5.1</b> Sorting Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#calculate-percentage-of-correct-responses"><i class="fa fa-check"></i>Calculate percentage of correct responses</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#plot-sorting-performance"><i class="fa fa-check"></i>Plot sorting performance</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#sorting-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Sorting errors as a function of sequence position</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#timeline-task-1"><i class="fa fa-check"></i><b>5.2</b> Timeline Task</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#visualize-the-raw-data"><i class="fa fa-check"></i>Visualize the raw data</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#accuracy-of-remembered-times"><i class="fa fa-check"></i>Accuracy of remembered times</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#relationship-of-sorting-errors-and-timeline-errors"><i class="fa fa-check"></i>Relationship of sorting errors and timeline errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#time-metrics-underlying-remembered-times"><i class="fa fa-check"></i>Time metrics underlying remembered times</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#compose-figure-for-behavioral-data"><i class="fa fa-check"></i>Compose Figure for Behavioral Data</a></li>
<li class="chapter" data-level="5.3" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#generalization-bias"><i class="fa fa-check"></i><b>5.3</b> Generalization bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#test-generalization-bias"><i class="fa fa-check"></i>Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-of-generalization-bias"><i class="fa fa-check"></i><b>5.4</b> Replication of Generalization Bias</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-quantify-relative-time-of-other-events"><i class="fa fa-check"></i>Replication data: Quantify relative time of other events</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#replication-data-test-generalization-bias"><i class="fa fa-check"></i>Replication data: Test Generalization Bias</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors"><i class="fa fa-check"></i><b>5.5</b> Swap Errors</a>
<ul>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#descriptives-of-swap-errors"><i class="fa fa-check"></i>Descriptives of swap errors</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-as-a-function-of-sequence-position"><i class="fa fa-check"></i>Swap errors as a function of sequence position</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-error-more-frequent-than-expected-from-chance"><i class="fa fa-check"></i>Swap error: More frequent than expected from chance?</a></li>
<li class="chapter" data-level="" data-path="behavioral-analysis.html"><a href="behavioral-analysis.html#swap-errors-and-generalization-bias"><i class="fa fa-check"></i>Swap errors and generalization bias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html"><i class="fa fa-check"></i><b>6</b> Prepare (f)MRI Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#regions-of-interest"><i class="fa fa-check"></i><b>6.1</b> Regions of Interest</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#freesurfer-masks"><i class="fa fa-check"></i>FreeSurfer Masks</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#subregion-masks-mni"><i class="fa fa-check"></i>Subregion masks (MNI)</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#final-rois-from-intersection-of-masks"><i class="fa fa-check"></i>Final ROIs from intersection of masks</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#group-level-masks"><i class="fa fa-check"></i><b>6.2</b> Group-Level Masks</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#probabilistic-rois-for-visualization"><i class="fa fa-check"></i>Probabilistic ROIs for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#field-of-view-mask-for-visualization"><i class="fa fa-check"></i>Field of view mask for visualization</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#gray-matter-mask"><i class="fa fa-check"></i>Gray matter mask</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#small-volume-correction-mask"><i class="fa fa-check"></i>Small Volume Correction Mask</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#quantify-representational-change"><i class="fa fa-check"></i><b>6.3</b> Quantify Representational Change</a>
<ul>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#get-multi-voxel-patterns-from-rois"><i class="fa fa-check"></i>Get multi-voxel patterns from ROIs</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-correlation-matrices"><i class="fa fa-check"></i>Calculate correlation matrices</a></li>
<li class="chapter" data-level="" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#calculate-pattern-similarity-change"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="prepare-fmri-data.html"><a href="prepare-fmri-data.html#combine-behavioral-and-fmri-data-for-rsa"><i class="fa fa-check"></i><b>6.4</b> Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html"><i class="fa fa-check"></i><b>7</b> Run RSA Searchlight</a>
<ul>
<li class="chapter" data-level="7.1" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-functional-data"><i class="fa fa-check"></i><b>7.1</b> Prepare functional data</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#data-cleaning-extract-residuals-from-motion-parameter-regression"><i class="fa fa-check"></i>Data cleaning: Extract residuals from motion parameter regression</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#extract-relevant-volumes-1"><i class="fa fa-check"></i>Extract relevant volumes</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#concatenate-relevant-volumes"><i class="fa fa-check"></i>Concatenate relevant volumes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#first-level-rsa-searchlight"><i class="fa fa-check"></i><b>7.2</b> First-level RSA searchlight</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#set-analysis-parameters"><i class="fa fa-check"></i>Set analysis parameters</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-predictions"><i class="fa fa-check"></i>Prepare RSA-predictions</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-lookup-table-for-searchlight"><i class="fa fa-check"></i>Create lookup table for searchlight</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#dataframe-with-input-for-analysis"><i class="fa fa-check"></i>Dataframe with input for analysis</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#searchlight-implementation"><i class="fa fa-check"></i>Searchlight implementation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#group-level-searchlight-analysis"><i class="fa fa-check"></i><b>7.3</b> Group-level searchlight analysis</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#move-first-level-images-to-mni-space"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#merge-and-smooth-first-level-images"><i class="fa fa-check"></i>Merge and smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#run-fsl-randomise"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#find-searchlight-clusters-and-atlas-labels"><i class="fa fa-check"></i>Find searchlight clusters and atlas labels</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-outlines-of-significant-clusters"><i class="fa fa-check"></i>Create outlines of significant clusters</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#prepare-rsa-in-searchlight-peak"><i class="fa fa-check"></i><b>7.4</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#create-the-roi-mask"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculating-the-correlation-matrices"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#calculate-pattern-similarity-change-1"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="run-rsa-searchlight.html"><a href="run-rsa-searchlight.html#combine-behavioral-and-fmri-data-for-rsa-1"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html"><i class="fa fa-check"></i><b>8</b> RSA on Pattern Similarity Change</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#time-metrics-to-quantify-event-relations"><i class="fa fa-check"></i><b>8.1</b> Time metrics to quantify event relations</a></li>
<li class="chapter" data-level="8.2" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualize-regions-of-interests"><i class="fa fa-check"></i><b>8.2</b> Visualize Regions of Interests</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#template-background-image-with-fov"><i class="fa fa-check"></i>Template background image with FOV</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-hippocampus-roi"><i class="fa fa-check"></i>Anterior hippocampus ROI</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#anterior-lateral-entorhinal-cortex"><i class="fa fa-check"></i>Anterior-lateral entorhinal cortex</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#first-level-rsa"><i class="fa fa-check"></i><b>8.3</b> First-level RSA</a></li>
<li class="chapter" data-level="8.4" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence"><i class="fa fa-check"></i><b>8.4</b> aHPC: virtual time within sequence</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-3"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-2"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#not-driven-by-first-last-event-pairs"><i class="fa fa-check"></i>Not driven by first &amp; last event pairs</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.5</b> aHPC: virtual time within sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#one-model-with-multiple-predictors"><i class="fa fa-check"></i>One model with multiple predictors</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-explains-residuals-of-order-and-real-time"><i class="fa fa-check"></i>Virtual time explains residuals of order and real time</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequences"><i class="fa fa-check"></i><b>8.6</b> aHPC: virtual time across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-7"><i class="fa fa-check"></i>Summary statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-5"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#representational-change-visualization-1"><i class="fa fa-check"></i>Representational Change Visualization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-across-sequence-when-including-order-real-time"><i class="fa fa-check"></i><b>8.7</b> aHPC: virtual time across sequence when including order &amp; real time</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-8"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-6"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i><b>8.8</b> aHPC: virtual time within vs. across sequences</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#second-level-analysis"><i class="fa fa-check"></i>Second-level analysis</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-7"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-order"><i class="fa fa-check"></i>Interaction of sequence membership and order</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-real-time"><i class="fa fa-check"></i>Interaction of sequence membership and real time</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#interaction-of-sequence-membership-and-virtual-time-when-including-interactions-with-other-time-metrics"><i class="fa fa-check"></i>Interaction of sequence membership and virtual time when including interactions with other time metrics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mds"><i class="fa fa-check"></i>MDS</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#umap"><i class="fa fa-check"></i>UMAP</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec"><i class="fa fa-check"></i><b>8.9</b> alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-withinacross-sequences-separately"><i class="fa fa-check"></i>alEC: virtual time within/across sequences separately</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-within-vs.-across-sequences"><i class="fa fa-check"></i>alEC: virtual time within vs. across sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs"><i class="fa fa-check"></i>alEC: virtual time for all event pairs</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#alec-virtual-time-for-all-event-pairs-when-including-order-real-time"><i class="fa fa-check"></i>alEC: virtual time for all event pairs when including order &amp; real time</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#ahpc-vs.-alec"><i class="fa fa-check"></i><b>8.10</b> aHPC vs. alEC</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#summary-statistics-12"><i class="fa fa-check"></i>Summary Statistics</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#linear-mixed-effects-10"><i class="fa fa-check"></i>Linear Mixed Effects</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#searchlight-results"><i class="fa fa-check"></i><b>8.11</b> Searchlight Results</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-within-sequence"><i class="fa fa-check"></i>Virtual Time Within Sequence</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences-in-within-searchlight-cluster"><i class="fa fa-check"></i>Virtual Time Across Sequences in Within-Searchlight Cluster</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-across-sequences"><i class="fa fa-check"></i>Virtual Time Across Sequences</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#visualization-of-overlap"><i class="fa fa-check"></i>Visualization of Overlap</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#virtual-time-sequence-interaction"><i class="fa fa-check"></i>Virtual Time &amp; Sequence Interaction</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#exploratory-searchlight-results"><i class="fa fa-check"></i>Exploratory Searchlight Results</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-of-behavioral-generalization-bias-with-searchlight-effects"><i class="fa fa-check"></i><b>8.12</b> Correlation of behavioral generalization bias with searchlight effects</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-across-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with across-sequence searchlight effect</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#correlation-with-same-sequence-searchlight-effect"><i class="fa fa-check"></i>Correlation with same-sequence searchlight effect</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#mixed-model-summaries"><i class="fa fa-check"></i><b>8.13</b> Mixed Model Summaries</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-figure-1"><i class="fa fa-check"></i>Supplemental Figure</a></li>
<li class="chapter" data-level="" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#supplemental-tables"><i class="fa fa-check"></i>Supplemental Tables</a></li>
<li class="chapter" data-level="8.13.1" data-path="rsa-on-pattern-similarity-change.html"><a href="rsa-on-pattern-similarity-change.html#source-data"><i class="fa fa-check"></i><b>8.13.1</b> Source data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html"><i class="fa fa-check"></i><b>9</b> Signal to noise ratio</a>
<ul>
<li class="chapter" data-level="9.1" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#calculate-voxel-wise-temporal-snr"><i class="fa fa-check"></i><b>9.1</b> Calculate voxel-wise temporal SNR</a></li>
<li class="chapter" data-level="9.2" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#average-tsnr-per-roi"><i class="fa fa-check"></i><b>9.2</b> Average tSNR per ROI</a></li>
<li class="chapter" data-level="9.3" data-path="signal-to-noise-ratio.html"><a href="signal-to-noise-ratio.html#contrast-tsnr-between-ahpc-and-alec"><i class="fa fa-check"></i><b>9.3</b> Contrast tSNR between aHPC and alEC</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html"><i class="fa fa-check"></i><b>10</b> RSA in searchlight peak with different threshold</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#prepare-rsa-in-searchlight-peak-1"><i class="fa fa-check"></i><b>10.1</b> Prepare RSA in searchlight peak</a>
<ul>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#create-the-roi-mask-1"><i class="fa fa-check"></i>Create the ROI mask</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculating-the-correlation-matrices-1"><i class="fa fa-check"></i>Calculating the correlation matrices</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#calculate-pattern-similarity-change-2"><i class="fa fa-check"></i>Calculate Pattern Similarity Change</a></li>
<li class="chapter" data-level="" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#combine-behavioral-and-fmri-data-for-rsa-2"><i class="fa fa-check"></i>Combine behavioral and fMRI data for RSA</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="rsa-in-searchlight-peak-with-different-threshold.html"><a href="rsa-in-searchlight-peak-with-different-threshold.html#rsa"><i class="fa fa-check"></i><b>10.2</b> RSA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html"><i class="fa fa-check"></i><b>11</b> Univariate GLM: Relative time</a>
<ul>
<li class="chapter" data-level="11.1" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#copy-feat-folder-from-preprocessing-to-first-level-glm-directory"><i class="fa fa-check"></i><b>11.1</b> Copy FEAT-folder from Preprocessing to First-Level GLM directory</a></li>
<li class="chapter" data-level="11.2" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-glm"><i class="fa fa-check"></i><b>11.2</b> Prepare GLM</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#compute-relative-time"><i class="fa fa-check"></i>Compute relative time</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#write-custom-ev-files-for-fsl-feat"><i class="fa fa-check"></i>Write custom EV files for FSL FEAT</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#glm-design-files"><i class="fa fa-check"></i>GLM Design files</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#prepare-confound-ev"><i class="fa fa-check"></i>Prepare confound EV</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#create-design-matrix"><i class="fa fa-check"></i>Create design matrix</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-1st-level-glm-on-htcondor"><i class="fa fa-check"></i><b>11.3</b> Run 1st-level GLM on HTCondor</a></li>
<li class="chapter" data-level="11.4" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#group-level-1"><i class="fa fa-check"></i><b>11.4</b> Group-level</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#move-first-level-images-to-mni-space-1"><i class="fa fa-check"></i>Move first-level images to MNI space</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#merge-first-level-images"><i class="fa fa-check"></i>Merge first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#smooth-first-level-images"><i class="fa fa-check"></i>Smooth first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#average-first-level-images"><i class="fa fa-check"></i>Average first-level images</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#ahpc-roi-analysis"><i class="fa fa-check"></i>aHPC ROI analysis</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#run-fsl-randomise-1"><i class="fa fa-check"></i>Run FSL Randomise</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#results-in-ahpc-and-alec"><i class="fa fa-check"></i>Results in aHPC and alEC</a></li>
<li class="chapter" data-level="" data-path="univariate-glm-relative-time.html"><a href="univariate-glm-relative-time.html#fov-results"><i class="fa fa-check"></i>FOV results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="credit.html"><a href="credit.html"><i class="fa fa-check"></i><b>12</b> Credit</a>
<ul>
<li class="chapter" data-level="12.1" data-path="credit.html"><a href="credit.html#list-of-packages"><i class="fa fa-check"></i><b>12.1</b> List of packages</a></li>
<li class="chapter" data-level="12.2" data-path="credit.html"><a href="credit.html#references"><i class="fa fa-check"></i><b>12.2</b> References</a></li>
<li class="chapter" data-level="12.3" data-path="credit.html"><a href="credit.html#session-info"><i class="fa fa-check"></i><b>12.3</b> Session Info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structuring time: The hippocampus constructs sequence memories that generalize temporal relations across experiences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="signal-to-noise-ratio" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Signal to noise ratio</h1>
<blockquote>
<p>The temporal signal-to-noise ratio was quantified as the mean unsmoothed signal over time divided by its standard deviation. It was calculated for each voxel and then averaged across voxels in a region of interest.</p>
</blockquote>
<p>We want to contrast the signal to noise ratio in our regions of interest. We will look at both the temporal and spatial signal to noise ratio. We will used the cleaned voxel time series that we also extracted the multi-voxel patterns from for this.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="signal-to-noise-ratio.html#cb501-1" aria-hidden="true" tabindex="-1"></a>snr_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;mri&quot;</span>, <span class="st">&quot;processed&quot;</span>, <span class="st">&quot;SNR&quot;</span>)</span>
<span id="cb501-2"><a href="signal-to-noise-ratio.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="fu">file.path</span>(snr_dir, subjects), </span>
<span id="cb501-3"><a href="signal-to-noise-ratio.html#cb501-3" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(x) <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(x)) <span class="fu">dir.create</span>(x, <span class="at">recursive =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<div id="calculate-voxel-wise-temporal-snr" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Calculate voxel-wise temporal SNR</h2>
<p>The first step is to calculate the temporal signal to noise ratio for each voxel. We use fslmaths for that via the fslr-package. Specifically, the tSNR of a voxel is its temporal mean divided by its standard deviation over time. This is done for each of the ten blocks of each run of the picture viewing task.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="signal-to-noise-ratio.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build a tibble with the info we&#39;ll need tp build the file names (will be overwritten later)</span></span>
<span id="cb502-2"><a href="signal-to-noise-ratio.html#cb502-2" aria-hidden="true" tabindex="-1"></a>snr_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="fu">rep</span>(subjects, <span class="at">each =</span> n_runs<span class="sc">*</span>n_blocks),</span>
<span id="cb502-3"><a href="signal-to-noise-ratio.html#cb502-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">run =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(runs, <span class="at">each =</span> n_blocks), n_subs),</span>
<span id="cb502-4"><a href="signal-to-noise-ratio.html#cb502-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">run_no =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">each =</span> n_blocks), n_subs),</span>
<span id="cb502-5"><a href="signal-to-noise-ratio.html#cb502-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">block =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n_blocks), n_runs<span class="sc">*</span>n_subs)</span>
<span id="cb502-6"><a href="signal-to-noise-ratio.html#cb502-6" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb502-7"><a href="signal-to-noise-ratio.html#cb502-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-8"><a href="signal-to-noise-ratio.html#cb502-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create the file names to use</span></span>
<span id="cb502-9"><a href="signal-to-noise-ratio.html#cb502-9" aria-hidden="true" tabindex="-1"></a>filt_func_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>samespace_dir,</span>
<span id="cb502-10"><a href="signal-to-noise-ratio.html#cb502-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste0</span>(<span class="st">&quot;VIRTEM_P&quot;</span>, snr_df<span class="sc">$</span>subject),</span>
<span id="cb502-11"><a href="signal-to-noise-ratio.html#cb502-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">sprintf</span>(<span class="st">&quot;VIRTEM_P%s_RSA_%02d_Block%02d_func.nii.gz&quot;</span>,</span>
<span id="cb502-12"><a href="signal-to-noise-ratio.html#cb502-12" aria-hidden="true" tabindex="-1"></a>                                  snr_df<span class="sc">$</span>subject, snr_df<span class="sc">$</span>run_no, snr_df<span class="sc">$</span>block)) </span>
<span id="cb502-13"><a href="signal-to-noise-ratio.html#cb502-13" aria-hidden="true" tabindex="-1"></a>tMean_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(snr_dir, snr_df<span class="sc">$</span>subject, </span>
<span id="cb502-14"><a href="signal-to-noise-ratio.html#cb502-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sprintf</span>(<span class="st">&quot;%s_RSA_%s_block%02d_tMean.nii.gz&quot;</span>,</span>
<span id="cb502-15"><a href="signal-to-noise-ratio.html#cb502-15" aria-hidden="true" tabindex="-1"></a>                              snr_df<span class="sc">$</span>subject, snr_df<span class="sc">$</span>run, snr_df<span class="sc">$</span>block))</span>
<span id="cb502-16"><a href="signal-to-noise-ratio.html#cb502-16" aria-hidden="true" tabindex="-1"></a>tSd_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(snr_dir, snr_df<span class="sc">$</span>subject,</span>
<span id="cb502-17"><a href="signal-to-noise-ratio.html#cb502-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sprintf</span>(<span class="st">&quot;%s_RSA_%s_block%02d_tSd.nii.gz&quot;</span>,</span>
<span id="cb502-18"><a href="signal-to-noise-ratio.html#cb502-18" aria-hidden="true" tabindex="-1"></a>                            snr_df<span class="sc">$</span>subject, snr_df<span class="sc">$</span>run, snr_df<span class="sc">$</span>block))</span>
<span id="cb502-19"><a href="signal-to-noise-ratio.html#cb502-19" aria-hidden="true" tabindex="-1"></a>tSNR_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(snr_dir, snr_df<span class="sc">$</span>subject,</span>
<span id="cb502-20"><a href="signal-to-noise-ratio.html#cb502-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sprintf</span>(<span class="st">&quot;%s_RSA_%s_block%02d_tSNR.nii.gz&quot;</span>,</span>
<span id="cb502-21"><a href="signal-to-noise-ratio.html#cb502-21" aria-hidden="true" tabindex="-1"></a>                             snr_df<span class="sc">$</span>subject, snr_df<span class="sc">$</span>run, snr_df<span class="sc">$</span>block))</span>
<span id="cb502-22"><a href="signal-to-noise-ratio.html#cb502-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-23"><a href="signal-to-noise-ratio.html#cb502-23" aria-hidden="true" tabindex="-1"></a><span class="co"># define function to calculate tSNR</span></span>
<span id="cb502-24"><a href="signal-to-noise-ratio.html#cb502-24" aria-hidden="true" tabindex="-1"></a>calc_tSNR <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">fourD_fn=</span><span class="cn">NULL</span>, <span class="at">tMean_fn=</span><span class="cn">NULL</span>, <span class="at">tStd_fn=</span><span class="cn">NULL</span>, <span class="at">tSNR_fn=</span><span class="cn">NULL</span>){</span>
<span id="cb502-25"><a href="signal-to-noise-ratio.html#cb502-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb502-26"><a href="signal-to-noise-ratio.html#cb502-26" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate temporal mean for each voxel</span></span>
<span id="cb502-27"><a href="signal-to-noise-ratio.html#cb502-27" aria-hidden="true" tabindex="-1"></a>fslr<span class="sc">::</span><span class="fu">fsl_maths</span>(<span class="at">file =</span> fourD_fn, <span class="at">opts =</span> <span class="st">&quot;-Tmean&quot;</span>, <span class="at">outfile =</span> tMean_fn,</span>
<span id="cb502-28"><a href="signal-to-noise-ratio.html#cb502-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">retimg =</span> <span class="cn">FALSE</span>)</span>
<span id="cb502-29"><a href="signal-to-noise-ratio.html#cb502-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-30"><a href="signal-to-noise-ratio.html#cb502-30" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate temporal mean for each voxel</span></span>
<span id="cb502-31"><a href="signal-to-noise-ratio.html#cb502-31" aria-hidden="true" tabindex="-1"></a>fslr<span class="sc">::</span><span class="fu">fsl_maths</span>(<span class="at">file =</span> fourD_fn, <span class="at">opts =</span> <span class="st">&quot;-Tstd&quot;</span>, <span class="at">outfile =</span> tStd_fn,</span>
<span id="cb502-32"><a href="signal-to-noise-ratio.html#cb502-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">retimg =</span> <span class="cn">FALSE</span>)</span>
<span id="cb502-33"><a href="signal-to-noise-ratio.html#cb502-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-34"><a href="signal-to-noise-ratio.html#cb502-34" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate temporal mean for each voxel</span></span>
<span id="cb502-35"><a href="signal-to-noise-ratio.html#cb502-35" aria-hidden="true" tabindex="-1"></a>fslr<span class="sc">::</span><span class="fu">fsl_div</span>(<span class="at">file =</span> tMean_fn, <span class="at">file2 =</span> tStd_fn, <span class="at">outfile =</span> tSNR_fn,</span>
<span id="cb502-36"><a href="signal-to-noise-ratio.html#cb502-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">retimg =</span> <span class="cn">FALSE</span>)</span>
<span id="cb502-37"><a href="signal-to-noise-ratio.html#cb502-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb502-38"><a href="signal-to-noise-ratio.html#cb502-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb502-39"><a href="signal-to-noise-ratio.html#cb502-39" aria-hidden="true" tabindex="-1"></a><span class="co"># apply to images in questions (invisible to avoid overly long output)</span></span>
<span id="cb502-40"><a href="signal-to-noise-ratio.html#cb502-40" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">mapply</span>(calc_tSNR, <span class="at">fourD_fn=</span>filt_func_fn, <span class="at">tMean_fn=</span>tMean_fn, <span class="at">tStd_fn=</span>tSd_fn, <span class="at">tSNR_fn=</span>tSNR_fn))</span></code></pre></div>
</div>
<div id="average-tsnr-per-roi" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Average tSNR per ROI</h2>
<p>To find the average tSNR for a given ROI, we load the tSNR image and the ROI mask before calculating the mean across voxels. Here we define the function that returns the mean tSNR, given the file names of the tSNR image and the ROI masks.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="signal-to-noise-ratio.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to calculate the mean tSNR for an ROI</span></span>
<span id="cb503-2"><a href="signal-to-noise-ratio.html#cb503-2" aria-hidden="true" tabindex="-1"></a>get_ROI_tSNR <span class="ot">&lt;-</span> <span class="cf">function</span>(roi_fn, tSNR_fn){</span>
<span id="cb503-3"><a href="signal-to-noise-ratio.html#cb503-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb503-4"><a href="signal-to-noise-ratio.html#cb503-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load images</span></span>
<span id="cb503-5"><a href="signal-to-noise-ratio.html#cb503-5" aria-hidden="true" tabindex="-1"></a>  tSNR_nii <span class="ot">&lt;-</span> neurobase<span class="sc">::</span><span class="fu">readNIfTI2</span>(tSNR_fn)</span>
<span id="cb503-6"><a href="signal-to-noise-ratio.html#cb503-6" aria-hidden="true" tabindex="-1"></a>  roi_nii <span class="ot">&lt;-</span> neurobase<span class="sc">::</span><span class="fu">readNIfTI2</span>(roi_fn)</span>
<span id="cb503-7"><a href="signal-to-noise-ratio.html#cb503-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb503-8"><a href="signal-to-noise-ratio.html#cb503-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the tSNR values of the ROI voxels</span></span>
<span id="cb503-9"><a href="signal-to-noise-ratio.html#cb503-9" aria-hidden="true" tabindex="-1"></a>  snr_dat <span class="ot">&lt;-</span> tSNR_nii[roi_nii<span class="sc">==</span><span class="dv">1</span>]</span>
<span id="cb503-10"><a href="signal-to-noise-ratio.html#cb503-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb503-11"><a href="signal-to-noise-ratio.html#cb503-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return the average</span></span>
<span id="cb503-12"><a href="signal-to-noise-ratio.html#cb503-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(snr_dat))</span>
<span id="cb503-13"><a href="signal-to-noise-ratio.html#cb503-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s apply the function and store the tSNR values for each block in each run.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="signal-to-noise-ratio.html#cb504-1" aria-hidden="true" tabindex="-1"></a>snr_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="fu">rep</span>(subjects, <span class="at">each =</span> n_runs<span class="sc">*</span>n_blocks<span class="sc">*</span><span class="fu">length</span>(rois)),</span>
<span id="cb504-2"><a href="signal-to-noise-ratio.html#cb504-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">roi =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(rois, <span class="at">each =</span> n_runs <span class="sc">*</span> n_blocks),n_subs),</span>
<span id="cb504-3"><a href="signal-to-noise-ratio.html#cb504-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">run =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(runs, <span class="at">each =</span> n_blocks), <span class="fu">length</span>(rois)<span class="sc">*</span>n_subs),</span>
<span id="cb504-4"><a href="signal-to-noise-ratio.html#cb504-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">block =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n_blocks), n_runs<span class="sc">*</span><span class="fu">length</span>(rois)<span class="sc">*</span>n_subs),</span>
<span id="cb504-5"><a href="signal-to-noise-ratio.html#cb504-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tSNR =</span> <span class="cn">NA</span>)</span>
<span id="cb504-6"><a href="signal-to-noise-ratio.html#cb504-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb504-7"><a href="signal-to-noise-ratio.html#cb504-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(snr_df)){</span>
<span id="cb504-8"><a href="signal-to-noise-ratio.html#cb504-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb504-9"><a href="signal-to-noise-ratio.html#cb504-9" aria-hidden="true" tabindex="-1"></a>  snr_df<span class="sc">$</span>tSNR[i] <span class="ot">&lt;-</span> <span class="fu">get_ROI_tSNR</span>(<span class="at">roi_fn =</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;mri&quot;</span>, <span class="st">&quot;rois&quot;</span>, snr_df<span class="sc">$</span>roi[i], <span class="st">&quot;samespace&quot;</span>,</span>
<span id="cb504-10"><a href="signal-to-noise-ratio.html#cb504-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">sprintf</span>(<span class="st">&quot;P%s_%s_ss_fs.nii.gz&quot;</span>, </span>
<span id="cb504-11"><a href="signal-to-noise-ratio.html#cb504-11" aria-hidden="true" tabindex="-1"></a>                                                       snr_df<span class="sc">$</span>subject[i], snr_df<span class="sc">$</span>roi[i])), </span>
<span id="cb504-12"><a href="signal-to-noise-ratio.html#cb504-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">tSNR_fn =</span> <span class="fu">file.path</span>(snr_dir, snr_df<span class="sc">$</span>subject[i],</span>
<span id="cb504-13"><a href="signal-to-noise-ratio.html#cb504-13" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">sprintf</span>(<span class="st">&quot;%s_RSA_%s_block%02d_tSNR.nii.gz&quot;</span>,</span>
<span id="cb504-14"><a href="signal-to-noise-ratio.html#cb504-14" aria-hidden="true" tabindex="-1"></a>                                                             snr_df<span class="sc">$</span>subject[i], snr_df<span class="sc">$</span>run[i], snr_df<span class="sc">$</span>block[i])))</span>
<span id="cb504-15"><a href="signal-to-noise-ratio.html#cb504-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Lastly, we want to write out the dataframe with the tSNR values for later analysis.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="signal-to-noise-ratio.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the relevant data</span></span>
<span id="cb505-2"><a href="signal-to-noise-ratio.html#cb505-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;snr.txt&quot;</span>)</span>
<span id="cb505-3"><a href="signal-to-noise-ratio.html#cb505-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(snr_df, <span class="at">file =</span> fn, <span class="at">append =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, </span>
<span id="cb505-4"><a href="signal-to-noise-ratio.html#cb505-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>

</div>
<div id="contrast-tsnr-between-ahpc-and-alec" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Contrast tSNR between aHPC and alEC</h2>
<p>We begin by loading the SNR data from file.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="signal-to-noise-ratio.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data from CSV</span></span>
<span id="cb506-2"><a href="signal-to-noise-ratio.html#cb506-2" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dirs<span class="sc">$</span>data4analysis, <span class="st">&quot;snr.txt&quot;</span>)</span>
<span id="cb506-3"><a href="signal-to-noise-ratio.html#cb506-3" aria-hidden="true" tabindex="-1"></a>col_types_list <span class="ot">&lt;-</span> <span class="fu">cols_only</span>(</span>
<span id="cb506-4"><a href="signal-to-noise-ratio.html#cb506-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">subject =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb506-5"><a href="signal-to-noise-ratio.html#cb506-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">roi =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> rois),</span>
<span id="cb506-6"><a href="signal-to-noise-ratio.html#cb506-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">run =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> runs),</span>
<span id="cb506-7"><a href="signal-to-noise-ratio.html#cb506-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">block =</span> <span class="fu">col_double</span>(),</span>
<span id="cb506-8"><a href="signal-to-noise-ratio.html#cb506-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">tSNR =</span> <span class="fu">col_double</span>()</span>
<span id="cb506-9"><a href="signal-to-noise-ratio.html#cb506-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb506-10"><a href="signal-to-noise-ratio.html#cb506-10" aria-hidden="true" tabindex="-1"></a>snr_data <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_csv</span>(fn, <span class="at">col_types =</span> col_types_list))</span>
<span id="cb506-11"><a href="signal-to-noise-ratio.html#cb506-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-12"><a href="signal-to-noise-ratio.html#cb506-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(snr_data)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-246">
<col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">subject</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">roi</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">run</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">block</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">tSNR</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">031</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">aHPC_lr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">pre</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">26.9</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">031</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">aHPC_lr</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pre</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">25.2</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">031</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">aHPC_lr</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">pre</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">25.1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">031</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">aHPC_lr</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pre</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">25.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">031</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">aHPC_lr</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">pre</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">5</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">25.4</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">031</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">aHPC_lr</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pre</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">24.1</td></tr>
</table>

<p>To contrast the global tSNR between the aHPC and the alEC, we need to average across all blocks and runs to obtain one value per ROI per participant.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="signal-to-noise-ratio.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the average tSNR per ROI for each suject</span></span>
<span id="cb507-2"><a href="signal-to-noise-ratio.html#cb507-2" aria-hidden="true" tabindex="-1"></a>snr_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span> <span class="sc">|</span> roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb507-3"><a href="signal-to-noise-ratio.html#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject, roi) <span class="sc">%&gt;%</span></span>
<span id="cb507-4"><a href="signal-to-noise-ratio.html#cb507-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tSNR =</span> <span class="fu">mean</span>(tSNR), <span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>) <span class="ot">-&gt;</span> snr_avg</span></code></pre></div>
<p>To test whether the tSNR differs between the aHPC and the alEC we run a permutation-based t-test on the within-subject differences.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="signal-to-noise-ratio.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">56</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb508-2"><a href="signal-to-noise-ratio.html#cb508-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-3"><a href="signal-to-noise-ratio.html#cb508-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> snr_avg <span class="sc">%&gt;%</span></span>
<span id="cb508-4"><a href="signal-to-noise-ratio.html#cb508-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi<span class="sc">==</span><span class="st">&quot;aHPC_lr&quot;</span> <span class="sc">|</span> roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb508-5"><a href="signal-to-noise-ratio.html#cb508-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span></span>
<span id="cb508-6"><a href="signal-to-noise-ratio.html#cb508-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tSNR_diff =</span> tSNR[roi<span class="sc">==</span><span class="st">&quot;aHPC_lr&quot;</span>]<span class="sc">-</span>tSNR[roi<span class="sc">==</span><span class="st">&quot;alEC_lr&quot;</span>],<span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb508-7"><a href="signal-to-noise-ratio.html#cb508-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test difference against 0</span></span>
<span id="cb508-8"><a href="signal-to-noise-ratio.html#cb508-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tSNR_diff) <span class="sc">%&gt;%</span> </span>
<span id="cb508-9"><a href="signal-to-noise-ratio.html#cb508-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paired_t_perm_jb</span> (., <span class="at">n_perm =</span> n_perm)</span>
<span id="cb508-10"><a href="signal-to-noise-ratio.html#cb508-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb508-11"><a href="signal-to-noise-ratio.html#cb508-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen&#39;s d with Hedges&#39; correction for paired samples using non-central t-distribution for CI</span></span>
<span id="cb508-12"><a href="signal-to-noise-ratio.html#cb508-12" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">cohen.d</span>(<span class="at">d=</span>(snr_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>))<span class="sc">$</span>tSNR, </span>
<span id="cb508-13"><a href="signal-to-noise-ratio.html#cb508-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">f=</span>(snr_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>))<span class="sc">$</span>tSNR, </span>
<span id="cb508-14"><a href="signal-to-noise-ratio.html#cb508-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">pooled=</span><span class="cn">TRUE</span>, <span class="at">hedges.correction=</span><span class="cn">TRUE</span>, <span class="at">noncentral=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in pt(q = t, df = df, ncp = x): full precision may not have been achieved in &#39;pnt{final}&#39;

## Warning in pt(q = t, df = df, ncp = x): full precision may not have been achieved in &#39;pnt{final}&#39;</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="signal-to-noise-ratio.html#cb510-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>d <span class="ot">&lt;-</span> d<span class="sc">$</span>estimate</span>
<span id="cb510-2"><a href="signal-to-noise-ratio.html#cb510-2" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_low <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">1</span>]]</span>
<span id="cb510-3"><a href="signal-to-noise-ratio.html#cb510-3" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">$</span>dCI_high <span class="ot">&lt;-</span> d<span class="sc">$</span>conf.int[[<span class="dv">2</span>]]</span>
<span id="cb510-4"><a href="signal-to-noise-ratio.html#cb510-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-5"><a href="signal-to-noise-ratio.html#cb510-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb510-6"><a href="signal-to-noise-ratio.html#cb510-6" aria-hidden="true" tabindex="-1"></a><span class="fu">huxtable</span>(stats) <span class="sc">%&gt;%</span> <span class="fu">theme_article</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-248">
<col><col><col><col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">estimate</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">statistic</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p.value</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">p_perm</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">conf.high</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">method</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alternative</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">d</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dCI_low</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">dCI_high</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">4.44</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">12.4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.09e-12</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.0001</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">27</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.71</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.17</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">One Sample t-test</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">two.sided</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.99</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.65</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3.13</td></tr>
</table>

<p>Summary Statistics: paired t-test comparing tSNR in aHPC and alEC
t<sub>27</sub>=12.43, p=0.000, d=1.99, 95% CI [1.65, 3.13]</p>
<p>Here is a plot of the results</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="signal-to-noise-ratio.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with custom jitter</span></span>
<span id="cb511-2"><a href="signal-to-noise-ratio.html#cb511-2" aria-hidden="true" tabindex="-1"></a>snr_avg <span class="ot">&lt;-</span> snr_avg <span class="sc">%&gt;%</span> </span>
<span id="cb511-3"><a href="signal-to-noise-ratio.html#cb511-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_jit =</span> <span class="fu">as.numeric</span>(roi) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">jitter</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n_subs), <span class="at">amount=</span><span class="fl">0.05</span>), <span class="at">each=</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),n_subs))</span>
<span id="cb511-4"><a href="signal-to-noise-ratio.html#cb511-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-5"><a href="signal-to-noise-ratio.html#cb511-5" aria-hidden="true" tabindex="-1"></a>snr_figa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>snr_avg, <span class="fu">aes</span>(<span class="at">x=</span>roi, <span class="at">y=</span>tSNR, <span class="at">fill =</span> roi, <span class="at">color =</span> roi)) <span class="sc">+</span></span>
<span id="cb511-6"><a href="signal-to-noise-ratio.html#cb511-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span>roi), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb511-7"><a href="signal-to-noise-ratio.html#cb511-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> .<span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb511-8"><a href="signal-to-noise-ratio.html#cb511-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], alEC_colors[<span class="st">&quot;main&quot;</span>]))) <span class="sc">+</span></span>
<span id="cb511-9"><a href="signal-to-noise-ratio.html#cb511-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">unname</span>(<span class="fu">c</span>(aHPC_colors[<span class="st">&quot;within_main&quot;</span>], alEC_colors[<span class="st">&quot;main&quot;</span>])),</span>
<span id="cb511-10"><a href="signal-to-noise-ratio.html#cb511-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;roi&quot;</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;aHPC&quot;</span>, <span class="st">&quot;alEC&quot;</span>)) <span class="sc">+</span></span>
<span id="cb511-11"><a href="signal-to-noise-ratio.html#cb511-11" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> snr_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;aHPC_lr&quot;</span>), </span>
<span id="cb511-12"><a href="signal-to-noise-ratio.html#cb511-12" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>roi, <span class="at">y=</span>tSNR),</span>
<span id="cb511-13"><a href="signal-to-noise-ratio.html#cb511-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.1</span>),</span>
<span id="cb511-14"><a href="signal-to-noise-ratio.html#cb511-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;l&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb511-15"><a href="signal-to-noise-ratio.html#cb511-15" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_violin</span>(<span class="at">data =</span> snr_avg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="st">&quot;alEC_lr&quot;</span>), </span>
<span id="cb511-16"><a href="signal-to-noise-ratio.html#cb511-16" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x=</span>roi, <span class="at">y=</span>tSNR),</span>
<span id="cb511-17"><a href="signal-to-noise-ratio.html#cb511-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="fl">0.1</span>),</span>
<span id="cb511-18"><a href="signal-to-noise-ratio.html#cb511-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">side =</span> <span class="st">&quot;r&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb511-19"><a href="signal-to-noise-ratio.html#cb511-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb511-20"><a href="signal-to-noise-ratio.html#cb511-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb511-21"><a href="signal-to-noise-ratio.html#cb511-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb511-22"><a href="signal-to-noise-ratio.html#cb511-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb511-23"><a href="signal-to-noise-ratio.html#cb511-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_jit, <span class="at">group=</span>subject,), <span class="at">color =</span> ultimate_gray, </span>
<span id="cb511-24"><a href="signal-to-noise-ratio.html#cb511-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>))) <span class="sc">+</span></span>
<span id="cb511-25"><a href="signal-to-noise-ratio.html#cb511-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x_jit, <span class="at">fill =</span> roi), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.15</span>)),</span>
<span id="cb511-26"><a href="signal-to-noise-ratio.html#cb511-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb511-27"><a href="signal-to-noise-ratio.html#cb511-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;aHPC&quot;</span>, <span class="st">&quot;alEC&quot;</span>)) <span class="sc">+</span></span>
<span id="cb511-28"><a href="signal-to-noise-ratio.html#cb511-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;tSNR&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;ROI&#39;</span>) <span class="sc">+</span>    </span>
<span id="cb511-29"><a href="signal-to-noise-ratio.html#cb511-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb511-30"><a href="signal-to-noise-ratio.html#cb511-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate(geom = &quot;line&quot;,x=c(1.3, 1.7), y=25, size=0.5) +</span></span>
<span id="cb511-31"><a href="signal-to-noise-ratio.html#cb511-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.5</span>), <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb511-32"><a href="signal-to-noise-ratio.html#cb511-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;underline(&quot;   ***   &quot;)&#39;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb511-33"><a href="signal-to-noise-ratio.html#cb511-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span> <span class="st">&quot;none&quot;</span>, <span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb511-34"><a href="signal-to-noise-ratio.html#cb511-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb511-35"><a href="signal-to-noise-ratio.html#cb511-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family =</span> font2use), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb511-36"><a href="signal-to-noise-ratio.html#cb511-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>) </span></code></pre></div>
<p>Save the figure with theme to match the other figures.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="signal-to-noise-ratio.html#cb512-1" aria-hidden="true" tabindex="-1"></a>snr_fig <span class="ot">&lt;-</span> snr_figa <span class="sc">+</span></span>
<span id="cb512-2"><a href="signal-to-noise-ratio.html#cb512-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb512-3"><a href="signal-to-noise-ratio.html#cb512-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position =</span> <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb512-4"><a href="signal-to-noise-ratio.html#cb512-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.margin=grid::unit(c(5,8,5,0), &quot;pt&quot;),</span></span>
<span id="cb512-5"><a href="signal-to-noise-ratio.html#cb512-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">family=</span>font2use),</span>
<span id="cb512-6"><a href="signal-to-noise-ratio.html#cb512-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb512-7"><a href="signal-to-noise-ratio.html#cb512-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb512-8"><a href="signal-to-noise-ratio.html#cb512-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb512-9"><a href="signal-to-noise-ratio.html#cb512-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&#39;mm&#39;</span>),</span>
<span id="cb512-10"><a href="signal-to-noise-ratio.html#cb512-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">3</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb512-11"><a href="signal-to-noise-ratio.html#cb512-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>))</span>
<span id="cb512-12"><a href="signal-to-noise-ratio.html#cb512-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-13"><a href="signal-to-noise-ratio.html#cb512-13" aria-hidden="true" tabindex="-1"></a><span class="co"># save and print</span></span>
<span id="cb512-14"><a href="signal-to-noise-ratio.html#cb512-14" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;sf08&quot;</span>)</span>
<span id="cb512-15"><a href="signal-to-noise-ratio.html#cb512-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.pdf&quot;</span>), <span class="at">plot=</span>snr_fig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb512-16"><a href="signal-to-noise-ratio.html#cb512-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb512-17"><a href="signal-to-noise-ratio.html#cb512-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(fn, <span class="st">&quot;.png&quot;</span>), <span class="at">plot=</span>snr_fig, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb512-18"><a href="signal-to-noise-ratio.html#cb512-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="st">&quot;retina&quot;</span>, <span class="at">device =</span> <span class="st">&quot;png&quot;</span>)</span>
<span id="cb512-19"><a href="signal-to-noise-ratio.html#cb512-19" aria-hidden="true" tabindex="-1"></a>snr_fig</span></code></pre></div>
<p><img src="virtem_book_files/figure-html/unnamed-chunk-250-1.png" width="672" /></p>
<blockquote>
<p>Supplemental Figure 6. Temporal signal-to-noise ratio in the anterior hippocampus and the anterior-lateral entorhinal cortex. A. The temporal signal-to-noise ratio was quantified as the mean unsmoothed signal over time divided by its standard deviation. It was calculated for each voxel and then averaged across voxels in a region of interest. The temporal signal-to-noise ratio was higher in the anterior hippocampus (aHPC) than in the anterior-lateral entorhinal cortex (alEC, summary statistics: t27=12.43, p&lt;0.001). Circles show individual participant values; boxplot shows median and upper/lower quartile along with whiskers extending to most extreme data point within 1.5 interquartile ranges above/below the upper/lower quartile; black circle with error bars corresponds to mean±S.E.M.; distribution shows probability density function of data points. *** p&lt;0.001 </p>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rsa-on-pattern-similarity-change.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rsa-in-searchlight-peak-with-different-threshold.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
